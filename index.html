<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MetaDefender Storage Security - Settings</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://vilevich.github.io/blue-line/tokens.css">
  <link rel="stylesheet" href="https://vilevich.github.io/blue-line/components.css">
  <link rel="stylesheet" href="https://vilevich.github.io/blue-line/icons.css">
  <style>
    /* Product-specific styles only. DS imported via <link> tags above. */

    /* ===== LAYOUT ===== */
    .app { display: flex; flex-direction: column; height: 100vh; }

    /* ===== HEADER ===== */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 56px;
      padding: 0 20px;
      background: var(--surface-bg);
      color: var(--text-strong);
      flex-shrink: 0;
      z-index: 10;
      border-bottom: 1px solid var(--border-bg);
    }
    .header-left { display: flex; align-items: center; gap: 12px; margin-left: -7px; }
    .header-logo { display: flex; align-items: center; gap: 10px; }
    .header-logo-icon {
      width: 28px; height: 28px;
      background: var(--header-bg);
      border-radius: 4px;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 12px; color: var(--text-on-fill);
    }
    .header-logo-text { display: flex; flex-direction: column; gap: 4px; font-family: var(--font-brand); }
    .header-logo-text span:first-child { font-size: 10px; font-weight: 400; line-height: 10px; color: var(--text-strong); letter-spacing: 0.5px; text-transform: uppercase; }
    .header-logo-text span:last-child { font-size: 16px; font-weight: 500; line-height: 16px; color: var(--text-strong); }
    .sidebar-toggle {
      width: 32px; height: 32px; border-radius: var(--radius);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-subtle); background: none; border: none;
    }
    .sidebar-toggle:hover { color: var(--text-strong); background: var(--hover-default); }
    .sidebar-toggle svg { width: 18px; height: 18px; }
    .header-right { display: flex; align-items: center; gap: 8px; }
    /* header-icon, notif-dot, header-avatar → blue-line/components.css */

    /* ===== MAIN ===== */
    .main { display: flex; flex: 1; min-height: 0; }

    /* ===== SIDEBAR ===== */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--surface-bg);
      border-right: 1px solid var(--border-bg);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      transition: width 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
    }
    .sidebar.collapsed {
      width: var(--sidebar-collapsed);
    }
    .content {
      transition: flex 0.25s cubic-bezier(0.4, 0, 0.2, 1) 0.03s;
    }
    .sidebar-nav {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
      padding: 8px;
    }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: var(--radius);
      font-size: 14px;
      color: var(--text-subtle);
      cursor: pointer;
      text-decoration: none;
      height: 40px;
      white-space: nowrap;
      overflow: hidden;
    }
    .nav-item:hover { background: var(--hover-subtle); }
    .nav-item.active { background: var(--blue-100); color: var(--text-strong); font-weight: 500; }
    .nav-item svg { width: 18px; height: 18px; flex-shrink: 0; }
    .nav-text { opacity: 1; transition: opacity 0.12s ease; }
    .sidebar.collapsed .nav-item { padding: 8px 12px; }
    .sidebar.collapsed .nav-text { opacity: 0; pointer-events: none; }
    .nav-divider { height: 1px; background: var(--border-200); margin: 2px 0; }
    .sidebar-footer { padding: 20px; display: flex; flex-direction: column; align-items: flex-start; gap: 4px; overflow: hidden; opacity: 1; transition: opacity 0.12s ease; font-family: var(--font-brand); }
    .sidebar-footer-brand { height: 18px; width: auto; flex-shrink: 0; }
    .sidebar-footer-tagline { font-size: 12px; font-weight: 400; color: var(--text-muted); white-space: nowrap; }
    .sidebar.collapsed .sidebar-footer { opacity: 0; pointer-events: none; }

    /* ===== CONTENT ===== */
    .content {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      min-width: 0;
    }

    /* .page-header, .page-title — moved to DS components.css */
    .btn-export {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 0 12px;
      height: 32px;
      background: var(--primary);
      color: var(--text-on-fill);
      border: none;
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
    }
    .btn-export:hover { background: var(--primary-hover); }

    /* Settings Cards */
    .settings-card {
      background: var(--surface-card);
      border: 1px solid var(--border-card);
      border-radius: var(--radius);
      box-shadow: var(--shadow-card);
      overflow: hidden;
      margin-bottom: 12px;
    }
    .settings-card:last-child { margin-bottom: 0; }
    /* .card-header, .card-header-actions, .card-header-with-desc, .card-header-desc — moved to DS components.css */
    .settings-card.dirty .btn-discard { display: inline-flex; align-items: center; }
    .btn-save {
      padding: 0 16px;
      background: var(--surface-bg);
      color: var(--text-muted);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: default;
      pointer-events: none;
      height: 32px;
      display: inline-flex;
      align-items: center;
      transition: background 0.2s, color 0.2s, border-color 0.2s;
    }
    .settings-card.dirty .btn-save {
      background: var(--primary);
      color: var(--text-on-fill);
      border-color: var(--primary);
      cursor: pointer;
      pointer-events: auto;
    }
    .settings-card.dirty .btn-save:hover { background: var(--primary-hover); }
    .settings-card.dirty .btn-save:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }
    .card-content {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      column-gap: 12px;
      row-gap: 20px;
    }
    .card-content > * {
      grid-column: 1 / -1;
    }

    /* Table */
    .headers-table {
      width: 100%;
      border: 1px solid var(--border-card);
      border-radius: var(--radius);
      overflow: hidden;
    }
    .headers-table-head {
      display: flex;
      align-items: center;
      background: var(--surface-card);
      border-bottom: 1px solid var(--border-card);
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-strong);
    }
    .headers-table-head .col-key { flex: 1; display: flex; align-items: center; position: relative; padding-right: 36px; }
    .headers-table-head .col-value { flex: 1; display: flex; align-items: center; position: relative; padding-right: 36px; }
    .headers-table-head .filter-icon { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); margin-left: 0; }
    .headers-table-head .col-actions { width: 40px; }
    .headers-table-row {
      display: flex;
      align-items: center;
      padding: 0 16px;
      height: 56px;
      border-bottom: 1px solid var(--border-card);
      font-size: 14px;
    }
    .headers-table-row:last-child { border-bottom: none; }
    .headers-table-row .col-key { flex: 1; color: var(--text-strong); }
    .headers-table-row .col-value { flex: 1; color: var(--text-subtle); }
    .headers-table-row .col-actions {
      width: 40px;
      display: flex; align-items: center; justify-content: center;
    }
    .edit-icon { width: 16px; height: 16px; color: var(--text-muted); cursor: pointer; display: inline-flex; align-items: center; justify-content: center; }
    .edit-icon svg { width: 16px; height: 16px; }
    .edit-icon:hover { color: var(--text-strong); }

    /* Headers Input Row */
    .headers-input-row { display: flex; gap: 8px; align-items: center; }
    .headers-input-row .input-field { flex: 1; }
    .btn-add-header {
      padding: 0 12px;
      background: transparent;
      color: var(--text-strong);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      height: 32px;
      display: inline-flex;
      align-items: center;
    }
    .btn-add-header:hover { background: var(--hover-subtle); }

    /* API Key */
    .api-key-status { font-size: 14px; color: var(--text-muted); }
    .btn-generate {
      padding: 0 12px;
      background: transparent;
      color: var(--text-strong);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      height: 32px;
      display: inline-flex;
      align-items: center;
      align-self: flex-start;
      width: fit-content;
    }
    .btn-generate:hover { background: var(--hover-subtle); }

    /* ===== SCAN POOLS ===== */
    .promo-banner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--blue-100);
      border: 1px solid var(--blue-200);
      border-radius: var(--radius);
      padding: 12px 20px;
      margin-bottom: 12px;
    }
    .promo-banner-text { font-size: 14px; color: var(--text-strong); }
    .promo-banner-text strong { font-weight: 500; }
    .pool-card { margin-bottom: 12px; }
    .pool-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      height: 56px;
      min-height: 56px;
      border-bottom: 1px solid var(--border-card);
    }
    .pool-card-header-left { display: flex; align-items: center; gap: 12px; min-width: 0; }
    .pool-drag-handle {
      display: flex; align-items: center; justify-content: center;
      width: 16px; height: 16px; flex-shrink: 0;
      cursor: grab; color: var(--text-muted);
      margin-right: -4px;
    }
    .pool-drag-handle:active { cursor: grabbing; }
    .pool-drag-handle svg { width: 16px; height: 16px; }
    .pool-card.dragging { opacity: 0.4; }
    .pool-card.flip-animate { transition: transform 0.15s cubic-bezier(0.2,0,0,1); }
    .pool-card-header-left h2 { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .pool-instance-count {
      font-size: 14px;
      color: var(--primary);
      font-weight: 400;
    }
    .pool-card-header-right { display: flex; gap: 8px; }
    /* .pool-table base — now inherits from DS .data-table; keep column widths only */
    .pool-table .col-url { width: 32%; }
    .pool-table .col-av { width: 22%; }
    .pool-table .col-api { width: 20%; }
    .pool-table .col-timeout { width: 20%; }
    .pool-table .col-actions { width: 48px; text-align: center; padding-right: 16px; overflow: visible; position: relative; }
    .api-dots { letter-spacing: 2px; color: var(--text-muted); }
    /* .pool-action-btn, .pool-action-menu — removed, now uses DS .row-action-btn / .row-action-menu */

    .encryption-status { font-size: 14px; color: var(--text-subtle); line-height: 1.5; }

    /* Product-specific contrast fixes */
    .api-key-status { color: var(--text-muted-accessible); }
    .sidebar-footer-tagline { color: var(--text-muted-accessible); font-size: 12px; }

    /* Nav item focus */
    .nav-item:focus-visible { outline: 2px solid var(--primary); outline-offset: -2px; }

    /* Product-specific panel size overrides */
    #addScanPoolPanel { width: 420px; right: -420px; }
    #addScanPoolPanel.open { right: 0; }
    #editJobPanel { width: 420px; right: -420px; }
    #editJobPanel.open { right: 0; }

    /* ===== LICENSE BADGE ===== */
    .license-badge {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 8px; font-size: 14px; font-family: var(--font);
      font-weight: 400; line-height: 16px; white-space: nowrap;
    }
    .license-badge.green { background: var(--ds-success-100); color: var(--ds-success-text); }
    .license-badge.red { background: var(--ds-alert-100); color: var(--ds-alert-text); }

    .license-empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }
    .license-empty-illustration {
      width: 120px;
      height: 120px;
      margin-bottom: 20px;
      opacity: 0.7;
    }
    .license-empty-title {
      font-size: 16px;
      font-weight: 500;
      color: var(--text-strong);
      margin-bottom: 4px;
    }
    .license-empty-desc {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 24px;
    }

    .license-warning-banner {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: var(--ds-alert-100);
      color: var(--ds-alert-text);
      font-size: 14px;
      border-bottom: 1px solid var(--red-200);
    }
    .license-warning-banner a { color: var(--ds-alert-text); font-weight: 500; }
    .license-warning-banner svg { width: 16px; height: 16px; flex-shrink: 0; }


    @media (prefers-reduced-motion: reduce) {
      .sidebar { transition: none; }
    }

    /* ===== RESPONSIVE: Medium (<=1460px) — Figma "Medium" breakpoint ===== */
    @media (max-width: 1460px) {
      .content { padding: 20px; }
    }

    /* ===== RESPONSIVE: Small / Tablet (<=1024px) — Figma "Small" breakpoint ===== */
    @media (max-width: 1024px) {
      .sidebar { width: var(--sidebar-collapsed); }
      .sidebar .nav-item { padding: 8px 12px; }
      .sidebar .nav-text { opacity: 0; pointer-events: none; }
      .sidebar .sidebar-footer { opacity: 0; pointer-events: none; }
    }

    /* ===== RESPONSIVE: Mobile (<=768px) ===== */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .app.sidebar-open .sidebar {
        display: flex;
        position: fixed;
        top: 56px; left: 0; bottom: 0;
        width: 260px;
        z-index: 1500;
        box-shadow: 4px 0 24px rgba(0,0,0,0.12);
      }
      .app.sidebar-open .sidebar .nav-text { opacity: 1; pointer-events: auto; }
      .app.sidebar-open .sidebar .nav-item { padding: 8px 16px; }
      .app.sidebar-open .sidebar .sidebar-footer { opacity: 1; pointer-events: auto; }
      .app.sidebar-open .sidebar-mobile-overlay {
        display: block;
        position: fixed; inset: 0; top: 56px;
        background: var(--overlay-medium);
        z-index: 1499;
      }
      .sidebar-mobile-overlay { display: none; }
      .content { padding: 16px; }
      .header-logo-text { display: none; }
    }

    /* ===== RESPONSIVE: Small Mobile (<=480px) ===== */
    @media (max-width: 480px) {
      .content { padding: 12px; }
      .card-content { padding: 16px; column-gap: 8px; row-gap: 16px; }
      .card-header { padding: 0 16px; }
      .page-title { font-size: 20px; }
      .header { padding: 0 12px; }
      .headers-input-row { flex-direction: column; }
      .headers-input-row .input-field { width: 100%; }
      .pool-card-header { flex-direction: column; align-items: flex-start; gap: 8px; padding: 12px 16px; height: auto; min-height: auto; }
      .pool-card-header-right { flex-wrap: wrap; }
    }

    /* ===== USERS PAGE ===== */
    .user-name-cell {
      display: flex; align-items: center; gap: 10px;
    }
    .user-avatar {
      width: 20px; height: 20px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 10px; font-weight: 500; color: var(--text-on-fill);
      flex-shrink: 0;
    }
    .users-empty-state {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 48px 20px; text-align: center;
    }
    .users-empty-icon {
      width: 48px; height: 48px; border-radius: 50%;
      background: var(--tab-bg); display: flex; align-items: center; justify-content: center;
      margin-bottom: 16px;
    }
    .users-empty-icon svg { width: 24px; height: 24px; color: var(--text-muted); }
    .users-empty-title {
      font-size: 14px; font-weight: 500; color: var(--text-strong); margin: 0 0 4px;
    }
    .users-empty-desc {
      font-size: 14px; color: var(--text-muted); margin: 0;
    }

    /* ===== JOBS PAGE ===== */
    /* Jobs tables: sticky col-cb, col-pinned, col-action → blue-line/components.css */

    .jobs-row-with-progress { position: relative; }
    .jobs-row-with-progress::after {
      content: ''; position: absolute; bottom: 0; left: 0; right: 0;
      height: 3px; background: var(--border-card); pointer-events: none;
    }
    .jobs-row-with-progress .jobs-progress-fill {
      position: absolute; bottom: 0; left: 0; height: 3px;
      background: var(--primary); border-radius: 0 2px 2px 0;
      pointer-events: none; z-index: 1;
    }
    .jobs-detections { color: var(--danger); font-weight: 500; }
    .jobs-detections.none { color: var(--text-subtle); font-weight: 400; }
    .jobs-elapsed { font-variant-numeric: tabular-nums; }
    .jobs-files-progress { display: flex; align-items: center; gap: 8px; }
    .jobs-files-bar { flex: 1; max-width: 80px; height: 4px; background: var(--border-card); border-radius: 2px; overflow: hidden; }
    .jobs-files-bar-fill { height: 100%; background: var(--primary); border-radius: 2px; }
    .jobs-edit-btn {
      width: 32px; height: 32px; border: 1px solid var(--border-200); border-radius: var(--radius);
      background: var(--surface-card); cursor: pointer; display: flex; align-items: center; justify-content: center;
      color: var(--text-muted);
    }
    .jobs-edit-btn:hover { color: var(--text-strong); border-color: var(--text-muted); }
    .jobs-edit-btn svg { width: 14px; height: 14px; }

    /* Job Detail Page */
    /* job-detail-breadcrumb → blue-line/components.css (.detail-breadcrumb) */
    /* .job-detail-header — removed, now uses DS .page-header + .page-header-actions */
    .job-info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0; padding: 20px; }
    .job-info-item { display: flex; flex-direction: column; gap: 4px; padding: 0 20px 0 0; }
    .job-info-label { font-size: 12px; font-weight: 500; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.3px; }
    .job-info-value { font-size: 14px; color: var(--text-strong); display: flex; align-items: center; gap: 6px; }

    /* Job summary stats */
    .job-summary-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px; }
    .job-summary-stat {
      background: var(--surface-card); border: 1px solid var(--border-card); border-radius: var(--radius);
      box-shadow: var(--shadow-card); padding: 20px; display: flex; flex-direction: column; gap: 8px;
    }
    .job-summary-stat-label { font-size: 12px; font-weight: 500; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.3px; }
    .job-summary-stat-value { font-size: 28px; font-weight: 500; color: var(--text-strong); }
    .job-summary-stat-value.alert { color: var(--danger); }
    .job-summary-stat-value.success { color: #0f8a56; }

    /* Completed job banner */
    .job-completed-banner {
      display: flex; align-items: center; gap: 12px;
      padding: 12px 20px; margin-bottom: 12px;
      border-radius: var(--radius); border: 1px solid #b6e3cc;
      background: var(--green-100); color: var(--text-strong);
      font-size: 14px; font-weight: 400;
    }
    .job-completed-banner svg { width: 16px; height: 16px; color: #0f8a56; flex-shrink: 0; }
    .job-stopped-banner {
      display: flex; align-items: center; gap: 12px;
      padding: 12px 20px; margin-bottom: 12px;
      border-radius: var(--radius); border: 1px solid #ffe0a3;
      background: var(--yellow-100); color: var(--text-strong);
      font-size: 14px; font-weight: 400;
    }
    .job-stopped-banner svg { width: 16px; height: 16px; color: var(--feedback-warning); flex-shrink: 0; }

    /* priority-toggle, af-section/chips → blue-line/components.css */

    /* ===== AUDIT PAGE ===== */
    /* page-view, expand-btn → blue-line/components.css */

    /* .audit-header — removed, now uses DS .page-header */

    /* Expanded row */
    .audit-expanded-row td {
      padding: 12px 16px 12px 60px !important;
      background: var(--surface-card);
      font-size: 14px;
      color: var(--text-subtle);
      line-height: 1.5;
      border-bottom: 1px solid var(--border-card);
    }

    /* audit-user, audit-avatar, level-badge, category-badge → blue-line/components.css */

    /* ===== DARK MODE (product-specific overrides only) ===== */
    [data-theme="dark"] body { background: var(--surface-bg); color: var(--text-subtle); }
    [data-theme="dark"] .sidebar { background: var(--header-bg); border-color: var(--border-card); }
    [data-theme="dark"] .sidebar .nav-item { color: var(--text-subtle); }
    [data-theme="dark"] .sidebar .nav-item.active { background: rgba(29,107,252,0.25); color: var(--text-strong); }
    [data-theme="dark"] .sidebar .nav-item:hover:not(.active) { background: rgba(255,255,255,0.04); }
    [data-theme="dark"] .main-header { background: var(--header-bg); border-color: var(--border-card); }
    [data-theme="dark"] .header { background: var(--surface-bg); border-color: var(--border-card); }
    [data-theme="dark"] .header .header-logo-text span { color: var(--text-strong); }
    [data-theme="dark"] .sidebar-toggle { color: var(--text-strong); }
    [data-theme="dark"] .sidebar-toggle:hover { background: var(--hover-default); color: var(--text-strong); }
    [data-theme="dark"] .settings-card { background: var(--surface-card); border-color: var(--border-card); }
    [data-theme="dark"] .card-header { border-color: var(--border-card); }
    [data-theme="dark"] .card-header h2 { color: var(--text-strong); }
    [data-theme="dark"] .btn-save { background: var(--surface-bg); border-color: var(--border-200); color: var(--text-muted); }
    [data-theme="dark"] .settings-card.dirty .btn-save { background: var(--primary); color: var(--text-on-fill); border-color: var(--primary); }
    [data-theme="dark"] .btn-discard { border-color: var(--border-200); color: var(--text-subtle); }
    /* [data-theme="dark"] .pool-table — now inherited from DS .data-table dark mode */
    [data-theme="dark"] .headers-table-head { background: var(--surface-card); color: var(--text-subtle); border-color: var(--border-card); }
    [data-theme="dark"] .headers-table-row { border-color: var(--border-card); color: var(--text-subtle); }
    [data-theme="dark"] .promo-banner { background: rgba(29,107,252,0.08); border-color: rgba(29,107,252,0.2); }
    [data-theme="dark"] .warning-banner { background: rgba(232,123,30,0.08); border-color: rgba(232,123,30,0.2); }
    [data-theme="dark"] .content-title h1 { color: var(--text-strong); }
    [data-theme="dark"] .pool-card-header { border-color: var(--border-card); }
    [data-theme="dark"] .pool-card-header h2 { color: var(--text-strong); }
    [data-theme="dark"] .sidebar-footer { border-color: var(--border-card); }
    [data-theme="dark"] .sidebar-footer-brand path { fill: var(--text-on-fill); }
    /* [data-theme="dark"] .pool-action — removed, now inherited from DS .row-action-menu dark mode */
    [data-theme="dark"] .users-empty-icon { background: rgba(255,255,255,0.06); }
    [data-theme="dark"] .btn-export { border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .audit-detail-row td { color: var(--text-muted); }

    /* theme-toggle, advanced-filters, avatar-dropdown → blue-line/components.css */

    /* Component demo wrapper for standalone previews */
    .avd-demo-container {
      display: flex; gap: 24px; flex-wrap: wrap; align-items: flex-start;
    }
    .avd-demo-block {
      position: relative; width: 260px;
    }
    .avd-demo-block .avatar-dropdown {
      position: static; display: flex;
    }

    /* notif-dropdown → blue-line/components.css */

    /* ===== WORKFLOWS PAGE ===== */
    /* .wf-header — removed, now uses DS .page-header */

    /* Full-height layout (list + detail views) */
    #workflowsPage.active { display: flex; flex-direction: column; height: calc(100vh - 56px - 40px); }
    #workflowsListView, #workflowDetailView { flex: 1; flex-direction: column; min-height: 0; }
    #workflowsListView .audit-card,
    #workflowDetailView .audit-card { flex: 1; display: flex; flex-direction: column; min-height: 0; overflow: hidden; }
    #workflowsListView .table-scroll { flex: 1; overflow: auto; min-height: 0; }
    #workflowsListView .audit-pagination { flex-shrink: 0; }
    #workflowDetailView .wf-canvas { flex: 1; overflow: auto; min-height: 0; }

    /* wf-breadcrumb → blue-line/components.css (.detail-breadcrumb) */

    /* .wf-detail-title — removed, now uses .page-title inside .page-header */

    /* Remediation mini-tags in table */
    .wf-rem-tag {
      display: inline-flex; align-items: center; height: 24px; padding: 0 8px;
      font-size: 12px; font-weight: 500; border-radius: var(--radius);
      white-space: nowrap;
    }
    .wf-rem-tag.keep { background: var(--neutral-100); color: var(--neutral-800); }
    .wf-rem-tag.copy { background: var(--blue-100); color: var(--blue-900); }
    .wf-rem-tag.move { background: var(--blue-100); color: var(--blue-900); }
    .wf-rem-tag.delete { background: var(--red-100); color: var(--red-800); }
    .wf-rem-tag.failed { background: var(--red-100); color: var(--red-800); }
    .wf-rem-tag.none { background: transparent; color: var(--text-muted); font-weight: 400; padding: 0; }
    .wf-rem-tags { display: flex; gap: 4px; flex-wrap: wrap; }

    /* Dot + text status in table cells */
    .wf-status { display: flex; align-items: center; gap: 6px; font-size: 14px; color: var(--text-strong); }
    .wf-status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--green-800); flex-shrink: 0; }

    /* Reports table — sticky col-cb/col-action → blue-line/components.css */
    #reportsTable { min-width: 1200px; }
    .rpt-verdict { display: inline-flex; align-items: center; gap: 4px; white-space: nowrap; }
    .rpt-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
    .rpt-verdict.detected .rpt-dot { background: var(--red-800); }
    .rpt-verdict.none { color: var(--text-muted); }
    .rpt-verdict.none .rpt-dot { background: var(--text-disabled); }

    /* Default workflow star icon */
    .wf-default-icon { width: 16px; height: 16px; color: var(--text-strong); margin-right: 4px; vertical-align: middle; }

    /* ===== WORKFLOW FLOW DIAGRAM ===== */
    .wf-canvas {
      background-color: var(--surface-100, #F8F9F9);
      background-image: radial-gradient(circle at 1px 1px, rgba(169, 178, 196, 0.2) 1px, transparent 1px);
      background-size: 12px 12px;
      border-radius: var(--radius);
      padding: 48px; overflow: auto;
      position: relative; cursor: grab;
      flex: 1 0 0; align-self: stretch;
    }
    .wf-canvas.dragging { cursor: grabbing; user-select: none; }
    .wf-flow { display: inline-flex; align-items: center; gap: 0; }
    .wf-step { display: flex; align-items: center; gap: 0; cursor: pointer; }
    .wf-node { display: flex; flex-direction: column; align-items: center; gap: 8px; }
    .wf-node-box {
      padding: 16px; border-radius: 4px; border: 1px solid var(--border-card);
      background: var(--surface-card);
      display: flex; align-items: center; justify-content: center;
      box-shadow: 1px 3px 4px -2px rgba(12, 18, 29, 0.04), 2px 2px 4px 0 rgba(12, 18, 29, 0.04);
      transition: border-color 0.15s, box-shadow 0.15s;
    }
    .wf-step:hover .wf-node-box { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(29,107,252,0.15); }
    .wf-node-box svg { width: 48px; height: 48px; color: var(--neutral-700); }
    .wf-node-label { font-size: 12px; font-weight: 500; color: var(--text-strong); text-align: center; white-space: nowrap; }
    .wf-node-sublabel { font-size: 11px; color: var(--text-muted); text-align: center; margin-top: -4px; }
    .wf-connector { width: 40px; height: 0; border-top: 2px dashed var(--border-200); flex-shrink: 0; }
    .wf-start-label { font-size: 12px; font-weight: 500; color: var(--text-muted); white-space: nowrap; }
    .wf-diamond { display: flex; align-items: center; justify-content: center; }
    .wf-diamond svg { width: 24px; height: 24px; }

    /* Remediations stack (vertical within horizontal flow) */
    .wf-rem-stack { display: flex; flex-direction: column; gap: 8px; }
    .wf-rem-col {
      border: 1px solid var(--border-card); border-radius: 4px;
      background: var(--surface-card); padding: 12px; display: flex; flex-direction: column; gap: 8px;
      box-shadow: 1px 3px 4px -2px rgba(12, 18, 29, 0.04), 2px 2px 4px 0 rgba(12, 18, 29, 0.04);
    }
    .wf-rem-col-header { font-size: 13px; font-weight: 600; color: var(--text-strong); }
    .wf-rem-row { display: flex; align-items: center; gap: 8px; }
    .wf-rem-row-label { font-size: 11px; color: var(--text-muted); min-width: 52px; flex-shrink: 0; }
    .wf-action-btns { display: flex; gap: 4px; }
    .wf-action-btn {
      display: inline-flex; align-items: center; gap: 4px;
      padding: 4px 8px; border-radius: 2px;
      border: 1px solid transparent; background: var(--neutral-100);
      cursor: pointer; transition: background 0.15s;
      font-size: 12px; font-weight: 500; color: var(--text-muted); white-space: nowrap;
    }
    .wf-action-btn:hover { background: var(--neutral-200); }
    .wf-action-btn svg { width: 16px; height: 16px; flex-shrink: 0; }
    .wf-action-btn.active { border-color: var(--primary); background: var(--blue-100); color: var(--primary); }

    /* .panel-banner — moved to DS components.css (warning/error/info variants) */

    /* Tech list in Technologies panel */
    .wf-tech-item {
      padding: 16px 0; border-bottom: 1px solid var(--border-card);
    }
    .wf-tech-item:last-child { border-bottom: none; }
    .wf-tech-name { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .wf-tech-desc { font-size: 13px; color: var(--text-subtle); margin-top: 2px; }
    .wf-tech-status { margin-top: 6px; }

    /* Checkbox with sub-fields (File Tagging) */
    .wf-tag-group { padding: 12px 0; border-bottom: 1px solid var(--border-card); }
    .wf-tag-group:last-child { border-bottom: none; }
    .wf-tag-check { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
    .wf-tag-check input[type="checkbox"] { width: 16px; height: 16px; accent-color: var(--primary); }
    .wf-tag-check label { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .wf-tag-fields { padding-left: 24px; display: flex; flex-direction: column; gap: 8px; }
    .wf-tag-field-label { font-size: 12px; color: var(--text-subtle); }
    .wf-tag-field-value { font-size: 13px; color: var(--text-strong); padding: 6px 8px; border: 1px solid var(--border-200); border-radius: var(--radius); background: var(--surface-card); }
    .wf-show-verdicts { font-size: 13px; color: var(--primary); cursor: pointer; padding-left: 24px; }
    .wf-show-verdicts:hover { text-decoration: underline; }
    .wf-verdicts { padding-left: 24px; margin-top: 8px; display: flex; flex-direction: column; gap: 8px; }
    .wf-verdict-row { display: flex; flex-direction: column; gap: 4px; }
    .wf-verdict-label { font-size: 12px; font-weight: 500; color: var(--text-strong); }
    .wf-verdict-input { font-size: 13px; padding: 6px 8px; border: 1px solid var(--border-200); border-radius: var(--radius); background: var(--surface-card); color: var(--text-strong); display: flex; align-items: center; justify-content: space-between; }
    .wf-verdict-input .clear-x { cursor: pointer; color: var(--text-muted); font-size: 14px; }

    /* Remediation radio with conditional content */
    .wf-rem-option { padding: 8px 0; }
    .wf-rem-radio { display: flex; align-items: center; gap: 8px; }
    .wf-rem-radio input[type="radio"] { width: 16px; height: 16px; accent-color: var(--primary); }
    .wf-rem-radio label { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .wf-rem-content { padding-left: 24px; margin-top: 8px; }
    .wf-storage-tags { display: flex; gap: 4px; flex-wrap: wrap; align-items: center; margin-bottom: 12px; }
    .wf-storage-tag {
      display: inline-flex; align-items: center; gap: 4px; padding: 4px 8px;
      background: var(--neutral-100); border-radius: var(--radius); font-size: 13px; color: var(--text-strong);
    }
    .wf-storage-tag .remove-x { cursor: pointer; color: var(--text-muted); font-size: 14px; }
    .wf-folder-check { display: flex; align-items: center; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border-card); }
    .wf-folder-check:last-child { border-bottom: none; }
    .wf-folder-check label { font-size: 14px; color: var(--text-strong); }
    .wf-folder-check input[type="checkbox"] { width: 16px; height: 16px; accent-color: var(--primary); }

    /* Dark mode - Workflows */
    [data-theme="dark"] .wf-canvas { background-color: var(--neutral-1100); background-image: radial-gradient(circle at 1px 1px, rgba(169, 178, 196, 0.08) 1px, transparent 1px); }
    [data-theme="dark"] .wf-node-box { background: var(--surface-card); border-color: var(--border-200); }
    [data-theme="dark"] .wf-rem-col { background: var(--surface-card); border-color: var(--border-200); }
    [data-theme="dark"] .wf-action-btn { background: var(--neutral-900); }
    [data-theme="dark"] .wf-action-btn:hover { background: var(--neutral-800); }
    [data-theme="dark"] .wf-action-btn.active { background: rgba(29,107,252,0.15); border-color: var(--primary); }
    [data-theme="dark"] .wf-rem-tag.keep { background: var(--neutral-900); color: var(--neutral-400); }
    [data-theme="dark"] .wf-rem-tag.copy, [data-theme="dark"] .wf-rem-tag.move { background: rgba(29,107,252,0.15); color: var(--blue-400); }
    [data-theme="dark"] .wf-rem-tag.delete, [data-theme="dark"] .wf-rem-tag.failed { background: rgba(212,0,49,0.15); color: var(--red-400); }
    [data-theme="dark"] .wf-storage-tag { background: var(--neutral-900); color: var(--text-strong); }
    [data-theme="dark"] .wf-tag-field-value, [data-theme="dark"] .wf-verdict-input { background: var(--surface-bg); border-color: var(--border-200); color: var(--text-strong); }
    /* [data-theme="dark"] .panel-banner — moved to DS */

    /* ================================================================
       INVENTORY PAGE
       Uses from DS: .page-header, .page-title, .page-header-actions,
       .btn-icon, .btn-outline, .row-action-btn, .row-action-menu,
       .row-action-menu-item, .section-title, .section-desc,
       .cards-grid, .grid-card, .grid-card-icon, .grid-card-name,
       .grid-card-type, .data-table
       ================================================================ */

    /* .inv-provider / .inv-provider-icon — moved to DS components.css */

    /* Recommended integrations (promo cards) */
    .inv-promo {
      display: flex; gap: 24px; align-items: flex-start; margin-bottom: 24px;
    }
    .inv-promo-img {
      width: 64px; height: 64px; border-radius: 8px; flex-shrink: 0;
      background: linear-gradient(135deg, #1a2744 0%, #1d6bfc 100%);
      display: flex; align-items: center; justify-content: center;
    }
    .inv-promo-img svg { width: 32px; height: 32px; color: #fff; }
    .inv-promo-content { flex: 1; }
    .inv-promo-title { font-size: 14px; font-weight: 500; color: var(--text-strong); margin-bottom: 4px; }
    .inv-promo-desc { font-size: 13px; color: var(--text-subtle); margin-bottom: 8px; line-height: 1.4; }
    .inv-promo-link { font-size: 13px; color: var(--primary); text-decoration: none; cursor: pointer; font-weight: 500; }
    .inv-promo-link:hover { text-decoration: underline; }

    /* Dark mode — Inventory */
    [data-theme="dark"] .inv-promo-img { background: linear-gradient(135deg, #0d1b2a 0%, #1d6bfc 100%); }

    /* ================================================================
       ACCOUNT DETAIL PAGE
       ================================================================ */

    /* Account Overview stats */
    .acct-overview-row {
      display: flex; gap: 0;
      background: var(--surface-card);
      border: 1px solid var(--border-card);
      border-radius: var(--radius);
      box-shadow: var(--shadow-card);
      margin-bottom: 16px;
    }
    .acct-overview-stat {
      flex: 1; padding: 20px 24px;
      border-left: 3px solid transparent;
      display: flex; flex-direction: column; gap: 4px;
    }
    .acct-overview-stat:not(:last-child) { border-right: 1px solid var(--border-card); }
    .acct-overview-stat:first-child { border-radius: var(--radius) 0 0 var(--radius); }
    .acct-overview-stat:last-child { border-radius: 0 var(--radius) var(--radius) 0; }
    .acct-overview-stat.blue { border-left-color: var(--blue-700); }
    .acct-overview-stat.green { border-left-color: var(--green-800); }
    .acct-overview-stat.red { border-left-color: var(--red-700); }
    .acct-overview-stat.yellow { border-left-color: var(--yellow-700); }
    .acct-overview-stat-label { font-size: 12px; font-weight: 500; color: var(--text-muted); }
    .acct-overview-stat-value { font-size: 24px; font-weight: 500; color: var(--text-strong); }

    /* Account detail tabs */
    .acct-tab-panel, .grp-tab-panel { display: none; }
    .acct-tab-panel.active, .grp-tab-panel.active { display: block; }

    /* Donut charts */
    .acct-donut-row { display: flex; gap: 0; padding: 24px 20px; justify-content: space-around; }
    .acct-donut-item { display: flex; flex-direction: column; align-items: center; gap: 16px; flex: 1; }
    .acct-donut-svg { width: 120px; height: 120px; transform: rotate(-90deg); }
    .acct-donut-svg text { transform: rotate(90deg); transform-origin: center; }
    .acct-donut-labels { display: flex; flex-direction: column; gap: 4px; }
    .acct-donut-label-row { display: flex; align-items: center; gap: 6px; font-size: 13px; color: var(--text-subtle); }
    .acct-donut-label-row span:last-child { font-weight: 500; color: var(--text-strong); margin-left: auto; }
    .acct-donut-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }

    /* Job summary header */
    /* acct-job-summary-header/meta/link removed — now uses DS .audit-card-title / .count / .card-header-link */

    /* Client ID cell */
    .acct-client-id { display: flex; align-items: center; gap: 8px; width: 100%; }
    .acct-client-id-text { flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 13px; font-family: 'Roboto Mono', monospace; color: var(--text-subtle); }
    .acct-copy-btn { width: 16px; height: 16px; cursor: pointer; color: var(--text-muted); flex-shrink: 0; }
    .acct-copy-btn:hover { color: var(--primary); }

    /* .tag-keyword → DS .tag-keyword | .count-more → DS | .col-vis-* → DS */

    /* Actions dropdown for detail page header */
    .acct-actions-wrap { position: relative; display: inline-block; }
    .acct-actions-menu {
      position: absolute; top: 36px; right: 0; min-width: 180px; z-index: 100;
      background: var(--surface-card); border: 1px solid var(--border-200);
      border-radius: var(--radius-graphics); box-shadow: var(--shadow-3);
      padding: 4px 0; display: none;
    }
    .acct-actions-menu.open { display: block; }

    /* Settings link */
    .acct-settings-link { font-size: 13px; color: var(--primary); cursor: pointer; font-weight: 500; text-decoration: none; }
    .acct-settings-link:hover { text-decoration: underline; }

    /* Dark mode — Account Detail */
    /* .count-more dark override → now in DS as .count-more */
    [data-theme="dark"] .acct-donut-dot { opacity: 0.8; }


/* ===== DASHBOARD ===== */

/* Filter button (icon + selected text) */
/* Menu button — local override until BL CDN is updated */
.btn-menu { height: 32px; padding: 0 12px; gap: 8px; background: transparent; border: 1px solid var(--border-200); border-radius: var(--radius); font-family: var(--font); font-size: 14px; font-weight: 400; line-height: 16px; color: var(--text-strong); cursor: pointer; white-space: nowrap; display: inline-flex; align-items: center; justify-content: center; }
.btn-menu:hover { border-color: var(--neutral-500); }
.btn-menu svg { width: 16px; height: 16px; }
.btn-menu.active { border-color: var(--primary); }
.btn-menu.active:hover { border-color: var(--primary); }
.btn-menu:disabled, .btn-menu.disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }
.btn-menu.skeleton { color: transparent; pointer-events: none; background: var(--neutral-100); border-color: transparent; }
.btn-menu.skeleton svg { visibility: hidden; }
.filter-btn-wrap { position: relative; }
.filter-menu {
  display: none; position: absolute; top: calc(100% + 4px); left: 0; z-index: 50;
  min-width: 100%; background: var(--surface-card); border: 1px solid var(--border-200);
  border-radius: var(--radius); box-shadow: var(--shadow-md); padding: 4px 0;
}
.filter-btn-wrap.open .filter-menu { display: block; }
.filter-menu-item {
  padding: 8px 12px; font-size: 14px; color: var(--text-body); cursor: pointer;
  white-space: nowrap;
}
.filter-menu-item:hover { background: var(--neutral-100); }
.filter-menu-item.active { color: var(--primary); font-weight: 500; }

/* Generic dash card spacing */
.dash-card {
  margin-bottom: 12px;
}

/* ===== 1. ACCOUNT INFO BAR — uses BL .info-bar component ===== */
/* Local overrides until BL CDN is updated */
.info-bar { align-items: center; padding: 20px; gap: 20px; border-radius: 4px; overflow: visible; }
.info-bar-section { gap: 20px; padding: 0; flex: 1 1 0; min-width: 0; }
.info-bar-divider { height: 64px; align-self: auto; background: var(--border-200); }
.info-bar-icon { width: 64px; height: 64px; background: var(--neutral-100); border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.info-bar-icon .dash-provider-letter { font-size: 24px; font-weight: 600; color: var(--text-subtle); line-height: 1; }
[data-theme="dark"] .info-bar-icon { background: var(--neutral-800); }
.info-bar-meta { min-width: 0; }
.info-bar-label { font-size: 14px; font-weight: 400; line-height: 16px; color: var(--text-subtle); text-transform: none; letter-spacing: normal; }
.info-bar-value { gap: 8px; min-width: 0; font-size: 14px; font-weight: 500; line-height: 16px; height: 32px; padding: 8px 0; display: flex; align-items: center; box-sizing: border-box; }
.info-bar-value-text { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0; }

/* ===== 2. PAGE HEADER / BREADCRUMB — product-specific overrides ===== */
.page-header { margin-bottom: 20px; padding: 0; }
.page-title-row { margin-bottom: 20px; }
.page-header .page-title-row { margin-bottom: 0; }
.breadcrumb-item { background: none; border: none; padding: 0; }
.skeleton-text { width: 120px; height: 16px; background: var(--neutral-300); border-radius: 4px; }
.skeleton-block { width: 120px; height: 32px; background: var(--neutral-200); border-radius: 4px; }
/* Text button — local override until BL CDN is updated */
.btn-text { padding: 0; height: auto; gap: 8px; background: none; line-height: 16px; text-decoration: none; }
.btn-text:hover { background: none; text-decoration: none; color: var(--blue-900); }
.audit-card-actions .btn-text { height: auto; }
.btn-text.skeleton { color: transparent; pointer-events: none; background: var(--neutral-200); border-radius: var(--radius); }
[data-theme="dark"] .btn-text:hover { background: none; color: var(--blue-400); }
[data-theme="dark"] .btn-text.skeleton { background: var(--neutral-800); }
/* Checkbox: 16×16 with 4px corners — override BL WCAG min-size */
.cb { width: 16px; height: 16px; min-width: 16px; min-height: 16px; border-radius: 4px; }
.cb svg { width: 16px; height: 16px; }
/* .col-cb, .col-action sticky columns → blue-line/components.css */

/* ===== 3. JOB MONITOR BANNER — uses BL .banner component ===== */

/* ===== 3. JOB SUMMARY ===== */
.dash-job-summary-body {
  display: flex;
  align-items: stretch;
  gap: 32px;
  padding: 20px;
}
.dash-donut-lockup {
  flex: 1 1 0;
  display: flex;
  align-items: center;
  gap: 20px;
}
.dash-donut-svg {
  width: 44px;
  height: 44px;
  flex-shrink: 0;
}
.dash-donut-legend {
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1;
  min-width: 0;
}
.dash-legend-row {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  line-height: 16px;
}
.dash-legend-marker {
  width: 14px; height: 14px;
  margin: 1px;
  border-radius: 4px;
  flex-shrink: 0;
}
.dash-legend-label {
  color: var(--text-strong);
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dash-legend-val {
  color: var(--text-subtle);
  white-space: nowrap;
}
.dash-delta { color: var(--blue-600); }
/* Card header accent — local override until BL CDN is updated */
.audit-card-title .count .accent { color: var(--blue-600); }

/* ===== 4. STAT CARDS ===== */
.dash-stat-row {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-bottom: 12px;
}
.dash-stat-card {
  margin-bottom: 0 !important;
  display: flex;
  flex-direction: column;
}
.dash-stat-body {
  padding: 16px 20px 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1;
}
.dash-stat-total-row {
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.dash-stat-total-label {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.3px;
}
.dash-stat-total-val {
  font-size: 24px;
  font-weight: 500;
  color: var(--text-strong);
  display: flex;
  align-items: center;
  gap: 6px;
}
.dash-trend-arrow {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.dash-trend-arrow svg { width: 12px; height: 12px; }
.dash-trend-up svg { color: var(--ds-success-text); }
.dash-trend-down svg { color: var(--ds-alert-text); transform: rotate(180deg); }
.dash-trend-text {
  font-size: 12px;
  color: var(--ds-success-text);
  font-weight: 500;
}

.dash-stat-legend {
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.dash-stat-legend-row {
  display: flex;
  align-items: center;
  gap: 7px;
  font-size: 13px;
}
.dash-stat-legend-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}
.dash-stat-legend-label {
  flex: 1;
  color: var(--text-subtle);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dash-stat-legend-val {
  color: var(--text-strong);
  font-weight: 500;
  font-variant-numeric: tabular-nums;
}

/* Bar chart inside stat cards */
.dash-bar-chart {
  display: flex;
  align-items: flex-end;
  gap: 6px;
  height: 72px;
  border-top: 1px solid var(--border-100);
  padding-top: 8px;
  margin-top: 4px;
}
.dash-bar-col {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  gap: 4px;
  height: 100%;
}
.dash-bar-label {
  font-size: 9px;
  color: var(--text-muted);
  text-align: center;
  line-height: 1.1;
  white-space: nowrap;
}
.dash-bar-fill {
  width: 100%;
  min-height: 2px;
  border-radius: 2px 2px 0 0;
  transition: height 0.3s ease;
}
.dash-bar-x-label {
  font-size: 9px;
  color: var(--text-muted);
  text-align: center;
}

/* ===== 5. SECURITY TREND ===== */
.dash-trend-legend {
  display: flex;
  align-items: center;
  gap: 16px;
}
.dash-trend-legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: var(--text-subtle);
  white-space: nowrap;
}
.dash-trend-legend-swatch {
  width: 10px; height: 10px;
  border-radius: 2px;
  flex-shrink: 0;
}
.dash-trend-period-tabs {
  display: flex;
  border: 1px solid var(--border-200);
  border-radius: var(--radius);
  overflow: hidden;
}
.dash-trend-tab {
  padding: 0 10px;
  height: 28px;
  border: none;
  background: transparent;
  font-family: var(--font);
  font-size: 12px;
  font-weight: 500;
  color: var(--text-subtle);
  cursor: pointer;
  border-right: 1px solid var(--border-200);
}
.dash-trend-tab:last-child { border-right: none; }
.dash-trend-tab:hover { background: var(--hover-subtle); color: var(--text-strong); }
.dash-trend-tab.active { background: var(--blue-100); color: var(--primary); }

.dash-trend-chart-wrap {
  display: flex;
  align-items: stretch;
  padding: 8px 20px 0;
  height: 180px;
}
.dash-trend-y-axis {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding-bottom: 24px;
  padding-right: 8px;
  font-size: 10px;
  color: var(--text-muted);
  text-align: right;
  flex-shrink: 0;
  min-width: 32px;
}
.dash-trend-chart {
  flex: 1;
  display: flex;
  align-items: flex-end;
  gap: 8px;
  border-left: 1px solid var(--border-100);
  border-bottom: 1px solid var(--border-100);
  padding: 0 12px;
}
.dash-trend-col {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  gap: 4px;
  height: 100%;
}
.dash-trend-stacked {
  width: 100%;
  display: flex;
  flex-direction: column-reverse;
  align-items: stretch;
  gap: 1px;
  max-height: 130px;
  min-height: 0;
  flex: 1;
  justify-content: flex-start;
}
.dash-trend-seg {
  width: 100%;
  min-height: 2px;
  border-radius: 1px;
  transition: height 0.3s ease;
}
.dash-trend-threats { background: var(--red-600); }
.dash-trend-dataloss { background: var(--teal-600); }
.dash-trend-sanitized { background: var(--blue-600); }
.dash-trend-x-label {
  font-size: 10px;
  color: var(--text-muted);
  white-space: nowrap;
  padding-bottom: 4px;
}

/* ===== 6. REMEDIATION ACTIONS ===== */
.dash-rem-body {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1px;
  background: var(--border-card);
}
.dash-rem-item {
  background: var(--surface-card);
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px 24px;
  cursor: pointer;
  transition: background 0.15s;
}
.dash-rem-item:hover { background: var(--hover-subtle); }
.dash-rem-ring-wrap {
  position: relative;
  width: 52px; height: 52px;
  flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
}
.dash-rem-ring-svg {
  width: 52px; height: 52px;
  transform: rotate(-90deg);
  position: absolute;
  top: 0; left: 0;
}
.dash-rem-ring-track {
  fill: none;
  stroke: var(--neutral-100);
  stroke-width: 4;
}
.dash-rem-ring-fill {
  fill: none;
  stroke-width: 4;
  stroke-linecap: round;
  transition: stroke-dasharray 0.3s ease;
}
.dash-rem-ring-pct {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-strong);
  position: relative;
  z-index: 1;
  line-height: 1;
}
.dash-rem-label {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-strong);
}
.dash-rem-desc {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
  margin-top: 2px;
}
.dash-rem-item > div:last-child {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

/* ===== 7. FILE TYPE DISTRIBUTION ===== */
.dash-filetype-body {
  display: flex;
  gap: 0;
  min-height: 240px;
}
.dash-treemap {
  flex: 1.4;
  display: flex;
  flex-direction: column;
  gap: 2px;
  padding: 16px;
  min-width: 0;
}
.dash-treemap-row {
  display: flex;
  gap: 2px;
  min-height: 0;
}
.dash-treemap-cell {
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 6px 8px;
  border-radius: 3px;
  cursor: pointer;
  transition: opacity 0.15s;
  overflow: hidden;
  min-width: 0;
}
.dash-treemap-cell:hover { opacity: 0.85; }
.dash-tm-name {
  font-size: 11px;
  font-weight: 500;
  color: rgba(255,255,255,0.9);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.2;
}
.dash-tm-count {
  font-size: 10px;
  color: rgba(255,255,255,0.65);
  font-variant-numeric: tabular-nums;
}

/* Treemap cell colors */
.dash-tm-archive   { background: var(--neutral-600); }
.dash-tm-application { background: var(--red-600); }
.dash-tm-executable { background: var(--neutral-400); }
.dash-tm-graphical  { background: var(--red-400); }
.dash-tm-diskimage  { background: var(--neutral-300); }
.dash-tm-openssl   { background: var(--neutral-500); }
.dash-tm-pdf      { background: var(--red-500); }
.dash-tm-text     { background: var(--neutral-350, #aaaaaa); }
.dash-tm-other    { background: var(--neutral-200); }
/* text contrast on light cells */
.dash-tm-diskimage .dash-tm-name,
.dash-tm-other .dash-tm-name {
  color: var(--text-subtle);
}
.dash-tm-diskimage .dash-tm-count,
.dash-tm-other .dash-tm-count {
  color: var(--text-muted);
}

/* Right legend panel */
.dash-filetype-legend {
  flex: 1;
  border-left: 1px solid var(--border-card);
  display: flex;
  flex-direction: column;
  padding: 16px 20px;
  min-width: 0;
}
.dash-filetype-legend-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--border-100);
}
.dash-filetype-legend-title {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-strong);
}
.dash-filetype-legend-total {
  font-size: 13px;
  font-weight: 500;
  color: var(--primary);
}
.dash-filetype-legend-rows {
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.dash-filetype-legend-row {
  display: flex;
  align-items: center;
  gap: 10px;
}
.dash-ftl-icon {
  width: 24px; height: 24px;
  border-radius: var(--radius);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.dash-ftl-icon svg { width: 14px; height: 14px; }
.dash-ftl-archive   { background: var(--neutral-100); color: var(--neutral-700); }
.dash-ftl-app      { background: var(--red-100); color: var(--red-700); }
.dash-ftl-exe      { background: var(--neutral-100); color: var(--neutral-600); }
.dash-ftl-img      { background: var(--red-100); color: var(--red-500); }
.dash-ftl-pdf      { background: var(--red-100); color: var(--red-600); }
.dash-ftl-other    { background: var(--neutral-100); color: var(--neutral-500); }
.dash-ftl-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 3px;
  min-width: 0;
}
.dash-ftl-name {
  font-size: 12px;
  color: var(--text-subtle);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dash-ftl-bar-wrap {
  height: 4px;
  background: var(--neutral-100);
  border-radius: 2px;
  overflow: hidden;
}
.dash-ftl-bar {
  height: 100%;
  border-radius: 2px;
  transition: width 0.3s ease;
}
.dash-ftl-val {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-strong);
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

/* ===== 8-9. TABLE EXTRAS ===== */

/* Job type tags */
.dash-job-type-tag {
  display: inline-flex;
  align-items: center;
  height: 22px;
  padding: 0 8px;
  font-size: 11px;
  font-weight: 500;
  border-radius: var(--radius);
  white-space: nowrap;
}
.dash-jt-scan-now {
  background: var(--blue-100);
  color: var(--blue-800);
  border: 1px solid var(--blue-200);
}
.dash-jt-scheduled {
  background: var(--neutral-100);
  color: var(--neutral-700);
  border: 1px solid var(--neutral-200);
}
.dash-jt-realtime {
  background: var(--teal-100);
  color: var(--teal-800);
  border: 1px solid var(--teal-200);
}

[data-theme="dark"] .dash-jt-scan-now {
  background: rgba(29, 107, 252, 0.12);
  color: var(--blue-400);
  border-color: rgba(29, 107, 252, 0.2);
}
[data-theme="dark"] .dash-jt-scheduled {
  background: rgba(255,255,255,0.05);
  color: var(--neutral-400);
  border-color: var(--border-200);
}
[data-theme="dark"] .dash-jt-realtime {
  background: rgba(0, 180, 160, 0.1);
  color: var(--teal-400);
  border-color: rgba(0, 180, 160, 0.2);
}

/* Schedule cell with icon */
.dash-schedule-cell {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
  color: var(--text-strong);
}

/* ===== DARK MODE OVERRIDES ===== */
[data-theme="dark"] .dash-donut-track { stroke: var(--neutral-800); }
[data-theme="dark"] .dash-donut-sep { background: var(--border-card); }
[data-theme="dark"] .dash-trend-chart {
  border-color: var(--border-200);
}
[data-theme="dark"] .dash-bar-chart { border-color: var(--border-200); }
[data-theme="dark"] .dash-rem-body { background: var(--border-card); }
[data-theme="dark"] .dash-rem-item { background: var(--surface-card); }
[data-theme="dark"] .dash-rem-item:hover { background: var(--hover-default); }
[data-theme="dark"] .dash-rem-ring-track { stroke: var(--neutral-800); }
[data-theme="dark"] .dash-filetype-legend { border-color: var(--border-card); }
[data-theme="dark"] .dash-filetype-legend-header { border-color: var(--border-200); }
[data-theme="dark"] .dash-ftl-bar-wrap { background: var(--neutral-800); }
[data-theme="dark"] .dash-ftl-archive { background: var(--neutral-800); color: var(--neutral-400); }
[data-theme="dark"] .dash-ftl-app { background: rgba(212,0,49,0.12); color: var(--red-400); }
[data-theme="dark"] .dash-ftl-exe { background: var(--neutral-800); color: var(--neutral-400); }
[data-theme="dark"] .dash-ftl-img { background: rgba(212,0,49,0.1); color: var(--red-400); }
[data-theme="dark"] .dash-ftl-pdf { background: rgba(212,0,49,0.1); color: var(--red-400); }
[data-theme="dark"] .dash-ftl-other { background: var(--neutral-900); color: var(--neutral-500); }
[data-theme="dark"] .btn-menu:hover { border-color: var(--neutral-400); }
[data-theme="dark"] .btn-menu.active { border-color: var(--blue-400); }
[data-theme="dark"] .btn-menu.active:hover { border-color: var(--blue-400); }
[data-theme="dark"] .btn-menu.skeleton { background: var(--neutral-800); }
[data-theme="dark"] .filter-menu { background: var(--surface-card); border-color: var(--border-200); }
[data-theme="dark"] .filter-menu-item:hover { background: var(--neutral-800); }
[data-theme="dark"] .dash-trend-period-tabs { border-color: var(--border-200); }
[data-theme="dark"] .dash-trend-tab { border-color: var(--border-200); color: var(--text-muted); }
[data-theme="dark"] .dash-trend-tab.active { background: rgba(29,107,252,0.12); color: var(--primary); }
[data-theme="dark"] .dash-filetype-legend-header { border-color: var(--border-200); }

/* ===== RESPONSIVE ===== */
@media (max-width: 1200px) {
  .dash-stat-row { grid-template-columns: 1fr 1fr; }
  .dash-stat-row .dash-stat-card:last-child { grid-column: span 2; }
  .dash-rem-body { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 900px) {
  .dash-job-summary-body { flex-direction: column; }
  .dash-card .audit-card-title .count { display: none; }
  .dash-stat-row { grid-template-columns: 1fr; }
  .dash-stat-row .dash-stat-card:last-child { grid-column: span 1; }
  .dash-filetype-body { flex-direction: column; }
  .dash-filetype-legend { border-left: none; border-top: 1px solid var(--border-card); }
  .dash-rem-body { grid-template-columns: 1fr; }
}
@media (max-width: 600px) {
  .dash-trend-chart-wrap { height: 140px; }
  .dash-trend-period-tabs { display: none; }
  .dash-trend-legend { flex-wrap: wrap; gap: 8px; }
}

/* ===== Filter Dropdown (Units tab) ===== */
.filter-dropdown {
  position: absolute; top: calc(100% + 4px); right: 0; z-index: 200;
  min-width: 200px; background: var(--surface-card); border: 1px solid var(--border-200);
  border-radius: var(--radius); box-shadow: var(--shadow-3); padding: 0;
  font-size: 14px;
}
.filter-dropdown-header {
  padding: 10px 12px 6px; font-weight: 600; font-size: 13px; color: var(--text-strong);
  border-bottom: 1px solid var(--border-100);
}
.filter-dropdown-item {
  display: flex; align-items: center; gap: 8px; padding: 6px 12px;
  cursor: pointer; color: var(--text-body); font-size: 13px; white-space: nowrap;
}
.filter-dropdown-item:hover { background: var(--neutral-100); }
.filter-dropdown-footer {
  display: flex; align-items: center; justify-content: flex-end; gap: 8px;
  padding: 8px 12px; border-top: 1px solid var(--border-100);
}
[data-theme="dark"] .filter-dropdown-item:hover { background: var(--neutral-800); }

/* Provider icon — Google Cloud */
.inv-provider-icon.gcloud { background: #4285f4; }

/* ===== RESPONSIVE: Mobile (<=768px) ===== */
@media (max-width: 768px) {
  /* Page header — title left, buttons stacked below */
  .page-title-row { flex-direction: column; align-items: flex-start; height: auto; gap: 20px; }
  .page-header-actions { flex-wrap: wrap; }

  /* Info-bar — stack sections vertically */
  .info-bar { flex-direction: column; align-items: flex-start; gap: 32px; }
  .info-bar-divider { display: none; }
  .info-bar-section { width: 100%; }

  /* Banner — stack text and actions */
  .banner-content { flex-wrap: wrap; }
  .banner-actions { width: 100%; }

  /* Tables — card full-width, content scrolls */
  .data-table, .pool-table { display: block; overflow-x: auto; }

  /* Inputs — full width */
  .input-field, .select-field { width: 100% !important; max-width: 100% !important; }
  .form-row { flex-direction: column; }
  .form-value { width: 100%; }

  /* Tabs — scroll when overflowing */
  .tab-bar { overflow-x: auto; flex-wrap: nowrap; }
}

  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <div class="app">
    <!-- Header -->
    <header class="header" role="banner">
      <div class="header-left">
        <button class="sidebar-toggle" aria-label="Toggle sidebar" onclick="toggleSidebar()">
          <svg class="sidebar-icon-extended" viewBox="0 0 16 16" fill="currentColor"><path d="M2 2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm12-1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2z"/><path d="M13 4a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z"/></svg>
          <svg class="sidebar-icon-collapsed" style="display:none" viewBox="0 0 16 16" fill="currentColor"><path d="M14 2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zM2 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2z"/><path d="M3 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z"/></svg>
        </button>
        <div class="header-logo">
          <div class="header-logo-text">
            <span>METADEFENDER</span>
            <span>Storage Security</span>
          </div>
        </div>
      </div>
      <div class="header-right">
        <div class="header-icon">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
        </div>
        <div class="notif-dropdown-wrap">
          <div class="header-icon" style="position: relative; cursor:pointer;" onclick="toggleNotifDropdown(event)">
            <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.62984 13.13C8.13984 13.62 7.34984 13.62 6.85984 13.13C6.56984 12.84 6.08984 12.84 5.79984 13.13C5.50984 13.42 5.50984 13.9 5.79984 14.19C6.33984 14.73 7.03984 14.99 7.73984 14.99C8.43984 14.99 9.14984 14.72 9.67984 14.19C9.96984 13.9 9.96984 13.42 9.67984 13.13C9.38984 12.84 8.90984 12.84 8.61984 13.13H8.62984Z"/><path d="M14.1698 10.63C13.3598 10.07 12.4998 8.17 12.4998 5.75C12.4998 3.13 10.3698 1 7.74984 1C5.12984 1 2.99984 3.13 2.99984 5.75C2.99984 8.17 2.13984 10.07 1.32984 10.63C1.05984 10.82 0.939844 11.16 1.03984 11.47C1.13984 11.78 1.42984 12 1.75984 12H13.7598C14.0898 12 14.3798 11.79 14.4798 11.47C14.5798 11.16 14.4598 10.82 14.1898 10.63H14.1698Z"/></svg>
            <span class="notif-dot" style="display:none;"></span>
          </div>
          <!-- Notifications Dropdown -->
          <div class="notif-dropdown" id="notifDropdown">
            <div class="notif-header">
              <span class="notif-header-title">Notifications</span>
              <button class="notif-header-action" onclick="markAllNotifRead()">Mark all read</button>
            </div>
            <div class="notif-list" id="notifList">
              <!-- License Expired notification (hidden until expiration triggers) -->
              <div class="notif-msg" id="notifLicenseExpired" style="display:none;" onclick="notifNavigateLicensing()">
                <div class="notif-msg-top">
                  <div class="notif-msg-title-row">
                    <span class="notif-msg-title">License Expired</span>
                    <span class="notif-msg-dot"></span>
                  </div>
                  <div class="notif-msg-body">Your MetaDefender Storage Security license has expired. Scanning and protection features are now disabled. Please renew your license to restore full functionality.</div>
                </div>
                <div class="notif-msg-bottom">
                  <span class="notif-msg-time">Just now</span>
                </div>
              </div>
              <!-- Empty state (shown by default) -->
              <div class="notif-empty" id="notifEmptyState">
                <div class="notif-empty-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="64" height="48" viewBox="0 0 64 48" fill="none"><path d="M3 0.150391H61C62.574 0.150391 63.8496 1.42599 63.8496 3V35C63.8496 36.574 62.574 37.8496 61 37.8496H11.9453L11.9043 37.8848L0.150391 47.6797V3C0.150391 1.42599 1.42599 0.150391 3 0.150391Z" fill="url(#paint0_linear_18490_25811)" stroke="url(#paint1_linear_18490_25811)" stroke-width="0.3"/><circle cx="16.5" cy="19" r="4.35" fill="#607497" stroke="url(#paint2_linear_18490_25811)" stroke-width="0.3"/><circle cx="32" cy="19" r="4.35" fill="#607497" stroke="url(#paint3_linear_18490_25811)" stroke-width="0.3"/><circle cx="47.5" cy="19" r="4.35" fill="#607497" stroke="url(#paint4_linear_18490_25811)" stroke-width="0.3"/><defs><linearGradient id="paint0_linear_18490_25811" x1="32" y1="0" x2="32" y2="48" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="paint1_linear_18490_25811" x1="32" y1="0" x2="32" y2="48" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="paint2_linear_18490_25811" x1="16.5" y1="14.5" x2="16.5" y2="23.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="paint3_linear_18490_25811" x1="32" y1="14.5" x2="32" y2="23.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="paint4_linear_18490_25811" x1="47.5" y1="14.5" x2="47.5" y2="23.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient></defs></svg>
                  <span class="notif-empty-badge">0</span>
                </div>
                <div class="notif-empty-title">No Notifications</div>
                <div class="notif-empty-subtitle">Check back for important messages.</div>
              </div>
            </div>
          </div>
        </div>
        <div class="avatar-dropdown-wrap">
          <div class="header-avatar" onclick="toggleAvatarDropdown(event)" style="cursor:pointer;">E</div>
          <!-- Avatar Dropdown -->
          <div class="avatar-dropdown" id="avatarDropdown">
            <!-- Main Menu -->
            <div class="avd-submenu open" id="avdMain">
              <div class="avd-group">
                <div class="avd-user">
                  <div class="avd-user-info">
                    <div class="avd-user-name">Elvijs Vilevics</div>
                    <div class="avd-user-email">elvijs@opswat.com</div>
                  </div>
                </div>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
                <button class="avd-item" onclick="showAvdSub('avdOrg')">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11 6C10.4477 6 10 6.44772 10 7H9V14H11V12H12V14H14V7H13C13 6.44772 12.5523 6 12 6H11ZM13 11H12V10H13V11ZM11 11H10V10H11V11ZM13 9H12V8H13V9ZM11 9H10V8H11V9Z"/><path d="M5 2C4.72386 2 4.5 2.22386 4.5 2.5V3H4C3.44772 3 3 3.44772 3 4H2V14H4V12H6V14H8V4H7C7 3.44772 6.55228 3 6 3H5.5V2.5C5.5 2.22386 5.27614 2 5 2ZM7 11H6V10H7V11ZM4 11H3V10H4V11ZM7 9H6V8H7V9ZM4 9H3V8H4V9ZM7 7H6V6H7V7ZM4 7H3V6H4V7ZM6 5H4V4H6V5Z"/></svg>
                  <span class="avd-item-text">Organization</span>
                  <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.74945 12.9999C5.55945 12.9999 5.36945 12.9299 5.21945 12.7799C4.92945 12.4899 4.92945 12.0099 5.21945 11.7199L8.93945 7.99994L5.21945 4.27994C4.92945 3.98994 4.92945 3.50994 5.21945 3.21994C5.50945 2.92994 5.98945 2.92994 6.27945 3.21994L10.5295 7.46994C10.8195 7.75994 10.8195 8.23994 10.5295 8.52994L6.27945 12.7799C6.12945 12.9299 5.93945 12.9999 5.74945 12.9999Z"/></svg>
                </button>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
                <button class="avd-item" onclick="avdNavigate('profile')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M7.99023 10C8.60018 10 9.30032 10.0896 9.99023 10.2695C10.1201 10.2995 10.2598 10.3399 10.3896 10.3799C11.7795 10.8198 12.9802 11.5998 12.9805 12.6396H13V14H3V12.6396C3.00027 11.5999 4.20005 10.8198 5.58984 10.3799C6.38984 10.1299 7.26023 10 7.99023 10Z"/><path d="M8 3C8.76989 3 9.47003 3.28966 10 3.76953C10.62 4.30953 11 5.11 11 6C11 6.88994 10.6199 7.68973 10 8.21973C9.47 8.70973 8.77 9 8 9C7.23 9 6.53 8.70973 6 8.21973C5.38008 7.68973 5 6.88994 5 6C5 4.34 6.34 3 8 3Z"/></svg>
                <span class="avd-item-text">Profile</span>
              </button>
              <button class="avd-item" onclick="avdNavigate('settings')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.2101 8.46C13.2201 8.31 13.2301 8.16 13.2301 8C13.2301 7.84 13.2201 7.69 13.2101 7.54C13.2001 7.4 13.1801 7.25 13.1601 7.11L14.1201 6.26C14.4801 5.95 14.5601 5.42 14.3301 5.01L13.7501 4.01C13.5101 3.6 13.0201 3.41 12.5701 3.56L11.3301 3.97C11.1001 3.78 10.8601 3.61 10.6001 3.46C10.3301 3.32 10.0601 3.19 9.78005 3.08L9.54005 1.81C9.45005 1.34 9.04005 1 8.56005 1H7.41005C6.93005 1 6.52005 1.34 6.43005 1.81L6.19005 3.08C5.91005 3.19 5.64005 3.32 5.37005 3.46C5.11005 3.61 4.87005 3.78 4.64005 3.97L3.40005 3.56C2.95005 3.41 2.46005 3.6 2.22005 4.01L1.64005 5.01C1.40005 5.42 1.49005 5.95 1.85005 6.26L2.81005 7.11C2.79005 7.25 2.77005 7.4 2.76005 7.54C2.75005 7.69 2.74005 7.84 2.74005 8C2.74005 8.16 2.75005 8.31 2.76005 8.46C2.77005 8.6 2.79005 8.75 2.81005 8.89L1.85005 9.74C1.49005 10.05 1.41005 10.58 1.64005 10.99L2.22005 11.99C2.46005 12.4 2.95005 12.59 3.40005 12.44L4.64005 12.03C4.87005 12.22 5.11005 12.39 5.37005 12.54C5.64005 12.68 5.91005 12.81 6.19005 12.92L6.43005 14.19C6.52005 14.66 6.93005 15 7.41005 15H8.56005C9.04005 15 9.45005 14.66 9.54005 14.19L9.78005 12.92C10.0601 12.81 10.3301 12.68 10.6001 12.54C10.8601 12.39 11.1001 12.22 11.3301 12.03L12.5701 12.44C13.0201 12.59 13.5101 12.4 13.7501 11.99L14.3301 10.99C14.5701 10.58 14.4801 10.05 14.1201 9.74L13.1601 8.89C13.1801 8.75 13.2001 8.6 13.2101 8.46ZM8.57005 10.94C6.45005 11.34 4.64005 9.53 5.04005 7.41C5.26005 6.23 6.22005 5.27 7.40005 5.05C9.52005 4.65 11.3301 6.46 10.9301 8.58C10.7101 9.76 9.75005 10.72 8.57005 10.94Z"/></svg>
                <span class="avd-item-text">Settings</span>
              </button>
              <button class="avd-item">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14 2H2C1.45 2 1 2.45 1 3V14.5L3.5 12H14C14.55 12 15 11.55 15 11V3C15 2.45 14.55 2 14 2Z"/></svg>
                <span class="avd-item-text">Support</span>
              </button>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
              <button class="avd-item" onclick="showAvdSub('avdTheme')">
                <svg class="theme-icon-moon" viewBox="0 0 16 16" fill="currentColor"><path d="M14.4379 10.1415C14.6279 9.71649 14.1169 9.35449 13.6899 9.54049C12.6773 9.98079 11.5557 10.1061 10.4709 9.90018C9.38608 9.69424 8.38839 9.16655 7.60762 8.38578C6.82686 7.60502 6.29917 6.60733 6.09323 5.52253C5.88728 4.43774 6.01262 3.31607 6.45292 2.30349C6.63892 1.87649 6.27692 1.36549 5.85292 1.55549C4.89004 1.98495 4.04606 2.64214 3.39374 3.47042C2.74142 4.2987 2.30033 5.2732 2.10851 6.30991C1.91668 7.34662 1.97988 8.41443 2.29265 9.42128C2.60541 10.4281 3.15837 11.3438 3.90383 12.0893C4.6493 12.8349 5.5649 13.388 6.57172 13.7008C7.57853 14.0137 8.64633 14.0771 9.68306 13.8853C10.7198 13.6936 11.6944 13.2527 12.5227 12.6004C13.3511 11.9482 14.0084 11.1043 14.4379 10.1415Z"/></svg>
                <svg class="theme-icon-sun" viewBox="0 0 16 16" fill="currentColor" style="display:none;"><path d="M8 11C9.65 11 11 9.66 11 8C11 6.34 9.65 5 8 5C6.35 5 5 6.34 5 8C5 9.66 6.35 11 8 11Z"/><path d="M14.25 7.25C14.6642 7.25 15 7.58579 15 8C15 8.41421 14.6642 8.75 14.25 8.75H13.25C12.8358 8.75 12.5 8.41421 12.5 8C12.5 7.58579 12.8358 7.25 13.25 7.25H14.25Z"/><path d="M11.8897 3.04973C12.1826 2.75684 12.6573 2.75685 12.9502 3.04973C13.2431 3.34262 13.2431 3.81738 12.9502 4.11028L12.2403 4.82024C11.9474 5.11313 11.4726 5.11313 11.1797 4.82024C10.8869 4.52734 10.8868 4.05258 11.1797 3.75969L11.8897 3.04973Z"/><path d="M7.25 2.75V1.75C7.25 1.33579 7.58579 1 8 1C8.41421 1 8.75 1.33579 8.75 1.75V2.75C8.75 3.16421 8.41421 3.5 8 3.5C7.58579 3.5 7.25 3.16421 7.25 2.75Z"/><path d="M3.04973 3.04973C3.34262 2.75684 3.81738 2.75684 4.11028 3.04973L4.82024 3.75969L4.87199 3.81633C5.11234 4.11091 5.09485 4.54562 4.82024 4.82024C4.54562 5.09485 4.11091 5.11234 3.81633 4.87199L3.75969 4.82024L3.04973 4.11028C2.75684 3.81738 2.75684 3.34262 3.04973 3.04973Z"/><path d="M2.75 7.25C3.16421 7.25 3.5 7.58579 3.5 8C3.5 8.41421 3.16421 8.75 2.75 8.75H1.75C1.33579 8.75 1 8.41421 1 8C1 7.58579 1.33579 7.25 1.75 7.25H2.75Z"/><path d="M3.75969 11.1797C4.05258 10.8868 4.52734 10.8869 4.82024 11.1797C5.11313 11.4726 5.11313 11.9474 4.82024 12.2403L4.11028 12.9502C3.81738 13.2431 3.34262 13.2431 3.04973 12.9502C2.75685 12.6573 2.75684 12.1826 3.04973 11.8897L3.75969 11.1797Z"/><path d="M7.25 14.25V13.25C7.25 12.8358 7.58579 12.5 8 12.5C8.41421 12.5 8.75 12.8358 8.75 13.25V14.25C8.75 14.6642 8.41421 15 8 15C7.58579 15 7.25 14.6642 7.25 14.25Z"/><path d="M11.1797 11.1797C11.4726 10.8868 11.9474 10.8868 12.2403 11.1797L12.9502 11.8897L13.002 11.9463C13.2423 12.2409 13.2249 12.6756 12.9502 12.9502C12.6756 13.2249 12.2409 13.2423 11.9463 13.002L11.8897 12.9502L11.1797 12.2403C10.8868 11.9474 10.8868 11.4726 11.1797 11.1797Z"/></svg>
                <span class="avd-item-text" id="avdThemeLabel">Light Theme</span>
                <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.74945 12.9999C5.55945 12.9999 5.36945 12.9299 5.21945 12.7799C4.92945 12.4899 4.92945 12.0099 5.21945 11.7199L8.93945 7.99994L5.21945 4.27994C4.92945 3.98994 4.92945 3.50994 5.21945 3.21994C5.50945 2.92994 5.98945 2.92994 6.27945 3.21994L10.5295 7.46994C10.8195 7.75994 10.8195 8.23994 10.5295 8.52994L6.27945 12.7799C6.12945 12.9299 5.93945 12.9999 5.74945 12.9999Z"/></svg>
              </button>
              <button class="avd-item" onclick="showAvdSub('avdLang')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.996 5.00155C11.1422 5.0016 11.2851 5.04435 11.4072 5.12456C11.5294 5.20476 11.6254 5.31891 11.6834 5.45295L14.9306 12.943C14.9726 13.0337 14.9961 13.1319 14.9995 13.2318C15.003 13.3316 14.9865 13.4312 14.9509 13.5246C14.9153 13.618 14.8613 13.7033 14.7922 13.7755C14.7231 13.8477 14.6402 13.9054 14.5485 13.9451C14.4567 13.9849 14.358 14.0058 14.258 14.0068C14.158 14.0078 14.0588 13.9887 13.9663 13.9508C13.8738 13.9129 13.7899 13.8569 13.7193 13.786C13.6488 13.7152 13.5932 13.6309 13.5558 13.5382L12.8844 11.9923H9.10668L8.43726 13.5382C8.3583 13.7206 8.21009 13.8641 8.02525 13.9373C7.8404 14.0104 7.63406 14.0072 7.45162 13.9282C7.26918 13.8493 7.12558 13.7012 7.05241 13.5164C6.97924 13.3316 6.98249 13.1254 7.06146 12.943L10.3086 5.45295C10.3667 5.31891 10.4627 5.20476 10.5848 5.12456C10.707 5.04435 10.8499 5.0016 10.996 5.00155ZM9.75711 10.4943H12.235L10.996 7.63406L9.75711 10.4943ZM5.00126 1.00684C5.19999 1.00684 5.39059 1.08575 5.53112 1.22622C5.67165 1.36668 5.7506 1.5572 5.7506 1.75584V3.01518C6.6189 3.04074 7.4853 3.11107 8.34634 3.2259C8.54336 3.25238 8.72178 3.35602 8.84235 3.51399C8.96293 3.67197 9.01578 3.87135 8.98928 4.06828C8.96278 4.26521 8.8591 4.44355 8.70106 4.56407C8.54301 4.68459 8.34353 4.73742 8.14651 4.71093C7.92671 4.68097 7.7069 4.655 7.48509 4.63104C7.13359 5.84275 6.60645 6.99648 5.92045 8.0555C6.15725 8.3591 6.40803 8.64971 6.6718 8.92735C6.80893 9.07117 6.88328 9.26355 6.87851 9.46217C6.87373 9.66079 6.79021 9.84938 6.64632 9.98644C6.50243 10.1235 6.30997 10.1978 6.11126 10.1931C5.91255 10.1883 5.72388 10.1048 5.58675 9.96098C5.38423 9.74824 5.18896 9.52874 5.00126 9.30285C4.18461 10.2846 3.22824 11.1413 2.16273 11.8455C1.99685 11.955 1.79423 11.9942 1.59946 11.9544C1.40468 11.9146 1.23371 11.7991 1.12413 11.6333C1.01456 11.4675 0.975374 11.2649 1.01519 11.0702C1.05501 10.8756 1.17057 10.7047 1.33645 10.5951C2.38365 9.90296 3.311 9.04483 4.08206 8.0545C3.88453 7.75012 3.69986 7.43759 3.52854 7.11774C3.43487 6.94253 3.41466 6.73731 3.47237 6.54721C3.53009 6.35711 3.66098 6.19772 3.83627 6.10409C4.01156 6.01046 4.21688 5.99026 4.40706 6.04795C4.59725 6.10563 4.75671 6.23647 4.85039 6.41168C4.89934 6.50156 4.9493 6.59244 5.00026 6.68232C5.38792 6.00322 5.70764 5.27918 5.95143 4.52118C4.58303 4.4671 3.21252 4.53059 1.855 4.71093C1.65798 4.73742 1.45851 4.68459 1.30046 4.56407C1.14241 4.44355 1.03873 4.26521 1.01223 4.06828C0.985733 3.87135 1.03858 3.67197 1.15916 3.51399C1.27973 3.35602 1.45815 3.25238 1.65517 3.2259C2.50743 3.11205 3.37367 3.04114 4.25091 3.01518V1.75584C4.25091 1.6574 4.27032 1.55992 4.30805 1.46898C4.34577 1.37804 4.40105 1.29543 4.47074 1.22586C4.54043 1.1563 4.62316 1.10115 4.71419 1.06356C4.80522 1.02598 4.90277 1.00671 5.00126 1.00684Z"/></svg>
                <span class="avd-item-text">English</span>
                <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.74945 12.9999C5.55945 12.9999 5.36945 12.9299 5.21945 12.7799C4.92945 12.4899 4.92945 12.0099 5.21945 11.7199L8.93945 7.99994L5.21945 4.27994C4.92945 3.98994 4.92945 3.50994 5.21945 3.21994C5.50945 2.92994 5.98945 2.92994 6.27945 3.21994L10.5295 7.46994C10.8195 7.75994 10.8195 8.23994 10.5295 8.52994L6.27945 12.7799C6.12945 12.9299 5.93945 12.9999 5.74945 12.9999Z"/></svg>
              </button>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
              <button class="avd-item avd-item-subtle" style="display:none;">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.29055 11.76L4.55055 9.5L5.61055 10.56L4.45055 11.72H6.83055C7.24055 11.72 7.58055 12.06 7.58055 12.47C7.58055 12.88 7.24055 13.22 6.83055 13.22H4.45055L5.61055 14.38L4.55055 15.44L2.29055 13.18C1.90055 12.79 1.90055 12.16 2.29055 11.77V11.76Z"/><path d="M13.7105 4.68L11.4505 6.94L10.3905 5.88L11.5505 4.72H9.17055C8.76055 4.72 8.42055 4.38 8.42055 3.97C8.42055 3.56 8.76055 3.22 9.17055 3.22H11.5505L10.3905 2.06L11.4505 1L13.7105 3.26C14.1005 3.65 14.1005 4.28 13.7105 4.67V4.68Z"/><path d="M3.00055 4.22V7.22H4.50055V4.72H13.0005V3.22H4.00055C3.45055 3.22 3.00055 3.67 3.00055 4.22Z"/><path d="M13.0005 12.22V9.22H11.5005V11.72H3.00055V13.22H12.0005C12.5505 13.22 13.0005 12.77 13.0005 12.22Z"/></svg>
                <span class="avd-item-text">Switch to New Version</span>
              </button>
              <button class="avd-item">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.54 8.75H6.75C6.34 8.75 6 8.41 6 8C6 7.59 6.34 7.25 6.75 7.25H11.54L10.38 6.09L11.44 5.03L13.7 7.29C14.09 7.68 14.09 8.31 13.7 8.7L11.44 10.96L10.38 9.9L11.54 8.74V8.75Z"/><path d="M8 14H3C2.45 14 2 13.55 2 13V3C2 2.45 2.45 2 3 2H8V3.5H3.5V12.5H8V14Z"/></svg>
                <span class="avd-item-text">Logout</span>
              </button>
              </div>
            </div>
            <!-- Theme Submenu -->
            <div class="avd-submenu" id="avdTheme">
              <button class="avd-back" onclick="showAvdSub('avdMain')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99945 12.9999C9.80945 12.9999 9.61945 12.9299 9.46945 12.7799L5.21945 8.52994C4.92945 8.23994 4.92945 7.75994 5.21945 7.46994L9.46945 3.21994C9.75945 2.92994 10.2395 2.92994 10.5295 3.21994C10.8195 3.50994 10.8195 3.98994 10.5295 4.27994L6.80945 7.99994L10.5295 11.7199C10.8195 12.0099 10.8195 12.4899 10.5295 12.7799C10.3795 12.9299 10.1895 12.9999 9.99945 12.9999Z"/></svg>
                Back
              </button>
              <div class="avd-divider"></div>
              <button class="avd-item active" onclick="setAvdTheme('light', this)">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 11C9.65 11 11 9.66 11 8C11 6.34 9.65 5 8 5C6.35 5 5 6.34 5 8C5 9.66 6.35 11 8 11Z"/><path d="M14.25 7.25C14.6642 7.25 15 7.58579 15 8C15 8.41421 14.6642 8.75 14.25 8.75H13.25C12.8358 8.75 12.5 8.41421 12.5 8C12.5 7.58579 12.8358 7.25 13.25 7.25H14.25Z"/><path d="M11.8897 3.04973C12.1826 2.75684 12.6573 2.75685 12.9502 3.04973C13.2431 3.34262 13.2431 3.81738 12.9502 4.11028L12.2403 4.82024C11.9474 5.11313 11.4726 5.11313 11.1797 4.82024C10.8869 4.52734 10.8868 4.05258 11.1797 3.75969L11.8897 3.04973Z"/><path d="M7.25 2.75V1.75C7.25 1.33579 7.58579 1 8 1C8.41421 1 8.75 1.33579 8.75 1.75V2.75C8.75 3.16421 8.41421 3.5 8 3.5C7.58579 3.5 7.25 3.16421 7.25 2.75Z"/><path d="M3.04973 3.04973C3.34262 2.75684 3.81738 2.75684 4.11028 3.04973L4.82024 3.75969L4.87199 3.81633C5.11234 4.11091 5.09485 4.54562 4.82024 4.82024C4.54562 5.09485 4.11091 5.11234 3.81633 4.87199L3.75969 4.82024L3.04973 4.11028C2.75684 3.81738 2.75684 3.34262 3.04973 3.04973Z"/><path d="M2.75 7.25C3.16421 7.25 3.5 7.58579 3.5 8C3.5 8.41421 3.16421 8.75 2.75 8.75H1.75C1.33579 8.75 1 8.41421 1 8C1 7.58579 1.33579 7.25 1.75 7.25H2.75Z"/><path d="M3.75969 11.1797C4.05258 10.8868 4.52734 10.8869 4.82024 11.1797C5.11313 11.4726 5.11313 11.9474 4.82024 12.2403L4.11028 12.9502C3.81738 13.2431 3.34262 13.2431 3.04973 12.9502C2.75685 12.6573 2.75684 12.1826 3.04973 11.8897L3.75969 11.1797Z"/><path d="M7.25 14.25V13.25C7.25 12.8358 7.58579 12.5 8 12.5C8.41421 12.5 8.75 12.8358 8.75 13.25V14.25C8.75 14.6642 8.41421 15 8 15C7.58579 15 7.25 14.6642 7.25 14.25Z"/><path d="M11.1797 11.1797C11.4726 10.8868 11.9474 10.8868 12.2403 11.1797L12.9502 11.8897L13.002 11.9463C13.2423 12.2409 13.2249 12.6756 12.9502 12.9502C12.6756 13.2249 12.2409 13.2423 11.9463 13.002L11.8897 12.9502L11.1797 12.2403C10.8868 11.9474 10.8868 11.4726 11.1797 11.1797Z"/></svg>
                <span class="avd-item-text">Light Theme</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item" onclick="setAvdTheme('dark', this)">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.4379 10.1415C14.6279 9.71649 14.1169 9.35449 13.6899 9.54049C12.6773 9.98079 11.5557 10.1061 10.4709 9.90018C9.38608 9.69424 8.38839 9.16655 7.60762 8.38578C6.82686 7.60502 6.29917 6.60733 6.09323 5.52253C5.88728 4.43774 6.01262 3.31607 6.45292 2.30349C6.63892 1.87649 6.27692 1.36549 5.85292 1.55549C4.89004 1.98495 4.04606 2.64214 3.39374 3.47042C2.74142 4.2987 2.30033 5.2732 2.10851 6.30991C1.91668 7.34662 1.97988 8.41443 2.29265 9.42128C2.60541 10.4281 3.15837 11.3438 3.90383 12.0893C4.6493 12.8349 5.5649 13.388 6.57172 13.7008C7.57853 14.0137 8.64633 14.0771 9.68306 13.8853C10.7198 13.6936 11.6944 13.2527 12.5227 12.6004C13.3511 11.9482 14.0084 11.1043 14.4379 10.1415Z"/></svg>
                <span class="avd-item-text">Dark Theme</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item" onclick="setAvdTheme('system', this)">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2zm0 1.5a.5.5 0 00-.5.5v4h4.75V3.5H4zm4.75 5H3.5V12a.5.5 0 00.5.5h4.75V8.5zm1.5-5v9.5H12a.5.5 0 00.5-.5V4a.5.5 0 00-.5-.5h-1.75z"/></svg>
                <span class="avd-item-text">System Default</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
            </div>
            <!-- Organization Submenu -->
            <div class="avd-submenu" id="avdOrg">
              <button class="avd-back" onclick="showAvdSub('avdMain')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99945 12.9999C9.80945 12.9999 9.61945 12.9299 9.46945 12.7799L5.21945 8.52994C4.92945 8.23994 4.92945 7.75994 5.21945 7.46994L9.46945 3.21994C9.75945 2.92994 10.2395 2.92994 10.5295 3.21994C10.8195 3.50994 10.8195 3.98994 10.5295 4.27994L6.80945 7.99994L10.5295 11.7199C10.8195 12.0099 10.8195 12.4899 10.5295 12.7799C10.3795 12.9299 10.1895 12.9999 9.99945 12.9999Z"/></svg>
                Back
              </button>
              <div class="avd-divider"></div>
              <button class="avd-item active">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11 6C10.4477 6 10 6.44772 10 7H9V14H11V12H12V14H14V7H13C13 6.44772 12.5523 6 12 6H11ZM13 11H12V10H13V11ZM11 11H10V10H11V11ZM13 9H12V8H13V9ZM11 9H10V8H11V9Z"/><path d="M5 2C4.72386 2 4.5 2.22386 4.5 2.5V3H4C3.44772 3 3 3.44772 3 4H2V14H4V12H6V14H8V4H7C7 3.44772 6.55228 3 6 3H5.5V2.5C5.5 2.22386 5.27614 2 5 2ZM7 11H6V10H7V11ZM4 11H3V10H4V11ZM7 9H6V8H7V9ZM4 9H3V8H4V9ZM7 7H6V6H7V7ZM4 7H3V6H4V7ZM6 5H4V4H6V5Z"/></svg>
                <span class="avd-item-text">OPSWAT Inc.</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
            </div>
            <!-- Language Submenu -->
            <div class="avd-submenu" id="avdLang">
              <button class="avd-back" onclick="showAvdSub('avdMain')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99945 12.9999C9.80945 12.9999 9.61945 12.9299 9.46945 12.7799L5.21945 8.52994C4.92945 8.23994 4.92945 7.75994 5.21945 7.46994L9.46945 3.21994C9.75945 2.92994 10.2395 2.92994 10.5295 3.21994C10.8195 3.50994 10.8195 3.98994 10.5295 4.27994L6.80945 7.99994L10.5295 11.7199C10.8195 12.0099 10.8195 12.4899 10.5295 12.7799C10.3795 12.9299 10.1895 12.9999 9.99945 12.9999Z"/></svg>
                Back
              </button>
              <div class="avd-divider"></div>
              <button class="avd-item active">
                <svg class="avd-flag" viewBox="0 0 20 16" fill="none"><path d="M20 0H0v16h20V0Z" fill="#F0F0F0"/><path d="M20 3.5H0v1.8h20V3.5ZM20 0H0v1.8h20V0ZM20 7.1H0v1.8h20V7.1ZM20 10.6H0v1.8h20v-1.8ZM20 14.1H0V16h20v-1.9Z" fill="#D80027"/><path d="M10 0H0v8.9h10V0Z" fill="#2E52B2"/><path d="M3.9 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L3.9 3.5ZM4.06 6.27L3.9 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM1.86 6.27L1.7 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM1.7 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L1.7 3.5ZM3.9 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L3.9 1.4ZM1.7 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L1.7 1.4ZM6.1 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L6.1 3.5ZM6.26 6.27L6.1 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM8.47 6.27L8.3 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM8.3 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L8.3 3.5ZM6.1 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L6.1 1.4ZM8.3 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L8.3 1.4Z" fill="#F0F0F0"/></svg>
                <span class="avd-item-text">English</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item">
                <svg class="avd-flag" viewBox="0 0 20 16" fill="none"><path d="M20 0H0v16h20V0Z" fill="#D80027"/><path d="M20 0H0v5.3h20V0Z" fill="#000"/><path d="M20 10.7H0V16h20v-5.3Z" fill="#FFDA44"/></svg>
                <span class="avd-item-text">Deutsch</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item">
                <svg class="avd-flag" viewBox="0 0 20 16" fill="none"><path d="M20 0H0v16h20V0Z" fill="#F0F0F0"/><path d="M10 11.9a3.9 3.9 0 100-7.8 3.9 3.9 0 000 7.8Z" fill="#D80027"/></svg>
                <span class="avd-item-text">&#26085;&#26412;&#35486;</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main -->
    <div class="main">
      <!-- Mobile sidebar overlay -->
      <div class="sidebar-mobile-overlay" onclick="closeMobileSidebar()"></div>
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar" role="complementary" aria-label="Settings navigation">
        <nav class="sidebar-nav" aria-label="Main navigation">
          <a class="nav-item active" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M7.5 7.5V3.5H14.5C15.05 3.5 15.5 3.9 15.5 4.39V7.5H7.5Z"/><path d="M1.5 12.61V9.5H8.5V13.5H2.36C1.88 13.5 1.5 13.1 1.5 12.61Z"/><path d="M6 5.5C6 4.11929 4.88071 3 3.5 3C2.11929 3 1 4.11929 1 5.5C1 6.88071 2.11929 8 3.5 8C4.88071 8 6 6.88071 6 5.5Z"/><path d="M10.5 9.5H15.5V12.5C15.5 13.05 15.05 13.5 14.5 13.5H10.5V9.5Z"/></svg><span class="nav-text">Dashboard</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5 2V5H2V3C2 2.45 2.45 2 3 2H5Z"/><path d="M5 9.5V6.5H2V9.5H5Z"/><path d="M5 11V14H3C2.45 14 2 13.55 2 13V11H5Z"/><path d="M14 3V5H6.5V2H13C13.55 2 14 2.45 14 3Z"/><path d="M6.5 14V11H14V13C14 13.55 13.55 14 13 14H6.5Z"/><path d="M14 9.5V6.5H6.5V9.5H14Z"/></svg><span class="nav-text">Reports</span></a>
          <div class="nav-divider"></div>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.5 4.05L13.25 3.9L8.5 1.13C8.35 1.04 8.17 1 8 1C7.83 1 7.65 1.04 7.5 1.13L2.75 3.9L2.5 4.05C2.19 4.23 2 4.56 2 4.91V10.77C2 11.12 2.19 11.45 2.5 11.63L7.25 14.4L7.5 14.55C7.65 14.64 7.83 14.68 8 14.68C8.17 14.68 8.35 14.64 8.5 14.55L8.75 14.4L13.5 11.63C13.81 11.45 14 11.12 14 10.77V4.91C14 4.56 13.81 4.23 13.5 4.05ZM12.5 6.09L8.75 8.27V12.66L8 13.1L7.25 12.66V8.27L3.5 6.09V5.2L4.23 4.77L8 6.97L11.77 4.77L12.5 5.2V6.09Z"/></svg><span class="nav-text">Inventory</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 14H14V10H12.75V8C12.75 7.59 12.41 7.25 12 7.25L8.75 7.25V6H10V2L6 2V6H7.25V7.25L4 7.25C3.59 7.25 3.25 7.59 3.25 8L3.25 10H2L2 14H6V10H4.75L4.75 8.75L11.25 8.75V10H10L10 14Z"/></svg><span class="nav-text">Workflows</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 6V4.75H8.75V11.25H10V10H14V14H10V12.75H8C7.59 12.75 7.25 12.41 7.25 12V8.75H6.25L4 11L1 8L4 5L6.25 7.25H7.25V4C7.25 3.59 7.59 3.25 8 3.25H10V2H14V6H10Z"/></svg><span class="nav-text">Jobs</span></a>
          <div class="nav-divider"></div>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 6C13 7.57 11.8 8.85 10.27 8.98C10.18 9 10.09 9 10 9C10.03 8.97 10.06 8.93 10.08 8.89C10.66 8.07 11 7.08 11 6C11 4.92 10.63 3.83 10 3C11.66 3 13 4.34 13 6Z"/><path d="M15 12.64V14H13V12.64C13 11.71 12.64 10.92 12.05 10.28C13.58 10.69 15 11.51 15 12.64Z"/><path d="M9 6C9 6.89 8.62 7.69 8 8.22C7.47 8.71 6.77 9 6 9C5.23 9 4.53 8.71 4 8.22C3.38 7.69 3 6.89 3 6C3 4.34 4.34 3 6 3C6.77 3 7.47 3.29 8 3.77C8.62 4.31 9 5.11 9 6Z"/><path d="M11 12.64V14H1V12.64C1 11.6 2.2 10.82 3.59 10.38C4.39 10.13 5.26 10 5.99 10C6.6 10 7.3 10.09 7.99 10.27C8.12 10.3 8.26 10.34 8.39 10.38C9.78 10.82 10.98 11.6 10.98 12.64H11Z"/></svg><span class="nav-text">Users</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.2101 8.46C13.2201 8.31 13.2301 8.16 13.2301 8C13.2301 7.84 13.2201 7.69 13.2101 7.54C13.2001 7.4 13.1801 7.25 13.1601 7.11L14.1201 6.26C14.4801 5.95 14.5601 5.42 14.3301 5.01L13.7501 4.01C13.5101 3.6 13.0201 3.41 12.5701 3.56L11.3301 3.97C11.1001 3.78 10.8601 3.61 10.6001 3.46C10.3301 3.32 10.0601 3.19 9.78005 3.08L9.54005 1.81C9.45005 1.34 9.04005 1 8.56005 1H7.41005C6.93005 1 6.52005 1.34 6.43005 1.81L6.19005 3.08C5.91005 3.19 5.64005 3.32 5.37005 3.46C5.11005 3.61 4.87005 3.78 4.64005 3.97L3.40005 3.56C2.95005 3.41 2.46005 3.6 2.22005 4.01L1.64005 5.01C1.40005 5.42 1.49005 5.95 1.85005 6.26L2.81005 7.11C2.79005 7.25 2.77005 7.4 2.76005 7.54C2.75005 7.69 2.74005 7.84 2.74005 8C2.74005 8.16 2.75005 8.31 2.76005 8.46C2.77005 8.6 2.79005 8.75 2.81005 8.89L1.85005 9.74C1.49005 10.05 1.41005 10.58 1.64005 10.99L2.22005 11.99C2.46005 12.4 2.95005 12.59 3.40005 12.44L4.64005 12.03C4.87005 12.22 5.11005 12.39 5.37005 12.54C5.64005 12.68 5.91005 12.81 6.19005 12.92L6.43005 14.19C6.52005 14.66 6.93005 15 7.41005 15H8.56005C9.04005 15 9.45005 14.66 9.54005 14.19L9.78005 12.92C10.0601 12.81 10.3301 12.68 10.6001 12.54C10.8601 12.39 11.1001 12.22 11.3301 12.03L12.5701 12.44C13.0201 12.59 13.5101 12.4 13.7501 11.99L14.3301 10.99C14.5701 10.58 14.4801 10.05 14.1201 9.74L13.1601 8.89C13.1801 8.75 13.2001 8.6 13.2101 8.46ZM8.57005 10.94C6.45005 11.34 4.64005 9.53 5.04005 7.41C5.26005 6.23 6.22005 5.27 7.40005 5.05C9.52005 4.65 11.3301 6.46 10.9301 8.58C10.7101 9.76 9.75005 10.72 8.57005 10.94Z"/></svg><span class="nav-text">Settings</span></a>
          <div class="nav-divider"></div>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12 2H11.5V5H4.5V2H4C3.45 2 3 2.45 3 3V13C3 13.55 3.45 14 4 14H12C12.55 14 13 13.55 13 13V3C13 2.45 12.55 2 12 2ZM11 11.5H5C4.59 11.5 4.25 11.16 4.25 10.75C4.25 10.34 4.59 10 5 10H11C11.41 10 11.75 10.34 11.75 10.75C11.75 11.16 11.41 11.5 11 11.5ZM11 8.5H5C4.59 8.5 4.25 8.16 4.25 7.75C4.25 7.34 4.59 7 5 7H11C11.41 7 11.75 7.34 11.75 7.75C11.75 8.16 11.41 8.5 11 8.5Z"/><path d="M10 2V3.5H6V2H7C7 1.45 7.45 1 8 1C8.55 1 9 1.45 9 2H10Z"/></svg><span class="nav-text">Audit</span></a>
        </nav>
        <div class="sidebar-footer">
          <svg class="sidebar-footer-brand" viewBox="0 0 114 18" fill="none"><path d="M8.80491 0C6.66754 0 4.76356 0.719826 3.37305 1.90643V4.27473C4.5572 2.9874 6.4882 1.85484 8.83193 1.85484C12.6423 1.85484 15.5782 4.84224 15.5782 8.85902V14.3941C16.8409 13.0551 17.6394 11.1241 17.6394 8.85902C17.6369 3.75882 13.6987 0 8.80491 0Z" fill="#0C121D"/><path d="M2.08578 8.70425V3.16675C0.823009 4.50567 0 6.43667 0 8.70425C0 13.802 3.94062 17.5608 8.832 17.5608C10.9694 17.5608 12.8733 16.841 14.2909 15.6544V13.2861C13.0797 14.5734 11.1241 15.706 8.80743 15.706C4.99702 15.706 2.08578 12.694 2.08578 8.70179V8.70425Z" fill="#0C121D"/><path d="M29.3974 0.282471H23.4226V17.2758H25.4322V2.03413H29.3728C31.6134 2.03413 32.773 3.42465 32.773 5.2279C32.773 7.03115 31.6134 8.39464 29.3728 8.39464H26.695V10.1463H29.3974C32.746 10.1463 34.8293 8.08509 34.8293 5.20333C34.8293 2.32157 32.746 0.282471 29.3974 0.282471Z" fill="#0C121D"/><path d="M49.2259 3.99221L50.695 2.88422C49.6656 1.23574 47.7076 0 45.4425 0C44.7718 0 44.1552 0.103183 43.5876 0.282526V2.18896C44.1552 1.95802 44.8234 1.85484 45.3909 1.85484C46.9362 1.85484 48.3267 2.62626 49.2283 3.99221H49.2259Z" fill="#0C121D"/><path d="M46.9336 8.08506L45.0542 7.18343C43.5089 6.43658 42.3248 5.87153 42.3248 4.06828V0.874512C41.089 1.62136 40.239 2.8571 40.239 4.45399C40.239 6.84931 42.0939 8.03346 44.0765 8.98668L45.9829 9.8883C47.6559 10.6867 48.8155 11.3034 48.8155 13.1337V16.61C50.1028 15.7869 50.9013 14.4996 50.9013 12.8241C50.9013 10.532 49.4346 9.27166 46.9361 8.08751L46.9336 8.08506Z" fill="#0C121D"/><path d="M40.6517 12.7971L39.158 13.9051C40.4699 16.1457 42.7374 17.5607 45.3637 17.5607C46.1621 17.5607 46.882 17.4305 47.5527 17.1996V15.3202C46.882 15.5511 46.1105 15.7059 45.3907 15.7059C43.2018 15.7059 41.6835 14.367 40.6541 12.7971H40.6517Z" fill="#0C121D"/><path d="M54.8174 0.282471L61.2811 17.5608H62.0009L62.7207 15.8091L57.0309 0.282471H54.8174Z" fill="#0C121D"/><path d="M73.6899 11.4582L74.7709 14.1115L79.9227 0.282471H77.7337L73.6899 11.4582Z" fill="#0C121D"/><path d="M67.0223 0L62.4651 11.4067L63.4159 14.0329L67.381 4.09294L72.7638 17.5608H73.5106L74.1027 15.9123L67.7422 0H67.0223Z" fill="#0C121D"/><path d="M86.0548 12.1659L88.7573 5.88401L87.7033 3.3855L81.7285 17.4184H83.8389L85.281 13.9692H92.2335L91.4621 12.1659H86.0548Z" fill="#0C121D"/><path d="M89.0914 0.142578L88.3716 1.76403L95.0662 17.4184H97.2036L89.8407 0.142578H89.0914Z" fill="#0C121D"/><path d="M112.241 0.282471H98.26V2.08572H112.241V0.282471Z" fill="#0C121D"/><path d="M106.242 3.34619H104.232V17.2759H106.242V3.34619Z" fill="#0C121D"/><path d="M112.263 14.9788C111.536 14.9788 110.934 15.5856 110.934 16.3349C110.934 17.0842 111.536 17.6861 112.263 17.6861C112.991 17.6861 113.583 17.0793 113.583 16.3349C113.583 15.5905 112.993 14.9788 112.263 14.9788Z" fill="#0C121D"/></svg>
          <div class="sidebar-footer-tagline">Protecting the World's Critical Infrastructure</div>
        </div>
      </aside>

      <!-- Content Area -->
      <main class="content" id="main-content" role="main">

        <!-- ==================== SETTINGS PAGE ==================== -->

        <!-- ==================== DASHBOARD PAGE ==================== -->
        <div id="dashboardPage" class="page-view active">

  <!-- Page Header -->
  <div class="page-title-row">
    <h1 class="page-title">Dashboard</h1>
    <div class="page-header-actions">
      <!-- Storage unit filter -->
      <div class="filter-btn-wrap" id="dashUnitFilterWrap">
        <button class="btn-menu" onclick="toggleFilterMenu('dashUnitFilterWrap')">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg>
          <span id="dashUnitFilterText">All Storage Units</span>
        </button>
        <div class="filter-menu" id="dashUnitFilterMenu">
          <div class="filter-menu-item active" data-value="all" onclick="selectFilter('dashUnitFilter','All Storage Units',this)">All Storage Units</div>
          <div class="filter-menu-item" data-value="aws-1" onclick="selectFilter('dashUnitFilter','AWS Unit Name',this)">AWS Unit Name</div>
          <div class="filter-menu-item" data-value="azure-1" onclick="selectFilter('dashUnitFilter','Azure Blob Store',this)">Azure Blob Store</div>
          <div class="filter-menu-item" data-value="gcp-1" onclick="selectFilter('dashUnitFilter','GCP Bucket',this)">GCP Bucket</div>
        </div>
      </div>
      <!-- Time period filter -->
      <div class="filter-btn-wrap" id="dashPeriodWrap">
        <button class="btn-menu" onclick="toggleFilterMenu('dashPeriodWrap')">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg>
          <span id="dashPeriodText">Last 30 days</span>
        </button>
        <div class="filter-menu" id="dashPeriodMenu">
          <div class="filter-menu-item" data-value="7" onclick="selectDashPeriod(7,'Last 7 days',this)">Last 7 days</div>
          <div class="filter-menu-item active" data-value="30" onclick="selectDashPeriod(30,'Last 30 days',this)">Last 30 days</div>
          <div class="filter-menu-item" data-value="90" onclick="selectDashPeriod(90,'Last 90 days',this)">Last 90 days</div>
        </div>
      </div>
      <!-- Export (subtle) -->
      <button class="btn-outline" title="Export report">Export</button>
    </div>
  </div>

  <!-- ===== 1. ACCOUNT INFO BAR ===== -->
  <div class="info-bar" style="margin-bottom:12px;">
    <div class="info-bar-section">
      <div class="info-bar-icon" id="dashProviderIcon">
        <span class="dash-provider-letter">A</span>
      </div>
      <div class="info-bar-meta">
        <div class="info-bar-label">Storage Unit</div>
        <div class="info-bar-value">AWS Unit Name</div>
      </div>
    </div>

    <div class="info-bar-divider"></div>

    <div class="info-bar-section">
      <div class="info-bar-meta">
        <div class="info-bar-label">Status</div>
        <div class="info-bar-value">
          <span class="tag tag-info">Operational</span>
        </div>
      </div>
    </div>

    <div class="info-bar-divider"></div>

    <div class="info-bar-section">
      <div class="info-bar-meta">
        <div class="info-bar-label">Client ID</div>
        <div class="info-bar-value">
          <span class="info-bar-value-text" style="font-weight:400;">a3f9b2c1-4d8e-4f2a-9c1b-7e3d5f8a2b4c</span>
          <button class="copy-btn" title="Copy Client ID" onclick="navigator.clipboard.writeText('a3f9b2c1-4d8e-4f2a-9c1b-7e3d5f8a2b4c').then(function(){showNotification('success','Copied to clipboard')})">
            <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== 2. JOB MONITOR CTA BANNER ===== -->
  <div class="banner banner-info" style="margin-bottom:12px;">
    <div class="banner-icon">
      <svg viewBox="0 0 16 16" fill="none"><path d="M13 2H3C2.45 2 2 2.45 2 3V13C2 13.55 2.45 14 3 14H13C13.55 14 14 13.55 14 13V3C14 2.45 13.55 2 13 2ZM8 4C8.41 4 8.75 4.34 8.75 4.75C8.75 5.16 8.41 5.5 8 5.5C7.59 5.5 7.25 5.16 7.25 4.75C7.25 4.34 7.59 4 8 4ZM9.25 12H6.75C6.34 12 6 11.66 6 11.25C6 10.84 6.34 10.5 6.75 10.5H7.25V7.5H6.75C6.34 7.5 6 7.16 6 6.75C6 6.34 6.34 6 6.75 6H8C8.41 6 8.75 6.34 8.75 6.75V10.5H9.25C9.66 10.5 10 10.84 10 11.25C10 11.66 9.66 12 9.25 12Z" fill="currentColor"/></svg>
    </div>
    <div class="banner-content">
      <div class="banner-text">
        <span class="banner-title">Job Monitor</span>
        <span class="banner-desc">2 jobs currently running</span>
      </div>
      <div class="banner-actions">
        <a href="#" class="btn-text" onclick="showPage('jobsPage'); return false;">View Running Jobs</a>
        <span class="banner-actions-divider"></span>
        <a href="#" class="btn-text">Create Job</a>
      </div>
    </div>
  </div>

  <!-- ===== 3. JOB SUMMARY CARD ===== -->
  <div class="audit-card dash-card" style="margin-bottom: 12px;">
    <div class="audit-card-header">
      <div class="audit-card-title">
        <h3>Job Summary</h3>
        <span class="count">3 Past <span class="accent">(+2 Running)</span></span>
      </div>
      <div class="audit-card-actions">
        <a href="#" class="btn-text" onclick="showPage('auditPage'); return false;">View Reports</a>
      </div>
    </div>

    <div class="dash-job-summary-body">

      <!-- Lockup 1: Total / Skipped+Failed (135/134785 ≈ 0.1%, shown as ~2% for visibility) -->
      <div class="dash-donut-lockup">
        <svg class="dash-donut-svg" viewBox="0 0 44 44">
          <circle cx="22" cy="22" r="22" fill="var(--neutral-200)"/>
          <path d="M22 22 L22 0 A22 22 0 0 1 24.76 0.17Z" fill="var(--red-500)"/>
        </svg>
        <div class="dash-donut-legend">
          <div class="dash-legend-row">
            <span class="dash-legend-marker" style="background: var(--neutral-200);"></span>
            <span class="dash-legend-label">Total</span>
            <span class="dash-legend-val">134,785 <span class="dash-delta">(+657)</span></span>
          </div>
          <div class="dash-legend-row">
            <span class="dash-legend-marker" style="background: var(--red-500);"></span>
            <span class="dash-legend-label">Skipped/Failed</span>
            <span class="dash-legend-val">135 <span class="dash-delta">(+2)</span></span>
          </div>
        </div>
      </div>

      <!-- Lockup 2: Cached / Scanned (3785/134785 ≈ 2.8%) -->
      <div class="dash-donut-lockup">
        <svg class="dash-donut-svg" viewBox="0 0 44 44">
          <circle cx="22" cy="22" r="22" fill="var(--neutral-200)"/>
          <path d="M22 22 L22 0 A22 22 0 0 1 25.86 0.34Z" fill="var(--neutral-800)"/>
        </svg>
        <div class="dash-donut-legend">
          <div class="dash-legend-row">
            <span class="dash-legend-marker" style="background: var(--neutral-200);"></span>
            <span class="dash-legend-label">Cached</span>
            <span class="dash-legend-val">131,000</span>
          </div>
          <div class="dash-legend-row">
            <span class="dash-legend-marker" style="background: var(--neutral-800);"></span>
            <span class="dash-legend-label">Scanned</span>
            <span class="dash-legend-val">3,785 <span class="dash-delta">(+1,045)</span></span>
          </div>
        </div>
      </div>

      <!-- Lockup 3: Allowed / Blocked (126/2593 ≈ 4.9%) -->
      <div class="dash-donut-lockup">
        <svg class="dash-donut-svg" viewBox="0 0 44 44">
          <circle cx="22" cy="22" r="22" fill="var(--neutral-200)"/>
          <path d="M22 22 L22 0 A22 22 0 0 1 28.62 1.02Z" fill="var(--blue-700)"/>
        </svg>
        <div class="dash-donut-legend">
          <div class="dash-legend-row">
            <span class="dash-legend-marker" style="background: var(--neutral-200);"></span>
            <span class="dash-legend-label">Allowed</span>
            <span class="dash-legend-val">2,467 <span class="dash-delta">(+988)</span></span>
          </div>
          <div class="dash-legend-row">
            <span class="dash-legend-marker" style="background: var(--blue-700);"></span>
            <span class="dash-legend-label">Blocked</span>
            <span class="dash-legend-val">126 <span class="dash-delta">(+4)</span></span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- ===== 4. THREE STAT CARDS ROW ===== -->
  <div class="dash-stat-row">

    <!-- Card 1: Threats Detected -->
    <div class="audit-card dash-card dash-stat-card">
      <div class="audit-card-header">
        <div class="audit-card-title">
          <h3>Threats Detected</h3>
        </div>
        <div class="audit-card-actions">
          <a href="#" class="btn-text">View Reports</a>
        </div>
      </div>
      <div class="dash-stat-body">
        <div class="dash-stat-total-row">
          <div class="dash-stat-total-label">Total Files</div>
          <div class="dash-stat-total-val">
            2,001
            <span class="dash-trend-arrow dash-trend-up">
              <svg viewBox="0 0 12 12" fill="currentColor"><path d="M6 2l4 5H2l4-5z"/></svg>
            </span>
            <span class="dash-trend-text">+100, +1%</span>
          </div>
        </div>
        <div class="dash-stat-legend">
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-900);"></span>
            <span class="dash-stat-legend-label">Known Malware</span>
            <span class="dash-stat-legend-val">1,834</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-800);"></span>
            <span class="dash-stat-legend-label">Malicious Behavior</span>
            <span class="dash-stat-legend-val">47</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-700);"></span>
            <span class="dash-stat-legend-label">Vulnerable Executable</span>
            <span class="dash-stat-legend-val">263</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-600);"></span>
            <span class="dash-stat-legend-label">Reputation Match</span>
            <span class="dash-stat-legend-val">436</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-400);"></span>
            <span class="dash-stat-legend-label">Blocked Origin by Policy</span>
            <span class="dash-stat-legend-val">65</span>
          </div>
        </div>
        <!-- Bar chart: values 1834, 47, 263, 436, 65 | max=1834 -->
        <div class="dash-bar-chart">
          <div class="dash-bar-col">
            <span class="dash-bar-label">1,834</span>
            <div class="dash-bar-fill" style="height: 100%; background: var(--blue-900);"></div>
            <span class="dash-bar-x-label">KM</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">47</span>
            <div class="dash-bar-fill" style="height: 2.6%; background: var(--blue-800);"></div>
            <span class="dash-bar-x-label">MB</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">263</span>
            <div class="dash-bar-fill" style="height: 14.3%; background: var(--blue-700);"></div>
            <span class="dash-bar-x-label">VE</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">436</span>
            <div class="dash-bar-fill" style="height: 23.8%; background: var(--blue-600);"></div>
            <span class="dash-bar-x-label">RM</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">65</span>
            <div class="dash-bar-fill" style="height: 3.5%; background: var(--blue-400);"></div>
            <span class="dash-bar-x-label">BP</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Card 2: Data Loss Prevented -->
    <div class="audit-card dash-card dash-stat-card">
      <div class="audit-card-header">
        <div class="audit-card-title">
          <h3>Data Loss Prevented</h3>
        </div>
        <div class="audit-card-actions">
          <a href="#" class="btn-text">View Reports</a>
        </div>
      </div>
      <div class="dash-stat-body">
        <div class="dash-stat-total-row">
          <div class="dash-stat-total-label">Total Files</div>
          <div class="dash-stat-total-val">
            344
            <span class="dash-trend-arrow dash-trend-up">
              <svg viewBox="0 0 12 12" fill="currentColor"><path d="M6 2l4 5H2l4-5z"/></svg>
            </span>
            <span class="dash-trend-text">+18, +5%</span>
          </div>
        </div>
        <div class="dash-stat-legend">
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-800);"></span>
            <span class="dash-stat-legend-label">Personal Information</span>
            <span class="dash-stat-legend-val">146</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-700);"></span>
            <span class="dash-stat-legend-label">Secrets in Text Files</span>
            <span class="dash-stat-legend-val">90</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-600);"></span>
            <span class="dash-stat-legend-label">Credit Card</span>
            <span class="dash-stat-legend-val">85</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-500);"></span>
            <span class="dash-stat-legend-label">SSN</span>
            <span class="dash-stat-legend-val">47</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-300);"></span>
            <span class="dash-stat-legend-label">Other</span>
            <span class="dash-stat-legend-val">65</span>
          </div>
        </div>
        <!-- Bar chart: values 146, 90, 85, 47, 65 | max=146 -->
        <div class="dash-bar-chart">
          <div class="dash-bar-col">
            <span class="dash-bar-label">146</span>
            <div class="dash-bar-fill" style="height: 100%; background: var(--teal-800);"></div>
            <span class="dash-bar-x-label">PI</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">90</span>
            <div class="dash-bar-fill" style="height: 61.6%; background: var(--teal-700);"></div>
            <span class="dash-bar-x-label">ST</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">85</span>
            <div class="dash-bar-fill" style="height: 58.2%; background: var(--teal-600);"></div>
            <span class="dash-bar-x-label">CC</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">47</span>
            <div class="dash-bar-fill" style="height: 32.2%; background: var(--teal-500);"></div>
            <span class="dash-bar-x-label">SS</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">65</span>
            <div class="dash-bar-fill" style="height: 44.5%; background: var(--teal-300);"></div>
            <span class="dash-bar-x-label">Ot</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Card 3: Sanitized -->
    <div class="audit-card dash-card dash-stat-card">
      <div class="audit-card-header">
        <div class="audit-card-title">
          <h3>Sanitized</h3>
        </div>
        <div class="audit-card-actions">
          <a href="#" class="btn-text">View Reports</a>
        </div>
      </div>
      <div class="dash-stat-body">
        <div class="dash-stat-total-row">
          <div class="dash-stat-total-label">Total Files</div>
          <div class="dash-stat-total-val">
            1,578
            <span class="dash-trend-arrow dash-trend-up">
              <svg viewBox="0 0 12 12" fill="currentColor"><path d="M6 2l4 5H2l4-5z"/></svg>
            </span>
            <span class="dash-trend-text">+203, +15%</span>
          </div>
        </div>
        <div class="dash-stat-legend">
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-800);"></span>
            <span class="dash-stat-legend-label">Image</span>
            <span class="dash-stat-legend-val">1,347</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--blue-600);"></span>
            <span class="dash-stat-legend-label">Hyperlinks</span>
            <span class="dash-stat-legend-val">1,013</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-700);"></span>
            <span class="dash-stat-legend-label">Javascript</span>
            <span class="dash-stat-legend-val">436</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-500);"></span>
            <span class="dash-stat-legend-label">Scripts</span>
            <span class="dash-stat-legend-val">263</span>
          </div>
          <div class="dash-stat-legend-row">
            <span class="dash-stat-legend-dot" style="background: var(--teal-300);"></span>
            <span class="dash-stat-legend-label">Other</span>
            <span class="dash-stat-legend-val">165</span>
          </div>
        </div>
        <!-- Bar chart: values 1347, 1013, 436, 263, 165 | max=1347 -->
        <div class="dash-bar-chart">
          <div class="dash-bar-col">
            <span class="dash-bar-label">1,347</span>
            <div class="dash-bar-fill" style="height: 100%; background: var(--blue-800);"></div>
            <span class="dash-bar-x-label">Im</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">1,013</span>
            <div class="dash-bar-fill" style="height: 75.2%; background: var(--blue-600);"></div>
            <span class="dash-bar-x-label">Hy</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">436</span>
            <div class="dash-bar-fill" style="height: 32.4%; background: var(--teal-700);"></div>
            <span class="dash-bar-x-label">JS</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">263</span>
            <div class="dash-bar-fill" style="height: 19.5%; background: var(--teal-500);"></div>
            <span class="dash-bar-x-label">Sc</span>
          </div>
          <div class="dash-bar-col">
            <span class="dash-bar-label">165</span>
            <div class="dash-bar-fill" style="height: 12.3%; background: var(--teal-300);"></div>
            <span class="dash-bar-x-label">Ot</span>
          </div>
        </div>
      </div>
    </div>

  </div><!-- /.dash-stat-row -->

  <!-- ===== 5. SECURITY TREND CARD ===== -->
  <div class="audit-card dash-card" style="margin-bottom: 12px;">
    <div class="audit-card-header">
      <div class="audit-card-title">
        <h3>Security Trend</h3>
      </div>
      <div class="audit-card-actions" style="display:flex; align-items:center; gap: 16px;">
        <!-- Legend -->
        <div class="dash-trend-legend">
          <span class="dash-trend-legend-item">
            <span class="dash-trend-legend-swatch" style="background: var(--red-600);"></span>
            Threats Detected
          </span>
          <span class="dash-trend-legend-item">
            <span class="dash-trend-legend-swatch" style="background: var(--teal-600);"></span>
            Data Loss
          </span>
          <span class="dash-trend-legend-item">
            <span class="dash-trend-legend-swatch" style="background: var(--blue-600);"></span>
            Sanitized
          </span>
        </div>
        <!-- Period selector -->
        <div class="dash-trend-period-tabs">
          <button class="dash-trend-tab" data-period="7d">7d</button>
          <button class="dash-trend-tab active" data-period="30d">30d</button>
          <button class="dash-trend-tab" data-period="90d">90d</button>
        </div>
      </div>
    </div>

    <div class="dash-trend-chart-wrap">
      <!-- Y-axis labels -->
      <div class="dash-trend-y-axis">
        <span>500</span>
        <span>400</span>
        <span>300</span>
        <span>200</span>
        <span>100</span>
        <span>0</span>
      </div>
      <!-- Stacked bar columns -->
      <div class="dash-trend-chart">
        <!-- Each col: [threats, dataloss, sanitized] as % of max ~500 -->
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 42%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 10%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 18%;"></div>
          </div>
          <span class="dash-trend-x-label">Jan 15</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 56%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 14%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 22%;"></div>
          </div>
          <span class="dash-trend-x-label">Jan 18</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 34%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 8%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 16%;"></div>
          </div>
          <span class="dash-trend-x-label">Jan 21</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 68%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 16%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 28%;"></div>
          </div>
          <span class="dash-trend-x-label">Jan 24</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 80%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 20%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 34%;"></div>
          </div>
          <span class="dash-trend-x-label">Jan 27</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 52%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 12%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 24%;"></div>
          </div>
          <span class="dash-trend-x-label">Jan 30</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 44%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 10%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 20%;"></div>
          </div>
          <span class="dash-trend-x-label">Feb 2</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 60%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 14%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 30%;"></div>
          </div>
          <span class="dash-trend-x-label">Feb 5</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 76%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 18%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 36%;"></div>
          </div>
          <span class="dash-trend-x-label">Feb 8</span>
        </div>
        <div class="dash-trend-col">
          <div class="dash-trend-stacked">
            <div class="dash-trend-seg dash-trend-threats" style="height: 88%;"></div>
            <div class="dash-trend-seg dash-trend-dataloss" style="height: 22%;"></div>
            <div class="dash-trend-seg dash-trend-sanitized" style="height: 42%;"></div>
          </div>
          <span class="dash-trend-x-label">Feb 11</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== 6. REMEDIATION ACTIONS CARD ===== -->
  <div class="audit-card dash-card" style="margin-bottom: 12px;">
    <div class="audit-card-header">
      <div class="audit-card-title">
        <h3>Remediation Actions</h3>
      </div>
    </div>
    <div class="dash-rem-body">

      <!-- File Tagging 92% -->
      <div class="dash-rem-item">
        <div class="dash-rem-ring-wrap">
          <svg class="dash-rem-ring-svg" viewBox="0 0 52 52">
            <circle class="dash-rem-ring-track" cx="26" cy="26" r="22"/>
            <circle class="dash-rem-ring-fill" cx="26" cy="26" r="22"
              stroke="var(--blue-600)"
              stroke-dasharray="127.2 138.16"
              stroke-dashoffset="34.54"/>
          </svg>
          <span class="dash-rem-ring-pct">92%</span>
        </div>
        <div class="dash-rem-label">File Tagging</div>
        <div class="dash-rem-desc">Tag files with metadata on detection</div>
      </div>

      <!-- Keep 45% -->
      <div class="dash-rem-item">
        <div class="dash-rem-ring-wrap">
          <svg class="dash-rem-ring-svg" viewBox="0 0 52 52">
            <circle class="dash-rem-ring-track" cx="26" cy="26" r="22"/>
            <circle class="dash-rem-ring-fill" cx="26" cy="26" r="22"
              stroke="var(--neutral-600)"
              stroke-dasharray="62.11 76.05"
              stroke-dashoffset="34.54"/>
          </svg>
          <span class="dash-rem-ring-pct">45%</span>
        </div>
        <div class="dash-rem-label">Keep</div>
        <div class="dash-rem-desc">Retain files in place after scan</div>
      </div>

      <!-- Copy 20% -->
      <div class="dash-rem-item">
        <div class="dash-rem-ring-wrap">
          <svg class="dash-rem-ring-svg" viewBox="0 0 52 52">
            <circle class="dash-rem-ring-track" cx="26" cy="26" r="22"/>
            <circle class="dash-rem-ring-fill" cx="26" cy="26" r="22"
              stroke="var(--blue-500)"
              stroke-dasharray="27.63 110.53"
              stroke-dashoffset="34.54"/>
          </svg>
          <span class="dash-rem-ring-pct">20%</span>
        </div>
        <div class="dash-rem-label">Copy</div>
        <div class="dash-rem-desc">Copy files to quarantine location</div>
      </div>

      <!-- Move 18% -->
      <div class="dash-rem-item">
        <div class="dash-rem-ring-wrap">
          <svg class="dash-rem-ring-svg" viewBox="0 0 52 52">
            <circle class="dash-rem-ring-track" cx="26" cy="26" r="22"/>
            <circle class="dash-rem-ring-fill" cx="26" cy="26" r="22"
              stroke="var(--blue-400)"
              stroke-dasharray="24.87 113.29"
              stroke-dashoffset="34.54"/>
          </svg>
          <span class="dash-rem-ring-pct">18%</span>
        </div>
        <div class="dash-rem-label">Move</div>
        <div class="dash-rem-desc">Move files to a secure container</div>
      </div>

      <!-- Delete 12% -->
      <div class="dash-rem-item">
        <div class="dash-rem-ring-wrap">
          <svg class="dash-rem-ring-svg" viewBox="0 0 52 52">
            <circle class="dash-rem-ring-track" cx="26" cy="26" r="22"/>
            <circle class="dash-rem-ring-fill" cx="26" cy="26" r="22"
              stroke="var(--red-600)"
              stroke-dasharray="16.58 121.58"
              stroke-dashoffset="34.54"/>
          </svg>
          <span class="dash-rem-ring-pct">12%</span>
        </div>
        <div class="dash-rem-label">Delete</div>
        <div class="dash-rem-desc">Permanently remove threat files</div>
      </div>

      <!-- Other Remediations 5% -->
      <div class="dash-rem-item">
        <div class="dash-rem-ring-wrap">
          <svg class="dash-rem-ring-svg" viewBox="0 0 52 52">
            <circle class="dash-rem-ring-track" cx="26" cy="26" r="22"/>
            <circle class="dash-rem-ring-fill" cx="26" cy="26" r="22"
              stroke="var(--neutral-400)"
              stroke-dasharray="6.91 131.25"
              stroke-dashoffset="34.54"/>
          </svg>
          <span class="dash-rem-ring-pct">5%</span>
        </div>
        <div class="dash-rem-label">Other Remediations</div>
        <div class="dash-rem-desc">Custom and policy-based actions</div>
      </div>

    </div>
  </div>

  <!-- ===== 7. FILE TYPE DISTRIBUTION CARD ===== -->
  <div class="audit-card dash-card" style="margin-bottom: 12px;">
    <div class="audit-card-header">
      <div class="audit-card-title">
        <h3>File Type Distribution</h3>
      </div>
      <div class="audit-card-actions">
        <a href="#" class="btn-text">View Full Report</a>
      </div>
    </div>
    <div class="dash-filetype-body">

      <!-- Left: Treemap -->
      <div class="dash-treemap">
        <!-- Row 1 -->
        <div class="dash-treemap-row" style="flex: 2.2;">
          <div class="dash-treemap-cell dash-tm-archive" style="flex: 2.7;">
            <span class="dash-tm-name">Archive</span>
            <span class="dash-tm-count">436</span>
          </div>
          <div class="dash-treemap-cell dash-tm-application" style="flex: 2;">
            <span class="dash-tm-name">Application</span>
            <span class="dash-tm-count">322</span>
          </div>
        </div>
        <!-- Row 2 -->
        <div class="dash-treemap-row" style="flex: 1.8;">
          <div class="dash-treemap-cell dash-tm-executable" style="flex: 1.8;">
            <span class="dash-tm-name">Executables</span>
            <span class="dash-tm-count">289</span>
          </div>
          <div class="dash-treemap-cell dash-tm-graphical" style="flex: 1.1;">
            <span class="dash-tm-name">Graphical</span>
            <span class="dash-tm-count">177</span>
          </div>
          <div class="dash-treemap-cell dash-tm-diskimage" style="flex: 0.75;">
            <span class="dash-tm-name">Disk Image</span>
            <span class="dash-tm-count">120</span>
          </div>
        </div>
        <!-- Row 3 -->
        <div class="dash-treemap-row" style="flex: 1.4;">
          <div class="dash-treemap-cell dash-tm-openssl" style="flex: 0.56;">
            <span class="dash-tm-name">OpenSSL</span>
            <span class="dash-tm-count">89</span>
          </div>
          <div class="dash-treemap-cell dash-tm-pdf" style="flex: 0.4;">
            <span class="dash-tm-name">PDF</span>
            <span class="dash-tm-count">63</span>
          </div>
          <div class="dash-treemap-cell dash-tm-text" style="flex: 0.34;">
            <span class="dash-tm-name">Text</span>
            <span class="dash-tm-count">54</span>
          </div>
          <div class="dash-treemap-cell dash-tm-other" style="flex: 0.62;">
            <span class="dash-tm-name">Other</span>
            <span class="dash-tm-count">99</span>
          </div>
        </div>
      </div>

      <!-- Right: Detection legend -->
      <div class="dash-filetype-legend">
        <div class="dash-filetype-legend-header">
          <span class="dash-filetype-legend-title">Detections</span>
          <span class="dash-filetype-legend-total">562</span>
        </div>
        <div class="dash-filetype-legend-rows">
          <div class="dash-filetype-legend-row">
            <div class="dash-ftl-icon dash-ftl-archive">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 4H3C2.45 4 2 4.45 2 5v7c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zm-5 7H6v-1h2v1zm0-2H6V8h2v1zm0-2H6V6h2v1z"/><path d="M13 2H3L2 4h12L13 2z"/></svg>
            </div>
            <div class="dash-ftl-info">
              <span class="dash-ftl-name">Archive</span>
              <div class="dash-ftl-bar-wrap">
                <div class="dash-ftl-bar" style="width: 77.6%; background: var(--neutral-500);"></div>
              </div>
            </div>
            <span class="dash-ftl-val">436</span>
          </div>
          <div class="dash-filetype-legend-row">
            <div class="dash-ftl-icon dash-ftl-app">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11 2H5C4.45 2 4 2.45 4 3v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zM8 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm3-3H5V4h6v6z"/></svg>
            </div>
            <div class="dash-ftl-info">
              <span class="dash-ftl-name">Application</span>
              <div class="dash-ftl-bar-wrap">
                <div class="dash-ftl-bar" style="width: 57.3%; background: var(--red-500);"></div>
              </div>
            </div>
            <span class="dash-ftl-val">322</span>
          </div>
          <div class="dash-filetype-legend-row">
            <div class="dash-ftl-icon dash-ftl-exe">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12 2H4C3.45 2 3 2.45 3 3v10c0 .55.45 1 1 1h8c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zM5 12V4l6 4-6 4z"/></svg>
            </div>
            <div class="dash-ftl-info">
              <span class="dash-ftl-name">Executables</span>
              <div class="dash-ftl-bar-wrap">
                <div class="dash-ftl-bar" style="width: 51.4%; background: var(--neutral-400);"></div>
              </div>
            </div>
            <span class="dash-ftl-val">289</span>
          </div>
          <div class="dash-filetype-legend-row">
            <div class="dash-ftl-icon dash-ftl-img">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H3C2.45 2 2 2.45 2 3v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 10H4l3-4 2 2.5 2-3L12 12zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"/></svg>
            </div>
            <div class="dash-ftl-info">
              <span class="dash-ftl-name">Graphical</span>
              <div class="dash-ftl-bar-wrap">
                <div class="dash-ftl-bar" style="width: 31.5%; background: var(--red-300);"></div>
              </div>
            </div>
            <span class="dash-ftl-val">177</span>
          </div>
          <div class="dash-filetype-legend-row">
            <div class="dash-ftl-icon dash-ftl-pdf">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12 1H4C3.45 1 3 1.45 3 2v12c0 .55.45 1 1 1h8c.55 0 1-.45 1-1V2c0-.55-.45-1-1-1zM5 5h6v1H5V5zm0 2h6v1H5V7zm0 2h4v1H5V9z"/></svg>
            </div>
            <div class="dash-ftl-info">
              <span class="dash-ftl-name">PDF</span>
              <div class="dash-ftl-bar-wrap">
                <div class="dash-ftl-bar" style="width: 11.2%; background: var(--red-400);"></div>
              </div>
            </div>
            <span class="dash-ftl-val">63</span>
          </div>
          <div class="dash-filetype-legend-row">
            <div class="dash-ftl-icon dash-ftl-other">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H3C2.45 2 2 2.45 2 3v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-2 8H5v-1h6v1zm0-2H5V7h6v1zm0-2H5V5h6v1z"/></svg>
            </div>
            <div class="dash-ftl-info">
              <span class="dash-ftl-name">Other</span>
              <div class="dash-ftl-bar-wrap">
                <div class="dash-ftl-bar" style="width: 17.6%; background: var(--neutral-300);"></div>
              </div>
            </div>
            <span class="dash-ftl-val">99</span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- ===== 8. JOBS IN RANGE TABLE ===== -->
  <div class="audit-card dash-card" style="margin-bottom: 12px;">
    <div class="audit-card-header">
      <div class="audit-card-title">
        <h3>Jobs in Range</h3>
        <span class="count">5</span>
      </div>
      <div class="audit-card-actions">
        <a href="#" class="btn-text" onclick="showPage('jobsPage'); return false;">View All Jobs</a>
      </div>
    </div>
    <div class="table-scroll">
      <table class="data-table">
        <thead>
          <tr>
            <th>Job Name</th>
            <th>Status</th>
            <th>Type</th>
            <th>Files Processed</th>
            <th>Detections</th>
            <th>Start Time</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>AWS Production Full Scan</td>
            <td><span class="tag tag-running">Running</span></td>
            <td><span class="dash-job-type-tag dash-jt-scan-now">Scan Now</span></td>
            <td>
              <div class="jobs-files-progress">
                <span>45,231</span>
                <div class="jobs-files-bar"><div class="jobs-files-bar-fill" style="width:67%;"></div></div>
                <span style="color:var(--text-muted); font-size:12px;">67%</span>
              </div>
            </td>
            <td class="jobs-detections">312</td>
            <td>Feb 26, 2026 08:14 AM</td>
          </tr>
          <tr>
            <td>SharePoint Weekly Scheduled</td>
            <td><span class="tag tag-running">Running</span></td>
            <td><span class="dash-job-type-tag dash-jt-scheduled">Scheduled Scan</span></td>
            <td>
              <div class="jobs-files-progress">
                <span>12,874</span>
                <div class="jobs-files-bar"><div class="jobs-files-bar-fill" style="width:38%;"></div></div>
                <span style="color:var(--text-muted); font-size:12px;">38%</span>
              </div>
            </td>
            <td class="jobs-detections">47</td>
            <td>Feb 26, 2026 09:00 AM</td>
          </tr>
          <tr>
            <td>Alibaba Real-Time Monitor</td>
            <td><span class="tag tag-success">Complete</span></td>
            <td><span class="dash-job-type-tag dash-jt-realtime">Real-Time Scan</span></td>
            <td>
              <div class="jobs-files-progress">
                <span>78,602</span>
                <div class="jobs-files-bar"><div class="jobs-files-bar-fill" style="width:100%;"></div></div>
                <span style="color:var(--text-muted); font-size:12px;">100%</span>
              </div>
            </td>
            <td class="jobs-detections">1,204</td>
            <td>Feb 25, 2026 11:30 PM</td>
          </tr>
          <tr>
            <td>Azure Blob Incremental Scan</td>
            <td><span class="tag tag-alert">Failed</span></td>
            <td><span class="dash-job-type-tag dash-jt-scheduled">Scheduled Scan</span></td>
            <td>
              <div class="jobs-files-progress">
                <span>5,119</span>
                <div class="jobs-files-bar"><div class="jobs-files-bar-fill" style="width:22%; background:var(--danger);"></div></div>
                <span style="color:var(--text-muted); font-size:12px;">22%</span>
              </div>
            </td>
            <td class="jobs-detections none">—</td>
            <td>Feb 25, 2026 06:00 AM</td>
          </tr>
          <tr>
            <td>Google Cloud Storage Audit</td>
            <td><span class="tag tag-cancelled">Cancelled</span></td>
            <td><span class="dash-job-type-tag dash-jt-scan-now">Scan Now</span></td>
            <td>
              <div class="jobs-files-progress">
                <span>0</span>
                <div class="jobs-files-bar"><div class="jobs-files-bar-fill" style="width:0%;"></div></div>
                <span style="color:var(--text-muted); font-size:12px;">0%</span>
              </div>
            </td>
            <td class="jobs-detections none">—</td>
            <td>Feb 24, 2026 03:45 PM</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ===== 9. UPCOMING SCHEDULED JOBS TABLE ===== -->
  <div class="audit-card dash-card">
    <div class="audit-card-header">
      <div class="audit-card-title">
        <h3>Upcoming Scheduled Jobs</h3>
        <span class="count">3</span>
      </div>
      <div class="audit-card-actions">
        <div class="audit-search">
          <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
          <input type="text" placeholder="Search jobs...">
        </div>
        <button class="audit-filter-btn" title="Filter">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
        </button>
      </div>
    </div>
    <div class="table-scroll">
      <table class="data-table">
        <thead>
          <tr>
            <th>Job Name</th>
            <th>Scheduled Scan</th>
            <th>Workflow</th>
            <th>Partition</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>AWS S3 Daily Incremental</td>
            <td>
              <div class="dash-schedule-cell">
                <svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;color:var(--text-muted);flex-shrink:0;"><path d="M13 2h-1V1h-1.5v1h-5V1H4v1H3C2.45 2 2 2.45 2 3v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 11H3V5h10v8zM5 7H4v1h1V7zm2 0H6v1h1V7zm2 0H8v1h1V7zm2 0h-1v1h1V7zM5 9H4v1h1V9zm2 0H6v1h1V9zm2 0H8v1h1V9zm2 0h-1v1h1V9zM5 11H4v1h1v-1zm2 0H6v1h1v-1z"/></svg>
                <span>Feb 27, 2026 02:00 AM</span>
              </div>
            </td>
            <td>Default Workflow</td>
            <td>aws-prod-bucket-1</td>
          </tr>
          <tr>
            <td>SharePoint Compliance Scan</td>
            <td>
              <div class="dash-schedule-cell">
                <svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;color:var(--text-muted);flex-shrink:0;"><path d="M13 2h-1V1h-1.5v1h-5V1H4v1H3C2.45 2 2 2.45 2 3v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 11H3V5h10v8zM5 7H4v1h1V7zm2 0H6v1h1V7zm2 0H8v1h1V7zm2 0h-1v1h1V7zM5 9H4v1h1V9zm2 0H6v1h1V9zm2 0H8v1h1V9zm2 0h-1v1h1V9zM5 11H4v1h1v-1zm2 0H6v1h1v-1z"/></svg>
                <span>Feb 28, 2026 06:00 AM</span>
              </div>
            </td>
            <td>Compliance Workflow</td>
            <td>sharepoint-corp</td>
          </tr>
          <tr>
            <td>Monthly Full Archive Sweep</td>
            <td>
              <div class="dash-schedule-cell">
                <svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;color:var(--text-muted);flex-shrink:0;"><path d="M13 2h-1V1h-1.5v1h-5V1H4v1H3C2.45 2 2 2.45 2 3v10c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 11H3V5h10v8zM5 7H4v1h1V7zm2 0H6v1h1V7zm2 0H8v1h1V7zm2 0h-1v1h1V7zM5 9H4v1h1V9zm2 0H6v1h1V9zm2 0H8v1h1V9zm2 0h-1v1h1V9zM5 11H4v1h1v-1zm2 0H6v1h1v-1z"/></svg>
                <span>Mar 1, 2026 12:00 AM</span>
              </div>
            </td>
            <td>Deep Scan Workflow</td>
            <td>alibaba-archive-zone</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="audit-pagination">
      <div class="audit-pagination-left">
        <select>
          <option selected>10</option>
          <option>25</option>
          <option>50</option>
        </select>
        <span>items per page</span>
        <span style="margin-left: 8px; color: var(--text-muted);">|</span>
        <span style="margin-left: 8px;">1-10 of 15 items</span>
      </div>
      <div class="audit-pagination-right">
        <button class="audit-page-btn" disabled>
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg>
        </button>
        <select class="audit-page-select">
          <option selected>Page 1</option>
          <option>Page 2</option>
        </select>
        <button class="audit-page-btn">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg>
        </button>
      </div>
    </div>
  </div>

</div><!-- /#dashboardPage -->

        <div id="settingsPage" class="page-view">
        <!-- Page Header -->
        <div class="page-title-row">
          <h1 class="page-title">Settings</h1>
          <button class="btn-export" title="Includes Accounts, Groups, Storage Units, RTP Scans, Workflow Snapshots, Scan Instances, Scan Pools, Workflows, Scan Schedules, SSO Config">Export</button>
        </div>

        <!-- Tabs -->
        <div class="tabs" id="settingsTabs" role="tablist" aria-label="Settings sections">
          <button class="tab active" role="tab" aria-selected="true" aria-controls="panel-profile" data-tab="profile">Profile</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-scan-pools" data-tab="scan-pools">Scan Pools</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-security" data-tab="security">Security</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-smtp" data-tab="smtp">SMTP</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-notifications" data-tab="notifications">Notifications</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-licensing" data-tab="licensing">Licensing</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-sso" data-tab="sso">SSO</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-data" data-tab="data">Data</button>
        </div>

        <!-- ==================== PROFILE TAB ==================== -->
        <div class="tab-panel active" id="panel-profile">

          <!-- Personal Information Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Personal Information</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Warning</div>
                  <div class="banner-desc">Changing email or password requires re-login.</div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Full Name</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="Elvis Vilevich">
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Email</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="email" value="email@email.com">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Password Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Password</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Warning</div>
                  <div class="banner-desc">Changing password requires re-login.</div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">New Password</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="password1234">
                    <span class="input-clear" onclick="clearInput(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
                    </span>
                    <span class="input-eye" onclick="togglePassword(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Repeat Password</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="password12345">
                    <span class="input-clear" onclick="clearInput(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
                    </span>
                    <span class="input-eye" onclick="togglePassword(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Configure API Key Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Configure API Key</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row form-row--top">
                <div class="form-label">
                  API Key
                  <span class="help-icon">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
                  </span>
                </div>
                <div class="form-value">
                  <span class="api-key-status" id="apiKeyStatus">Not generated</span>
                  <button class="btn-generate" id="btnGenerateKey" onclick="generateApiKey()">Generate API Key</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== NOTIFICATIONS TAB ==================== -->
        <div class="tab-panel" id="panel-notifications">

          <!-- Email Notifications Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Email Notifications</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Attention</div>
                  <div class="banner-desc">This feature requires the SMTP Server to be configured</div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Generated Report
                  <span class="help-icon">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
                  </span>
                </div>
                <div class="form-value">
                  <div class="radio-group" data-radio-group="generated-report">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Only to the owner</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">To all registered users</span>
                    </label>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">User Registration Requests</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Blocked Files
                  <span class="help-icon">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
                  </span>
                </div>
                <div class="form-value">
                  <div class="radio-group" data-radio-group="blocked-files">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">To all registered users</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Only to the file owner</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">To the file owner and all registered users</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Webhook Notifications Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Webhook Notifications</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Upon Scan Completion</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Upon File Scan</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                    <div class="radio-inline" style="margin-left: 16px;" data-radio-group="webhook-file-scan">
                      <label class="radio-option selected">
                        <div class="radio-circle"></div>
                        <span class="radio-label">Blocked files</span>
                      </label>
                      <label class="radio-option">
                        <div class="radio-circle"></div>
                        <span class="radio-label">All files</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Destination Address</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="https://webhook.site/748c1c48-f41...">
                    <span class="input-clear" onclick="clearInput(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">Headers</div>
                <div class="form-value">
                  <div class="headers-input-row">
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Enter key" class="header-key-input">
                    </div>
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Value" class="header-value-input">
                    </div>
                    <button class="btn-add-header" onclick="addHeader(this)">Add Header</button>
                  </div>
                  <div class="headers-table">
                    <div class="headers-table-head">
                      <div class="col-key">Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-value">Value <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-actions"></div>
                    </div>
                    <div class="headers-table-body">
                      <div class="headers-table-row">
                        <div class="col-key">Authorization:</div>
                        <div class="col-value">Bearer sk_test_abc123xyz</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                      <div class="headers-table-row">
                        <div class="col-key">X-API-Key:</div>
                        <div class="col-value">your-api-key-here</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Request Type</div>
                <div class="form-value">
                  <div class="radio-inline" data-radio-group="request-type">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">POST</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">PUT</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- RabbitMQ Notifications Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>RabbitMQ Notifications</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Upon a File Scan</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                    <div class="radio-inline" style="margin-left: 16px;" data-radio-group="rabbitmq-file-scan">
                      <label class="radio-option selected">
                        <div class="radio-circle"></div>
                        <span class="radio-label">Blocked files</span>
                      </label>
                      <label class="radio-option">
                        <div class="radio-circle"></div>
                        <span class="radio-label">All files</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">RabbitMQ URL</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" placeholder="Enter RabbitMQ URL">
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">Headers</div>
                <div class="form-value">
                  <div class="headers-input-row">
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Enter key" class="header-key-input">
                    </div>
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Value" class="header-value-input">
                    </div>
                    <button class="btn-add-header" onclick="addHeader(this)">Add Header</button>
                  </div>
                  <div class="headers-table">
                    <div class="headers-table-head">
                      <div class="col-key">Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-value">Value <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-actions"></div>
                    </div>
                    <div class="headers-table-body">
                      <div class="headers-table-row">
                        <div class="col-key">Authorization:</div>
                        <div class="col-value">Bearer sk_test_abc123xyz</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                      <div class="headers-table-row">
                        <div class="col-key">X-API-Key:</div>
                        <div class="col-value">your-api-key-here</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== SCAN POOLS TAB ==================== -->
        <div class="tab-panel" id="panel-scan-pools">
          <!-- Promo Banner -->
          <div class="promo-banner">
            <div class="promo-banner-text"><strong>Add a New Scan Pool</strong>&nbsp; Boost overall scan performance by integrating another scan pool</div>
            <button class="btn-primary" onclick="openSlidePanel('addScanPoolPanel')">Add Pool</button>
          </div>

          <!-- Default MetaDefender Cloud Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>Default MetaDefender Cloud Scan Pool</h2>
                <span class="pool-instance-count">1 instance</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="data-table pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>https://api.metadefender.com/v4/</td>
                  <td><span class="av-badge">Metascan 8 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>01:00:00</td>
                  <td class="col-action"><div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="row-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Default MetaDefender Core Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>Default MetaDefender Core Scan Pool</h2>
                <span class="pool-instance-count">1 instance</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="data-table pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>https://mdcore.opswat-mdss.net/</td>
                  <td><span class="av-badge">Metascan 8 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>01:00:00</td>
                  <td class="col-action"><div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="row-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- My Custom Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>My Custom Scan Pool</h2>
                <span class="pool-instance-count">2 instances</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="data-table pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>https://mdcore.opswat-mdss.net/</td>
                  <td><span class="av-badge">Metascan 8 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>01:00:00</td>
                  <td class="col-action"><div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="row-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
                <tr>
                  <td>inventory_update_nov2022</td>
                  <td><span class="av-badge">Metascan 12 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>09:15:00</td>
                  <td class="col-action"><div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="row-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Another Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>Another Scan Pool</h2>
                <span class="pool-instance-count">21 instances</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="data-table pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5" style="text-align:center; color:var(--text-muted); padding: 20px;">21 instances configured. Click Add Instance to manage.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ==================== SECURITY TAB ==================== -->
        <div class="tab-panel" id="panel-security">

          <!-- Encryption Key Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Encryption Key</h2>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Warning</div>
                  <div class="banner-desc">Generating a new key is not reversible and will result in logging out of the application from all the profiles.</div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Encryption Key Status
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <span class="encryption-status">Last encryption key generated is older than 90 days (4 months ago)</span>
                  <button class="btn-outline" onclick="showNotification('success', 'Encryption key generated', 'A new encryption key has been generated. All users will be logged out.')" title="This password is required for importing the configuration file. Please store it securely as it cannot be recovered.">Generate New</button>
                </div>
              </div>
            </div>
          </div>

          <!-- SSL Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>SSL</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Service Status
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">SSL Certificate</div>
                <div class="form-value">
                  <div class="file-upload-field" onclick="this.querySelector('input').click()">
                    <input type="file" onchange="handleFileUpload(this)">
                    <span class="file-upload-text">Add file</span>
                    <span class="file-upload-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1v10M4 7l4 4 4-4M2 13h12v2H2z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">SSL Key</div>
                <div class="form-value">
                  <div class="file-upload-field" onclick="this.querySelector('input').click()">
                    <input type="file" onchange="handleFileUpload(this)">
                    <span class="file-upload-text">Add file</span>
                    <span class="file-upload-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1v10M4 7l4 4 4-4M2 13h12v2H2z"/></svg></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Single User Session Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Single User Session</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Service Status
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== SMTP TAB ==================== -->
        <div class="tab-panel" id="panel-smtp">
          <!-- Configuration Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Configuration</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Service Status</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Active</span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Host
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="smtp.sendgrid.net">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Port
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="587">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Base URL (optional)
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="https://demo.opswat-mdss.net/">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Sender name (optional)
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="John Doe">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Sender email address (optional)
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="email" value="example@mail.com">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Authentication Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Authentication</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Domain (optional)</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="company.com">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Username (optional)</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="apikey">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Password</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="supersecretpassword123">
                    <span class="input-eye" onclick="togglePassword(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Advanced Settings Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Advanced Settings</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Ignore certificate warnings</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Security option
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="radio-group" data-radio-group="security-option">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">None</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Auto</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Connecting using SSL or TLS immediately</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Elevate the connection using StartTLS command</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Elevate the connection using StartTLS command if it is available</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== LICENSING TAB ==================== -->
        <div class="tab-panel" id="panel-licensing">
          <!-- State 1: Empty / No License -->
          <div id="licenseEmptyState">
            <div class="settings-card">
              <div class="card-header">
                <h2>Active License</h2>
              </div>
              <div class="license-empty-state">
                <svg class="license-empty-illustration" viewBox="0 0 120 120" fill="none">
                  <rect x="20" y="30" width="80" height="60" rx="4" fill="#E8ECF0" stroke="#C4CDD5" stroke-width="1.5"/>
                  <rect x="30" y="45" width="40" height="4" rx="2" fill="#C4CDD5"/>
                  <rect x="30" y="55" width="60" height="4" rx="2" fill="#C4CDD5"/>
                  <rect x="30" y="65" width="50" height="4" rx="2" fill="#C4CDD5"/>
                  <rect x="30" y="75" width="30" height="4" rx="2" fill="#C4CDD5"/>
                  <path d="M85 25L95 35L85 35V25Z" fill="#C4CDD5"/>
                  <path d="M65 25H85V35H95V75" stroke="#C4CDD5" stroke-width="1.5" fill="none"/>
                  <circle cx="90" cy="80" r="18" fill="#E8F0FF" stroke="#4A6FA5" stroke-width="1.5"/>
                  <path d="M84 80L88 84L96 76" stroke="#4A6FA5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>
                <div class="license-empty-title">Your do not have a valid license.</div>
                <div class="license-empty-desc">Certain features are currently disabled.<br>Please contact <a href="#" style="color:var(--primary); text-decoration:none;">OPSWAT Sales</a> to get your license.</div>
                <button class="btn-primary" onclick="openModal('addLicenseModal')">Add License</button>
              </div>
            </div>
          </div>

          <!-- State 2: Active License -->
          <div id="licenseActiveState" style="display:none;">
            <div class="settings-card">
              <div class="card-header">
                <h2>Active License</h2>
              </div>
              <div class="card-content">
                <div class="form-row">
                  <div class="form-label">Deployment ID</div>
                  <div class="form-value">
                    <span style="font-size:14px; color:var(--text-subtle); font-family:monospace;">MDSSChuLmMLF4oneXGZP4jz4qx9xH2YDfib14</span>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-label">Product ID</div>
                  <div class="form-value">
                    <span style="font-size:14px; color:var(--text-subtle);">MD-SUPPLY-CHAIN-SA-EVAL</span>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-label">Expiration Date</div>
                  <div class="form-value">
                    <span id="licenseExpBadge" class="license-badge green">Dec 31, 2026</span>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-label">Name</div>
                  <div class="form-value">
                    <span style="font-size:14px; color:var(--text-subtle);">MetaDefender Software Supply Chain - Standalone - Evaluation</span>
                  </div>
                </div>
                <div style="display:flex; gap:8px;">
                  <button class="btn-outline" onclick="deactivateLicense()" title="The current instance will be deactivated">Deactivate</button>
                  <button class="btn-outline" onclick="openModal('addLicenseModal')">Activate New License</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== SSO TAB ==================== -->
        <div class="tab-panel" id="panel-sso">
          <div class="settings-card">
            <div class="card-header">
              <h2>SSO Configuration</h2>
              <div class="card-header-actions">
                <button class="btn-discard" aria-label="Discard changes">Discard</button>
                <button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button>
              </div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Service Status</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Active</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">SSO Type</div>
                <div class="form-value">
                  <select class="select-field">
                    <option selected>Open ID Connect</option>
                    <option>SAML 2.0</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">SSO Provider</div>
                <div class="form-value">
                  <select class="select-field">
                    <option selected>Okta</option>
                    <option>Azure AD</option>
                    <option>Auth0</option>
                    <option>Custom</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Client ID</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="0oahpipezgAHp3Iez5d7">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Client Secret</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="supersecretclientsecret123">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                    <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Authority URL</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="https://dev-17591912.okta.com/oa...">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">ReadOnly Role Name</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="Everyone">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== DATA TAB ==================== -->
        <div class="tab-panel" id="panel-data">

          <!-- Telemetry Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Telemetry</h2>
              <div class="card-header-actions">
                <button class="btn-discard" aria-label="Discard changes">Discard</button>
                <button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button>
              </div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Telemetry Data Collection
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Send Telemetry to OPSWAT <span class="help-icon" title="Includes Accounts, Groups, Storage Units, RTP Scans, Workflow Snapshots, Scan Instances, Scan Pools, Workflows, Scan Schedules, SSO Config"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span></div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0" aria-label="Send Telemetry to OPSWAT"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row form-row--top">
                <div class="form-label">Collectors</div>
                <div class="form-value">
                  <table class="data-table" style="border: 1px solid var(--border-card); border-radius: var(--radius); overflow: hidden;">
                    <thead>
                      <tr>
                        <th>Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Metric Endpoint URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Metric API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Metric Protocol <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th style="width:40px;"></th>
                      </tr>
                    </thead>
                    <tbody id="collectorsTableBody">
                      <tr>
                        <td><span class="av-badge">OPSWAT Collector</span></td>
                        <td>http://&lt;OPTEL_ADDRES...</td>
                        <td>-</td>
                        <td>gRPC</td>
                        <td><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></td>
                      </tr>
                    </tbody>
                  </table>
                  <button class="btn-outline" onclick="openSlidePanel('addCollectorPanel')">Add Collector</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Data Retention Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Data Retention</h2>
              <div class="card-header-actions">
                <button class="btn-discard" aria-label="Discard changes">Discard</button>
                <button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button>
              </div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Telemetry Data Collection
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Clean up audit records older than</div>
                <div class="form-value">
                  <div class="input-with-suffix">
                    <div class="input-field"><input type="number" value="15" style="width:60px;"></div>
                    <span class="input-suffix">days</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Reports retention</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Clean up reports older than</div>
                <div class="form-value">
                  <div class="input-with-suffix">
                    <div class="input-field"><input type="number" value="15" style="width:60px;"></div>
                    <span class="input-suffix">days</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">RTP history retention</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Clean up RTP history older than</div>
                <div class="form-value">
                  <div class="input-with-suffix">
                    <div class="input-field"><input type="number" value="15" style="width:60px;"></div>
                    <span class="input-suffix">days</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- External Loggers Configurations Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>External Loggers Configurations</h2>
              <button class="btn-outline" onclick="openSlidePanel('addLoggerPanel')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.25 8.75H8.75V11.25C8.75 11.66 8.41 12 8 12C7.59 12 7.25 11.66 7.25 11.25V8.75H4.75C4.34 8.75 4 8.41 4 8C4 7.59 4.34 7.25 4.75 7.25H7.25V4.75C7.25 4.34 7.59 4 8 4C8.41 4 8.75 4.34 8.75 4.75V7.25H11.25C11.66 7.25 12 7.59 12 8C12 8.41 11.66 8.75 11.25 8.75Z"/></svg>
                Add Server
              </button>
            </div>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Server Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Address <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Topic <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th style="width:40px;"></th>
                </tr>
              </thead>
              <tbody id="loggersTableBody">
                <tr>
                  <td>Syslog UDP Integration</td>
                  <td><span class="status-dot green"></span>Enabled</td>
                  <td>5.5.5.5:514</td>
                  <td>-</td>
                  <td><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></td>
                </tr>
                <tr>
                  <td>Syslog UDP Integration</td>
                  <td><span class="status-dot red"></span>Disabled</td>
                  <td>5.4.5.5:514</td>
                  <td>-</td>
                  <td><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        </div><!-- /settingsPage -->

        <!-- ==================== AUDIT PAGE ==================== -->
        <div id="auditPage" class="page-view table-page">
          <div class="page-title-row">
            <h1 class="page-title">Audit</h1>
            <button class="btn-outline" onclick="refreshAuditLog()">Refresh</button>
          </div>

          <div class="audit-card">
            <div class="audit-card-header">
              <div class="audit-card-title">
                <h3>System Events Log</h3>
                <span class="count" id="auditTotalCount">1,256</span>
              </div>
              <div class="audit-card-actions">
                <div class="audit-search">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                  <input type="text" placeholder="Search for Files or Hash" id="auditSearchInput">
                </div>
                <button class="audit-filter-btn" onclick="openAdvancedFilters()" title="Advanced Filters">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                </button>
              </div>
            </div>

            <div class="audit-table-scroll table-scroll">
              <table class="audit-table" id="auditTable">
                <thead>
                  <tr>
                    <th class="col-expand"></th>
                    <th class="col-user">User <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-level">Level <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-category">Category <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-type">Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-date">Date <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-details">Details</th>
                    <th class="col-copy"></th>
                  </tr>
                </thead>
                <tbody id="auditTableBody">
                  <!-- Rows generated by JS -->
                </tbody>
              </table>
            </div>

            <div class="audit-pagination">
              <div class="audit-pagination-left">
                <select id="auditPerPage">
                  <option>10</option>
                  <option>25</option>
                  <option selected>50</option>
                  <option>100</option>
                </select>
                <span>items per page</span>
                <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                <span id="auditPageInfo" style="margin-left: 8px;">1-50 of 1,256 items</span>
              </div>
              <div class="audit-pagination-right">
                <button class="audit-page-btn" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                <select class="audit-page-select">
                  <option selected>Page 1</option>
                  <option>Page 2</option>
                  <option>Page 3</option>
                  <option>Page 4</option>
                  <option>Page 5</option>
                  <option>Page 6</option>
                  <option>Page 7</option>
                  <option>Page 8</option>
                  <option>Page 9</option>
                  <option>Page 10</option>
                  <option>Page 11</option>
                  <option>Page 12</option>
                  <option>Page 13</option>
                  <option>Page 14</option>
                  <option>Page 15</option>
                  <option>Page 16</option>
                  <option>Page 17</option>
                  <option>Page 18</option>
                  <option>Page 19</option>
                  <option>Page 20</option>
                  <option>Page 21</option>
                  <option>Page 22</option>
                  <option>Page 23</option>
                  <option>Page 24</option>
                  <option>Page 25</option>
                  <option>Page 26</option>
                </select>
                <button class="audit-page-btn"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
              </div>
            </div>
          </div>
        </div><!-- /auditPage -->

        <!-- ==================== USERS PAGE ==================== -->
        <div id="usersPage" class="page-view">
          <div class="page-title-row">
            <h1 class="page-title">Users</h1>
            <button class="btn-primary" onclick="openSlidePanel('addUserPanel')">Add User</button>
          </div>

          <!-- Pending Users Card -->
          <div class="audit-card" id="pendingUsersCard" style="margin-bottom:12px;">
            <div class="audit-card-header">
              <div class="audit-card-title">
                <h3>Pending Users</h3>
                <span class="count" id="pendingUsersCount">0</span>
              </div>
              <div class="audit-card-actions">
                <div class="audit-search">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                  <input type="text" placeholder="Search users" id="pendingUsersSearch">
                </div>
              </div>
            </div>
            <!-- Empty state (shown when 0 pending) -->
            <div class="users-empty-state" id="pendingEmptyState">
              <div class="users-empty-icon">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 6C13 7.57 11.8 8.85 10.27 8.98C10.18 9 10.09 9 10 9C10.03 8.97 10.06 8.93 10.08 8.89C10.66 8.07 11 7.08 11 6C11 4.92 10.63 3.83 10 3C11.66 3 13 4.34 13 6Z"/><path d="M15 12.64V14H13V12.64C13 11.71 12.64 10.92 12.05 10.28C13.58 10.69 15 11.51 15 12.64Z"/><path d="M9 6C9 6.89 8.62 7.69 8 8.22C7.47 8.71 6.77 9 6 9C5.23 9 4.53 8.71 4 8.22C3.38 7.69 3 6.89 3 6C3 4.34 4.34 3 6 3C6.77 3 7.47 3.29 8 3.77C8.62 4.31 9 5.11 9 6Z"/><path d="M11 12.64V14H1V12.64C1 11.6 2.2 10.82 3.59 10.38C4.39 10.13 5.26 10 5.99 10C6.6 10 7.3 10.09 7.99 10.27C8.12 10.3 8.26 10.34 8.39 10.38C9.78 10.82 10.98 11.6 10.98 12.64H11Z"/></svg>
              </div>
              <p class="users-empty-title">No Pending Users</p>
              <p class="users-empty-desc">New requests will appear here when submitted.</p>
            </div>
            <!-- Pending users table (hidden when empty) -->
            <div id="pendingUsersTableWrap" class="table-scroll" style="display:none;">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Username <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Email <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Permissions <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:40px;"></th>
                  </tr>
                </thead>
                <tbody id="pendingUsersBody">
                </tbody>
              </table>
            </div>
          </div>

          <!-- Active Users Card -->
          <div class="audit-card">
            <div class="audit-card-header">
              <div class="audit-card-title">
                <h3>Active Users</h3>
                <span class="count" id="activeUsersCount">5</span>
              </div>
              <div class="audit-card-actions">
                <div class="audit-search">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                  <input type="text" placeholder="Search users" id="activeUsersSearch">
                </div>
              </div>
            </div>
            <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Username <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Email <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Permissions <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th style="width:40px;"></th>
                </tr>
              </thead>
              <tbody id="activeUsersBody">
              </tbody>
            </table>
            </div><!-- /table-scroll -->
            <div class="audit-pagination" id="activeUsersPagination">
              <div class="audit-pagination-left">
                <select id="activeUsersPerPage">
                  <option selected>10</option>
                  <option>25</option>
                  <option>50</option>
                </select>
                <span>items per page</span>
                <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                <span id="activeUsersPageInfo" style="margin-left: 8px;">1-10 of 12 items</span>
              </div>
              <div class="audit-pagination-right">
                <button class="audit-page-btn" id="activeUsersPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                <select class="audit-page-select" id="activeUsersPageSelect">
                  <option selected>Page 1</option>
                  <option>Page 2</option>
                </select>
                <button class="audit-page-btn" id="activeUsersNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
              </div>
            </div>
          </div>
        </div><!-- /usersPage -->

        <!-- ==================== INVENTORY PAGE ==================== -->
        <div id="inventoryPage" class="page-view">
          <!-- Header -->
          <div class="page-title-row" id="inventoryPageHeader">
            <h1 class="page-title">Inventory</h1>
            <div class="page-header-actions">
              <button class="btn-icon" title="Refresh"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.14 9.29C2.61 11.56 4.45 13.39 6.71 13.86C10.58 14.67 14 11.73 14 8H12.5C12.5 10.8 9.93 13.01 7.03 12.4C5.33 12.04 3.96 10.67 3.6 8.97C2.99 6.07 5.2 3.5 8 3.5C8.17 3.5 8.34 3.51 8.5 3.53C8.85 3.57 9.18 3.64 9.5 3.76C10.06 3.96 10.57 4.26 11 4.66C11.12 4.76 11.24 4.88 11.34 5H9.5V6.5H13C13.55 6.5 14 6.05 14 5.5V2H12.5V4.04C12.33 3.85 12.15 3.67 11.96 3.5C11.27 2.88 10.43 2.43 9.5 2.2C9.18 2.11 8.84 2.05 8.5 2.02C8.34 2.01 8.17 2 8 2C4.27 2 1.32 5.42 2.14 9.29Z"/></svg></button>
              <button class="btn-outline">Add New <svg viewBox="0 0 16 16" fill="currentColor" style="width:12px;height:12px;"><path d="M7.99994 10.7495C7.80994 10.7495 7.61994 10.6795 7.46994 10.5295L3.21994 6.27945C2.92994 5.98945 2.92994 5.50945 3.21994 5.21945C3.50994 4.92945 3.98994 4.92945 4.27994 5.21945L7.99994 8.93945L11.7199 5.21945C12.0099 4.92945 12.4899 4.92945 12.7799 5.21945C13.0699 5.50945 13.0699 5.98945 12.7799 6.27945L8.52994 10.5295C8.37994 10.6795 8.18994 10.7495 7.99994 10.7495Z"/></svg></button>
            </div>
          </div>

          <!-- Tabs: Accounts | Groups | Units -->
          <div class="tabs" id="inventoryTabs" role="tablist">
            <button class="tab active" role="tab" data-inv-tab="accounts">Accounts</button>
            <button class="tab" role="tab" data-inv-tab="groups">Groups</button>
            <button class="tab" role="tab" data-inv-tab="units">Units</button>
          </div>

          <!-- ===== Accounts Tab ===== -->
          <div class="inv-tab-panel active" id="inv-panel-accounts">
            <div id="accountsListView">
            <!-- Accounts Table Card -->
            <div class="audit-card" style="margin-bottom: 24px;">
              <div class="card-header">
                <div class="card-header-left"><strong>Accounts</strong> <span class="text-muted" id="accountsCount">0</span></div>
                <div class="card-header-right" style="display:flex; gap:8px; align-items:center;">
                  <div class="audit-search"><svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg><input type="text" placeholder="Search for Files or Hash"></div>
                  <div style="display:flex; gap:8px;">
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Provider</span></button>
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Status</span></button>
                  </div>
                </div>
              </div>
              <div class="audit-table-scroll">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Provider <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Storage Units <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th class="col-action"></th>
                    </tr>
                  </thead>
                  <tbody id="accountsBody"></tbody>
                </table>
              </div>
            </div>

            <!-- Recommended Integrations (contextual accounts) -->
            <div style="margin-bottom: 32px;">
              <div class="section-title">Recommended integrations</div>
              <div class="section-desc">Enhance your storage capabilities and security with recommended integrations.</div>
              <div class="cards-grid" style="grid-template-columns: repeat(5, 1fr);">
                <div class="grid-card">
                  <div class="grid-card-icon aws" style="background:#232f3e;"><span style="font-size:16px; letter-spacing:-0.5px; font-weight:700;">aws</span></div>
                  <div class="grid-card-name">Amazon EFS</div>
                  <div class="grid-card-type">EC2 File Systems</div>
                </div>
                <div class="grid-card">
                  <div class="grid-card-icon sharepoint" style="background:#038387;"><span style="font-size:14px; font-weight:700;">SP</span></div>
                  <div class="grid-card-name">SharePoint</div>
                  <div class="grid-card-type">On-Premises</div>
                </div>
              </div>
            </div>

            <!-- Additional Integrations — full grid -->
            <div style="margin-bottom: 32px;">
              <div class="section-title">Additional Integrations</div>
              <div class="section-desc">Select the type of storage you would like to secure.</div>
              <div class="cards-grid">
                <div class="grid-card"><div class="grid-card-icon" style="background:#ff6a00;"><span style="font-size:12px; font-weight:700;">Ali</span></div><div class="grid-card-name">Alibaba Cloud</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#232f3e;"><span style="font-size:14px; letter-spacing:-0.5px; font-weight:700;">aws</span></div><div class="grid-card-name">Amazon S3</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#0078d4;"><svg viewBox="0 0 24 24" fill="#fff" style="width:24px;height:24px;"><rect x="4" y="4" width="7" height="7" rx="1"/><rect x="13" y="4" width="7" height="7" rx="1"/><rect x="4" y="13" width="7" height="7" rx="1"/><rect x="13" y="13" width="7" height="7" rx="1"/></svg></div><div class="grid-card-name">Azure Blob</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#0078d4;"><svg viewBox="0 0 24 24" fill="#fff" style="width:24px;height:24px;"><rect x="6" y="4" width="12" height="16" rx="1" stroke="#fff" stroke-width="1.5" fill="none"/><path d="M10 10h4M10 13h4" stroke="#fff" stroke-width="1.5"/></svg></div><div class="grid-card-name">Azure Files</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#0061d5;"><svg viewBox="0 0 24 24" fill="#fff" style="width:24px;height:24px;"><path d="M6 6h12v12H6z" rx="2"/></svg></div><div class="grid-card-name">Box</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#00b4d8;"><span style="font-size:10px; font-weight:700;">CB</span></div><div class="grid-card-name">Cubbit</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#007db8;"><span style="font-size:9px; font-weight:700;">EMC</span></div><div class="grid-card-name">Dell Isilon</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#6b7a90;"><span style="font-size:10px; font-weight:700;">FTP</span></div><div class="grid-card-name">FTP</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#4285f4;"><svg viewBox="0 0 24 24" fill="none" style="width:24px;height:24px;"><path d="M4 8l8-4 8 4v8l-8 4-8-4V8z" stroke="#fff" stroke-width="1.5"/></svg></div><div class="grid-card-name">Google Cloud</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#0067c5;"><span style="font-size:10px; font-weight:700;">NA</span></div><div class="grid-card-name">NetApp</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#4a5568;"><span style="font-size:10px; font-weight:700;">NFS</span></div><div class="grid-card-name">NFS</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#4a5568;"><span style="font-size:8px; font-weight:700;">SISL</span></div><div class="grid-card-name">NFS with SISL</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#0078d4;"><svg viewBox="0 0 24 24" fill="#fff" style="width:24px;height:24px;"><path d="M12 4a8 8 0 100 16 8 8 0 000-16z"/></svg></div><div class="grid-card-name">One Drive</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#1d6bfc;"><svg viewBox="0 0 24 24" fill="none" style="width:24px;height:24px;"><circle cx="12" cy="12" r="8" stroke="#fff" stroke-width="1.5"/><path d="M12 7v10" stroke="#fff" stroke-width="1.5"/></svg></div><div class="grid-card-name">OPSWAT MFT</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#c74634;"><svg viewBox="0 0 24 24" fill="#fff" style="width:24px;height:24px;"><circle cx="12" cy="12" r="8"/></svg></div><div class="grid-card-name">Oracle</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#e25d33;"><span style="font-size:10px; font-weight:700;">S3</span></div><div class="grid-card-name">S3 Compatible</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#4a5568;"><span style="font-size:9px; font-weight:700;">SFTP</span></div><div class="grid-card-name">SFTP</div><div class="grid-card-type">Network-Attached Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#038387;"><span style="font-size:12px; font-weight:700;">SP</span></div><div class="grid-card-name">SharePoint</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#038387;"><span style="font-size:8px; font-weight:700;">SP+</span></div><div class="grid-card-name">SharePoint On-Prem</div><div class="grid-card-type">Object Storage</div></div>
                <div class="grid-card"><div class="grid-card-icon" style="background:#4a5568;"><span style="font-size:9px; font-weight:700;">SMB</span></div><div class="grid-card-name">SMB Compatible</div><div class="grid-card-type">Network-Attached Storage</div></div>
              </div>
            </div>

            <!-- Recommended Integrations (product promos) -->
            <div style="margin-bottom: 32px;">
              <div class="section-title">Recommended Integrations</div>
              <div class="section-desc">Add connectors to your MetaDefender Core engine for expanded, centralized security.</div>
              <div style="display:flex; gap:32px; flex-wrap:wrap;">
                <div class="inv-promo" style="flex:1; min-width:280px;">
                  <div class="inv-promo-img"><svg viewBox="0 0 32 32" fill="none"><path d="M16 4L6 9v7c0 6.6 4.4 12.7 10 14 5.6-1.3 10-7.4 10-14V9l-10-5z" stroke="#fff" stroke-width="2"/><path d="M12 16l3 3 5-6" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                  <div class="inv-promo-content">
                    <div class="inv-promo-title">MetaDefender Software Supply Chain</div>
                    <div class="inv-promo-desc">Secure Amazon ECR and prevent supply chain attacks.</div>
                    <a class="inv-promo-link" href="#">Learn More</a>
                  </div>
                </div>
                <div class="inv-promo" style="flex:1; min-width:280px;">
                  <div class="inv-promo-img"><svg viewBox="0 0 32 32" fill="none"><path d="M4 10h8v12H4zM14 6h8v16h-8zM24 14h4v8h-4z" stroke="#fff" stroke-width="1.5"/><path d="M12 16h2M22 18h2" stroke="#fff" stroke-width="1.5"/></svg></div>
                  <div class="inv-promo-content">
                    <div class="inv-promo-title">MetaDefender Managed File Transfer</div>
                    <div class="inv-promo-desc">Secure file transfers between productivity tools and internal and external users.</div>
                    <a class="inv-promo-link" href="#">Learn More</a>
                  </div>
                </div>
              </div>
            </div>
            </div><!-- /accountsListView -->

            <!-- Account Detail View (hidden by default) -->
            <div id="accountDetailView" style="display:none;">
              <div class="page-header">
                <nav class="breadcrumb">
                  <a class="breadcrumb-item" onclick="showAccountsList()">Inventory</a>
                  <span class="breadcrumb-sep"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 3l5 5-5 5"/></svg></span>
                  <a class="breadcrumb-item" onclick="showAccountsList()">Accounts</a>
                </nav>
                <div class="page-title-row">
                  <h1 class="page-title" id="acctDetailTitle">Account Name</h1>
                  <div class="page-header-actions">
                    <button class="btn-icon" title="Refresh" onclick="openAccountDetail(window._acctDetailIdx||0)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.14 9.29C2.61 11.56 4.45 13.39 6.71 13.86C10.58 14.67 14 11.73 14 8H12.5C12.5 10.8 9.93 13.01 7.03 12.4C5.33 12.04 3.96 10.67 3.6 8.97C2.99 6.07 5.2 3.5 8 3.5C8.17 3.5 8.34 3.51 8.5 3.53C8.85 3.57 9.18 3.64 9.5 3.76C10.06 3.96 10.57 4.26 11 4.66C11.12 4.76 11.24 4.88 11.34 5H9.5V6.5H13C13.55 6.5 14 6.05 14 5.5V2H12.5V4.04C12.33 3.85 12.15 3.67 11.96 3.5C11.27 2.88 10.43 2.43 9.5 2.2C9.18 2.11 8.84 2.05 8.5 2.02C8.34 2.01 8.17 2 8 2C4.27 2 1.32 5.42 2.14 9.29Z"/></svg></button>
                    <div class="acct-actions-wrap">
                      <button class="btn-outline" onclick="toggleAcctActionsMenu(event)">Actions <svg viewBox="0 0 16 16" fill="currentColor" style="width:12px;height:12px;margin-left:4px;"><path d="M7.99994 10.7495C7.80994 10.7495 7.61994 10.6795 7.46994 10.5295L3.21994 6.27945C2.92994 5.98945 2.92994 5.50945 3.21994 5.21945C3.50994 4.92945 3.98994 4.92945 4.27994 5.21945L7.99994 8.93945L11.7199 5.21945C12.0099 4.92945 12.4899 4.92945 12.7799 5.21945C13.0699 5.50945 13.0699 5.98945 12.7799 6.27945L8.52994 10.5295C8.37994 10.6795 8.18994 10.7495 7.99994 10.7495Z"/></svg></button>
                      <div class="acct-actions-menu" id="acctActionsMenu">
                        <div class="row-action-menu-item" onclick="openSlidePanel('editJobPanel')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div>
                        <div class="row-action-menu-item" onclick="openSlidePanel('acctSettingsPanel')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="5"/><path d="M8 5.5v5M5.5 8h5"/></svg> Account Settings</div>
                        <div class="inv-context-item danger"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Delete Account</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Account Detail Inner Tabs -->
              <div class="tabs" id="acctDetailTabs" role="tablist">
                <button class="tab active" role="tab" data-acct-tab="units">Units</button>
                <button class="tab" role="tab" data-acct-tab="jobs">Jobs</button>
              </div>

              <!-- ===== Units Tab ===== -->
              <div class="acct-tab-panel active" id="acct-panel-units">
                <!-- Account Overview -->
                <div class="acct-overview-row" id="acctOverviewRow">
                  <div class="acct-overview-stat blue">
                    <span class="acct-overview-stat-label">Total Units</span>
                    <span class="acct-overview-stat-value" id="acctStatTotal">15</span>
                  </div>
                  <div class="acct-overview-stat green">
                    <span class="acct-overview-stat-label">Operational</span>
                    <span class="acct-overview-stat-value" id="acctStatOp">12</span>
                  </div>
                  <div class="acct-overview-stat red">
                    <span class="acct-overview-stat-label">Issues Found</span>
                    <span class="acct-overview-stat-value" id="acctStatIssues">2</span>
                  </div>
                  <div class="acct-overview-stat yellow">
                    <span class="acct-overview-stat-label">Pending</span>
                    <span class="acct-overview-stat-value" id="acctStatPending">1</span>
                  </div>
                </div>

                <!-- Group Settings -->
                <div class="audit-card" style="margin-bottom:16px;">
                  <div class="card-header">
                    <div class="card-header-left"><strong>Group Settings</strong></div>
                  </div>
                  <div style="padding:16px 20px;">
                    <div style="display:flex; align-items:center; gap:8px;">
                      <span style="font-size:13px; color:var(--text-muted); min-width:90px;">Group Name</span>
                      <span style="font-size:13px; color:var(--text-strong); font-weight:500;" id="acctGroupName">Default Group</span>
                    </div>
                  </div>
                </div>

                <!-- Storage Units Table -->
                <div class="audit-card">
                  <div class="audit-card-header">
                    <div class="audit-card-title">
                      <h3>Storage Units</h3>
                      <span class="count" id="acctUnitsCount">15</span>
                    </div>
                    <div class="audit-card-actions">
                      <div class="audit-search">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                        <input type="text" placeholder="Search units" id="acctUnitsSearch">
                      </div>
                      <button class="audit-filter-btn" onclick="openSlidePanel('acctUnitsColVisPanel')" title="Column Visibility">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.5 4.5h11M2.5 8h11M2.5 11.5h11" stroke="currentColor" stroke-width="1.5" fill="none"/><circle cx="5" cy="4.5" r="1.5" fill="currentColor"/><circle cx="11" cy="8" r="1.5" fill="currentColor"/><circle cx="7" cy="11.5" r="1.5" fill="currentColor"/></svg>
                      </button>
                    </div>
                  </div>
                  <div class="table-scroll">
                    <table class="data-table table-fixed" id="acctUnitsTable" style="min-width:1000px;">
                      <thead>
                        <tr>
                          <th class="col-cb"><div class="cb" onclick="toggleAllCb(this)"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                          <th class="col-pinned" style="width:22%;">Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:11%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:14%;">Group <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:22%;">Storage ClientID <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:18%;">Last Job <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th class="col-action"></th>
                        </tr>
                      </thead>
                      <tbody id="acctUnitsBody">
                        <!-- Populated by JS -->
                      </tbody>
                    </table>
                  </div>
                  <div class="audit-pagination" id="acctUnitsPagination">
                    <div class="audit-pagination-left">
                      <select id="acctUnitsPerPage"><option selected>10</option><option>25</option><option>50</option></select>
                      <span>items per page</span>
                      <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                      <span id="acctUnitsPageInfo" style="margin-left: 8px;">1-10 of 15 items</span>
                    </div>
                    <div class="audit-pagination-right">
                      <button class="audit-page-btn" id="acctUnitsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                      <select class="audit-page-select" id="acctUnitsPageSelect"><option selected>Page 1</option></select>
                      <button class="audit-page-btn" id="acctUnitsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                    </div>
                  </div>
                </div>
              </div><!-- /acct-panel-units -->

              <!-- ===== Jobs Tab ===== -->
              <div class="acct-tab-panel" id="acct-panel-jobs">
                <!-- Latest Job Summary -->
                <div class="audit-card" style="margin-bottom:16px;">
                  <div class="audit-card-header">
                    <div class="audit-card-title">
                      <h3>Latest Job Summary</h3>
                      <span class="count" id="acctJobSummaryMeta">Scheduled &middot; Jan 15, 2025 10:30 AM</span>
                    </div>
                    <a class="btn-text" id="acctJobSummaryLink">View Report <svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></a>
                  </div>
                  <div class="acct-donut-row" id="acctDonutRow">
                    <!-- 3 donut charts populated by JS -->
                  </div>
                </div>

                <!-- Jobs Table -->
                <div class="audit-card">
                  <div class="audit-card-header">
                    <div class="audit-card-title">
                      <h3>Jobs</h3>
                      <span class="count" id="acctJobsCount">10</span>
                    </div>
                    <div class="audit-card-actions">
                      <div class="audit-search">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                        <input type="text" placeholder="Search jobs" id="acctJobsSearch">
                      </div>
                      <button class="audit-filter-btn" onclick="openSlidePanel('acctJobsFiltersPanel')" title="Advanced Filters">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                      </button>
                      <button class="audit-filter-btn" onclick="openSlidePanel('acctJobsColVisPanel')" title="Column Visibility">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.5 4.5h11M2.5 8h11M2.5 11.5h11" stroke="currentColor" stroke-width="1.5" fill="none"/><circle cx="5" cy="4.5" r="1.5" fill="currentColor"/><circle cx="11" cy="8" r="1.5" fill="currentColor"/><circle cx="7" cy="11.5" r="1.5" fill="currentColor"/></svg>
                      </button>
                    </div>
                  </div>
                  <div class="table-scroll">
                    <table class="data-table table-fixed" id="acctJobsTable" style="min-width:1100px;">
                      <thead>
                        <tr>
                          <th class="col-cb"><div class="cb" onclick="toggleAllCb(this)"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                          <th class="col-pinned" style="width:15%;">Job Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:9%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:11%;">Files Processed <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:10%;">Detections <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:14%;">Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:14%;">Date & Time <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:10%;">Job Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th class="col-action"></th>
                        </tr>
                      </thead>
                      <tbody id="acctJobsBody">
                        <!-- Populated by JS -->
                      </tbody>
                    </table>
                  </div>
                  <div class="audit-pagination" id="acctJobsPagination">
                    <div class="audit-pagination-left">
                      <select id="acctJobsPerPage"><option selected>10</option><option>25</option><option>50</option></select>
                      <span>items per page</span>
                      <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                      <span id="acctJobsPageInfo" style="margin-left: 8px;">1-10 of 15 items</span>
                    </div>
                    <div class="audit-pagination-right">
                      <button class="audit-page-btn" id="acctJobsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                      <select class="audit-page-select" id="acctJobsPageSelect"><option selected>Page 1</option></select>
                      <button class="audit-page-btn" id="acctJobsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                    </div>
                  </div>
                </div>
              </div><!-- /acct-panel-jobs -->
            </div><!-- /accountDetailView -->
          </div><!-- /inv-panel-accounts -->

          <!-- ===== Groups Tab ===== -->
          <div class="inv-tab-panel" id="inv-panel-groups" style="display:none;">
            <!-- Groups List View -->
            <div id="groupsListView">
              <div class="audit-card">
                <div class="audit-card-header">
                  <div class="audit-card-title">
                    <h3>Groups</h3>
                    <span class="count" id="groupsCount">15</span>
                  </div>
                  <div class="audit-card-actions">
                    <div class="audit-search">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                      <input type="text" placeholder="Search groups" id="groupsSearch">
                    </div>
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Provider</span></button>
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Status</span></button>
                  </div>
                </div>
                <div class="table-scroll">
                  <table class="data-table" id="groupsTable">
                    <thead>
                      <tr>
                        <th class="col-cb"><div class="cb" id="groupsSelectAll" onclick="toggleAllCb(this)"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                        <th >Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Storage Units <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Providers <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th class="col-action"></th>
                      </tr>
                    </thead>
                    <tbody id="groupsBody">
                      <!-- Populated by JS -->
                    </tbody>
                  </table>
                </div>
                <div class="audit-pagination" id="groupsPagination">
                  <div class="audit-pagination-left">
                    <select id="groupsPerPage"><option selected>10</option><option>25</option><option>50</option></select>
                    <span>items per page</span>
                    <span style="margin-left:8px; color:var(--text-muted);">|</span>
                    <span id="groupsPageInfo" style="margin-left:8px;">1-10 of 15 items</span>
                  </div>
                  <div class="audit-pagination-right">
                    <button class="audit-page-btn" id="groupsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                    <select class="audit-page-select" id="groupsPageSelect"><option selected>Page 1</option></select>
                    <button class="audit-page-btn" id="groupsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Group Detail View -->
            <div id="groupDetailView" style="display:none;">
              <div class="page-header">
                <nav class="breadcrumb">
                  <a class="breadcrumb-item" onclick="showGroupsList()">Inventory</a>
                  <span class="breadcrumb-sep"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 3l5 5-5 5"/></svg></span>
                  <a class="breadcrumb-item" onclick="showGroupsList()">Groups</a>
                </nav>
                <div class="page-title-row">
                  <h1 class="page-title" id="grpDetailTitle">Group Name</h1>
                  <div class="page-header-actions">
                    <button class="btn-icon" title="Refresh"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.14 9.29C2.61 11.56 4.45 13.39 6.71 13.86C10.58 14.67 14 11.73 14 8H12.5C12.5 10.8 9.93 13.01 7.03 12.4C5.33 12.04 3.96 10.67 3.6 8.97C2.99 6.07 5.2 3.5 8 3.5C8.17 3.5 8.34 3.51 8.5 3.53C8.85 3.57 9.18 3.64 9.5 3.76C10.06 3.96 10.57 4.26 11 4.66C11.12 4.76 11.24 4.88 11.34 5H9.5V6.5H13C13.55 6.5 14 6.05 14 5.5V2H12.5V4.04C12.33 3.85 12.15 3.67 11.96 3.5C11.27 2.88 10.43 2.43 9.5 2.2C9.18 2.11 8.84 2.05 8.5 2.02C8.34 2.01 8.17 2 8 2C4.27 2 1.32 5.42 2.14 9.29Z"/></svg></button>
                    <div class="acct-actions-wrap">
                      <button class="btn-outline" onclick="toggleGrpActionsMenu(event)">Actions <svg viewBox="0 0 16 16" fill="currentColor" style="width:12px;height:12px;margin-left:4px;"><path d="M7.99994 10.7495C7.80994 10.7495 7.61994 10.6795 7.46994 10.5295L3.21994 6.27945C2.92994 5.98945 2.92994 5.50945 3.21994 5.21945C3.50994 4.92945 3.98994 4.92945 4.27994 5.21945L7.99994 8.93945L11.7199 5.21945C12.0099 4.92945 12.4899 4.92945 12.7799 5.21945C13.0699 5.50945 13.0699 5.98945 12.7799 6.27945L8.52994 10.5295C8.37994 10.6795 8.18994 10.7495 7.99994 10.7495Z"/></svg></button>
                      <div class="acct-actions-menu" id="grpActionsMenu">
                        <div class="row-action-menu-item" onclick="openSlidePanel('editJobPanel')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div>
                        <div class="row-action-menu-item" onclick="openSlidePanel('grpSettingsPanel')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="5"/><path d="M8 5.5v5M5.5 8h5"/></svg> Group Settings</div>
                        <div class="inv-context-item danger"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Delete Group</div>
                      </div>
                    </div>
                    <button class="btn-primary" onclick="openSlidePanel('editJobPanel')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" style="width:14px;height:14px;margin-right:4px;"><path d="M8 3v10M3 8h10"/></svg> Add Units</button>
                  </div>
                </div>
              </div>

              <!-- Group Detail Inner Tabs -->
              <div class="tabs" id="grpDetailTabs" role="tablist">
                <button class="tab active" role="tab" data-grp-tab="units">Units</button>
                <button class="tab" role="tab" data-grp-tab="jobs">Jobs</button>
              </div>

              <!-- ===== Group Units Tab ===== -->
              <div class="grp-tab-panel active" id="grp-panel-units">
                <!-- Account Overview -->
                <div class="acct-overview-row" id="grpOverviewRow">
                  <div class="acct-overview-stat blue">
                    <span class="acct-overview-stat-label">Total Units</span>
                    <span class="acct-overview-stat-value" id="grpStatTotal">15</span>
                  </div>
                  <div class="acct-overview-stat green">
                    <span class="acct-overview-stat-label">Operational</span>
                    <span class="acct-overview-stat-value" id="grpStatOp">13</span>
                  </div>
                  <div class="acct-overview-stat red">
                    <span class="acct-overview-stat-label">Errors</span>
                    <span class="acct-overview-stat-value" id="grpStatErrors">1</span>
                  </div>
                  <div class="acct-overview-stat yellow">
                    <span class="acct-overview-stat-label">Testing</span>
                    <span class="acct-overview-stat-value" id="grpStatTesting">1</span>
                  </div>
                </div>

                <!-- Storage Units Table -->
                <div class="audit-card">
                  <div class="audit-card-header">
                    <div class="audit-card-title">
                      <h3>Storage Units</h3>
                      <span class="count" id="grpUnitsCount">15</span>
                    </div>
                    <div class="audit-card-actions">
                      <div class="audit-search">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                        <input type="text" placeholder="Search for Files or Hash" id="grpUnitsSearch">
                      </div>
                      <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Status</span></button>
                      <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Group</span></button>
                    </div>
                  </div>
                  <div class="table-scroll">
                    <table class="data-table table-fixed" id="grpUnitsTable" style="min-width:1100px;">
                      <thead>
                        <tr>
                          <th class="col-cb"><div class="cb" onclick="toggleAllCb(this)"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                          <th class="col-pinned" style="width:16%;">Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:12%;">Provider <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:10%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:13%;">Account <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:10%;">Groups <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:14%;">Storage ClientID <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:15%;">Last Job <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th class="col-action"></th>
                        </tr>
                      </thead>
                      <tbody id="grpUnitsBody">
                        <!-- Populated by JS -->
                      </tbody>
                    </table>
                  </div>
                  <div class="audit-pagination" id="grpUnitsPagination">
                    <div class="audit-pagination-left">
                      <select id="grpUnitsPerPage"><option selected>10</option><option>25</option><option>50</option></select>
                      <span>items per page</span>
                      <span style="margin-left:8px; color:var(--text-muted);">|</span>
                      <span id="grpUnitsPageInfo" style="margin-left:8px;">1-10 of 15 items</span>
                    </div>
                    <div class="audit-pagination-right">
                      <button class="audit-page-btn" id="grpUnitsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                      <select class="audit-page-select" id="grpUnitsPageSelect"><option selected>Page 1</option></select>
                      <button class="audit-page-btn" id="grpUnitsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                    </div>
                  </div>
                </div>
              </div><!-- /grp-panel-units -->

              <!-- ===== Group Jobs Tab ===== -->
              <div class="grp-tab-panel" id="grp-panel-jobs">
                <div class="audit-card">
                  <div class="audit-card-header">
                    <div class="audit-card-title">
                      <h3>Jobs</h3>
                      <span class="count" id="grpJobsCount">0</span>
                    </div>
                    <div class="audit-card-actions">
                      <div class="audit-search">
                        <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                        <input type="text" placeholder="Search jobs" id="grpJobsSearch">
                      </div>
                    </div>
                  </div>
                  <div class="table-scroll">
                    <table class="data-table table-fixed" id="grpJobsTable" style="min-width:900px;">
                      <thead>
                        <tr>
                          <th class="col-cb"><div class="cb" onclick="toggleAllCb(this)"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                          <th class="col-pinned" style="width:22%;">Job Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:14%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th style="width:12%;">Type</th>
                          <th style="width:12%;">Files</th>
                          <th style="width:12%;">Detections</th>
                          <th style="width:18%;">Date <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                          <th class="col-action"></th>
                        </tr>
                      </thead>
                      <tbody id="grpJobsBody">
                        <!-- Populated by JS -->
                      </tbody>
                    </table>
                  </div>
                  <div class="audit-pagination" id="grpJobsPagination">
                    <div class="audit-pagination-left">
                      <select id="grpJobsPerPage"><option selected>10</option><option>25</option><option>50</option></select>
                      <span>items per page</span>
                      <span style="margin-left:8px; color:var(--text-muted);">|</span>
                      <span id="grpJobsPageInfo" style="margin-left:8px;">1-10 of 0 items</span>
                    </div>
                    <div class="audit-pagination-right">
                      <button class="audit-page-btn" id="grpJobsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                      <select class="audit-page-select" id="grpJobsPageSelect"><option selected>Page 1</option></select>
                      <button class="audit-page-btn" id="grpJobsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                    </div>
                  </div>
                </div>
              </div><!-- /grp-panel-jobs -->
            </div><!-- /groupDetailView -->
          </div>

          <!-- ===== Units Tab ===== -->
          <div class="inv-tab-panel" id="inv-panel-units" style="display:none;">
            <div class="audit-card">
              <div class="audit-card-header" id="allUnitsHeader">
                <div class="audit-card-title">
                  <h3>Storage Units</h3>
                  <span class="count" id="allUnitsCount">0</span>
                </div>
                <div class="audit-card-actions">
                  <div class="audit-search">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                    <input type="text" placeholder="Search units" id="allUnitsSearch">
                  </div>
                  <div style="display:flex; gap:8px;">
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Status</span></button>
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Group</span></button>
                    <button class="btn-menu"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.715 4C1.515 4 1.345 4.07 1.205 4.21C1.065 4.35 .995 4.52 .995 4.72C.995 4.92 1.065 5.09 1.205 5.23C1.345 5.37 1.515 5.44 1.715 5.44H14.275C14.475 5.44 14.645 5.37 14.785 5.23C14.925 5.09 14.995 4.92 14.995 4.72C14.995 4.52 14.925 4.35 14.785 4.21C14.645 4.07 14.475 4 14.275 4H1.715Z"/><path d="M3.835 7.33C3.625 7.33 3.455 7.4 3.315 7.54C3.175 7.68 3.105 7.85 3.105 8.05C3.105 8.25 3.175 8.42 3.315 8.56C3.455 8.7 3.635 8.77 3.835 8.77H12.165C12.365 8.77 12.535 8.7 12.675 8.56C12.815 8.42 12.885 8.25 12.885 8.05C12.885 7.85 12.815 7.68 12.675 7.54C12.535 7.4 12.355 7.33 12.155 7.33H3.835Z"/><path d="M5.515 10.65C5.315 10.65 5.145 10.72 5.005 10.86C4.865 11 4.795 11.17 4.795 11.37C4.795 11.57 4.865 11.74 5.005 11.88C5.145 12.02 5.315 12.09 5.515 12.09H10.475C10.675 12.09 10.845 12.02 10.985 11.88C11.125 11.74 11.195 11.57 11.195 11.37C11.195 11.17 11.125 11 10.985 10.86C10.845 10.72 10.675 10.65 10.475 10.65H5.515Z"/></svg><span class="filter-btn-text">Provider</span></button>
                  </div>
                </div>
                <div class="card-bulk-actions">
                  <span class="bulk-count" data-bulk-count>0 selected</span>
                  <div class="card-bulk-divider"></div>
                  <button class="btn-outline" onclick="bulkAction('delete','allUnitsBody')">Delete</button>
                  <button class="btn-outline" onclick="bulkAction('add to group','allUnitsBody')">Add to Group</button>
                  <button class="btn-outline" onclick="bulkAction('create job','allUnitsBody')">Create Job</button>
                </div>
              </div>
              <div class="table-scroll">
                <table class="data-table table-fixed" id="allUnitsTable" style="min-width:1400px;">
                  <thead>
                    <tr>
                      <th class="col-cb"><div class="cb" onclick="toggleAllCb(this)"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                      <th class="col-pinned" style="width:18%;">Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:10%;">Provider <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:10%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:14%;">Account <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:12%;">Groups</th>
                      <th style="width:18%;">Storage ClientID <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:14%;">Last Job <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.995 4.92 0.995 4.72C0.995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.145 12.02 5.005 11.88C4.865 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.865 11 5.005 10.86C5.145 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th class="col-action"></th>
                    </tr>
                  </thead>
                  <tbody id="allUnitsBody">
                    <!-- Populated by JS -->
                  </tbody>
                </table>
              </div>
              <div class="audit-pagination" id="allUnitsPagination">
                <div class="audit-pagination-left">
                  <select id="allUnitsPerPage"><option selected>10</option><option>25</option><option>50</option></select>
                  <span>items per page</span>
                  <span style="margin-left:8px; color:var(--text-muted);">|</span>
                  <span id="allUnitsPageInfo" style="margin-left:8px;">0 items</span>
                </div>
                <div class="audit-pagination-right">
                  <button class="audit-page-btn" id="allUnitsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                  <select class="audit-page-select" id="allUnitsPageSelect"><option selected>Page 1</option></select>
                  <button class="audit-page-btn" id="allUnitsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                </div>
              </div>
            </div>
          </div>
        </div><!-- /inventoryPage -->

        <!-- ==================== JOBS PAGE ==================== -->
        <div id="jobsPage" class="page-view">
          <!-- Jobs List View -->
          <div id="jobsListView">
            <div class="page-title-row">
              <h1 class="page-title">Jobs</h1>
              <button class="btn-primary" onclick="openSlidePanel('editJobPanel')">New Job</button>
            </div>

            <!-- Active Jobs Card -->
            <div class="audit-card" id="activeJobsCard" style="margin-bottom:12px;">
              <div class="audit-card-header">
                <div class="audit-card-title">
                  <h3>Active Jobs</h3>
                  <span class="count" id="activeJobsCount">0</span>
                </div>
                <div class="audit-card-actions">
                  <div class="audit-search">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                    <input type="text" placeholder="Search jobs" id="activeJobsSearch">
                  </div>
                  <button class="audit-filter-btn" onclick="openSlidePanel('jobsFiltersPanel')" title="Advanced Filters">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                  </button>
                </div>
              </div>
              <!-- Empty state -->
              <div class="users-empty-state" id="activeJobsEmpty" style="display:none;">
                <div class="users-empty-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 6V4.75H8.75V11.25H10V10H14V14H10V12.75H8C7.59 12.75 7.25 12.41 7.25 12V8.75H6.25L4 11L1 8L4 5L6.25 7.25H7.25V4C7.25 3.59 7.59 3.25 8 3.25H10V2H14V6H10Z"/></svg>
                </div>
                <p class="users-empty-title">No Active Jobs</p>
                <p class="users-empty-desc">Active and running jobs will appear here.</p>
              </div>
              <div id="activeJobsTableWrap" class="table-scroll">
                <table class="data-table table-fixed" id="activeJobsTable" style="min-width:1100px;">
                  <thead>
                    <tr>
                      <th class="col-pinned" style="width:15%;">Job Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:9%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:12%;">Job Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:10%;">Detections <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:13%;">Files Processed <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:17%;">Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:10%;">Elapsed Time <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th style="width:10%;">Start Time <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th class="col-action"></th>
                    </tr>
                  </thead>
                  <tbody id="activeJobsBody">
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Upcoming Jobs Card -->
            <div class="audit-card" id="upcomingJobsCard" style="margin-bottom:12px;">
              <div class="audit-card-header">
                <div class="audit-card-title">
                  <h3>Upcoming Jobs</h3>
                  <span class="count" id="upcomingJobsCount">0</span>
                </div>
                <div class="audit-card-actions">
                  <div class="audit-search">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                    <input type="text" placeholder="Search jobs" id="upcomingJobsSearch">
                  </div>
                  <button class="audit-filter-btn" onclick="openSlidePanel('jobsFiltersPanel')" title="Advanced Filters">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                  </button>
                </div>
              </div>
              <!-- Empty state -->
              <div class="users-empty-state" id="upcomingJobsEmpty" style="display:none;">
                <div class="users-empty-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 6V4.75H8.75V11.25H10V10H14V14H10V12.75H8C7.59 12.75 7.25 12.41 7.25 12V8.75H6.25L4 11L1 8L4 5L6.25 7.25H7.25V4C7.25 3.59 7.59 3.25 8 3.25H10V2H14V6H10Z"/></svg>
                </div>
                <p class="users-empty-title">No Upcoming Jobs</p>
                <p class="users-empty-desc">Scheduled jobs will appear here when configured.</p>
              </div>
              <div id="upcomingJobsTableWrap" class="table-scroll">
                <table class="data-table" id="upcomingJobsTable">
                  <thead>
                    <tr>
                      <th>Job Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Frequency <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Starts In <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th class="col-action"></th>
                    </tr>
                  </thead>
                  <tbody id="upcomingJobsBody">
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Past Jobs Card -->
            <div class="audit-card" id="pastJobsCard">
              <div class="audit-card-header">
                <div class="audit-card-title">
                  <h3>Past Jobs</h3>
                  <span class="count" id="pastJobsCount">0</span>
                </div>
                <div class="audit-card-actions">
                  <div class="audit-search">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                    <input type="text" placeholder="Search jobs" id="pastJobsSearch">
                  </div>
                  <button class="audit-filter-btn" onclick="openSlidePanel('jobsFiltersPanel')" title="Advanced Filters">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                  </button>
                </div>
              </div>
              <div class="table-scroll">
              <table class="data-table table-fixed" id="pastJobsTable" style="min-width:1100px;">
                <thead>
                  <tr>
                    <th class="col-pinned" style="width:15%;">Job Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:9%;">Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:12%;">Job Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:10%;">Detections <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:13%;">Files Processed <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:17%;">Storage Unit <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:10%;">Duration <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:10%;">Date <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-action"></th>
                  </tr>
                </thead>
                <tbody id="pastJobsBody">
                </tbody>
              </table>
              </div><!-- /table-scroll -->
              <div class="audit-pagination" id="pastJobsPagination">
                <div class="audit-pagination-left">
                  <select id="pastJobsPerPage">
                    <option selected>10</option>
                    <option>25</option>
                    <option>50</option>
                  </select>
                  <span>items per page</span>
                  <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                  <span id="pastJobsPageInfo" style="margin-left: 8px;">1-10 of 25 items</span>
                </div>
                <div class="audit-pagination-right">
                  <button class="audit-page-btn" id="pastJobsPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                  <select class="audit-page-select" id="pastJobsPageSelect">
                    <option selected>Page 1</option>
                  </select>
                  <button class="audit-page-btn" id="pastJobsNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                </div>
              </div>
            </div>
          </div><!-- /jobsListView -->

          <!-- Job Detail View (hidden by default) -->
          <div id="jobDetailView" style="display:none;">
            <div class="page-header">
              <nav class="breadcrumb">
                <a class="breadcrumb-item" onclick="showJobsList()">Jobs</a>
              </nav>
              <div class="page-title-row">
                <h1 class="page-title" id="jobDetailTitle">Scheduled File Scan</h1>
                <div class="page-header-actions">
                  <button class="btn-outline" onclick="openSlidePanel('jobDetailsPanel')">Job Details</button>
                  <button class="btn-outline" id="jobDetailCancelBtn" onclick="openCancelJobModal()">Cancel Job</button>
                  <button class="btn-primary" id="jobDetailReportBtn" style="display:none;">View Report</button>
                </div>
              </div>
            </div>

            <!-- Status banner (shown for completed/stopped) -->
            <div id="jobStatusBanner" style="display:none;"></div>

            <!-- Job Info Card -->
            <div class="audit-card" style="margin-bottom:12px;">
              <div class="job-info-grid" id="jobInfoGrid">
                <!-- Populated by JS -->
              </div>
            </div>

            <!-- Summary Stats -->
            <div class="job-summary-row" id="jobSummaryStats">
              <!-- Populated by JS -->
            </div>

            <!-- Processed Files Table -->
            <div class="audit-card" id="processedFilesCard">
              <div class="audit-card-header" id="processedFilesHeader">
                <div class="audit-card-title">
                  <h3>Processed Files</h3>
                  <span class="count" id="processedFilesCount">0</span>
                </div>
                <div class="audit-card-actions">
                  <div class="audit-search">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                    <input type="text" placeholder="Search files" id="processedFilesSearch">
                  </div>
                  <button class="audit-filter-btn" onclick="openSlidePanel('jobsFiltersPanel')" title="Advanced Filters">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                  </button>
                </div>
                <div class="card-bulk-actions">
                  <span class="bulk-count" data-bulk-count>0 selected</span>
                  <div class="card-bulk-divider"></div>
                  <button class="btn-outline" onclick="bulkAction('rescan','processedFilesBody')">Re-scan</button>
                  <button class="btn-outline" onclick="bulkAction('delete','processedFilesBody')">Delete</button>
                </div>
              </div>
              <div class="table-scroll">
              <table class="data-table table-fixed" id="processedFilesTable">
                <thead>
                  <tr>
                    <th class="col-cb"><div class="cb" onclick="toggleAllJobsCb(this,'processedFilesBody')"><svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg></div></th>
                    <th class="col-pinned" style="width:27%;">File Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:17%;">Verdict <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:13%;">Detections <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:13%;">File Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th style="width:25%;">Scan Date <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-action"></th>
                  </tr>
                </thead>
                <tbody id="processedFilesBody">
                </tbody>
              </table>
              </div><!-- /table-scroll -->
              <div class="audit-pagination" id="processedFilesPagination">
                <div class="audit-pagination-left">
                  <select id="processedFilesPerPage">
                    <option selected>10</option>
                    <option>25</option>
                    <option>50</option>
                  </select>
                  <span>items per page</span>
                  <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                  <span id="processedFilesPageInfo" style="margin-left: 8px;"></span>
                </div>
                <div class="audit-pagination-right">
                  <button class="audit-page-btn" id="processedFilesPrev" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                  <select class="audit-page-select" id="processedFilesPageSelect"><option selected>Page 1</option></select>
                  <button class="audit-page-btn" id="processedFilesNext"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                </div>
              </div>
            </div>
          </div><!-- /jobDetailView -->
        </div><!-- /jobsPage -->

        <!-- ==================== WORKFLOWS ==================== -->
        <div id="workflowsPage" class="page-view">
          <div id="workflowsListView" style="display:flex;">
            <div class="page-title-row">
              <h1 class="page-title">Workflows</h1>
              <button class="btn-primary" onclick="openSlidePanel('createWorkflowPanel')">Add New Workflow</button>
            </div>

            <div class="audit-card">
              <div class="audit-card-header">
                <div class="audit-card-title"><h3>Workflows</h3> <span class="count">10</span></div>
                <div style="display:flex; gap:8px; align-items:center;">
                  <div class="audit-search"><svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg><input type="text" placeholder="Search for Files or Hash" class="audit-search-input"></div>
                </div>
              </div>
              <div class="table-scroll">
                <table class="data-table" id="workflowsTable">
                  <thead>
                    <tr>
                      <th>Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>File Discovery <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Scan Pool <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Security <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>File Tagging <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Deep CDR™ <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th>Remediations <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                      <th class="col-action"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr onclick="openWorkflowDetail(0)" style="cursor:pointer;">
                      <td><svg class="wf-default-icon" viewBox="0 0 16 16" fill="currentColor"><path d="M14.52 6.39006L11.23 9.07006L12.32 13.1701C12.44 13.6101 11.95 13.9701 11.56 13.7201L8.00002 11.4101L4.44002 13.7201C4.05002 13.9701 3.56002 13.6101 3.68002 13.1701L4.77002 9.07006L1.48002 6.39006C1.12002 6.10006 1.31002 5.53006 1.77002 5.50006L6.01002 5.28006L7.53002 1.32006C7.70002 0.890059 8.30002 0.890059 8.47002 1.32006L9.99002 5.28006L14.23 5.50006C14.69 5.53006 14.88 6.10006 14.52 6.39006Z"/></svg> Default Workflow</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tag none">None</span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(1)" style="cursor:pointer;">
                      <td>Email 2025</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tag none">Keep</span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(2)" style="cursor:pointer;">
                      <td>Finance</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag copy">Copy</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(3)" style="cursor:pointer;">
                      <td>Weekly Scan</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag copy">Copy</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(4)" style="cursor:pointer;">
                      <td>Doc Library</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag copy">Copy</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(5)" style="cursor:pointer;">
                      <td>User Data</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag delete">Delete</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(6)" style="cursor:pointer;">
                      <td>Email 2024</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag move">Move</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(7)" style="cursor:pointer;">
                      <td>Test WF</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag none">Keep</span> <span class="wf-rem-tag copy">Copy</span> <span class="wf-rem-tag delete">Delete</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(8)" style="cursor:pointer;">
                      <td>Full Disk</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag failed">Failed</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                    <tr onclick="openWorkflowDetail(9)" style="cursor:pointer;">
                      <td>Quick Scan</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td>Scan Pool Name</td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> 3/4 Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-status"><span class="wf-status-dot"></span> Enabled</span></td>
                      <td><span class="wf-rem-tags"><span class="wf-rem-tag copy">Copy</span></span></td>
                      <td><button class="cell-action" onclick="event.stopPropagation();"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="audit-pagination">
                <div class="audit-pagination-left">
                  <select class="audit-page-select"><option selected>10</option><option>25</option><option>50</option></select>
                  <span>items per page</span>
                  <span>|</span>
                  <span>1-10 of 15 items</span>
                </div>
                <div class="audit-pagination-right">
                  <button class="audit-page-btn" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                  <select class="audit-page-select"><option selected>Page 1</option><option>Page 2</option></select>
                  <button class="audit-page-btn"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
                </div>
              </div>
            </div>
          </div><!-- /workflowsListView -->

          <!-- Workflow Detail View -->
          <div id="workflowDetailView" style="display:none;">
            <div class="page-header">
              <nav class="breadcrumb">
                <a class="breadcrumb-item" onclick="showWorkflowsList()">Workflows</a>
              </nav>
              <div class="page-title-row">
                <h1 class="page-title" id="wfDetailTitle">Default Workflow</h1>
              </div>
            </div>

            <div class="audit-card">
              <div class="audit-card-header"><div class="audit-card-title"><h3>Workflow Details</h3></div></div>
              <div class="wf-canvas" id="wfCanvas">
                <div class="wf-flow" id="wfFlow">
                  <div class="wf-start-label">Start</div>
                  <div class="wf-connector"></div>
                  <!-- File Discovery -->
                  <div class="wf-step" onclick="openSlidePanel('wfDiscoveryPanel')">
                    <div class="wf-node">
                      <div class="wf-node-box"><svg viewBox="0 0 48 48" fill="none"><path d="M26.9435 25.967C27.334 25.5768 27.9673 25.5768 28.3577 25.967L32.6922 30.3015L33.6507 30.1132C34.0184 30.041 34.398 30.1566 34.663 30.4216L44.472 40.2307C44.9114 40.67 44.9114 41.3823 44.472 41.8216L41.8204 44.4733C41.381 44.9126 40.6687 44.9126 40.2294 44.4733L30.4204 34.6643C30.1554 34.3993 30.0398 34.0196 30.1121 33.6518L30.3009 32.6914L25.9671 28.3576C25.5768 27.9671 25.5767 27.3339 25.9671 26.9434L26.9435 25.967Z" fill="url(#fd_g0)"/><path d="M26.9436 25.9675C27.3341 25.5773 27.9675 25.5772 28.3579 25.9675L32.6924 30.3019L33.6504 30.1137C34.0182 30.0415 34.3983 30.1571 34.6633 30.4221L44.4719 40.2307C44.9112 40.67 44.9111 41.3821 44.4719 41.8215L41.8206 44.4736L41.7349 44.5505C41.3224 44.887 40.7271 44.887 40.3147 44.5505L40.2297 44.4736L30.4204 34.6643C30.1887 34.4324 30.0711 34.113 30.0938 33.7905L30.1121 33.652L30.301 32.6918L25.9673 28.3581C25.6013 27.9919 25.578 27.412 25.8984 27.0192L25.9673 26.9438L26.9436 25.9675ZM28.199 26.1264C27.8964 25.824 27.4052 25.824 27.1025 26.1264L26.1262 27.1027C25.8238 27.4052 25.8239 27.8957 26.1262 28.1984L30.5449 32.6171L30.5215 32.7351L30.3325 33.6953C30.2747 33.9894 30.3674 34.2933 30.5794 34.5053L40.3887 44.3146C40.7402 44.6659 41.3102 44.666 41.6616 44.3146L44.313 41.6625C44.6643 41.3111 44.6644 40.741 44.313 40.3896L34.5037 30.581C34.2917 30.3691 33.9884 30.2765 33.6943 30.3342L32.7356 30.5224L32.6177 30.5458L32.5335 30.4609L28.199 26.1264Z" fill="url(#fd_g1)"/><path d="M33 18C33 26.2843 26.2843 33 18 33C9.71573 33 3 26.2843 3 18C3 9.71573 9.71573 3 18 3C26.2843 3 33 9.71573 33 18Z" fill="url(#fd_g2)"/><path d="M32.7751 18C32.7751 9.83999 26.16 3.22485 18 3.22485C9.83999 3.22485 3.22485 9.83999 3.22485 18C3.22485 26.16 9.83999 32.7751 18 32.7751V33C9.71573 33 3 26.2843 3 18C3 9.71573 9.71573 3 18 3C26.2843 3 33 9.71573 33 18C33 26.2843 26.2843 33 18 33V32.7751C26.16 32.7751 32.7751 26.16 32.7751 18Z" fill="url(#fd_g3)"/><path d="M18 6C24.6274 6 30 11.3726 30 18C30 24.6274 24.6274 30 18 30C11.3726 30 6 24.6274 6 18C6 11.3726 11.3726 6 18 6Z" fill="#607497"/><defs><linearGradient id="fd_g0" x1="35.2379" y1="25.6743" x2="35.2379" y2="44.8028" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="fd_g1" x1="35.2378" y1="25.6748" x2="35.2378" y2="44.8029" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="fd_g2" x1="18" y1="3" x2="18" y2="33" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="fd_g3" x1="18" y1="3" x2="18" y2="33" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient></defs></svg></div>
                      <div class="wf-node-label">File Discovery</div>
                    </div>
                  </div>
                  <div class="wf-connector"></div>
                  <!-- Scan Pool -->
                  <div class="wf-step" onclick="openSlidePanel('wfScanConfigPanel')">
                    <div class="wf-node">
                      <div class="wf-node-box"><svg viewBox="0 0 32 32" fill="none"><path d="M16 4L24 9V15L16 20L8 15V9L16 4Z" stroke="currentColor" stroke-width="2"/><path d="M16 20V28" stroke="currentColor" stroke-width="2"/><path d="M8 15L16 20L24 15" stroke="currentColor" stroke-width="2"/></svg></div>
                      <div class="wf-node-label">Scan Pool</div>
                    </div>
                  </div>
                  <div class="wf-connector"></div>
                  <!-- Security -->
                  <div class="wf-step" onclick="openSlidePanel('wfTechnologiesPanel')">
                    <div class="wf-node">
                      <div class="wf-node-box"><svg viewBox="0 0 48 48" fill="none"><path d="M22.8907 45.8707L3.80296 35.0543C2.78898 34.4797 2.78899 33.0188 3.80296 32.4442L22.8907 21.6279C23.5788 21.238 24.4211 21.238 25.1092 21.6279L44.197 32.4442C45.2109 33.0188 45.2109 34.4797 44.197 35.0543L25.1092 45.8707C24.4211 46.2607 23.5788 46.2607 22.8907 45.8707Z" fill="url(#sec_g0)"/><path d="M22.8905 21.6278C23.5785 21.2379 24.421 21.2381 25.109 21.6278L44.1974 32.4442C45.2111 33.0188 45.2111 34.4799 44.1974 35.0546L25.109 45.871L24.9786 45.9391C24.3607 46.2377 23.6396 46.2377 23.0216 45.9391L22.8905 45.871L3.80285 35.0546C2.78902 34.4799 2.78903 33.0188 3.80285 32.4442L22.8905 21.6278ZM24.9984 21.8241C24.3791 21.4731 23.6211 21.4731 23.0018 21.8241L3.91418 32.6398C3.0523 33.1282 3.0523 34.3706 3.91418 34.859L23.0018 45.6754C23.621 46.0262 24.3792 46.0262 24.9984 45.6754L44.0861 34.859C44.9479 34.3706 44.9479 33.1282 44.0861 32.6398L24.9984 21.8241Z" fill="url(#sec_g1)"/><path d="M22.8901 21.6279C23.5783 21.238 24.4213 21.238 25.1094 21.6279L41.0703 30.6726L25.2061 39.8506C24.5113 40.2525 23.6551 40.2539 22.959 39.8542L6.94971 30.6609L22.8901 21.6279Z" fill="#607497"/><path d="M22.959 36.1032L3.73398 25.0633C2.73687 24.4907 2.72828 23.0553 3.71847 22.4708L22.8561 11.1742C23.5617 10.7577 24.438 10.7577 25.1436 11.1742L44.2895 22.4756C45.2778 23.059 45.2716 24.491 44.2781 25.0657L25.2062 36.0996C24.5114 36.5016 23.6551 36.503 22.959 36.1032Z" fill="url(#sec_g2)"/><path d="M22.8561 11.1747C23.5617 10.7582 24.4379 10.7582 25.1435 11.1747L44.2897 22.476C45.2779 23.0594 45.2714 24.4911 44.278 25.0658L25.2065 36.0998L25.0746 36.1708C24.45 36.4788 23.7168 36.4798 23.0912 36.1738L22.9594 36.1035L3.734 25.0636C2.76805 24.5089 2.72976 23.1441 3.62853 22.528L3.71862 22.4708L22.8561 11.1747ZM25.0292 11.368C24.3942 10.9933 23.6054 10.9932 22.9704 11.368L3.83288 22.6649C2.99145 23.1618 2.99874 24.3813 3.84606 24.8681L23.0714 35.9086C23.6979 36.2682 24.4685 36.2667 25.0937 35.905L44.166 24.871C45.0101 24.3824 45.0154 23.1652 44.1755 22.6693L25.0292 11.368Z" fill="url(#sec_g3)"/><path d="M22.856 11.1742C23.5616 10.7577 24.4384 10.7577 25.144 11.1742L41.5034 20.8304L25.1096 30.1212C24.4215 30.5112 23.5785 30.5112 22.8904 30.1212L6.49658 20.8304L22.856 11.1742Z" fill="#607497"/><path d="M22.8907 26.3707L3.80296 15.5543C2.78898 14.9797 2.78899 13.5188 3.80296 12.9442L22.8907 2.1279C23.5788 1.73797 24.4211 1.73797 25.1092 2.1279L44.197 12.9442C45.2109 13.5188 45.2109 14.9797 44.197 15.5543L25.1092 26.3707C24.4211 26.7607 23.5788 26.7607 22.8907 26.3707Z" fill="url(#sec_g4)"/><path d="M22.8905 2.1278C23.5785 1.73793 24.421 1.73807 25.109 2.1278L44.1974 12.9442C45.2111 13.5188 45.2111 14.9799 44.1974 15.5546L25.109 26.371L24.9786 26.4391C24.3607 26.7377 23.6396 26.7377 23.0216 26.4391L22.8905 26.371L3.80285 15.5546C2.78902 14.9799 2.78903 13.5188 3.80285 12.9442L22.8905 2.1278ZM24.9984 2.32409C24.3791 1.97315 23.6211 1.97315 23.0018 2.32409L3.91418 13.1398C3.0523 13.6282 3.0523 14.8706 3.91418 15.359L23.0018 26.1754C23.621 26.5262 24.3792 26.5262 24.9984 26.1754L44.0861 15.359C44.9479 14.8706 44.9479 13.6282 44.0861 13.1398L24.9984 2.32409Z" fill="url(#sec_g5)"/><defs><linearGradient id="sec_g0" x1="24" y1="21.3354" x2="24" y2="46.1632" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="sec_g1" x1="24.0001" y1="21.3354" x2="24.0001" y2="46.163" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="sec_g2" x1="24.004" y1="10.8618" x2="24.004" y2="36.4021" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="sec_g3" x1="24.004" y1="10.8623" x2="24.004" y2="36.4026" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="sec_g4" x1="24" y1="1.83545" x2="24" y2="26.6632" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="sec_g5" x1="24.0001" y1="1.83545" x2="24.0001" y2="26.663" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient></defs></svg></div>
                      <div class="wf-node-label">Security</div>
                    </div>
                  </div>
                  <div class="wf-connector"></div>
                  <!-- File Tagging -->
                  <div class="wf-step" onclick="openSlidePanel('wfFileTaggingPanel')">
                    <div class="wf-node">
                      <div class="wf-node-box"><svg viewBox="0 0 32 32" fill="none"><path d="M6 8H18L26 16L18 24H6V8Z" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="16" r="2" fill="currentColor"/></svg></div>
                      <div class="wf-node-label">File Tagging</div>
                      <div class="wf-node-sublabel">Inactive</div>
                    </div>
                  </div>
                  <div class="wf-connector"></div>
                  <!-- Deep CDR -->
                  <div class="wf-step" onclick="openSlidePanel('wfDeepCdrPanel')">
                    <div class="wf-node">
                      <div class="wf-node-box"><svg viewBox="0 0 48 48" fill="none"><g clip-path="url(#cdr_clip)"><path d="M20.25 8.2504L24 8.25V6H40.5488L48 14.1631V40C48 41.1046 47.1046 42 46 42H24V39.75H20.25V42H2.25C1.00736 42 0 40.9926 0 39.75V8.25004C0 7.00739 1.00739 6.00002 2.25004 6.00004L20.25 6.0004V8.2504Z" fill="url(#cdr_g0)"/><path d="M0 39.75V8.25C2.31929e-05 7.00738 1.00738 6 2.25 6L20.25 6.00073V8.25073L24 8.25V6H40.5491L48 14.1628V39.9998C48 41.1043 47.1043 42 45.9998 42V41.7751C46.9801 41.7751 47.7751 40.9801 47.7751 39.9998V14.25L40.4495 6.22485H24.2249V8.47485L20.0251 8.47559V6.22485H2.25C1.13164 6.22485 0.224877 7.13164 0.224854 8.25V39.75C0.224854 40.8684 1.13162 41.7751 2.25 41.7751V42L2.13428 41.9971C0.945416 41.9368 0 40.9538 0 39.75ZM24 39.75H20.25V42H2.25V41.7751H20.0251V39.5251H24.2249V41.7751H45.9998V42H24V39.75Z" fill="url(#cdr_g1)"/><path d="M27.75 39.75H24V36H27.75V39.75Z" fill="#607497"/><path d="M32.25 33.75H28.5V30H32.25V33.75Z" fill="#607497"/><path d="M42 30H32.25V27.75H42V30Z" fill="#607497"/><path d="M28.5 27.75H24V23.25H28.5V27.75Z" fill="#607497"/><path d="M42 23.25H32.25V21H42V23.25Z" fill="#607497"/><path d="M32.25 21H29.25V18H32.25V21Z" fill="#607497"/><path d="M27.75 18H24V14.25H27.75V18Z" fill="#607497"/><path d="M42 16.5H32.25V14.25H42V16.5Z" fill="#607497"/><path fill-rule="evenodd" clip-rule="evenodd" d="M20.2502 10.5H23.9995V14.25H20.2502V18H23.9995V23.25H19.5002V27.75H23.9995V36H20.2502V39.75H2.24951V8.25H20.2502V10.5ZM5.25024 30H14.2502V27.75H5.25024V30ZM5.25024 23.25H14.2502V21H5.25024V23.25ZM16.5002 20.25V23.25H19.5002V20.25H16.5002ZM5.25024 16.5H14.2502V14.25H5.25024V16.5Z" fill="#607497"/></g><defs><linearGradient id="cdr_g0" x1="24" y1="6" x2="24" y2="42" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="cdr_g1" x1="24" y1="6" x2="24" y2="42" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><clipPath id="cdr_clip"><rect width="48" height="48" fill="white"/></clipPath></defs></svg></div>
                      <div class="wf-node-label">Deep CDR™</div>
                      <div class="wf-node-sublabel">Active</div>
                    </div>
                  </div>
                  <div class="wf-connector"></div>
                  <!-- Decision Diamond -->
                  <div class="wf-diamond"><svg viewBox="0 0 16 16" fill="none"><path d="M15.0002 7.99954C15.0006 8.13052 14.9749 8.26026 14.9249 8.38127C14.8748 8.50228 14.8012 8.61216 14.7083 8.70454L8.70519 14.7083C8.51782 14.8945 8.26437 14.9991 8.00019 14.9991C7.736 14.9991 7.48255 14.8945 7.29519 14.7083L1.29519 8.70454C1.10894 8.51718 1.00439 8.26373 1.00439 7.99954C1.00439 7.73536 1.10894 7.48191 1.29519 7.29454L7.29831 1.29079C7.48567 1.10454 7.73913 1 8.00331 1C8.2675 1 8.52095 1.10454 8.70831 1.29079L14.7114 7.29454C14.8037 7.38718 14.8767 7.49717 14.9263 7.61818C14.9759 7.73918 15.001 7.86879 15.0002 7.99954Z" fill="#0C121D"/></svg></div>
                  <div class="wf-connector"></div>
                  <!-- Remediations -->
                  <div class="wf-rem-stack">
                    <!-- Allowed -->
                    <div class="wf-rem-col">
                      <div class="wf-rem-col-header">Allowed</div>
                      <div class="wf-rem-row">
                        <span class="wf-rem-row-label">Original</span>
                        <div class="wf-action-btns">
                          <div class="wf-action-btn active"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Keep</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Copy</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M13.67 8.33006C13.67 8.33006 13.69 8.31006 13.69 8.29006C13.73 8.20006 13.75 8.10006 13.75 8.00006C13.75 7.90006 13.73 7.80007 13.69 7.71006C13.69 7.70006 13.67 7.69006 13.67 7.67006C13.63 7.59007 13.59 7.52006 13.52 7.46006L9.01 3.21006C8.71 2.92006 8.23 2.94006 7.95 3.24006C7.66 3.54006 7.68 4.02006 7.98 4.30006L11.11 7.26007H3C2.59 7.26007 2.25 7.60007 2.25 8.01007C2.25 8.42006 2.59 8.76007 3 8.76007H11.11L7.98 11.7201C7.68 12.0001 7.66 12.4801 7.95 12.7801C8.1 12.9401 8.3 13.0201 8.49 13.0201C8.67 13.0201 8.86 12.9501 9 12.8101L13.5 8.56006C13.56 8.50006 13.61 8.43006 13.65 8.35006L13.67 8.33006Z" fill="#607497"/></svg> Move</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M14 5H2V7H14V5Z" fill="#607497"/><path d="M9.5 3.5V5.5H6.5V3.5H9.5ZM10 2H6C5.45 2 5 2.45 5 3V6C5 6.55 5.45 7 6 7H10C10.55 7 11 6.55 11 6V3C11 2.45 10.55 2 10 2Z" fill="#607497"/><path d="M12 14H4L3 6H13L12 14ZM6.5 7.25C6.08579 7.25 5.75 7.58579 5.75 8V11C5.75 11.4142 6.08579 11.75 6.5 11.75C6.91421 11.75 7.25 11.4142 7.25 11V8C7.25 7.58579 6.91421 7.25 6.5 7.25ZM9.5 7.25C9.08579 7.25 8.75 7.58579 8.75 8V11C8.75 11.4142 9.08579 11.75 9.5 11.75C9.91421 11.75 10.25 11.4142 10.25 11V8C10.25 7.58579 9.91421 7.25 9.5 7.25Z" fill="#607497"/></svg> Delete</div>
                        </div>
                      </div>
                      <div class="wf-rem-row">
                        <span class="wf-rem-row-label">Sanitized</span>
                        <div class="wf-action-btns">
                          <div class="wf-action-btn active"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Keep</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Copy</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M13.67 8.33006C13.67 8.33006 13.69 8.31006 13.69 8.29006C13.73 8.20006 13.75 8.10006 13.75 8.00006C13.75 7.90006 13.73 7.80007 13.69 7.71006C13.69 7.70006 13.67 7.69006 13.67 7.67006C13.63 7.59007 13.59 7.52006 13.52 7.46006L9.01 3.21006C8.71 2.92006 8.23 2.94006 7.95 3.24006C7.66 3.54006 7.68 4.02006 7.98 4.30006L11.11 7.26007H3C2.59 7.26007 2.25 7.60007 2.25 8.01007C2.25 8.42006 2.59 8.76007 3 8.76007H11.11L7.98 11.7201C7.68 12.0001 7.66 12.4801 7.95 12.7801C8.1 12.9401 8.3 13.0201 8.49 13.0201C8.67 13.0201 8.86 12.9501 9 12.8101L13.5 8.56006C13.56 8.50006 13.61 8.43006 13.65 8.35006L13.67 8.33006Z" fill="#607497"/></svg> Move</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M14 5H2V7H14V5Z" fill="#607497"/><path d="M9.5 3.5V5.5H6.5V3.5H9.5ZM10 2H6C5.45 2 5 2.45 5 3V6C5 6.55 5.45 7 6 7H10C10.55 7 11 6.55 11 6V3C11 2.45 10.55 2 10 2Z" fill="#607497"/><path d="M12 14H4L3 6H13L12 14ZM6.5 7.25C6.08579 7.25 5.75 7.58579 5.75 8V11C5.75 11.4142 6.08579 11.75 6.5 11.75C6.91421 11.75 7.25 11.4142 7.25 11V8C7.25 7.58579 6.91421 7.25 6.5 7.25ZM9.5 7.25C9.08579 7.25 8.75 7.58579 8.75 8V11C8.75 11.4142 9.08579 11.75 9.5 11.75C9.91421 11.75 10.25 11.4142 10.25 11V8C10.25 7.58579 9.91421 7.25 9.5 7.25Z" fill="#607497"/></svg> Delete</div>
                        </div>
                      </div>
                    </div>
                    <!-- Blocked -->
                    <div class="wf-rem-col">
                      <div class="wf-rem-col-header">Blocked</div>
                      <div class="wf-rem-row">
                        <span class="wf-rem-row-label">Original</span>
                        <div class="wf-action-btns">
                          <div class="wf-action-btn active"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Keep</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Copy</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M13.67 8.33006C13.67 8.33006 13.69 8.31006 13.69 8.29006C13.73 8.20006 13.75 8.10006 13.75 8.00006C13.75 7.90006 13.73 7.80007 13.69 7.71006C13.69 7.70006 13.67 7.69006 13.67 7.67006C13.63 7.59007 13.59 7.52006 13.52 7.46006L9.01 3.21006C8.71 2.92006 8.23 2.94006 7.95 3.24006C7.66 3.54006 7.68 4.02006 7.98 4.30006L11.11 7.26007H3C2.59 7.26007 2.25 7.60007 2.25 8.01007C2.25 8.42006 2.59 8.76007 3 8.76007H11.11L7.98 11.7201C7.68 12.0001 7.66 12.4801 7.95 12.7801C8.1 12.9401 8.3 13.0201 8.49 13.0201C8.67 13.0201 8.86 12.9501 9 12.8101L13.5 8.56006C13.56 8.50006 13.61 8.43006 13.65 8.35006L13.67 8.33006Z" fill="#607497"/></svg> Move</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M14 5H2V7H14V5Z" fill="#607497"/><path d="M9.5 3.5V5.5H6.5V3.5H9.5ZM10 2H6C5.45 2 5 2.45 5 3V6C5 6.55 5.45 7 6 7H10C10.55 7 11 6.55 11 6V3C11 2.45 10.55 2 10 2Z" fill="#607497"/><path d="M12 14H4L3 6H13L12 14ZM6.5 7.25C6.08579 7.25 5.75 7.58579 5.75 8V11C5.75 11.4142 6.08579 11.75 6.5 11.75C6.91421 11.75 7.25 11.4142 7.25 11V8C7.25 7.58579 6.91421 7.25 6.5 7.25ZM9.5 7.25C9.08579 7.25 8.75 7.58579 8.75 8V11C8.75 11.4142 9.08579 11.75 9.5 11.75C9.91421 11.75 10.25 11.4142 10.25 11V8C10.25 7.58579 9.91421 7.25 9.5 7.25Z" fill="#607497"/></svg> Delete</div>
                        </div>
                      </div>
                      <div class="wf-rem-row">
                        <span class="wf-rem-row-label">Sanitized</span>
                        <div class="wf-action-btns">
                          <div class="wf-action-btn active"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Keep</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Copy</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M13.67 8.33006C13.67 8.33006 13.69 8.31006 13.69 8.29006C13.73 8.20006 13.75 8.10006 13.75 8.00006C13.75 7.90006 13.73 7.80007 13.69 7.71006C13.69 7.70006 13.67 7.69006 13.67 7.67006C13.63 7.59007 13.59 7.52006 13.52 7.46006L9.01 3.21006C8.71 2.92006 8.23 2.94006 7.95 3.24006C7.66 3.54006 7.68 4.02006 7.98 4.30006L11.11 7.26007H3C2.59 7.26007 2.25 7.60007 2.25 8.01007C2.25 8.42006 2.59 8.76007 3 8.76007H11.11L7.98 11.7201C7.68 12.0001 7.66 12.4801 7.95 12.7801C8.1 12.9401 8.3 13.0201 8.49 13.0201C8.67 13.0201 8.86 12.9501 9 12.8101L13.5 8.56006C13.56 8.50006 13.61 8.43006 13.65 8.35006L13.67 8.33006Z" fill="#607497"/></svg> Move</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M14 5H2V7H14V5Z" fill="#607497"/><path d="M9.5 3.5V5.5H6.5V3.5H9.5ZM10 2H6C5.45 2 5 2.45 5 3V6C5 6.55 5.45 7 6 7H10C10.55 7 11 6.55 11 6V3C11 2.45 10.55 2 10 2Z" fill="#607497"/><path d="M12 14H4L3 6H13L12 14ZM6.5 7.25C6.08579 7.25 5.75 7.58579 5.75 8V11C5.75 11.4142 6.08579 11.75 6.5 11.75C6.91421 11.75 7.25 11.4142 7.25 11V8C7.25 7.58579 6.91421 7.25 6.5 7.25ZM9.5 7.25C9.08579 7.25 8.75 7.58579 8.75 8V11C8.75 11.4142 9.08579 11.75 9.5 11.75C9.91421 11.75 10.25 11.4142 10.25 11V8C10.25 7.58579 9.91421 7.25 9.5 7.25Z" fill="#607497"/></svg> Delete</div>
                        </div>
                      </div>
                    </div>
                    <!-- Sanitized -->
                    <div class="wf-rem-col">
                      <div class="wf-rem-col-header">Sanitized</div>
                      <div class="wf-rem-row">
                        <span class="wf-rem-row-label">Original</span>
                        <div class="wf-action-btns">
                          <div class="wf-action-btn active"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Keep</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Copy</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M13.67 8.33006C13.67 8.33006 13.69 8.31006 13.69 8.29006C13.73 8.20006 13.75 8.10006 13.75 8.00006C13.75 7.90006 13.73 7.80007 13.69 7.71006C13.69 7.70006 13.67 7.69006 13.67 7.67006C13.63 7.59007 13.59 7.52006 13.52 7.46006L9.01 3.21006C8.71 2.92006 8.23 2.94006 7.95 3.24006C7.66 3.54006 7.68 4.02006 7.98 4.30006L11.11 7.26007H3C2.59 7.26007 2.25 7.60007 2.25 8.01007C2.25 8.42006 2.59 8.76007 3 8.76007H11.11L7.98 11.7201C7.68 12.0001 7.66 12.4801 7.95 12.7801C8.1 12.9401 8.3 13.0201 8.49 13.0201C8.67 13.0201 8.86 12.9501 9 12.8101L13.5 8.56006C13.56 8.50006 13.61 8.43006 13.65 8.35006L13.67 8.33006Z" fill="#607497"/></svg> Move</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M14 5H2V7H14V5Z" fill="#607497"/><path d="M9.5 3.5V5.5H6.5V3.5H9.5ZM10 2H6C5.45 2 5 2.45 5 3V6C5 6.55 5.45 7 6 7H10C10.55 7 11 6.55 11 6V3C11 2.45 10.55 2 10 2Z" fill="#607497"/><path d="M12 14H4L3 6H13L12 14ZM6.5 7.25C6.08579 7.25 5.75 7.58579 5.75 8V11C5.75 11.4142 6.08579 11.75 6.5 11.75C6.91421 11.75 7.25 11.4142 7.25 11V8C7.25 7.58579 6.91421 7.25 6.5 7.25ZM9.5 7.25C9.08579 7.25 8.75 7.58579 8.75 8V11C8.75 11.4142 9.08579 11.75 9.5 11.75C9.91421 11.75 10.25 11.4142 10.25 11V8C10.25 7.58579 9.91421 7.25 9.5 7.25Z" fill="#607497"/></svg> Delete</div>
                        </div>
                      </div>
                      <div class="wf-rem-row">
                        <span class="wf-rem-row-label">Sanitized</span>
                        <div class="wf-action-btns">
                          <div class="wf-action-btn active"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Keep</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M8 1C4.13 1 1 4.13 1 8C1 11.87 4.13 15 8 15C11.87 15 15 11.87 15 8C15 4.13 11.87 1 8 1ZM11.53 6.53L7.53 10.53C7.38 10.68 7.19 10.75 7 10.75C6.81 10.75 6.62 10.68 6.47 10.53L4.47 8.53C4.18 8.24 4.18 7.76 4.47 7.47C4.76 7.18 5.24 7.18 5.53 7.47L7 8.94L10.47 5.47C10.76 5.18 11.24 5.18 11.53 5.47C11.82 5.76 11.82 6.24 11.53 6.53Z" fill="#00B67F"/></svg> Copy</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M13.67 8.33006C13.67 8.33006 13.69 8.31006 13.69 8.29006C13.73 8.20006 13.75 8.10006 13.75 8.00006C13.75 7.90006 13.73 7.80007 13.69 7.71006C13.69 7.70006 13.67 7.69006 13.67 7.67006C13.63 7.59007 13.59 7.52006 13.52 7.46006L9.01 3.21006C8.71 2.92006 8.23 2.94006 7.95 3.24006C7.66 3.54006 7.68 4.02006 7.98 4.30006L11.11 7.26007H3C2.59 7.26007 2.25 7.60007 2.25 8.01007C2.25 8.42006 2.59 8.76007 3 8.76007H11.11L7.98 11.7201C7.68 12.0001 7.66 12.4801 7.95 12.7801C8.1 12.9401 8.3 13.0201 8.49 13.0201C8.67 13.0201 8.86 12.9501 9 12.8101L13.5 8.56006C13.56 8.50006 13.61 8.43006 13.65 8.35006L13.67 8.33006Z" fill="#607497"/></svg> Move</div>
                          <div class="wf-action-btn"><svg viewBox="0 0 16 16" fill="none"><path d="M14 5H2V7H14V5Z" fill="#607497"/><path d="M9.5 3.5V5.5H6.5V3.5H9.5ZM10 2H6C5.45 2 5 2.45 5 3V6C5 6.55 5.45 7 6 7H10C10.55 7 11 6.55 11 6V3C11 2.45 10.55 2 10 2Z" fill="#607497"/><path d="M12 14H4L3 6H13L12 14ZM6.5 7.25C6.08579 7.25 5.75 7.58579 5.75 8V11C5.75 11.4142 6.08579 11.75 6.5 11.75C6.91421 11.75 7.25 11.4142 7.25 11V8C7.25 7.58579 6.91421 7.25 6.5 7.25ZM9.5 7.25C9.08579 7.25 8.75 7.58579 8.75 8V11C8.75 11.4142 9.08579 11.75 9.5 11.75C9.91421 11.75 10.25 11.4142 10.25 11V8C10.25 7.58579 9.91421 7.25 9.5 7.25Z" fill="#607497"/></svg> Delete</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="wf-connector"></div>
                  <!-- Other Remediations -->
                  <div class="wf-step">
                    <div class="wf-node">
                      <div class="wf-node-box"><svg viewBox="0 0 48 48" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M26.9056 1.5C27.886 1.5 28.7534 2.1347 29.0501 3.06903L30.6275 8.03649C32.2204 8.65109 33.7001 9.48008 35.0276 10.4874L40.3587 9.3033C41.3039 9.09336 42.2774 9.51166 42.7757 10.3418L45.6111 15.0657C46.1353 15.9392 46.0074 17.0559 45.2991 17.788L41.6577 21.5523C41.776 22.3519 41.8393 23.1689 41.8393 24C41.8393 24.8308 41.7759 25.6476 41.6577 26.4469L45.2993 30.212C46.0075 30.9442 46.1354 32.0608 45.6112 32.9342L42.7758 37.658C42.2775 38.4883 41.3039 38.9066 40.3586 38.6965L35.0268 37.5118C33.6997 38.5188 32.2207 39.3474 30.6283 39.9619L29.0502 44.9311C28.7534 45.8653 27.886 46.5 26.9057 46.5H21.0941C20.1139 46.5 19.2464 45.8654 18.9497 44.9311L17.3716 39.9627C15.7786 39.348 14.2989 38.5192 12.9715 37.5118L7.64138 38.6964C6.69609 38.9065 5.72241 38.4882 5.22406 37.658L2.38874 32.9341C1.86453 32.0608 1.99246 30.9442 2.70062 30.212L6.34141 26.4477C6.22311 25.6481 6.16056 24.831 6.16056 24C6.16056 23.1687 6.22222 22.3513 6.34058 21.5515L2.7006 17.788C1.99245 17.0558 1.86453 15.9392 2.38874 15.0659L5.22416 10.3419C5.72246 9.51168 6.69601 9.09338 7.64124 9.30335L12.9715 10.4874C14.2989 9.48006 15.7787 8.65114 17.3716 8.03649L18.9497 3.06879C19.2464 2.13458 20.1139 1.5 21.0941 1.5H26.9056Z" fill="url(#or_g0)"/><path d="M26.9058 1.5C27.8861 1.50005 28.7537 2.13462 29.0504 3.06885L30.6273 8.03613C32.2202 8.65074 33.7002 9.48026 35.0277 10.4875L40.359 9.30322C41.3042 9.09338 42.2777 9.51167 42.776 10.3418L45.6112 15.0659C46.1354 15.9393 46.0074 17.0562 45.2992 17.7883L41.6576 21.5522C41.7759 22.3518 41.8392 23.1689 41.8392 24C41.8392 24.8308 41.7758 25.6477 41.6576 26.447L45.2992 30.2117C46.0074 30.9438 46.1354 32.0607 45.6112 32.9341L42.776 37.6582C42.2777 38.4883 41.3041 38.9066 40.359 38.6968L35.027 37.5117C33.7 38.5186 32.221 39.3471 30.6287 39.9617L29.0504 44.9312C28.7536 45.8654 27.8861 46.5 26.9058 46.5H21.094C20.1139 46.4999 19.2462 45.8654 18.9495 44.9312L17.3719 39.9624C15.7789 39.3477 14.2989 38.5191 12.9715 37.5117L7.64161 38.6968C6.69635 38.9069 5.72224 38.4884 5.22387 37.6582L2.38866 32.9341C1.8645 32.0607 1.99253 30.9438 2.70067 30.2117L6.34155 26.4478C6.22325 25.6482 6.16065 24.831 6.16065 24C6.16065 23.1687 6.22246 22.3513 6.34082 21.5515L2.70067 17.7883C1.99254 17.0562 1.86449 15.9393 2.38866 15.0659L5.22387 10.3418C5.72218 9.51159 6.69638 9.09326 7.64161 9.30322L12.9715 10.4875C14.2989 9.48024 15.779 8.65079 17.3719 8.03613L18.9495 3.06885C19.2463 2.13466 20.1139 1.50003 21.094 1.5H26.9058ZM21.094 1.72485C20.2119 1.72488 19.4312 2.2962 19.1641 3.13696L17.5857 8.10425L17.5535 8.20752L17.4524 8.24634C15.8794 8.85334 14.4182 9.67182 13.1077 10.6663L13.0242 10.73L7.59254 9.52295C6.7419 9.33399 5.86574 9.71046 5.41723 10.4575L2.58129 15.1816C2.1096 15.9677 2.22524 16.9727 2.86254 17.6316L6.50196 21.3948L6.57959 21.4746L6.56348 21.5845C6.44671 22.3734 6.3855 23.1799 6.3855 24C6.3855 24.8197 6.44748 25.6259 6.56421 26.4148L6.58032 26.5247L6.50342 26.6038L2.86254 30.3684C2.22523 31.0273 2.1096 32.0323 2.58129 32.8184L5.41723 37.5425C5.8658 38.2895 6.74193 38.6661 7.59254 38.4771L13.0242 37.2693L13.1077 37.3323C14.2545 38.2026 15.5164 38.9387 16.868 39.5156L17.4524 39.7529L17.5535 39.7917L17.5857 39.8943L19.1641 44.863C19.4312 45.7038 20.2119 46.2751 21.094 46.2751H26.9058C27.788 46.2751 28.5687 45.7038 28.8358 44.863L30.4141 39.8936L30.4464 39.791L30.5474 39.7522C32.1201 39.1453 33.5804 38.3265 34.8907 37.3323L34.9742 37.2693L40.4073 38.4771C41.2581 38.6661 42.1349 38.2897 42.5834 37.5425L45.4186 32.8184C45.8903 32.0323 45.7747 31.0273 45.1373 30.3684L41.4957 26.603L41.4188 26.5239L41.4349 26.4141C41.5516 25.6252 41.6144 24.8193 41.6144 24C41.6144 23.1804 41.5517 22.3743 41.4349 21.5852L41.4188 21.4753L41.4957 21.3962L45.1373 17.6316C45.7747 16.9727 45.8903 15.9677 45.4186 15.1816L42.5826 10.4575C42.1341 9.7105 41.258 9.33402 40.4073 9.52295L34.975 10.73L34.8915 10.6663C33.5808 9.67183 32.1198 8.85328 30.5467 8.24634L30.4456 8.20752L30.4134 8.10425L28.8358 3.13696C28.5687 2.29618 27.788 1.7249 26.9058 1.72485H21.094Z" fill="url(#or_g1)"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.75 24.0001L20.4881 32.6203C19.7397 33.1068 18.75 32.5697 18.75 31.6771V16.3231C18.75 15.4305 19.7397 14.8934 20.4881 15.3799L33.75 24.0001Z" fill="#607497"/><defs><linearGradient id="or_g0" x1="24" y1="1.5" x2="24" y2="46.5" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="or_g1" x1="24" y1="1.5" x2="24" y2="46.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient></defs></svg></div>
                      <div class="wf-node-label">Other Remediations</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div><!-- /workflowDetailView -->
        </div><!-- /workflowsPage -->

        <!-- ==================== COMPONENTS SHOWCASE ==================== -->
        <div id="componentsPage" class="page-view" style="display:none; flex-direction:column; gap:20px; padding:20px;">
          <div style="display:flex; align-items:center; justify-content:space-between;">
            <h1 style="font-size:20px; font-weight:500; color:var(--text-strong);">Design System Components</h1>
            <button class="btn-outline" onclick="toggleDarkMode()">Toggle Dark Mode</button>
          </div>

          <!-- Tags (Status) -->
          <div class="settings-card">
            <div class="card-header"><h2>Tags — Status</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="tag-group">
                <span class="tag tag-neutral">Neutral</span>
                <span class="tag tag-inactive">Inactive</span>
                <span class="tag tag-secure">Secure</span>
                <span class="tag tag-success">Success</span>
                <span class="tag tag-accent">Accent</span>
                <span class="tag tag-guide">Guide</span>
                <span class="tag tag-alert">Alert</span>
                <span class="tag tag-warn">Warn</span>
                <span class="tag tag-caution">Caution</span>
              </div>
            </div>
          </div>

          <!-- Tags (Keyword) -->
          <div class="settings-card">
            <div class="card-header"><h2>Tags — Keyword</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="tag-group">
                <span class="tag-keyword">Neutral</span>
                <span class="tag-keyword">Inactive</span>
                <span class="tag-keyword">Secure</span>
                <span class="tag-keyword">Success</span>
                <span class="tag-keyword">Accent</span>
                <span class="tag-keyword">Guide</span>
                <span class="tag-keyword">Alert</span>
                <span class="tag-keyword">Warn</span>
                <span class="tag-keyword">Caution</span>
              </div>
            </div>
          </div>

          <!-- Scan Status Chips -->
          <div class="settings-card">
            <div class="card-header"><h2>Scan Status Chips</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="tag-group">
                <span class="tag tag-neutral">Allowed</span>
                <span class="tag tag-accent">Blocked</span>
                <span class="tag tag-success">Complete</span>
                <span class="tag tag-alert">Failed</span>
                <span class="tag tag-alert">Skipped</span>
                <span class="tag tag-warn">Pending</span>
              </div>
            </div>
          </div>

          <!-- Badges -->
          <div class="settings-card">
            <div class="card-header"><h2>Badges — Dots</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; align-items:center; gap:12px;">
                <span class="badge-dot badge-dot-neutral"></span>
                <span class="badge-dot badge-dot-inactive"></span>
                <span class="badge-dot badge-dot-secure"></span>
                <span class="badge-dot badge-dot-success"></span>
                <span class="badge-dot badge-dot-accent"></span>
                <span class="badge-dot badge-dot-guide"></span>
                <span class="badge-dot badge-dot-alert"></span>
                <span class="badge-dot badge-dot-warn"></span>
                <span class="badge-dot badge-dot-caution"></span>
              </div>
            </div>
          </div>

          <div class="settings-card">
            <div class="card-header"><h2>Badges — Numbers</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; align-items:center; gap:12px;">
                <span class="badge-number badge-number-neutral">12</span>
                <span class="badge-number badge-number-inactive">12</span>
                <span class="badge-number badge-number-secure">12</span>
                <span class="badge-number badge-number-success">12</span>
                <span class="badge-number badge-number-accent">12</span>
                <span class="badge-number badge-number-guide">12</span>
                <span class="badge-number badge-number-alert">12</span>
                <span class="badge-number badge-number-warn">12</span>
                <span class="badge-number badge-number-caution">12</span>
              </div>
            </div>
          </div>

          <!-- Chips -->
          <div class="settings-card">
            <div class="card-header"><h2>Chips</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center;">
                <span class="chip chip-default">Label</span>
                <span class="chip chip-disabled">Label</span>
                <span class="chip chip-inactive">Label</span>
                <span class="chip chip-secure">Label</span>
                <span class="chip chip-success">Label</span>
                <span class="chip chip-accent">Label</span>
                <span class="chip chip-guide">Label</span>
                <span class="chip chip-alert">Label</span>
                <span class="chip chip-warn">Label</span>
                <span class="chip chip-caution">Label</span>
              </div>
              <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center;">
                <span class="chip chip-default chip-selected">Label<button class="chip-remove"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></span>
                <span class="chip chip-accent chip-selected">Label<button class="chip-remove"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></span>
                <span class="chip chip-alert chip-selected">Label<button class="chip-remove"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></span>
              </div>
            </div>
          </div>

          <!-- Verdicts -->
          <div class="settings-card">
            <div class="card-header"><h2>Verdicts</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; flex-wrap:wrap; gap:16px; align-items:center;">
                <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Neutral</span></span>
                <span class="verdict verdict-not-active"><span class="verdict-dot"></span><span class="verdict-text">Not Active</span></span>
                <span class="verdict verdict-secure"><span class="verdict-dot"></span><span class="verdict-text">Secure</span></span>
                <span class="verdict verdict-completed"><span class="verdict-dot"></span><span class="verdict-text">Success</span></span>
                <span class="verdict verdict-accent"><span class="verdict-dot"></span><span class="verdict-text">Accent</span></span>
                <span class="verdict verdict-guide"><span class="verdict-dot"></span><span class="verdict-text">Guide</span></span>
                <span class="verdict verdict-detected"><span class="verdict-dot"></span><span class="verdict-text">Alert</span></span>
                <span class="verdict verdict-warn"><span class="verdict-dot"></span><span class="verdict-text">Warn</span></span>
                <span class="verdict verdict-caution"><span class="verdict-dot"></span><span class="verdict-text">Caution</span></span>
              </div>
            </div>
          </div>

          <!-- Scan Verdicts -->
          <div class="settings-card">
            <div class="card-header"><h2>Scan Verdicts</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:12px;">
              <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Not Detected</span></span>
              <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Not Supported</span></span>
              <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Excluded</span></span>
              <span class="verdict verdict-not-active"><span class="verdict-dot"></span><span class="verdict-text">Not Active</span></span>
              <span class="verdict verdict-detected"><span class="verdict-dot"></span><span class="verdict-text">Detected</span></span>
              <span class="verdict verdict-warn"><span class="verdict-dot"></span><span class="verdict-text">5/16 Detected</span></span>
              <span class="verdict verdict-progress"><span class="verdict-dot"></span><span class="verdict-text">In Progress</span></span>
              <span class="verdict verdict-completed"><span class="verdict-dot"></span><span class="verdict-text">Completed</span></span>
              <span class="verdict verdict-failed"><span class="verdict-dot"></span><span class="verdict-text">Failed</span></span>
            </div>
          </div>

          <!-- Severities -->
          <div class="settings-card">
            <div class="card-header"><h2>Severities</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; flex-direction:column; gap:12px;">
                <span class="severity severity-critical"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Malicious</span>
                <span class="severity severity-critical"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Likely Malicious</span>
                <span class="severity severity-high"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Suspicious</span>
                <span class="severity severity-medium"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Benign</span>
                <span class="severity severity-none"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.2"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>No Threat</span>
              </div>
              <div style="height:1px; background:var(--border-200); margin:4px 0;"></div>
              <div style="display:flex; flex-direction:column; gap:12px;">
                <span class="severity severity-critical"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Critical</span>
                <span class="severity severity-high"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>High</span>
                <span class="severity severity-medium"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Medium</span>
                <span class="severity severity-low"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Low</span>
                <span class="severity severity-none"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.2"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>None</span>
              </div>
            </div>
          </div>

          <!-- Avatar Dropdown Menu -->
          <div class="settings-card">
            <div class="card-header"><h2>Avatar Dropdown — User Menu</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="avd-demo-container">

                <!-- Main Menu Demo -->
                <div class="avd-demo-block">
                  <div style="font-size:12px; font-weight:500; color:var(--text-muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">Main Menu</div>
                  <div class="avatar-dropdown" style="position:static; display:flex;">
                    <!-- User Info -->
                    <div class="avd-user">
                      <div class="avd-avatar">E</div>
                      <div class="avd-user-info">
                        <div class="avd-user-name">Elvijs Vilevics</div>
                        <div class="avd-user-email">elvijs@opswat.com</div>
                      </div>
                    </div>
                    <div class="avd-divider"></div>
                    <!-- Navigation Items -->
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 4H3V3h10v1zm0 4H3V7h10v1zm-3 4H3v-1h7v1z"/></svg>
                      <span class="avd-item-text">Organization</span>
                      <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 8a3 3 0 100-6 3 3 0 000 6zm0 1c-3.31 0-6 1.79-6 4v1h12v-1c0-2.21-2.69-4-6-4z"/></svg>
                      <span class="avd-item-text">Profile</span>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.21 8.46c.01-.15.02-.3.02-.46s-.01-.31-.02-.46a6.5 6.5 0 00-.05-.43l.96-.85a.58.58 0 00.12-.74l-.58-1a.58.58 0 00-.67-.2l-1.24.41a5.5 5.5 0 00-.73-.51 5.6 5.6 0 00-.82-.38l-.24-1.27A.57.57 0 009.56 2H8.41a.57.57 0 00-.56.43l-.24 1.27c-.28.11-.55.24-.82.38-.26.15-.5.32-.73.51l-1.24-.41a.58.58 0 00-.67.2l-.58 1a.58.58 0 00.12.74l.96.85a5 5 0 00-.05.43c-.01.15-.02.3-.02.46s.01.31.02.46c.01.14.03.29.05.43l-.96.85a.58.58 0 00-.12.74l.58 1c.24.41.73.56 1.18.41l1.24-.41c.23.19.47.36.73.51.27.14.54.27.82.38l.24 1.27c.09.25.48.43.56.43h1.15c.48 0 .89-.34.98-.81l.24-1.27c.28-.11.55-.24.82-.38.26-.15.5-.32.73-.51l1.24.41c.45.15.94-.04 1.18-.45l.58-1a.58.58 0 00-.21-.74l-.96-.85c.02-.14.04-.29.05-.43zM8.57 10.94c-2.12.4-3.93-1.41-3.53-3.53.22-1.18 1.18-2.14 2.36-2.36 2.12-.4 3.93 1.41 3.53 3.53-.22 1.18-1.18 2.14-2.36 2.36z"/></svg>
                      <span class="avd-item-text">Settings</span>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm.75 10.5h-1.5v-1.5h1.5v1.5zm0-3h-1.5V4.5h1.5v4z"/></svg>
                      <span class="avd-item-text">Support</span>
                    </button>
                    <div class="avd-divider"></div>
                    <!-- Preferences -->
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 2a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 2zm0 9.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zm5.5-3.75a.75.75 0 010 1.5h-1.5a.75.75 0 010-1.5h1.5zm-10 0a.75.75 0 010 1.5H2a.75.75 0 010-1.5h1.5zm8.19-3.94a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 01-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-7.38 7.38a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm7.38 0a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 011.06-1.06l1.06 1.06zM4.31 5.37a.75.75 0 01-1.06 0L2.19 4.31a.75.75 0 111.06-1.06l1.06 1.06a.75.75 0 010 1.06zM8 12.25a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V13a.75.75 0 01.75-.75z"/></svg>
                      <span class="avd-item-text">Light Theme</span>
                      <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.25 1.57a.75.75 0 00-1.5 0V2A6.003 6.003 0 002 8a6.003 6.003 0 004.75 5.87v.56a.75.75 0 001.5 0v-.56A6.003 6.003 0 0014 8a6.003 6.003 0 00-4.75-5.87V1.57zM8 3.5A4.5 4.5 0 003.5 8 4.5 4.5 0 008 12.5 4.5 4.5 0 0012.5 8 4.5 4.5 0 008 3.5z"/></svg>
                      <span class="avd-item-text">English</span>
                      <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg>
                    </button>
                    <div class="avd-divider"></div>
                    <!-- Switch version -->
                    <button class="avd-item avd-item-subtle">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM8 0a8 8 0 100 16A8 8 0 008 0zm.75 4.75a.75.75 0 00-1.5 0v4.5a.75.75 0 001.5 0v-4.5z"/></svg>
                      <span class="avd-item-text">Switch to New Version</span>
                    </button>
                    <div class="avd-divider"></div>
                    <!-- Logout -->
                    <button class="avd-item avd-item-logout">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2 3a1 1 0 011-1h5.5a.75.75 0 010 1.5H3.5v9h5a.75.75 0 010 1.5H3a1 1 0 01-1-1V3z"/><path d="M11.22 4.72a.75.75 0 011.06 0l2.5 2.5a.75.75 0 010 1.06l-2.5 2.5a.75.75 0 01-1.06-1.06l1.22-1.22H6.75a.75.75 0 010-1.5h5.69l-1.22-1.22a.75.75 0 010-1.06z"/></svg>
                      <span class="avd-item-text">Logout</span>
                    </button>
                  </div>
                </div>

                <!-- Theme Submenu Demo -->
                <div class="avd-demo-block">
                  <div style="font-size:12px; font-weight:500; color:var(--text-muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">Theme Submenu</div>
                  <div class="avatar-dropdown" style="position:static; display:flex;">
                    <button class="avd-back">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.53 11.78a.75.75 0 01-1.06 0L5.22 8.53a.75.75 0 010-1.06l3.25-3.25a.75.75 0 011.06 1.06L6.81 8l2.72 2.72a.75.75 0 010 1.06z"/></svg>
                      Back
                    </button>
                    <button class="avd-item active">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 2a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 2zm0 9.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zm5.5-3.75a.75.75 0 010 1.5h-1.5a.75.75 0 010-1.5h1.5zm-10 0a.75.75 0 010 1.5H2a.75.75 0 010-1.5h1.5zm8.19-3.94a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 01-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-7.38 7.38a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm7.38 0a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 011.06-1.06l1.06 1.06zM4.31 5.37a.75.75 0 01-1.06 0L2.19 4.31a.75.75 0 111.06-1.06l1.06 1.06a.75.75 0 010 1.06zM8 12.25a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V13a.75.75 0 01.75-.75z"/></svg>
                      <span class="avd-item-text">Light Theme</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.54 1a.75.75 0 00-.48 1.31 5.25 5.25 0 01-2.37 9.2.75.75 0 00-.3 1.4A7 7 0 0014.95 7.14a.75.75 0 00-.93-.77A5.23 5.23 0 018.54 1z"/></svg>
                      <span class="avd-item-text">Dark Theme</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2zm0 1.5a.5.5 0 00-.5.5v4h4.75V3.5H4zm4.75 5H3.5V12a.5.5 0 00.5.5h4.75V8.5zm1.5-5v9.5H12a.5.5 0 00.5-.5V4a.5.5 0 00-.5-.5h-1.75z"/></svg>
                      <span class="avd-item-text">System Default</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.13 1.72a.75.75 0 011.06.06l2 2.25a.75.75 0 01-.06 1.06l-2 1.75a.75.75 0 11-.99-1.13l.72-.63H6a3.25 3.25 0 100 6.5h5.25a.75.75 0 010 1.5H6a4.75 4.75 0 110-9.5h5.88l-.75-.84a.75.75 0 01.06-1.06z"/></svg>
                      <span class="avd-item-text">My Theme</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                  </div>
                </div>

                <!-- Language Submenu Demo -->
                <div class="avd-demo-block">
                  <div style="font-size:12px; font-weight:500; color:var(--text-muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">Language Submenu</div>
                  <div class="avatar-dropdown" style="position:static; display:flex;">
                    <button class="avd-back">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.53 11.78a.75.75 0 01-1.06 0L5.22 8.53a.75.75 0 010-1.06l3.25-3.25a.75.75 0 011.06 1.06L6.81 8l2.72 2.72a.75.75 0 010 1.06z"/></svg>
                      Back
                    </button>
                    <button class="avd-item active">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.25 1.57a.75.75 0 00-1.5 0V2A6.003 6.003 0 002 8a6.003 6.003 0 004.75 5.87v.56a.75.75 0 001.5 0v-.56A6.003 6.003 0 0014 8a6.003 6.003 0 00-4.75-5.87V1.57zM8 3.5A4.5 4.5 0 003.5 8 4.5 4.5 0 008 12.5 4.5 4.5 0 0012.5 8 4.5 4.5 0 008 3.5z"/></svg>
                      <span class="avd-item-text">English</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">Deutsch</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">Fran&ccedil;ais</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">Espa&ntilde;ol</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">&#26085;&#26412;&#35486;</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                  </div>
                </div>

              </div>
            </div>
          </div>

        </div><!-- /componentsPage -->

        <!-- ==================== REPORTS ==================== -->
        <div id="reportsPage" class="page-view table-page">
          <div class="page-title-row">
            <h1 class="page-title">Reports</h1>
            <button class="btn-outline"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.95 4.05A5.48 5.48 0 0 0 8 2.5 5.5 5.5 0 1 0 13.43 9h1.07A6.5 6.5 0 1 1 8 1.5c1.58 0 3.02.56 4.14 1.5L14 1v4h-4l2.95-0.95Z"/></svg> Refresh</button>
          </div>

          <div class="audit-card">
            <div class="audit-card-header">
              <div class="audit-card-title">
                <h3>Recent Jobs</h3>
                <span class="count">1,256</span>
              </div>
              <div class="audit-card-actions">
                <div class="audit-search">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 2C9.76142 2 12 4.23858 12 7C12 8.11285 11.6353 9.13998 11.0205 9.9707L14.0713 13.0068L14.1221 13.0645C14.3629 13.3585 14.3471 13.7932 14.0732 14.0684C13.781 14.3615 13.3061 14.3622 13.0127 14.0703L9.95801 11.0303C9.12955 11.6393 8.1071 12 7 12C4.23858 12 2 9.76142 2 7C2 4.23858 4.23858 2 7 2ZM7 3.5C5.067 3.5 3.5 5.067 3.5 7C3.5 8.933 5.067 10.5 7 10.5C8.933 10.5 10.5 8.933 10.5 7C10.5 5.067 8.933 3.5 7 3.5Z"/></svg>
                  <input type="text" placeholder="Search for Files or Hash" id="reportsSearchInput">
                </div>
                <button class="audit-filter-btn" title="Advanced Filters">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                </button>
              </div>
            </div>

            <div class="audit-table-scroll table-scroll">
              <table class="data-table" id="reportsTable">
                <thead>
                  <tr>
                    <th class="col-cb"><input type="checkbox" class="cb"></th>
                    <th>Job Name <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Storage Unit</th>
                    <th>Total Files</th>
                    <th>Threats Detected <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Data Loss Prevented</th>
                    <th>Sanitized <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th>Job Type</th>
                    <th class="col-action"></th>
                  </tr>
                </thead>
                <tbody id="reportsTableBody">
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Delta Real-Time Scan</td>
                    <td><span class="tag tag-warn">Stopped</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>133,659</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 178</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 178</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 45</span></td>
                    <td>Real-Time Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Orion Full Scan</td>
                    <td><span class="tag tag-warn">Stopped</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>133,659</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 123</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 123</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 12</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Scheduled File Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>131,649</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Realtime Malware Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>130,159</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Scheduled DLP Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>129,159</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>On-Demand Malware Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>110,159</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 1,957</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 1,957</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 1,957</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Scheduled GDPR Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>110,003</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Delta Vulnerability Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>110,003</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 356</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 356</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 356</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Full Storage Scan</td>
                    <td><span class="tag tag-alert">Failed</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>110,017</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Manual File Upload</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>97,123</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Cloud Backup Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>89,421</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 89</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 89</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 34</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Compliance Audit Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>76,302</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Weekly Incremental Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>68,944</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 412</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 412</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 201</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Archive Deep Scan</td>
                    <td><span class="tag tag-warn">Stopped</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>54,210</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 67</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Real-Time Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Email Attachment Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>45,887</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>PII Detection Scan</td>
                    <td><span class="tag tag-alert">Failed</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>38,500</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 2,104</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Nightly CDR Process</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>31,204</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 1,847</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Document Library Scan</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>24,650</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 15</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 15</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 8</span></td>
                    <td>Scan Now</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Shared Drive Monitor</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>19,832</td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td><span class="rpt-verdict none"><span class="rpt-dot"></span> None</span></td>
                    <td>Real-Time Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                  <tr>
                    <td class="col-cb"><input type="checkbox" class="cb"></td>
                    <td>Quarantine Review</td>
                    <td><span class="tag tag-success">Complete</span></td>
                    <td><div class="inv-provider"><span class="inv-provider-icon aws"><span style="font-size:8px;letter-spacing:-0.5px;">aws</span></span> Storage Unit Name</div></td>
                    <td>12,100</td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 743</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 743</span></td>
                    <td><span class="rpt-verdict detected"><span class="rpt-dot"></span> 512</span></td>
                    <td>Scheduled Scan</td>
                    <td class="col-action"><button class="cell-action"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg></button></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="audit-pagination">
              <div class="audit-pagination-left">
                <select id="reportsPerPage">
                  <option>10</option>
                  <option selected>20</option>
                  <option>50</option>
                  <option>100</option>
                </select>
                <span>items per page</span>
                <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                <span id="reportsPageInfo" style="margin-left: 8px;">1-20 of 1,256 items</span>
              </div>
              <div class="audit-pagination-right">
                <button class="audit-page-btn" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99994 12.9995C9.80994 12.9995 9.61994 12.9295 9.46994 12.7795L5.21994 8.52945C4.92994 8.23945 4.92994 7.75945 5.21994 7.46945L9.46994 3.21945C9.75994 2.92945 10.2399 2.92945 10.5299 3.21945C10.8199 3.50945 10.8199 3.98945 10.5299 4.27945L6.80994 7.99945L10.5299 11.7195C10.8199 12.0095 10.8199 12.4895 10.5299 12.7795C10.3799 12.9295 10.1899 12.9995 9.99994 12.9995Z"/></svg></button>
                <select class="audit-page-select">
                  <option selected>Page 1</option>
                  <option>Page 2</option>
                  <option>Page 3</option>
                  <option>Page 4</option>
                  <option>Page 5</option>
                  <option>Page 6</option>
                  <option>Page 7</option>
                  <option>Page 8</option>
                  <option>Page 9</option>
                  <option>Page 10</option>
                  <option>Page 11</option>
                  <option>Page 12</option>
                  <option>Page 13</option>
                  <option>Page 14</option>
                  <option>Page 15</option>
                  <option>Page 16</option>
                  <option>Page 17</option>
                  <option>Page 18</option>
                  <option>Page 19</option>
                  <option>Page 20</option>
                  <option>Page 21</option>
                  <option>Page 22</option>
                  <option>Page 23</option>
                  <option>Page 24</option>
                  <option>Page 25</option>
                  <option>Page 26</option>
                  <option>Page 27</option>
                  <option>Page 28</option>
                  <option>Page 29</option>
                  <option>Page 30</option>
                  <option>Page 31</option>
                  <option>Page 32</option>
                  <option>Page 33</option>
                  <option>Page 34</option>
                  <option>Page 35</option>
                  <option>Page 36</option>
                  <option>Page 37</option>
                  <option>Page 38</option>
                  <option>Page 39</option>
                  <option>Page 40</option>
                  <option>Page 41</option>
                  <option>Page 42</option>
                  <option>Page 43</option>
                  <option>Page 44</option>
                  <option>Page 45</option>
                  <option>Page 46</option>
                  <option>Page 47</option>
                  <option>Page 48</option>
                  <option>Page 49</option>
                  <option>Page 50</option>
                  <option>Page 51</option>
                  <option>Page 52</option>
                  <option>Page 53</option>
                  <option>Page 54</option>
                  <option>Page 55</option>
                  <option>Page 56</option>
                  <option>Page 57</option>
                  <option>Page 58</option>
                  <option>Page 59</option>
                  <option>Page 60</option>
                  <option>Page 61</option>
                  <option>Page 62</option>
                  <option>Page 63</option>
                </select>
                <button class="audit-page-btn"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.99994 12.9995C6.18994 12.9995 6.37994 12.9295 6.52994 12.7795L10.7799 8.52945C11.0699 8.23945 11.0699 7.75945 10.7799 7.46945L6.52994 3.21945C6.23994 2.92945 5.75994 2.92945 5.46994 3.21945C5.17994 3.50945 5.17994 3.98945 5.46994 4.27945L9.18994 7.99945L5.46994 11.7195C5.17994 12.0095 5.17994 12.4895 5.46994 12.7795C5.61994 12.9295 5.80994 12.9995 5.99994 12.9995Z"/></svg></button>
              </div>
            </div>
          </div>
        </div><!-- /reportsPage -->

      </main>
    </div>
  </div>

  <!-- Reusable Notification Toast (top-right) -->
  <div class="top-toast" id="notificationToast" role="alert" aria-live="assertive">
    <div class="top-toast-icon">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm-.5 4v5h1V5h-1zm0 6v1h1v-1h-1z"/></svg>
    </div>
    <div class="top-toast-content">
      <div class="top-toast-title"></div>
      <div class="top-toast-desc"></div>
    </div>
    <div class="top-toast-close" onclick="dismissNotification()">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.7647 3.168C12.0591 2.928 12.4939 2.945 12.7686 3.22C13.043 3.494 13.0601 3.928 12.8203 4.223L12.7686 4.28L9.0615 7.989L12.7725 11.696L12.8242 11.753C13.0644 12.047 13.0469 12.482 12.7725 12.757C12.4797 13.05 12.0049 13.05 11.7119 12.757L8.002 9.05L4.296 12.761L4.239 12.813C3.945 13.053 3.51 13.035 3.235 12.761C2.943 12.468 2.943 11.993 3.235 11.7L6.941 7.99L3.231 4.284L3.18 4.228C2.94 3.933 2.957 3.498 3.231 3.224C3.506 2.949 3.94 2.932 4.234 3.172L4.292 3.224L8.001 6.93L11.708 3.22L11.7647 3.168Z"/></svg>
    </div>
  </div>

  <!-- Column Dropdown (Sorting / Pinning) -->
  <div class="col-dropdown" id="colDropdown">
    <div class="col-dropdown-section">
      <div class="col-dropdown-section-title">Sorting</div>
    </div>
    <div class="col-dropdown-item" data-action="sort-asc">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.8 6.74L8.55 2.24C8.41 2.1 8.22 2.01 8.01 2.01C7.8 2.01 7.61 2.1 7.47 2.24L3.21 6.74C2.92 7.04 2.94 7.52 3.24 7.8C3.54 8.09 4.02 8.07 4.3 7.77L7.26 4.64V12.75C7.26 13.16 7.6 13.5 8.01 13.5C8.42 13.5 8.76 13.16 8.76 12.75V4.64L11.72 7.77C11.87 7.93 12.07 8.01 12.26 8.01C12.44 8.01 12.63 7.94 12.77 7.8C13.07 7.52 13.09 7.04 12.8 6.74Z"/></svg>
      Ascending
    </div>
    <div class="col-dropdown-item" data-action="sort-desc">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.76 7.96C12.46 7.67 11.98 7.69 11.7 7.99L8.74 11.12V3C8.74 2.59 8.4 2.25 7.99 2.25C7.58 2.25 7.24 2.59 7.24 3V11.11L4.28 7.98C4 7.68 3.52 7.66 3.22 7.95C2.92 8.23 2.9 8.71 3.19 9.01L7.44 13.51C7.5 13.57 7.57 13.62 7.65 13.66C7.66 13.66 7.67 13.68 7.69 13.68C7.78 13.72 7.88 13.74 7.98 13.74C8.08 13.74 8.18 13.72 8.27 13.68C8.28 13.68 8.29 13.66 8.31 13.66C8.39 13.62 8.46 13.58 8.52 13.51L12.77 9.01C13.06 8.71 13.04 8.23 12.74 7.95L12.76 7.96Z"/></svg>
      Descending
    </div>
    <div class="col-dropdown-divider"></div>
    <div class="col-dropdown-item" data-action="pin">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14 11L12.3 8.45C12.11 8.17 11.8 8 11.47 8H10.01V3.72C10.61 3.37 11.01 2.74 11.01 2H5C5 2.74 5.4 3.38 6 3.72V8H4.54C4.21 8 3.89 8.17 3.71 8.45L2.01 11H7.26V14L8.01 15L8.76 14V11H14.01H14Z"/></svg>
      Pin Column
    </div>
  </div>

  <!-- Row action menu (global, positioned via JS) -->
  <div class="row-action-menu" id="rowActionMenu">
    <div class="row-action-menu-item" data-action="view">View Details</div>
    <div class="row-action-menu-item" data-action="edit">Edit</div>
    <div class="row-action-menu-item" data-action="duplicate">Duplicate</div>
    <div class="row-action-menu-divider"></div>
    <div class="row-action-menu-item danger" data-action="delete">Delete</div>
  </div>

  <!-- ==================== WORKFLOW SLIDE PANELS ==================== -->

  <!-- Create Workflow -->
  <div class="slide-panel-overlay" id="createWorkflowOverlay" onclick="closeSlidePanel('createWorkflowPanel')"></div>
  <div class="slide-panel" id="createWorkflowPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Create Workflow</h2><button class="modal-close" onclick="closeSlidePanel('createWorkflowPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <p style="font-size:13px; color:var(--text-subtle); margin-bottom:12px;">Create a new workflow to automate your processes. It can be used when instantiating a scan. <a href="#" style="color:var(--primary);">Learn more</a></p>
      <div class="panel-field"><label class="panel-field-label">Workflow Name</label><input class="input-field" placeholder="e.g. Weekly Scan" style="width:100%;"></div>
      <div class="panel-field"><span class="panel-field-label">Workflow Type</span>
        <div class="radio-group" style="flex-direction:column; gap:8px;">
          <label class="radio-option"><input type="radio" name="wfType" checked><span>Standard (with scanning)</span></label>
          <label class="radio-option"><input type="radio" name="wfType"><span>Discovery only</span></label>
        </div>
      </div>
      <div style="font-size:14px; font-weight:500; color:var(--text-strong); margin:16px 0 8px;">Scan Configuration</div>
      <div class="panel-field"><label class="panel-field-label">Scan Pool</label><select class="select-field" style="width:100%;"><option>Default MD Core Scan Pool</option></select></div>
      <div class="panel-field"><label class="panel-field-label">Rule</label><select class="select-field" style="width:100%;"><option>MetaDefender Software Supply Chain</option></select></div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('createWorkflowPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Discovery -->
  <div class="slide-panel-overlay" id="wfDiscoveryOverlay" onclick="closeSlidePanel('wfDiscoveryPanel')"></div>
  <div class="slide-panel" id="wfDiscoveryPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Discovery</h2><button class="modal-close" onclick="closeSlidePanel('wfDiscoveryPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <p style="font-size:13px; color:var(--text-subtle); margin-bottom:16px;">File discovery continuously scans your storage to detect files that need processing. This is always enabled to ensure all files are identified for remediation.</p>
      <div style="font-size:14px; font-weight:500; color:var(--text-strong); margin-bottom:8px;">Discovery</div>
      <p style="font-size:13px; color:var(--text-subtle); margin-bottom:12px;">Identity scanning uses file metadata to identify files that have already been processed. When enabled, MDSS reuses previous scan results for unchanged files instead of re-scanning them, significantly improving performance for backup datasets and subsequent scans.</p>
      <div style="display:flex; align-items:center; gap:8px; margin-bottom:4px;">
        <label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label>
        <span style="font-size:14px; color:var(--text-strong);">Disabled</span>
      </div>
      <p style="font-size:12px; color:var(--primary);">Identity scanning is disabled because Deep CDR is enabled.</p>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfDiscoveryPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Scan Configuration -->
  <div class="slide-panel-overlay" id="wfScanConfigOverlay" onclick="closeSlidePanel('wfScanConfigPanel')"></div>
  <div class="slide-panel" id="wfScanConfigPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Scan Configuration</h2><button class="modal-close" onclick="closeSlidePanel('wfScanConfigPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <div class="panel-banner warning"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 00-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 01-1.1 0L7.1 5.995A.905.905 0 018 5zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></svg><div>Changes made to the workflow in MetaDefender Core, Cloud or Cluster will affect the functionality of MetaDefender Storage Security<br><a onclick="event.preventDefault();">Dismiss</a></div></div>
      <p style="font-size:13px; color:var(--text-subtle); margin-bottom:16px;">MetaDefender for Secure Storage uses scan pools to group MetaDefender Core or Cloud instances.</p>
      <div class="panel-field"><label class="panel-field-label">Scan Pool</label><select class="select-field" style="width:100%;"><option>MetaDefender Core Demo</option><option>MetaDefender Cloud Demo</option></select></div>
      <div style="margin:8px 0 16px;"><label class="radio-option" style="font-size:13px;"><input type="checkbox"><span>Failover to secondary scan pool</span></label></div>
      <div class="panel-field"><label class="panel-field-label" style="color:var(--primary);">Failover Scan Pool</label><select class="select-field" style="width:100%;"><option>Not Available</option></select></div>
      <div class="panel-field"><label class="panel-field-label">User Agent</label><div style="display:flex;align-items:center;gap:8px;"><input class="input-field" value="mdss" style="flex:1;"><button style="background:none;border:none;cursor:pointer;color:var(--text-muted);font-size:16px;">✕</button></div></div>
      <div class="panel-field"><label class="panel-field-label">Workflow Rule</label><div style="display:flex;align-items:center;gap:8px;"><input class="input-field" value="MDSS Full" style="flex:1;"><button style="background:none;border:none;cursor:pointer;color:var(--text-muted);font-size:16px;">✕</button></div></div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfScanConfigPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Technologies -->
  <div class="slide-panel-overlay" id="wfTechnologiesOverlay" onclick="closeSlidePanel('wfTechnologiesPanel')"></div>
  <div class="slide-panel" id="wfTechnologiesPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Technologies</h2><button class="modal-close" onclick="closeSlidePanel('wfTechnologiesPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <div class="panel-banner warning"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 00-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 01-1.1 0L7.1 5.995A.905.905 0 018 5zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></svg><div>Changes made in MetaDefender Core, Cloud or Cluster will affect the functionality of MetaDefender Storage Security<br><a onclick="event.preventDefault();">Refresh</a></div></div>
      <div class="wf-tech-item"><div class="wf-tech-name">MetaScan™</div><div class="wf-tech-desc">30+ anti-malware engine threat detection.</div><div class="wf-tech-status"><span class="tag-success" style="font-size:12px; padding:2px 8px;">Active</span></div></div>
      <div class="wf-tech-item"><div class="wf-tech-name">Adaptive Sandbox</div><div class="wf-tech-desc">Dynamic file analysis and behavioral threat detection.</div><div class="wf-tech-status"><span style="font-size:13px; color:var(--text-muted);">Disabled</span></div></div>
      <div class="wf-tech-item"><div class="wf-tech-name">Deep CDR™</div><div class="wf-tech-desc">Dynamic file analysis and behavioral threat detection.</div><div class="wf-tech-status"><span class="tag-caution" style="font-size:12px; padding:2px 8px;">Unknown</span></div><p style="font-size:12px; color:var(--text-subtle); margin-top:4px;">Status cannot be determined due to missing or incomplete configuration.</p><a href="#" style="font-size:13px; color:var(--primary);">Go to MetaDefender Core</a></div>
      <div class="wf-tech-item"><div class="wf-tech-name">Proactive DLP™</div><div class="wf-tech-desc">Proactive data loss detection and prevention.</div><div class="wf-tech-status"><span class="tag-success" style="font-size:12px; padding:2px 8px;">Active</span></div></div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfTechnologiesPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- File Tagging -->
  <div class="slide-panel-overlay" id="wfFileTaggingOverlay" onclick="closeSlidePanel('wfFileTaggingPanel')"></div>
  <div class="slide-panel" id="wfFileTaggingPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>File Tagging</h2><button class="modal-close" onclick="closeSlidePanel('wfFileTaggingPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <div style="display:flex; align-items:center; gap:8px; margin-bottom:4px;"><label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label><span style="font-size:14px; color:var(--text-strong);">Disabled</span></div>
      <p style="font-size:12px; color:var(--text-subtle); margin-bottom:16px;">Labels processed files with security status (clean, sanitized, blocked) to support compliance and audit requirements.</p>
      <div class="wf-tag-group">
        <div class="wf-tag-check"><input type="checkbox" id="wfTagResult" checked><label for="wfTagResult">Add MetaDefender Result Tag</label></div>
        <div class="wf-tag-fields"><div class="wf-tag-field-label">MetaDefender Result</div><div class="wf-tag-field-value">OPSWAT-Core-Result</div><div class="wf-show-verdicts" onclick="toggleWfVerdicts()">Show Verdicts</div><div class="wf-verdicts" id="wfVerdictsBlock" style="display:none;"><div class="wf-verdict-row"><div class="wf-verdict-label">No Threat Detected</div><div class="wf-verdict-input">No Threat Detected <span class="clear-x">✕</span></div></div><div class="wf-verdict-row"><div class="wf-verdict-label">Infected</div><div class="wf-verdict-input">Infected <span class="clear-x">✕</span></div></div><div class="wf-verdict-row"><div class="wf-verdict-label">Suspicious</div><div class="wf-verdict-input">Suspicious <span class="clear-x">✕</span></div></div><div class="wf-verdict-row"><div class="wf-verdict-label">Allowlisted</div><div class="wf-verdict-input">Allowlisted <span class="clear-x">✕</span></div></div><div class="wf-verdict-row"><div class="wf-verdict-label">Blocklisted</div><div class="wf-verdict-input">Blocklisted <span class="clear-x">✕</span></div></div><div class="wf-verdict-row"><div class="wf-verdict-label">Potentially Vulnerable File</div><div class="wf-verdict-input">Potentially Vulnerable File <span class="clear-x">✕</span></div></div><div class="wf-verdict-row"><div class="wf-verdict-label">Sensitive Data Found</div><div class="wf-verdict-input">Sensitive Data Found <span class="clear-x">✕</span></div></div></div></div>
      </div>
      <div class="wf-tag-group">
        <div class="wf-tag-check"><input type="checkbox" id="wfTagFileId" checked><label for="wfTagFileId">Add File ID</label></div>
        <div class="wf-tag-fields"><div class="wf-tag-field-label">MetaDefender File Id</div><div class="wf-tag-field-value">MetaDefenderFileId</div></div>
      </div>
      <div class="wf-tag-group">
        <div class="wf-tag-check"><input type="checkbox" id="wfTagTimestamp" checked><label for="wfTagTimestamp">Add Timestamp</label></div>
        <div class="wf-tag-fields"><div class="wf-tag-field-label">MetaDefender Analysis Timestamp</div><div class="wf-tag-field-value">MetaDefenderAnalysisTimestamp</div></div>
      </div>
      <div style="display:flex; align-items:center; gap:6px; margin-top:12px; cursor:pointer; color:var(--text-subtle); font-size:13px;"><svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;"><path d="M8 3a5 5 0 100 10A5 5 0 008 3zM2 8a6 6 0 1112 0A6 6 0 012 8zm4.5-1.5l3 1.5-3 1.5v-3z"/></svg> Reset to Default</div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfFileTaggingPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Deep CDR -->
  <div class="slide-panel-overlay" id="wfDeepCdrOverlay" onclick="closeSlidePanel('wfDeepCdrPanel')"></div>
  <div class="slide-panel" id="wfDeepCdrPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Deep CDR</h2><button class="modal-close" onclick="closeSlidePanel('wfDeepCdrPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <p style="font-size:13px; color:var(--text-subtle); margin-bottom:16px;">File regeneration that protects from evasive malware and zero-day exploits.</p>
      <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;"><label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label><span style="font-size:14px; color:var(--text-strong);">Disabled</span></div>
      <p style="font-size:12px; color:var(--text-subtle);">File regeneration that protects from evasive malware and zero-day exploits.</p>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfDeepCdrPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- File Definition -->
  <div class="slide-panel-overlay" id="wfFileDefOverlay" onclick="closeSlidePanel('wfFileDefPanel')"></div>
  <div class="slide-panel" id="wfFileDefPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>File Definition</h2><button class="modal-close" onclick="closeSlidePanel('wfFileDefPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <div style="font-size:14px; font-weight:500; color:var(--text-strong); margin-bottom:16px;">Blocked files definition</div>
      <div class="radio-group" style="flex-direction:column; gap:16px;">
        <label class="radio-option" style="align-items:flex-start;"><input type="radio" name="wfFileDef" checked style="margin-top:3px;"><div><span style="font-weight:500;">Strict mode</span><p style="font-size:12px; color:var(--text-subtle); margin-top:4px;">When enabled, files blocked by MetaDefender Core for any reason (malware, encryption, blocklist) remain blocked in Storage Security.</p></div></label>
        <label class="radio-option" style="align-items:flex-start;"><input type="radio" name="wfFileDef" style="margin-top:3px;"><div><span style="font-weight:500;">Configurable mode</span><p style="font-size:12px; color:var(--text-subtle); margin-top:4px;">Override Core verdicts by category. Enable or disable blocking for malicious files, sensitive data violations, and vulnerability detections independently.</p>
          <div style="margin-top:12px; display:flex; flex-direction:column; gap:8px; padding-left:4px;">
            <label class="radio-option" style="opacity:0.5;"><input type="checkbox" disabled><span style="font-size:13px;">Files with malicious content</span></label>
            <p style="font-size:11px; color:var(--text-muted); margin-left:24px;">Any file marked Infected, Suspicious or Blocklisted by MetaDefender Core / Distributed Cluster will be considered malicious in MetaDefender Storage Security</p>
            <label class="radio-option" style="opacity:0.5;"><input type="checkbox" disabled><span style="font-size:13px;">Treat files with sensitive data as blocked</span></label>
            <label class="radio-option" style="opacity:0.5;"><input type="checkbox" disabled><span style="font-size:13px;">Treat files with vulnerabilities as blocked</span></label>
          </div>
        </div></label>
      </div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfFileDefPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Remediations -->
  <div class="slide-panel-overlay" id="wfRemediationsOverlay" onclick="closeSlidePanel('wfRemediationsPanel')"></div>
  <div class="slide-panel" id="wfRemediationsPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Allowed Original Files - Remediations</h2><button class="modal-close" onclick="closeSlidePanel('wfRemediationsPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <div class="wf-rem-option"><div class="wf-rem-radio"><input type="radio" name="wfRem" id="wfRemKeep"><label for="wfRemKeep">Keep</label></div></div>
      <div class="wf-rem-option"><div class="wf-rem-radio"><input type="radio" name="wfRem" id="wfRemCopy" checked><label for="wfRemCopy">Copy</label></div>
        <div class="wf-rem-content">
          <div style="font-size:13px; color:var(--text-subtle); margin-bottom:8px;">Selected storage unit</div>
          <div class="wf-storage-tags">
            <span class="wf-storage-tag">Storage Unit 1 <span class="remove-x">✕</span></span>
            <span class="wf-storage-tag">Storage Unit 2 <span class="remove-x">✕</span></span>
            <span style="display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:var(--primary);color:#fff;font-size:10px;font-weight:700;">5</span>
            <span style="margin-left:auto;display:flex;gap:4px;"><button style="background:none;border:none;cursor:pointer;color:var(--text-muted);font-size:14px;">✕</button><select class="select-field" style="height:28px;font-size:12px;padding:0 24px 0 6px;"><option>▾</option></select></span>
          </div>
          <div class="panel-banner warning" style="padding:8px 10px; font-size:12px;"><svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 10.5a.75.75 0 110-1.5.75.75 0 010 1.5zM8.75 8a.75.75 0 01-1.5 0V5a.75.75 0 011.5 0v3z"/></svg><span>You can only configure a maximum of 5 storage units as destinations</span></div>
          <div style="font-size:13px; font-weight:500; color:var(--text-strong); margin:12px 0 8px;">Keep folder structure</div>
          <div class="wf-folder-check"><label>Storage Unit 1</label><input type="checkbox" checked></div>
          <div class="wf-folder-check"><label>Storage Unit 2</label><input type="checkbox" checked></div>
          <div class="wf-folder-check"><label>Storage Unit 3</label><input type="checkbox" checked></div>
          <div class="wf-folder-check"><label>Storage Unit 4</label><input type="checkbox" checked></div>
          <div class="wf-folder-check"><label>Storage Unit 5</label><input type="checkbox" checked></div>
        </div>
      </div>
      <div class="wf-rem-option"><div class="wf-rem-radio"><input type="radio" name="wfRem" id="wfRemMove"><label for="wfRemMove">Move</label></div>
        <div class="wf-rem-content" style="display:none;"><div style="font-size:13px; color:var(--text-subtle); margin-bottom:8px;">Selected storage unit</div><select class="select-field" style="width:100%;"><option>Choose up to 5 storage units</option></select></div>
      </div>
      <div class="wf-rem-option"><div class="wf-rem-radio"><input type="radio" name="wfRem" id="wfRemDelete"><label for="wfRemDelete">Delete</label></div></div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfRemediationsPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Other Remediations -->
  <div class="slide-panel-overlay" id="wfOtherRemOverlay" onclick="closeSlidePanel('wfOtherRemPanel')"></div>
  <div class="slide-panel" id="wfOtherRemPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header"><h2>Other Remediations</h2><button class="modal-close" onclick="closeSlidePanel('wfOtherRemPanel')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg></button></div>
    <div class="slide-panel-body">
      <div class="panel-banner warning"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 00-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 01-1.1 0L7.1 5.995A.905.905 0 018 5zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></svg><div>You cannot enable delete empty folders remediation if you don't have any move or delete remediations configured<br><a onclick="event.preventDefault();">Dismiss</a></div></div>
      <div style="margin-bottom:20px;">
        <div style="font-size:14px; font-weight:500; color:var(--text-strong); margin-bottom:4px;">Delete Directories</div>
        <p style="font-size:12px; color:var(--text-subtle); margin-bottom:8px;">If it is empty after remediation (does not delete if the folder was empty to begin with) delete it.</p>
        <div style="display:flex; align-items:center; gap:8px;"><label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label><span style="font-size:14px; color:var(--text-strong);">Disabled</span></div>
        <p style="font-size:11px; color:var(--text-subtle); margin-top:4px;">File versioning is only supported by the following storage types: SharePoint On-Prem</p>
      </div>
      <div>
        <div style="font-size:14px; font-weight:500; color:var(--text-strong); margin-bottom:4px;">Scan File Versions</div>
        <p style="font-size:12px; color:var(--text-subtle); margin-bottom:8px;">File versioning is only supported by the following storage types: SharePoint On-Prem</p>
        <div style="display:flex; align-items:center; gap:8px;"><label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label><span style="font-size:14px; color:var(--text-strong);">Disabled</span></div>
      </div>
    </div>
    <div class="slide-panel-footer"><button class="btn-outline" onclick="closeSlidePanel('wfOtherRemPanel')">Cancel</button><button class="btn-primary">Save Changes</button></div>
  </div>

  <!-- Toast (bottom-right snackbar) -->
  <div class="toast" id="toast"></div>

  <!-- ==================== ACTIVATE NEW LICENSE MODAL ==================== -->
  <div class="modal-overlay" id="addLicenseModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-labelledby="addLicenseModalTitle" aria-modal="true">
      <div class="modal-header">
        <h2 id="addLicenseModalTitle">Activate License</h2>
        <button class="modal-close" aria-label="Close dialog" onclick="closeModal('addLicenseModal')">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
        </button>
      </div>
      <div class="radio-group" data-radio-group="license-activation-type">
        <label class="radio-option selected" onclick="showLicenseMode('online')">
          <div class="radio-circle"></div>
          <span class="radio-label">Online Activation</span>
        </label>
        <label class="radio-option" onclick="showLicenseMode('offline')">
          <div class="radio-circle"></div>
          <span class="radio-label">Offline Activation</span>
        </label>
      </div>
      <div class="modal-divider"></div>

      <!-- Online Activation Mode -->
      <div class="modal-body" id="licenseOnlineMode">
        <div class="modal-field">
          <label class="modal-field-label" for="licenseKeyInput">License Key</label>
          <div class="input-field" style="max-width:none;">
            <input type="password" id="licenseKeyInput" value="" placeholder="Enter your license key" style="flex:1;" onfocus="prefillLicenseKey(this)">
            <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
          </div>
        </div>
      </div>

      <!-- Offline Activation Mode -->
      <div class="modal-body" id="licenseOfflineMode" style="display:none;">
        <div class="modal-instructions">
          <strong>Copy down your Deployment ID</strong><br><br>
          Go to <a href="#">my.opswat.com</a><br><br>
          Activate and download your license file<br>
          You will need your activation key and the Deployment ID<br><br>
          Upload the license file below
        </div>
        <div class="modal-field">
          <label class="modal-field-label">Deployment ID</label>
          <div class="input-field" style="max-width:none;">
            <input type="text" value="MDSShV4GCrt5ByrTC2V6pD0B8Ea0yBa6WCv3" readonly style="flex:1; color:var(--text-subtle);">
            <button class="copy-btn" aria-label="Copy Deployment ID" onclick="navigator.clipboard?.writeText(this.previousElementSibling.value); showNotification('success', 'Description copied')">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg>
            </button>
          </div>
        </div>
        <div class="modal-field">
          <label class="modal-field-label">License Key File</label>
          <div class="file-upload-field" onclick="this.querySelector('input').click()" tabindex="0" role="button">
            <input type="file" onchange="handleFileUpload(this)">
            <span class="file-upload-text">Select file</span>
            <span class="file-upload-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1v10M4 7l4 4 4-4M2 13h12v2H2z"/></svg></span>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-outline" onclick="closeModal('addLicenseModal')">Cancel</button>
        <button class="btn-primary" onclick="activateLicense()">Activate</button>
      </div>
    </div>
  </div>

  <!-- ==================== ADVANCED FILTERS DRAWER ==================== -->
  <div class="advanced-filters-overlay" id="advancedFiltersOverlay"></div>
  <div class="advanced-filters-panel" id="advancedFiltersPanel">
    <div class="af-header">
      <h3>Advanced Filters</h3>
      <button class="af-close" onclick="closeAdvancedFilters()"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.7647 3.16797C12.0591 2.92776 12.4939 2.94534 12.7686 3.21973C13.043 3.49412 13.0601 3.92806 12.8203 4.22266L12.7686 4.28028L9.06153 7.98926L12.7725 11.6963L12.8242 11.7529C13.0644 12.0474 13.0469 12.4822 12.7725 12.7568C12.4797 13.0496 12.0049 13.0495 11.7119 12.7568L8.00196 9.04981L4.2959 12.7607L4.23926 12.8125C3.9448 13.0527 3.51 13.0351 3.23536 12.7607C2.94258 12.468 2.94268 11.9931 3.23536 11.7002L6.94141 7.99024L3.23145 4.28418L3.17969 4.22754C2.93948 3.93308 2.95706 3.49828 3.23145 3.22364C3.50584 2.94924 3.93978 2.93206 4.23438 3.17188L4.292 3.22364L8.00098 6.92969L11.708 3.21973L11.7647 3.16797Z"/></svg></button>
    </div>
    <div class="af-body">
      <div class="af-field">
        <span class="af-field-label">Category</span>
        <select id="afCategory">
          <option selected>All Categories</option>
          <option>Scan Activity</option>
          <option>Settings</option>
          <option>Authentication</option>
        </select>
      </div>
      <div class="af-field">
        <span class="af-field-label">Level</span>
        <select id="afLevel">
          <option selected>All Levels</option>
          <option>Warning</option>
          <option>Error</option>
          <option>Info</option>
        </select>
      </div>
      <div class="af-field">
        <span class="af-field-label">Time Format</span>
        <select id="afTimeFormat">
          <option selected>Local</option>
          <option>UTC</option>
        </select>
      </div>
    </div>
    <div class="af-footer">
      <span class="af-footer-info">134,785 files meet the filter criteria.</span>
      <div class="af-footer-actions">
        <button class="btn-outline" onclick="closeAdvancedFilters()">Revert</button>
        <button class="btn-primary" onclick="applyAdvancedFilters()">Apply</button>
      </div>
    </div>
  </div>

  <!-- ==================== UNSAVED CHANGES MODAL ==================== -->
  <div class="modal-overlay" id="unsavedModal" aria-hidden="true">
    <div class="modal" role="alertdialog" aria-labelledby="unsavedModalTitle" aria-describedby="unsavedModalDesc" aria-modal="true" style="width:420px;">
      <div class="modal-header">
        <h2 id="unsavedModalTitle">Unsaved Changes</h2>
        <button class="modal-close" aria-label="Close dialog" onclick="closeModal('unsavedModal')">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
        </button>
      </div>
      <p id="unsavedModalDesc" style="font-size:14px; color:var(--text-subtle); line-height:1.5; margin-bottom:20px;">
        You have unsaved changes on the page you are about to leave. Are you sure you want to continue?
      </p>
      <div class="modal-footer" style="border-top:none; padding-top:0; margin-top:0;">
        <button class="btn-outline" onclick="closeModal('unsavedModal')">Stay on Page</button>
        <button class="btn-primary" onclick="closeModal('unsavedModal'); showToast('Changes discarded')">Leave Anyway</button>
      </div>
    </div>
  </div>

  <!-- ==================== ADD COLLECTOR SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addCollectorOverlay" onclick="closeSlidePanel('addCollectorPanel')"></div>
  <div class="slide-panel" id="addCollectorPanel" role="dialog" aria-labelledby="addCollectorTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addCollectorTitle">Add Collector</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addCollectorPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <label class="panel-field-label" for="collectorName">Collector Name</label>
        <div class="input-field"><input type="text" id="collectorName" placeholder="Enter name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="collectorEndpoint">Metric Endpoint URL</label>
        <div class="input-field"><input type="text" id="collectorEndpoint" placeholder="Enter URL"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="collectorApiKey">Metric API Key</label>
        <div class="input-field">
          <input type="password" id="collectorApiKey" placeholder="Enter API Key">
          <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
        </div>
      </div>
      <div class="panel-field">
        <span class="panel-field-label">Metric Protocol</span>
        <div class="radio-group" data-radio-group="collector-protocol">
          <label class="radio-option selected">
            <div class="radio-circle"></div>
            <span class="radio-label">gRPC</span>
          </label>
          <label class="radio-option">
            <div class="radio-circle"></div>
            <span class="radio-label">HTTP/Protobuf</span>
          </label>
          <label class="radio-option">
            <div class="radio-circle"></div>
            <span class="radio-label">HTTP / JSON</span>
          </label>
        </div>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addCollectorPanel')">Cancel</button>
      <button class="btn-primary" onclick="addCollectorRow()">Add Collector</button>
    </div>
  </div>

  <!-- ==================== ADD EXTERNAL LOGGER SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addLoggerOverlay" onclick="closeSlidePanel('addLoggerPanel')"></div>
  <div class="slide-panel" id="addLoggerPanel" role="dialog" aria-labelledby="addLoggerTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addLoggerTitle">Add External Logger</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addLoggerPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <div style="display:flex; align-items:center; gap:12px;">
          <span class="panel-field-label" style="margin:0;">Status</span>
          <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
          <div class="toggle-switch" role="switch" aria-checked="false" tabindex="0" aria-label="Logger status"><div class="toggle-thumb"></div></div>
          <span class="toggle-label">Enabled</span>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerType">Integration Type</label>
        <select class="select-field" id="loggerType" style="max-width:none;">
          <option selected>Syslog UDP Integration</option>
          <option>Syslog TCP Integration</option>
          <option>Syslog TLS Integration</option>
        </select>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerAddress">Server Address</label>
        <div class="input-field"><input type="text" id="loggerAddress" value="5.5.5.5"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerPort">Server Point</label>
        <div class="input-field"><input type="text" id="loggerPort" placeholder="Enter API Key"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerFacility">Facility</label>
        <select class="select-field" id="loggerFacility" style="max-width:none;">
          <option selected>User Level Messages</option>
          <option>Local0</option>
          <option>Local1</option>
          <option>Local2</option>
        </select>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerFormat">Output Format</label>
        <select class="select-field" id="loggerFormat" style="max-width:none;">
          <option selected>RFC5424</option>
          <option>RFC3164</option>
          <option>JSON</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addLoggerPanel')">Discard</button>
      <button class="btn-primary" onclick="addLoggerRow()">Add Instance</button>
    </div>
  </div>

  <!-- ==================== ADD SCAN POOL SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addScanPoolOverlay" onclick="closeSlidePanel('addScanPoolPanel')"></div>
  <div class="slide-panel" id="addScanPoolPanel" role="dialog" aria-labelledby="addScanPoolTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addScanPoolTitle">Add Scan Pool</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addScanPoolPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolName">Name</label>
        <div class="input-field"><input type="text" id="scanPoolName" placeholder="Enter pool name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolType">Type</label>
        <select class="select-field" id="scanPoolType" style="max-width:none;">
          <option selected>MetaDefender Core</option>
          <option>MetaDefender Cloud</option>
        </select>
      </div>
      <hr style="border:none; border-top:1px solid var(--border-200); margin:0;">
      <div class="panel-field">
        <label class="panel-field-label" style="display:flex; align-items:baseline; gap:6px;">Add Scan Instance <span style="font-weight:400; color:var(--text-muted); font-size:14px;">(optional)</span></label>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolUrl">URL</label>
        <div class="input-field"><input type="text" id="scanPoolUrl" placeholder="Enter instance URL"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolApiKey">API Key (optional)</label>
        <div class="input-field">
          <input type="password" id="scanPoolApiKey" placeholder="Enter API Key">
          <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolTimeout">Timeout</label>
        <select class="select-field" id="scanPoolTimeout" style="max-width:none;">
          <option selected>01:00:00</option>
          <option>00:30:00</option>
          <option>02:00:00</option>
          <option>04:00:00</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addScanPoolPanel')">Cancel</button>
      <button class="btn-primary" onclick="addScanPool()">Add Scan Pool</button>
    </div>
  </div>

  <!-- ==================== ADD USER SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addUserOverlay" onclick="closeSlidePanel('addUserPanel')"></div>
  <div class="slide-panel" id="addUserPanel" role="dialog" aria-labelledby="addUserTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addUserTitle">Add User</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addUserPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <label class="panel-field-label" for="addUserFullName">Full Name <span style="color:#d40031;">*</span></label>
        <div class="input-field"><input type="text" id="addUserFullName" placeholder="Enter full name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="addUserUsername">Username</label>
        <div class="input-field"><input type="text" id="addUserUsername" placeholder="Enter username"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="addUserEmail">Email</label>
        <div class="input-field"><input type="email" id="addUserEmail" placeholder="Enter email address"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="addUserPassword">Password</label>
        <div class="input-field">
          <input type="password" id="addUserPassword" placeholder="Enter password">
          <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="addUserConfirmPassword">Confirm Password</label>
        <div class="input-field">
          <input type="password" id="addUserConfirmPassword" placeholder="Confirm password">
          <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="addUserPermissions">Permissions</label>
        <select class="select-field" id="addUserPermissions" style="max-width:none;">
          <option selected>Read-Only</option>
          <option>Read-Write</option>
          <option>Admin</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addUserPanel')">Cancel</button>
      <button class="btn-primary" onclick="addUser()">Add</button>
    </div>
  </div>

  <!-- ==================== EDIT USER SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="editUserOverlay" onclick="closeSlidePanel('editUserPanel')"></div>
  <div class="slide-panel" id="editUserPanel" role="dialog" aria-labelledby="editUserTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="editUserTitle">Edit User</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('editUserPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <label class="panel-field-label" for="editUserFullName">Full Name</label>
        <div class="input-field"><input type="text" id="editUserFullName" placeholder="Enter full name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editUserUsername">Username</label>
        <div class="input-field"><input type="text" id="editUserUsername" placeholder="Enter username"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editUserEmail">Email</label>
        <div class="input-field"><input type="email" id="editUserEmail" placeholder="Enter email address"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editUserPermissions">Permissions</label>
        <select class="select-field" id="editUserPermissions" style="max-width:none;">
          <option selected>Read-Only</option>
          <option>Read-Write</option>
          <option>Admin</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('editUserPanel')">Discard</button>
      <button class="btn-primary" onclick="saveUser()">Save</button>
    </div>
  </div>

  <!-- ==================== JOB DETAILS SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="jobDetailsOverlay" onclick="closeSlidePanel('jobDetailsPanel')"></div>
  <div class="slide-panel" id="jobDetailsPanel" role="dialog" aria-labelledby="jobDetailsTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="jobDetailsTitle">Job Details</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('jobDetailsPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body" id="jobDetailsPanelBody">
      <!-- Populated by JS -->
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('jobDetailsPanel')">Close</button>
    </div>
  </div>

  <!-- ==================== EDIT JOB SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="editJobOverlay" onclick="closeSlidePanel('editJobPanel')"></div>
  <div class="slide-panel" id="editJobPanel" role="dialog" aria-labelledby="editJobTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="editJobTitle">New Job</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('editJobPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <span class="panel-field-label">Scan Type</span>
        <div class="tabs" id="editJobScanTypeTabs" style="margin-bottom:0;">
          <button class="tab active" data-tab="scan-now">Scan Now</button>
          <button class="tab" data-tab="schedule-scan">Schedule Scan</button>
          <button class="tab" data-tab="realtime-scan">Real-Time Scan</button>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editJobName">Scan Name</label>
        <div class="input-field"><input type="text" id="editJobName" placeholder="Enter scan name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editJobWorkflow">Workflow</label>
        <select class="select-field" id="editJobWorkflow" style="max-width:none;">
          <option selected>Default Workflow</option>
          <option>Quick Scan</option>
          <option>Deep Scan</option>
          <option>Custom Workflow</option>
        </select>
      </div>
      <div class="panel-field">
        <span class="panel-field-label">Priority</span>
        <div class="priority-toggle" id="editJobPriority">
          <button class="priority-toggle-btn" data-priority="Low">Low</button>
          <button class="priority-toggle-btn active" data-priority="Medium">Medium</button>
          <button class="priority-toggle-btn" data-priority="High">High</button>
        </div>
      </div>
      <div class="panel-field" id="editJobReoccurrenceField" style="display:none;">
        <label class="panel-field-label" for="editJobReoccurrence">Reoccurrence</label>
        <select class="select-field" id="editJobReoccurrence" style="max-width:none;">
          <option selected>Once</option>
          <option>Daily</option>
          <option>Weekly</option>
          <option>Monthly</option>
        </select>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editJobPartition">Partition</label>
        <select class="select-field" id="editJobPartition" style="max-width:none;">
          <option selected>All Partitions</option>
          <option>Partition A</option>
          <option>Partition B</option>
          <option>Partition C</option>
        </select>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="editJobStorageUnit">Storage Unit</label>
        <select class="select-field" id="editJobStorageUnit" style="max-width:none;">
          <option selected>Azure Blob – prod-container-01</option>
          <option>AWS S3 – backup-bucket</option>
          <option>GCP Storage – archive-2024</option>
          <option>Azure Blob – staging-container</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('editJobPanel')">Cancel</button>
      <button class="btn-primary" onclick="createJob()">Create Job</button>
    </div>
  </div>

  <!-- ==================== JOBS ADVANCED FILTERS SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="jobsFiltersOverlay" onclick="closeSlidePanel('jobsFiltersPanel')"></div>
  <div class="slide-panel" id="jobsFiltersPanel" role="dialog" aria-labelledby="jobsFiltersTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="jobsFiltersTitle">Advanced Filters</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('jobsFiltersPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="af-section">
        <div class="af-section-title">Job Type</div>
        <div class="af-chips" id="jobsFilterType">
          <span class="af-chip" data-value="all" onclick="toggleAfChip(this)">All</span>
          <span class="af-chip" data-value="scheduled" onclick="toggleAfChip(this)">Scheduled File Scan</span>
          <span class="af-chip" data-value="realtime" onclick="toggleAfChip(this)">Real-Time Scan</span>
        </div>
      </div>
      <div class="af-section">
        <div class="af-section-title">Status</div>
        <div class="af-chips" id="jobsFilterStatus">
          <span class="af-chip" data-value="all" onclick="toggleAfChip(this)">All</span>
          <span class="af-chip" data-value="completed" onclick="toggleAfChip(this)">Completed</span>
          <span class="af-chip" data-value="stopped" onclick="toggleAfChip(this)">Stopped</span>
          <span class="af-chip" data-value="cancelled" onclick="toggleAfChip(this)">Cancelled</span>
        </div>
      </div>
      <div class="af-section">
        <div class="af-section-title">Detections</div>
        <div class="af-field">
          <select id="jobsFilterDetections">
            <option selected>Any</option>
            <option>With Detections</option>
            <option>No Detections</option>
          </select>
        </div>
      </div>
      <div class="af-section">
        <div class="af-section-title">Date Range</div>
        <div class="af-field">
          <label for="jobsFilterDateFrom">From</label>
          <div class="input-field"><input type="date" id="jobsFilterDateFrom"></div>
        </div>
        <div class="af-field">
          <label for="jobsFilterDateTo">To</label>
          <div class="input-field"><input type="date" id="jobsFilterDateTo"></div>
        </div>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="resetJobsFilters()">Reset</button>
      <button class="btn-primary" onclick="applyJobsFilters()">Apply Filters</button>
    </div>
  </div>

  <!-- ==================== ACCOUNT SETTINGS SLIDE PANEL ==================== -->
  <div class="slide-panel-overlay" id="acctSettingsOverlay" onclick="closeSlidePanel('acctSettingsPanel')"></div>
  <div class="slide-panel" id="acctSettingsPanel" role="dialog" aria-labelledby="acctSettingsTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="acctSettingsTitle">Account Settings</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('acctSettingsPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-banner warning" style="padding:8px 10px; font-size:12px; margin-bottom:16px;">
        <svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
        <span>Changing account settings may affect connected storage units and running jobs.</span>
      </div>
      <div class="panel-banner error" id="acctSettingsError" style="padding:8px 10px; font-size:12px; margin-bottom:16px; display:none;">
        <svg viewBox="0 0 16 16" fill="currentColor" style="width:14px;height:14px;"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 10.5a.75.75 0 110-1.5.75.75 0 010 1.5zM8.75 8a.75.75 0 01-1.5 0V5a.75.75 0 011.5 0v3z"/></svg>
        <span>Failed to save settings. Please check your credentials and try again.</span>
      </div>

      <!-- Autodiscovery -->
      <div class="panel-field" style="display:flex; align-items:center; justify-content:space-between;">
        <label class="panel-field-label" style="margin-bottom:0;">Autodiscovery</label>
        <div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div>
      </div>

      <!-- Group -->
      <div class="panel-field">
        <label class="panel-field-label">Group</label>
        <select class="select-field" style="width:100%;">
          <option selected>Default Group</option>
          <option>Production</option>
          <option>Staging</option>
          <option>Development</option>
        </select>
      </div>

      <!-- Account Name -->
      <div class="panel-field">
        <label class="panel-field-label" style="display:flex; align-items:center; gap:4px;">
          Account Name
          <svg viewBox="0 0 16 16" fill="currentColor" style="width:14px; height:14px; color:var(--text-muted); cursor:pointer;" onclick="document.getElementById('acctNameModal').classList.add('open')"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 10.5a.75.75 0 110-1.5.75.75 0 010 1.5zM8.75 8a.75.75 0 01-1.5 0V5a.75.75 0 011.5 0v3z"/></svg>
        </label>
        <input class="input-field" value="AWS Account Name" style="width:100%;" id="acctSettingsName">
      </div>

      <!-- Service URL -->
      <div class="panel-field">
        <label class="panel-field-label">Service URL</label>
        <input class="input-field" value="https://s3.amazonaws.com" style="width:100%;">
      </div>

      <!-- IAM Role -->
      <div class="panel-field" style="display:flex; align-items:center; justify-content:space-between;">
        <label class="panel-field-label" style="margin-bottom:0;">IAM Role</label>
        <div class="toggle-switch" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div>
      </div>

      <!-- Assume Role ARN -->
      <div class="panel-field">
        <label class="panel-field-label">Assume Role ARN</label>
        <input class="input-field" placeholder="arn:aws:iam::123456789012:role/role-name" style="width:100%;">
      </div>

      <!-- Access Key ID -->
      <div class="panel-field">
        <label class="panel-field-label">Access Key ID</label>
        <input class="input-field" value="AKIA2OGYBAH6XRKL2G4H" style="width:100%;">
      </div>

      <!-- Secret Access Key -->
      <div class="panel-field">
        <label class="panel-field-label">Secret Access Key</label>
        <input class="input-field" type="password" value="secretkey123456" style="width:100%;">
      </div>

      <!-- Region Endpoint -->
      <div class="panel-field">
        <label class="panel-field-label">Region Endpoint</label>
        <select class="select-field" style="width:100%;">
          <option selected>US East (N. Virginia) — us-east-1</option>
          <option>US West (Oregon) — us-west-2</option>
          <option>EU (Ireland) — eu-west-1</option>
          <option>EU (Frankfurt) — eu-central-1</option>
          <option>Asia Pacific (Tokyo) — ap-northeast-1</option>
        </select>
      </div>

      <!-- KMS -->
      <div class="panel-field" style="display:flex; align-items:center; justify-content:space-between;">
        <label class="panel-field-label" style="margin-bottom:0;">KMS Encryption</label>
        <div class="toggle-switch" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div>
      </div>

      <!-- KMS Key ID -->
      <div class="panel-field">
        <label class="panel-field-label">KMS Key ID</label>
        <input class="input-field" placeholder="Enter KMS Key ID" style="width:100%;">
      </div>

      <!-- Proxy URL -->
      <div class="panel-field">
        <label class="panel-field-label">Proxy URL</label>
        <input class="input-field" placeholder="https://proxy.example.com:8080" style="width:100%;">
      </div>

      <!-- Custom Endpoint -->
      <div class="panel-field">
        <label class="panel-field-label">Custom Endpoint URL</label>
        <input class="input-field" placeholder="https://custom-endpoint.example.com" style="width:100%;">
      </div>

      <!-- Path-Style Access -->
      <div class="panel-field" style="display:flex; align-items:center; justify-content:space-between;">
        <label class="panel-field-label" style="margin-bottom:0;">Path-Style Access</label>
        <div class="toggle-switch" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('acctSettingsPanel')">Cancel</button>
      <button class="btn-primary">Save Changes</button>
    </div>
  </div>

  <!-- ==================== ACCOUNT NAME INFO MODAL ==================== -->
  <div class="modal-overlay" id="acctNameModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-labelledby="acctNameModalTitle" aria-modal="true" style="width:420px;">
      <div class="modal-header">
        <h2 id="acctNameModalTitle">Account Name</h2>
        <button class="modal-close" aria-label="Close dialog" onclick="document.getElementById('acctNameModal').classList.remove('open')">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
        </button>
      </div>
      <p style="font-size:14px; color:var(--text-subtle); line-height:1.5; margin:0 0 16px;">
        The account name is a friendly identifier for this storage account. It is used throughout the interface to help you identify which account you are working with. Changing the name does not affect connections or data.
      </p>
      <div class="modal-footer" style="border-top:none; padding-top:0; margin-top:0;">
        <button class="btn-primary" onclick="document.getElementById('acctNameModal').classList.remove('open')">Got it</button>
      </div>
    </div>
  </div>

  <!-- ==================== ACCOUNT UNITS COLUMN VISIBILITY PANEL ==================== -->
  <div class="slide-panel-overlay" id="acctUnitsColVisOverlay" onclick="closeSlidePanel('acctUnitsColVisPanel')"></div>
  <div class="slide-panel" id="acctUnitsColVisPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header">
      <h2>Column Visibility</h2>
      <button class="modal-close" onclick="closeSlidePanel('acctUnitsColVisPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="col-vis-section-title">Visible Columns</div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Name</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Status</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Client ID</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Group</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Files</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Last Scanned</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('acctUnitsColVisPanel')">Cancel</button>
      <button class="btn-primary" onclick="closeSlidePanel('acctUnitsColVisPanel')">Apply</button>
    </div>
  </div>

  <!-- ==================== ACCOUNT JOBS COLUMN VISIBILITY PANEL ==================== -->
  <div class="slide-panel-overlay" id="acctJobsColVisOverlay" onclick="closeSlidePanel('acctJobsColVisPanel')"></div>
  <div class="slide-panel" id="acctJobsColVisPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header">
      <h2>Column Visibility</h2>
      <button class="modal-close" onclick="closeSlidePanel('acctJobsColVisPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="col-vis-section-title">Visible Columns</div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Job Name</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Status</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Type</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Files</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Detections</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
      <div class="col-vis-item"><span class="col-vis-drag">&#x2630;</span><span class="col-vis-label">Date</span><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('acctJobsColVisPanel')">Cancel</button>
      <button class="btn-primary" onclick="closeSlidePanel('acctJobsColVisPanel')">Apply</button>
    </div>
  </div>

  <!-- ==================== ACCOUNT JOBS ADVANCED FILTERS PANEL ==================== -->
  <div class="slide-panel-overlay" id="acctJobsFiltersOverlay" onclick="closeSlidePanel('acctJobsFiltersPanel')"></div>
  <div class="slide-panel" id="acctJobsFiltersPanel" role="dialog" aria-modal="true">
    <div class="slide-panel-header">
      <h2>Advanced Filters</h2>
      <button class="modal-close" onclick="closeSlidePanel('acctJobsFiltersPanel')">
        <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="af-section">
        <div class="af-section-title">Job Type</div>
        <div class="af-chips">
          <span class="af-chip" onclick="toggleAfChip(this)">All</span>
          <span class="af-chip" onclick="toggleAfChip(this)">Scheduled File Scan</span>
          <span class="af-chip" onclick="toggleAfChip(this)">Real-Time Scan</span>
        </div>
      </div>
      <div class="af-section">
        <div class="af-section-title">Status</div>
        <div class="af-chips">
          <span class="af-chip" onclick="toggleAfChip(this)">All</span>
          <span class="af-chip" onclick="toggleAfChip(this)">Completed</span>
          <span class="af-chip" onclick="toggleAfChip(this)">In Progress</span>
          <span class="af-chip" onclick="toggleAfChip(this)">Failed</span>
        </div>
      </div>
      <div class="af-section">
        <div class="af-section-title">Date Range</div>
        <div class="af-field">
          <label>From</label>
          <div class="input-field"><input type="date"></div>
        </div>
        <div class="af-field">
          <label>To</label>
          <div class="input-field"><input type="date"></div>
        </div>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('acctJobsFiltersPanel')">Reset</button>
      <button class="btn-primary" onclick="closeSlidePanel('acctJobsFiltersPanel')">Apply Filters</button>
    </div>
  </div>

  <!-- ==================== CANCEL JOB CONFIRMATION MODAL ==================== -->
  <div class="modal-overlay" id="cancelJobModal" aria-hidden="true">
    <div class="modal" role="alertdialog" aria-labelledby="cancelJobTitle" aria-describedby="cancelJobDesc" aria-modal="true" style="width:420px;">
      <div class="modal-header">
        <h2 id="cancelJobTitle">Cancel Job</h2>
        <button class="modal-close" aria-label="Close dialog" onclick="closeCancelJobModal()">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.5303 4.53033C12.8232 4.23744 12.8232 3.76256 12.5303 3.46967C12.2374 3.17678 11.7626 3.17678 11.4697 3.46967L8 6.93934L4.53033 3.46967C4.23744 3.17678 3.76256 3.17678 3.46967 3.46967C3.17678 3.76256 3.17678 4.23744 3.46967 4.53033L6.93934 8L3.46967 11.4697C3.17678 11.7626 3.17678 12.2374 3.46967 12.5303C3.76256 12.8232 4.23744 12.8232 4.53033 12.5303L8 9.06066L11.4697 12.5303C11.7626 12.8232 12.2374 12.8232 12.5303 12.5303C12.8232 12.2374 12.8232 11.7626 12.5303 11.4697L9.06066 8L12.5303 4.53033Z"/></svg>
        </button>
      </div>
      <div style="display:flex; align-items:flex-start; gap:12px; margin-bottom:20px;">
        <svg viewBox="0 0 16 16" fill="currentColor" style="width:20px; height:20px; flex-shrink:0; color:#e6a817; margin-top:2px;"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
        <p id="cancelJobDesc" style="font-size:14px; color:var(--text-subtle); line-height:1.5; margin:0;">
          Are you sure you want to cancel this job? This action cannot be undone. Any files currently being processed will be stopped.
        </p>
      </div>
      <div class="modal-footer" style="border-top:none; padding-top:0; margin-top:0;">
        <button class="btn-outline" onclick="closeCancelJobModal()">Keep Running</button>
        <button class="btn-danger" onclick="confirmCancelJob()">Cancel Job</button>
      </div>
    </div>
  </div>

  <script>
    // ===============================================================
    // FILTER BUTTON MENUS (Dashboard header)
    // ===============================================================
    function toggleFilterMenu(wrapId) {
      var wrap = document.getElementById(wrapId);
      var wasOpen = wrap.classList.contains('open');
      // Close all filter menus first
      document.querySelectorAll('.filter-btn-wrap.open').forEach(function(el) { el.classList.remove('open'); });
      if (!wasOpen) wrap.classList.add('open');
    }
    function selectFilter(filterId, label, el) {
      // Update text
      document.getElementById(filterId + 'Text').textContent = label;
      // Update active state
      var menu = el.parentElement;
      menu.querySelectorAll('.filter-menu-item').forEach(function(item) { item.classList.remove('active'); });
      el.classList.add('active');
      // Close menu
      el.closest('.filter-btn-wrap').classList.remove('open');
    }
    // Close filter menus on outside click
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.filter-btn-wrap')) {
        document.querySelectorAll('.filter-btn-wrap.open').forEach(function(el) { el.classList.remove('open'); });
      }
    });

    // ===============================================================
    // DIRTY STATE TRACKING — detects changes within each settings card
    // and activates Save/Discard buttons accordingly
    // ===============================================================

    function captureCardState(card) {
      const state = {};
      // Text / email / password / number inputs
      card.querySelectorAll('input[type="text"], input[type="email"], input[type="password"], input[type="number"]').forEach((input, i) => {
        state['input_' + i] = input.value;
      });
      // Select dropdowns
      card.querySelectorAll('select').forEach((sel, i) => {
        state['select_' + i] = sel.value;
      });
      // Toggle switches
      card.querySelectorAll('.toggle-switch').forEach((toggle, i) => {
        state['toggle_' + i] = toggle.classList.contains('active');
      });
      // Radio groups
      card.querySelectorAll('.radio-group, .radio-inline, [data-radio-group]').forEach((group, i) => {
        const sel = group.querySelector('.radio-option.selected');
        state['radio_' + i] = sel ? sel.querySelector('.radio-label').textContent : '';
      });
      // File uploads
      card.querySelectorAll('.file-upload-text').forEach((ft, i) => {
        state['file_' + i] = ft.textContent;
      });
      // Header table row counts (webhook / RabbitMQ)
      card.querySelectorAll('.headers-table-body').forEach((tbody, i) => {
        state['headerRows_' + i] = tbody.querySelectorAll('.headers-table-row').length;
      });
      return state;
    }

    function checkDirty(card) {
      if (!card._initialState) return;
      const current = captureCardState(card);
      const isDirty = JSON.stringify(current) !== JSON.stringify(card._initialState);
      card.classList.toggle('dirty', isDirty);
      const saveBtn = card.querySelector('.btn-save');
      if (saveBtn) saveBtn.setAttribute('aria-disabled', isDirty ? 'false' : 'true');
    }

    function restoreCardState(card) {
      if (!card._initialState) return;
      const s = card._initialState;
      // Restore inputs
      card.querySelectorAll('input[type="text"], input[type="email"], input[type="password"], input[type="number"]').forEach((input, i) => {
        if (s['input_' + i] !== undefined) input.value = s['input_' + i];
      });
      // Restore selects
      card.querySelectorAll('select').forEach((sel, i) => {
        if (s['select_' + i] !== undefined) sel.value = s['select_' + i];
      });
      // Restore toggles
      card.querySelectorAll('.toggle-switch').forEach((toggle, i) => {
        const wasActive = s['toggle_' + i];
        toggle.classList.toggle('active', wasActive);
        toggle.setAttribute('aria-checked', String(wasActive));
        const label = toggle.parentElement.querySelector('.toggle-label');
        if (label) {
          if (label.textContent === 'Active' || label.textContent === 'Inactive') {
            label.textContent = wasActive ? 'Active' : 'Inactive';
          } else {
            label.textContent = wasActive ? 'Enabled' : 'Disabled';
          }
        }
      });
      // Restore radios (including ARIA state)
      card.querySelectorAll('.radio-group, .radio-inline, [data-radio-group]').forEach((group, i) => {
        const target = s['radio_' + i];
        group.querySelectorAll('.radio-option').forEach(opt => {
          const lbl = opt.querySelector('.radio-label');
          const isMatch = lbl && lbl.textContent === target;
          opt.classList.toggle('selected', isMatch);
          opt.setAttribute('aria-checked', String(isMatch));
          opt.setAttribute('tabindex', isMatch ? '0' : '-1');
        });
      });
      // Restore file upload labels
      card.querySelectorAll('.file-upload-text').forEach((ft, i) => {
        if (s['file_' + i] !== undefined) {
          ft.textContent = s['file_' + i];
          ft.classList.toggle('has-file', ft.textContent !== 'Add file');
        }
      });
      // Clear dirty state
      card.classList.remove('dirty');
      const saveBtn = card.querySelector('.btn-save');
      if (saveBtn) saveBtn.setAttribute('aria-disabled', 'true');
    }

    function initDirtyTracking() {
      document.querySelectorAll('.settings-card').forEach(card => {
        if (!card.querySelector('.btn-save')) return;
        card._initialState = captureCardState(card);
        card.addEventListener('input', () => checkDirty(card));
        card.addEventListener('change', () => checkDirty(card));
      });
    }

    // ===============================================================
    // TAB SWITCHING — with full ARIA state management
    // ===============================================================

    const tablist = document.getElementById('settingsTabs');
    const tabs = Array.from(tablist.querySelectorAll('.tab'));

    function switchTab(tab) {
      tabs.forEach(t => {
        t.classList.remove('active');
        t.setAttribute('aria-selected', 'false');
        t.setAttribute('tabindex', '-1');
      });
      tab.classList.add('active');
      tab.setAttribute('aria-selected', 'true');
      tab.setAttribute('tabindex', '0');

      document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
      const panelId = 'panel-' + tab.dataset.tab;
      const panel = document.getElementById(panelId);
      if (panel) {
        panel.classList.add('active');
        panel.setAttribute('tabindex', '-1');
      }

      // Dismiss any open notification when switching tabs
      dismissNotification();
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => switchTabWithDirtyCheck(tab));
    });

    // Arrow key navigation for tablist (WCAG 2.4.11 / keyboard pattern)
    tablist.addEventListener('keydown', (e) => {
      const currentIndex = tabs.indexOf(document.activeElement);
      if (currentIndex === -1) return;
      let newIndex;
      if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
        e.preventDefault();
        newIndex = (currentIndex + 1) % tabs.length;
      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
        e.preventDefault();
        newIndex = (currentIndex - 1 + tabs.length) % tabs.length;
      } else if (e.key === 'Home') {
        e.preventDefault();
        newIndex = 0;
      } else if (e.key === 'End') {
        e.preventDefault();
        newIndex = tabs.length - 1;
      } else {
        return;
      }
      tabs[newIndex].focus();
      switchTabWithDirtyCheck(tabs[newIndex]);
    });

    // Initialise roving tabindex
    tabs.forEach(tab => {
      tab.setAttribute('tabindex', tab.classList.contains('active') ? '0' : '-1');
    });

    // ===============================================================
    // TOGGLE SWITCHES & RADIO BUTTONS — event delegation
    // ===============================================================

    document.addEventListener('click', (e) => {
      // --- Toggle switches ---
      const toggle = e.target.closest('.toggle-switch');
      if (toggle) {
        toggle.classList.toggle('active');
        const isActive = toggle.classList.contains('active');
        toggle.setAttribute('aria-checked', String(isActive));
        const label = toggle.parentElement.querySelector('.toggle-label');
        if (label) {
          if (label.textContent === 'Active' || label.textContent === 'Inactive') {
            label.textContent = isActive ? 'Active' : 'Inactive';
          } else {
            label.textContent = isActive ? 'Enabled' : 'Disabled';
          }
        }
        const card = toggle.closest('.settings-card');
        if (card) checkDirty(card);
      }

      // --- Radio buttons ---
      const radio = e.target.closest('.radio-option');
      if (radio) {
        const group = radio.closest('.radio-group, .radio-inline, [data-radio-group]');
        if (group) {
          group.querySelectorAll('.radio-option').forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-checked', 'false');
            o.setAttribute('tabindex', '-1');
          });
          radio.classList.add('selected');
          radio.setAttribute('aria-checked', 'true');
          radio.setAttribute('tabindex', '0');
        }
        const card = radio.closest('.settings-card');
        if (card) checkDirty(card);
      }

      // --- Discard button ---
      if (e.target.closest('.btn-discard')) {
        const card = e.target.closest('.settings-card');
        if (card) restoreCardState(card);
      }

      // --- Save button ---
      if (e.target.closest('.btn-save')) {
        const card = e.target.closest('.settings-card');
        if (card && card.classList.contains('dirty')) {
          card._initialState = captureCardState(card);
          card.classList.remove('dirty');
          const saveBtn = card.querySelector('.btn-save');
          if (saveBtn) saveBtn.setAttribute('aria-disabled', 'true');
          showToast('Settings saved');
        }
      }
    });

    // ===============================================================
    // KEYBOARD: comprehensive handler (WCAG 2.1.1 / 2.1.2 / 2.4.13)
    // ===============================================================

    document.addEventListener('keydown', (e) => {

      // --- Toggle switches: Enter / Space ---
      const toggle = e.target.closest('.toggle-switch');
      if (toggle && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        toggle.click();
        return;
      }

      // --- Radio groups: Arrow key navigation (roving tabindex) ---
      const radioOption = e.target.closest('.radio-option');
      if (radioOption) {
        const group = radioOption.closest('.radio-group, .radio-inline, [data-radio-group]');
        if (!group) return;
        const options = Array.from(group.querySelectorAll('.radio-option'));
        const idx = options.indexOf(radioOption);
        if (idx === -1) return;

        let newIdx;
        if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
          e.preventDefault();
          newIdx = (idx + 1) % options.length;
        } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
          e.preventDefault();
          newIdx = (idx - 1 + options.length) % options.length;
        } else if (e.key === ' ' || e.key === 'Enter') {
          e.preventDefault();
          // Select this option
          options.forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-checked', 'false');
            o.setAttribute('tabindex', '-1');
          });
          radioOption.classList.add('selected');
          radioOption.setAttribute('aria-checked', 'true');
          radioOption.setAttribute('tabindex', '0');
          const card = group.closest('.settings-card');
          if (card) checkDirty(card);
          return;
        } else {
          return;
        }

        // Move focus and selection
        options.forEach(o => {
          o.classList.remove('selected');
          o.setAttribute('aria-checked', 'false');
          o.setAttribute('tabindex', '-1');
        });
        options[newIdx].classList.add('selected');
        options[newIdx].setAttribute('aria-checked', 'true');
        options[newIdx].setAttribute('tabindex', '0');
        options[newIdx].focus();
        const card = group.closest('.settings-card');
        if (card) checkDirty(card);
        return;
      }

      // --- File upload fields: Enter / Space ---
      const fileField = e.target.closest('.file-upload-field');
      if (fileField && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        const fileInput = fileField.querySelector('input[type="file"]');
        if (fileInput) fileInput.click();
        return;
      }

      // --- Edit icons: Enter / Space ---
      const editIcon = e.target.closest('.edit-icon');
      if (editIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        editIcon.click();
        return;
      }

      // --- Clear input icons: Enter / Space ---
      const clearIcon = e.target.closest('.input-clear');
      if (clearIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        clearInput(clearIcon);
        return;
      }

      // --- Password eye icons: Enter / Space ---
      const eyeIcon = e.target.closest('.input-eye');
      if (eyeIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        togglePassword(eyeIcon);
        return;
      }

      // --- Toast close: Enter / Space ---
      const toastClose = e.target.closest('.top-toast-close');
      if (toastClose && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        dismissNotification();
        return;
      }

      // --- Pool icon SVGs: Enter / Space ---
      const poolIcon = e.target.closest('.pool-icons svg');
      if (poolIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        poolIcon.click();
        return;
      }

      // --- Escape key: dismiss notification toast if visible ---
      if (e.key === 'Escape') {
        const nToast = document.getElementById('notificationToast');
        if (nToast && nToast.classList.contains('visible')) {
          dismissNotification();
          return;
        }
      }
    });

    // ===============================================================
    // UTILITY FUNCTIONS
    // ===============================================================

    function clearInput(el) {
      const field = el.closest('.input-field');
      const input = field.querySelector('input');
      if (input) {
        input.value = '';
        input.focus();
        const card = field.closest('.settings-card');
        if (card) checkDirty(card);
      }
    }

    function togglePassword(el) {
      const input = el.closest('.input-field').querySelector('input');
      if (!input) return;
      if (input.type === 'password') {
        input.type = 'text';
        el.innerHTML = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/><line x1="2" y1="14" x2="14" y2="2" stroke="currentColor" stroke-width="1.5"/></svg>';
      } else {
        input.type = 'password';
        el.innerHTML = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>';
      }
    }

    function addHeader(btn) {
      const row = btn.closest('.headers-input-row');
      const keyInput = row.querySelector('.header-key-input');
      const valueInput = row.querySelector('.header-value-input');
      const key = keyInput.value.trim();
      const value = valueInput.value.trim();

      if (!key || !value) {
        showToast('Please enter both key and value');
        return;
      }

      const tableBody = row.closest('.form-value').querySelector('.headers-table-body');
      const newRow = document.createElement('div');
      newRow.className = 'headers-table-row';
      newRow.innerHTML = `
        <div class="col-key">${escapeHtml(key)}</div>
        <div class="col-value">${escapeHtml(value)}</div>
        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
      `;
      tableBody.appendChild(newRow);

      keyInput.value = '';
      valueInput.value = '';
      keyInput.focus();
      showToast('Header added');
      const card = btn.closest('.settings-card');
      if (card) checkDirty(card);
    }

    function generateApiKey() {
      const chars = 'abcdef0123456789';
      let key = 'sk_';
      for (let i = 0; i < 32; i++) key += chars[Math.floor(Math.random() * chars.length)];

      const status = document.getElementById('apiKeyStatus');
      status.textContent = key;
      status.style.color = 'var(--text-strong)';
      status.style.fontFamily = 'monospace';

      const btn = document.getElementById('btnGenerateKey');
      btn.textContent = 'Regenerate API Key';

      showNotification('success', 'API key generated', 'Your new API key has been created. Save to apply changes.');

      // Manually mark the card dirty (API key status is not a standard input)
      const card = status.closest('.settings-card');
      if (card) {
        card.classList.add('dirty');
        const saveBtn = card.querySelector('.btn-save');
        if (saveBtn) saveBtn.setAttribute('aria-disabled', 'false');
      }
    }

    // ===============================================================
    // TOAST (bottom snackbar)
    // ===============================================================

    function showToast(msg) {
      showNotification('info', msg);
    }

    // ===============================================================
    // NOTIFICATION (top-right reusable toast — info/success/warning/error)
    // ===============================================================

    const notificationIcons = {
      info:    '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm-.5 4v5h1V5h-1zm0 6v1h1v-1h-1z"/></svg>',
      success: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm3.354 4.646a.5.5 0 010 .708l-4 4a.5.5 0 01-.708 0l-2-2a.5.5 0 01.708-.708L7 9.293l3.646-3.647a.5.5 0 01.708 0z"/></svg>',
      warning: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 00-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 01-1.1 0L7.1 5.995A.905.905 0 018 5zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></svg>',
      error:   '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm0 3a.75.75 0 00-.75.75v4.5a.75.75 0 001.5 0v-4.5A.75.75 0 008 4zm0 8a1 1 0 100-2 1 1 0 000 2z"/></svg>'
    };

    function showNotification(type, title, desc) {
      const toast = document.getElementById('notificationToast');
      if (!toast) return;

      // Clear auto-dismiss timer
      clearTimeout(toast._timer);

      // Remove previous type classes
      toast.classList.remove('type-info', 'type-success', 'type-warning', 'type-error', 'visible');

      // Set type
      const validType = ['info', 'success', 'warning', 'error'].includes(type) ? type : 'info';
      toast.classList.add('type-' + validType);

      // Set icon
      const iconEl = toast.querySelector('.top-toast-icon');
      if (iconEl) iconEl.innerHTML = notificationIcons[validType];

      // Set content
      const titleEl = toast.querySelector('.top-toast-title');
      const descEl = toast.querySelector('.top-toast-desc');
      if (titleEl) titleEl.textContent = title || '';
      if (descEl) {
        descEl.textContent = desc || '';
        descEl.style.display = desc ? '' : 'none';
      }

      // Show with animation (force reflow for screen reader re-announcement)
      requestAnimationFrame(() => {
        toast.classList.add('visible');
      });

      // Auto-dismiss after 5 seconds
      toast._timer = setTimeout(() => dismissNotification(), 5000);
    }

    function dismissNotification() {
      const toast = document.getElementById('notificationToast');
      if (!toast) return;
      toast.classList.remove('visible');
      clearTimeout(toast._timer);
    }

    // ===============================================================
    // SIDEBAR TOGGLE
    // ===============================================================

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const app = document.querySelector('.app');
      const isMobile = window.innerWidth <= 768;
      const extIcon = document.querySelector('.sidebar-icon-extended');
      const colIcon = document.querySelector('.sidebar-icon-collapsed');

      if (isMobile) {
        app.classList.toggle('sidebar-open');
      } else {
        sidebar.classList.toggle('collapsed');
      }

      const isCollapsed = sidebar.classList.contains('collapsed');
      if (extIcon && colIcon) {
        extIcon.style.display = isCollapsed ? 'none' : '';
        colIcon.style.display = isCollapsed ? '' : 'none';
      }
    }

    function closeMobileSidebar() {
      const app = document.querySelector('.app');
      app.classList.remove('sidebar-open');
    }

    // ===============================================================
    // FILE UPLOAD
    // ===============================================================

    function handleFileUpload(input) {
      const label = input.closest('.file-upload-field').querySelector('.file-upload-text');
      if (input.files.length > 0) {
        label.textContent = input.files[0].name;
        label.classList.add('has-file');
        showToast('File selected: ' + input.files[0].name);
        const card = input.closest('.settings-card');
        if (card) checkDirty(card);
      }
    }

    // ===============================================================
    // ESCAPE HTML (XSS prevention)
    // ===============================================================

    function escapeHtml(text) {
      const d = document.createElement('div');
      d.textContent = text;
      return d.innerHTML;
    }

    // ===============================================================
    // ACCESSIBILITY INIT — patches missing ARIA attributes
    // ===============================================================

    function initAccessibility() {

      // ----- 1. Tab panels: role + aria-labelledby -----
      document.querySelectorAll('.tab-panel').forEach(panel => {
        panel.setAttribute('role', 'tabpanel');
        const tabName = panel.id.replace('panel-', '');
        const tab = document.querySelector('.tab[data-tab="' + tabName + '"]');
        if (tab) {
          if (!tab.id) tab.id = 'tab-' + tabName;
          panel.setAttribute('aria-labelledby', tab.id);
        }
      });

      // ----- 2. Visually-hidden h2 headings per tab panel (heading hierarchy) -----
      document.querySelectorAll('.tab-panel').forEach(panel => {
        const tabName = panel.id.replace('panel-', '');
        const tab = document.querySelector('.tab[data-tab="' + tabName + '"]');
        if (tab && !panel.querySelector('h2')) {
          const h2 = document.createElement('h2');
          h2.className = 'sr-only';
          h2.textContent = tab.textContent.trim() + ' Settings';
          panel.insertBefore(h2, panel.firstChild);
        }
      });

      // ----- 3. Toggle switches: role, aria-checked, tabindex -----
      document.querySelectorAll('.toggle-switch').forEach(toggle => {
        if (!toggle.hasAttribute('role')) {
          toggle.setAttribute('role', 'switch');
        }
        toggle.setAttribute('aria-checked', String(toggle.classList.contains('active')));
        if (!toggle.hasAttribute('tabindex')) {
          toggle.setAttribute('tabindex', '0');
        }
      });

      // ----- 4. Radio groups: role="radiogroup" + role="radio" + roving tabindex -----
      document.querySelectorAll('.radio-group, .radio-inline, [data-radio-group]').forEach(group => {
        group.setAttribute('role', 'radiogroup');
        group.querySelectorAll('.radio-option').forEach(option => {
          option.setAttribute('role', 'radio');
          const isSelected = option.classList.contains('selected');
          option.setAttribute('aria-checked', String(isSelected));
          option.setAttribute('tabindex', isSelected ? '0' : '-1');
        });
      });

      // ----- 5. Form label associations (aria-labelledby) -----
      let labelCounter = 0;
      document.querySelectorAll('.form-row').forEach(row => {
        const label = row.querySelector('.form-label');
        if (!label) return;
        const labelId = 'flabel-' + (labelCounter++);
        label.setAttribute('id', labelId);

        // Associate with text/email/password inputs
        row.querySelectorAll('.input-field input').forEach(input => {
          input.setAttribute('aria-labelledby', labelId);
        });

        // Associate with toggle switches
        const toggle = row.querySelector('.toggle-switch');
        if (toggle) {
          toggle.setAttribute('aria-labelledby', labelId);
        }

        // Associate with radio groups
        const radioGroup = row.querySelector('.radio-group, .radio-inline, [data-radio-group]');
        if (radioGroup) {
          radioGroup.setAttribute('aria-labelledby', labelId);
        }

        // Associate with file uploads
        const fileUpload = row.querySelector('.file-upload-field');
        if (fileUpload) {
          fileUpload.setAttribute('role', 'button');
          fileUpload.setAttribute('aria-labelledby', labelId);
          fileUpload.setAttribute('tabindex', '0');
        }
      });

      // ----- 6. Icon-only interactive elements: role, tabindex, aria-label -----
      document.querySelectorAll('.edit-icon').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Edit');
      });
      document.querySelectorAll('.filter-icon').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Filter column');
      });
      document.querySelectorAll('.input-clear').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Clear input');
      });
      document.querySelectorAll('.input-eye').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Toggle password visibility');
      });
      document.querySelectorAll('.top-toast-close').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Close notification');
      });

      // Pool table action icons (delete + view per row)
      document.querySelectorAll('.pool-icons').forEach(container => {
        const svgs = container.querySelectorAll('svg');
        if (svgs[0]) {
          svgs[0].setAttribute('role', 'button');
          svgs[0].setAttribute('tabindex', '0');
          svgs[0].setAttribute('aria-label', 'Delete instance');
        }
        if (svgs[1]) {
          svgs[1].setAttribute('role', 'button');
          svgs[1].setAttribute('tabindex', '0');
          svgs[1].setAttribute('aria-label', 'View instance details');
        }
      });

      // Help icons — focusable with tooltip description
      document.querySelectorAll('.help-icon').forEach(icon => {
        icon.setAttribute('role', 'img');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'More information');
      });

      // ----- 7. Decorative SVGs: aria-hidden -----
      document.querySelectorAll('.banner-icon svg, .header-logo-icon svg, .file-upload-icon svg, .top-toast-icon svg, .nav-item svg, .header-icon svg').forEach(svg => {
        svg.setAttribute('aria-hidden', 'true');
        svg.setAttribute('focusable', 'false');
      });

      // ----- 8. Active nav item: aria-current -----
      const activeNav = document.querySelector('.nav-item.active');
      if (activeNav) {
        activeNav.setAttribute('aria-current', 'page');
      }

      // ----- 9. Autocomplete attributes (WCAG 1.3.5 Identify Input Purpose) -----
      const profilePanel = document.getElementById('panel-profile');
      if (profilePanel) {
        profilePanel.querySelectorAll('.form-row').forEach(row => {
          const label = row.querySelector('.form-label');
          const input = row.querySelector('input');
          if (!label || !input) return;
          const t = label.textContent.trim().toLowerCase();
          if (t.includes('full name')) input.setAttribute('autocomplete', 'name');
          else if (t === 'email') input.setAttribute('autocomplete', 'email');
          else if (t.includes('new password')) input.setAttribute('autocomplete', 'new-password');
          else if (t.includes('repeat password')) input.setAttribute('autocomplete', 'new-password');
        });
      }

      // SMTP authentication username/password
      const smtpPanel = document.getElementById('panel-smtp');
      if (smtpPanel) {
        smtpPanel.querySelectorAll('.form-row').forEach(row => {
          const label = row.querySelector('.form-label');
          const input = row.querySelector('input');
          if (!label || !input) return;
          const t = label.textContent.trim().toLowerCase();
          if (t.includes('username')) input.setAttribute('autocomplete', 'username');
          else if (t === 'password') input.setAttribute('autocomplete', 'current-password');
          else if (t.includes('sender email')) input.setAttribute('autocomplete', 'email');
        });
      }

      // ----- 10. Toast live regions -----
      const toast = document.getElementById('toast');
      toast.setAttribute('role', 'status');
      toast.setAttribute('aria-live', 'polite');

      // Notification toast ARIA is set inline in HTML (role="alert", aria-live="assertive")

      // ----- 11. All data tables: scope attributes for screen readers -----
      document.querySelectorAll('.pool-table thead th, .data-table thead th').forEach(th => {
        th.setAttribute('scope', 'col');
      });

      // ----- 12. Select fields: ensure they have aria-label if no visible label -----
      document.querySelectorAll('.select-field').forEach(sel => {
        if (!sel.getAttribute('aria-labelledby') && !sel.getAttribute('aria-label') && !sel.id) {
          const row = sel.closest('.form-row');
          if (row) {
            const label = row.querySelector('.form-label');
            if (label && label.id) sel.setAttribute('aria-labelledby', label.id);
          }
        }
      });

      // ----- 13. Modal / dialog ARIA for new elements -----
      document.querySelectorAll('.slide-panel .radio-group, .modal .radio-group').forEach(group => {
        group.setAttribute('role', 'radiogroup');
        group.querySelectorAll('.radio-option').forEach(opt => {
          opt.setAttribute('role', 'radio');
          opt.setAttribute('aria-checked', String(opt.classList.contains('selected')));
          opt.setAttribute('tabindex', opt.classList.contains('selected') ? '0' : '-1');
        });
      });
    }

    // ===============================================================
    // MODAL DIALOGS
    // ===============================================================

    function openModal(id) {
      const overlay = document.getElementById(id);
      if (!overlay) return;
      overlay.classList.add('open');
      overlay.setAttribute('aria-hidden', 'false');
      // Trap focus inside modal
      const modal = overlay.querySelector('.modal');
      const focusable = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if (focusable.length) focusable[0].focus();
      // Close on overlay click
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) closeModal(id);
      });
      // Close on Escape
      overlay._escHandler = (e) => {
        if (e.key === 'Escape') closeModal(id);
      };
      document.addEventListener('keydown', overlay._escHandler);
    }

    function closeModal(id) {
      const overlay = document.getElementById(id);
      if (!overlay) return;
      overlay.classList.remove('open');
      overlay.setAttribute('aria-hidden', 'true');
      if (overlay._escHandler) {
        document.removeEventListener('keydown', overlay._escHandler);
      }
    }

    // License modal: switch between Online / Offline modes
    function showLicenseMode(mode) {
      const onlineEl = document.getElementById('licenseOnlineMode');
      const offlineEl = document.getElementById('licenseOfflineMode');
      if (mode === 'online') {
        onlineEl.style.display = '';
        offlineEl.style.display = 'none';
      } else {
        onlineEl.style.display = 'none';
        offlineEl.style.display = '';
      }
    }

    function activateLicense() {
      const isOnline = document.getElementById('licenseOnlineMode').style.display !== 'none';
      if (isOnline) {
        const keyInput = document.getElementById('licenseKeyInput');
        if (!keyInput.value.trim()) {
          showNotification('warning', 'Missing field', 'Please enter a license key.');
          return;
        }
      }
      closeModal('addLicenseModal');
      document.getElementById('licenseEmptyState').style.display = 'none';
      document.getElementById('licenseActiveState').style.display = '';
      // Reset badge to active state
      var badge = document.getElementById('licenseExpBadge');
      badge.className = 'license-badge green';
      badge.textContent = 'Dec 31, 2026';
      showNotification('success', 'License activated', 'Your license has been activated successfully.');
      document.getElementById('licenseKeyInput').value = '';

      // Hide the license expired notification on activation, show empty state
      var expNotif = document.getElementById('notifLicenseExpired');
      if (expNotif) expNotif.style.display = 'none';
      var notifEmpty = document.getElementById('notifEmptyState');
      if (notifEmpty) notifEmpty.style.display = '';
      // Hide the red dot on bell
      var notifDot = document.querySelector('.notif-dot');
      if (notifDot) notifDot.style.display = 'none';

      // After 10 seconds, expire the license and return to empty state
      clearTimeout(window._licenseExpTimer);
      window._licenseExpTimer = setTimeout(function() {
        var badge = document.getElementById('licenseExpBadge');
        if (badge && document.getElementById('licenseActiveState').style.display !== 'none') {
          badge.className = 'license-badge red';
          badge.textContent = 'Expired';
          showNotification('error', 'License expired', 'Your license has expired. Please add a new license to restore functionality.');
          // Show the license expired item in the notification dropdown, hide empty state
          var expNotif = document.getElementById('notifLicenseExpired');
          if (expNotif) { expNotif.style.display = ''; expNotif.querySelector('.notif-msg-time').textContent = 'Just now'; }
          var notifEmpty = document.getElementById('notifEmptyState');
          if (notifEmpty) notifEmpty.style.display = 'none';
          // Show the red dot on bell
          var notifDot = document.querySelector('.notif-dot');
          if (notifDot) notifDot.style.display = '';
          // Switch to empty state after a short delay so user sees the expired badge
          setTimeout(function() {
            document.getElementById('licenseActiveState').style.display = 'none';
            document.getElementById('licenseEmptyState').style.display = '';
          }, 2000);
        }
      }, 10000);
    }

    function prefillLicenseKey(input) {
      if (!input.value) {
        input.value = 'EVAL-2026-MDSS-XKPL-9F7H';
      }
    }

    function deactivateLicense() {
      clearTimeout(window._licenseExpTimer);
      document.getElementById('licenseActiveState').style.display = 'none';
      document.getElementById('licenseEmptyState').style.display = '';
      showNotification('info', 'License deactivated', 'The license has been deactivated.');
    }

    // ===============================================================
    // SLIDE-OUT PANELS
    // ===============================================================

    function openSlidePanel(id) {
      const panel = document.getElementById(id);
      if (!panel) return;
      const overlayId = id.replace('Panel', 'Overlay');
      const overlay = document.getElementById(overlayId);
      if (overlay) overlay.classList.add('open');
      panel.classList.add('open');
      // Focus first input in panel
      const focusable = panel.querySelectorAll('input, select, button, [tabindex]:not([tabindex="-1"])');
      if (focusable.length) setTimeout(() => focusable[0].focus(), 300);
      // Escape handler
      panel._escHandler = (e) => {
        if (e.key === 'Escape') closeSlidePanel(id);
      };
      document.addEventListener('keydown', panel._escHandler);
    }

    function closeSlidePanel(id) {
      const panel = document.getElementById(id);
      if (!panel) return;
      const overlayId = id.replace('Panel', 'Overlay');
      const overlay = document.getElementById(overlayId);
      if (overlay) overlay.classList.remove('open');
      panel.classList.remove('open');
      if (panel._escHandler) {
        document.removeEventListener('keydown', panel._escHandler);
      }
    }

    // ===============================================================
    // ADD COLLECTOR → inserts row into collectors table
    // ===============================================================
    function addCollectorRow() {
      const name = document.getElementById('collectorName').value.trim();
      const endpoint = document.getElementById('collectorEndpoint').value.trim();
      const apiKey = document.getElementById('collectorApiKey').value.trim();
      const selectedRadio = document.querySelector('#addCollectorPanel .radio-option.selected .radio-label');
      const protocol = selectedRadio ? selectedRadio.textContent.trim() : 'gRPC';

      if (!name) {
        showNotification('warning', 'Missing field', 'Please enter a Collector Name.');
        return;
      }

      const tbody = document.getElementById('collectorsTableBody');
      const editSvg = '<span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span>';

      const tr = document.createElement('tr');
      tr.innerHTML =
        '<td><span class="av-badge">' + escapeHtml(name) + '</span></td>' +
        '<td>' + escapeHtml(endpoint || '-') + '</td>' +
        '<td>' + (apiKey ? '••••••••' : '-') + '</td>' +
        '<td>' + escapeHtml(protocol) + '</td>' +
        '<td>' + editSvg + '</td>';
      tbody.appendChild(tr);

      // Reset form
      document.getElementById('collectorName').value = '';
      document.getElementById('collectorEndpoint').value = '';
      document.getElementById('collectorApiKey').value = '';

      closeSlidePanel('addCollectorPanel');
      showNotification('success', 'Collector added', 'The new collector has been configured successfully.');
    }

    // ===============================================================
    // ADD LOGGER → inserts row into external loggers table
    // ===============================================================
    function addLoggerRow() {
      const statusToggle = document.querySelector('#addLoggerPanel .toggle-switch');
      const isEnabled = statusToggle && statusToggle.getAttribute('aria-checked') === 'true';
      const serverType = document.getElementById('loggerType').value;
      const address = document.getElementById('loggerAddress').value.trim();
      const port = document.getElementById('loggerPort').value.trim();

      if (!address) {
        showNotification('warning', 'Missing field', 'Please enter a Server Address.');
        return;
      }

      const tbody = document.getElementById('loggersTableBody');
      const editSvg = '<span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span>';

      const statusDot = isEnabled ? '<span class="status-dot green"></span>Enabled' : '<span class="status-dot red"></span>Disabled';
      const fullAddress = address + (port ? ':' + port : ':514');

      const tr = document.createElement('tr');
      tr.innerHTML =
        '<td>' + escapeHtml(serverType) + '</td>' +
        '<td>' + statusDot + '</td>' +
        '<td>' + escapeHtml(fullAddress) + '</td>' +
        '<td>-</td>' +
        '<td>' + editSvg + '</td>';
      tbody.appendChild(tr);

      // Reset form
      document.getElementById('loggerAddress').value = '';
      document.getElementById('loggerPort').value = '';

      closeSlidePanel('addLoggerPanel');
      showNotification('success', 'Logger instance added', 'The external logger has been configured successfully.');
    }

    // HTML escaping helper
    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // ===============================================================
    // POOL ACTION MENU — toggle "..." menu on scan pool table rows
    // ===============================================================
    function togglePoolActionMenu(btn) {
      event.stopPropagation();
      const menu = btn.querySelector('.row-action-menu');
      const wasOpen = menu.classList.contains('open');
      // Close all other open menus
      document.querySelectorAll('.row-action-menu.open').forEach(m => m.classList.remove('open'));
      if (!wasOpen) {
        // Position menu using fixed coords relative to the button
        const rect = btn.getBoundingClientRect();
        menu.style.top = (rect.bottom + 4) + 'px';
        menu.style.right = (window.innerWidth - rect.right) + 'px';
        menu.classList.add('open');
        // Close on outside click
        const closeMenu = function(e) {
          if (!btn.contains(e.target)) {
            menu.classList.remove('open');
            document.removeEventListener('click', closeMenu);
          }
        };
        document.addEventListener('click', closeMenu);
      }
    }

    // ===============================================================
    // ADD SCAN POOL — creates a new scan pool card
    // ===============================================================
    function addScanPool() {
      const name = document.getElementById('scanPoolName').value.trim();
      if (!name) {
        showNotification('warning', 'Missing field', 'Please enter a pool name.');
        return;
      }

      const type = document.getElementById('scanPoolType').value;
      const url = document.getElementById('scanPoolUrl').value.trim();
      const timeout = document.getElementById('scanPoolTimeout').value;

      // Build action menu cell template
      const actionCell = '<div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="showToast(\'Edit instance\')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="row-action-menu-item danger" onclick="showToast(\'Delete instance\')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div>';

      // Filter icon SVG
      const filterSvg = '<span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span>';

      const instanceCount = url ? '1 instance' : '0 instances';
      let tbodyContent = '';
      if (url) {
        tbodyContent = '<tr><td>' + escapeHtml(url) + '</td><td><span class="av-badge">-</span></td><td><span class="api-dots">\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022</span></td><td>' + escapeHtml(timeout) + '</td><td>' + actionCell + '</td></tr>';
      } else {
        tbodyContent = '<tr><td colspan="5" style="text-align:center; color:var(--text-muted); padding:20px;">No instances configured. Click Add Instance to add one.</td></tr>';
      }

      const dragSvg = '<span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>';

      const cardHtml = '<div class="settings-card pool-card">' +
        '<div class="pool-card-header">' +
          '<div class="pool-card-header-left">' + dragSvg + '<h2>' + escapeHtml(name) + '</h2><span class="pool-instance-count">' + instanceCount + '</span></div>' +
          '<div class="pool-card-header-right"><button class="btn-outline" onclick="showToast(\'Add Instance dialog would open\')">Add Instance</button></div>' +
        '</div>' +
        '<table class="data-table pool-table"><thead><tr>' +
          '<th class="col-url">Scan Instance URL ' + filterSvg + '</th>' +
          '<th class="col-av">AV Package ' + filterSvg + '</th>' +
          '<th class="col-api">API Key ' + filterSvg + '</th>' +
          '<th class="col-timeout">Timeout ' + filterSvg + '</th>' +
          '<th class="col-actions"></th>' +
        '</tr></thead><tbody>' + tbodyContent + '</tbody></table></div>';

      const panel = document.getElementById('panel-scan-pools');
      const promoBanner = panel.querySelector('.promo-banner');
      promoBanner.insertAdjacentHTML('afterend', cardHtml);

      // Reset form
      document.getElementById('scanPoolName').value = '';
      document.getElementById('scanPoolUrl').value = '';
      document.getElementById('scanPoolApiKey').value = '';

      closeSlidePanel('addScanPoolPanel');
      showNotification('success', 'Scan pool added', 'The scan pool "' + escapeHtml(name) + '" has been created successfully.');
    }

    // ===============================================================
    // POOL CARD DRAG & DROP REORDERING (animated)
    // ===============================================================
    (function() {
      var draggedCard = null;
      var isAnimating = false;

      function getPoolCards() {
        var panel = document.getElementById('panel-scan-pools');
        return panel ? Array.from(panel.querySelectorAll('.pool-card')) : [];
      }

      // FLIP: snapshot positions → move DOM → animate delta
      function flipMove(target, before) {
        if (isAnimating) return;
        isAnimating = true;
        var cards = getPoolCards();
        var rects = new Map();
        cards.forEach(function(c) { rects.set(c, c.getBoundingClientRect()); });

        if (before) { target.before(draggedCard); }
        else { target.after(draggedCard); }

        getPoolCards().forEach(function(c) {
          if (c === draggedCard) return;
          var old = rects.get(c);
          if (!old) return;
          var now = c.getBoundingClientRect();
          var dy = old.top - now.top;
          if (Math.abs(dy) < 1) return;
          c.style.transition = 'none';
          c.style.transform = 'translateY(' + dy + 'px)';
          c.offsetHeight;
          c.classList.add('flip-animate');
          c.style.transform = '';
        });

        setTimeout(function() {
          getPoolCards().forEach(function(c) {
            c.classList.remove('flip-animate');
            c.style.transition = '';
            c.style.transform = '';
          });
          isAnimating = false;
        }, 160);
      }

      document.addEventListener('dragstart', function(e) {
        var handle = e.target.closest('.pool-drag-handle');
        if (!handle) return;
        draggedCard = handle.closest('.pool-card');
        if (draggedCard) {
          setTimeout(function() { if (draggedCard) draggedCard.classList.add('dragging'); }, 0);
          e.dataTransfer.effectAllowed = 'move';
          e.dataTransfer.setData('text/plain', '');
        }
      });

      document.addEventListener('dragover', function(e) {
        if (!draggedCard || isAnimating) return;
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        var target = e.target.closest('.pool-card');
        if (!target || target === draggedCard) return;

        var cards = getPoolCards();
        var dragIdx = cards.indexOf(draggedCard);
        var targetIdx = cards.indexOf(target);
        if (dragIdx === -1 || targetIdx === -1) return;

        // Only swap if cursor crosses the midpoint of the neighbor
        var rect = target.getBoundingClientRect();
        var mid = rect.top + rect.height / 2;
        if (dragIdx < targetIdx && e.clientY > mid) {
          flipMove(target, false);
        } else if (dragIdx > targetIdx && e.clientY < mid) {
          flipMove(target, true);
        }
      });

      document.addEventListener('drop', function(e) {
        if (!draggedCard) return;
        e.preventDefault();
        draggedCard.classList.remove('dragging');
        draggedCard = null;
      });

      document.addEventListener('dragend', function() {
        if (draggedCard) {
          draggedCard.classList.remove('dragging');
          draggedCard = null;
        }
        isAnimating = false;
      });
    })();

    // ===============================================================
    // UNSAVED CHANGES — warn when switching tabs with dirty cards
    // ===============================================================

    let pendingTabSwitch = null;

    function switchTabWithDirtyCheck(tab) {
      // Check if any visible card is dirty
      const activePanel = document.querySelector('.tab-panel.active');
      if (activePanel) {
        const dirtyCards = activePanel.querySelectorAll('.settings-card.dirty');
        if (dirtyCards.length > 0) {
          pendingTabSwitch = tab;
          openModal('unsavedModal');
          // Override the Leave Anyway button
          const leaveBtn = document.querySelector('#unsavedModal .btn-primary');
          leaveBtn.onclick = () => {
            // Discard all dirty cards in current panel
            dirtyCards.forEach(card => restoreCardState(card));
            closeModal('unsavedModal');
            switchTab(tab);
            pendingTabSwitch = null;
          };
          return;
        }
      }
      switchTab(tab);
    }

    // (Tab handlers already use switchTabWithDirtyCheck from initial setup)

    // ===============================================================
    // FILTER ICON SVG STATES
    // ===============================================================

    const FILTER_SVG_NORMAL = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg>';

    const FILTER_SVG_ASC = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.71999 7.77C1.51999 7.77 1.33999 7.7 1.19999 7.56C1.05999 7.42 0.98999 7.25 0.98999 7.05C0.98999 6.85 1.05999 6.68 1.19999 6.54C1.33999 6.4 1.50999 6.33 1.70999 6.33H8.03999C8.23999 6.33 8.41999 6.4 8.55999 6.54C8.69999 6.68 8.76999 6.85 8.76999 7.05C8.76999 7.25 8.69999 7.42 8.55999 7.56C8.41999 7.7 8.24999 7.77 8.04999 7.77H1.71999Z"/><path d="M1.71999 4.44C1.51999 4.44 1.34999 4.37 1.20999 4.23C1.06999 4.09 0.99999 3.92 0.99999 3.72C0.99999 3.52 1.06999 3.35 1.20999 3.21C1.34999 3.07 1.51999 3 1.71999 3H12.28C12.48 3 12.65 3.07 12.79 3.21C12.93 3.35 13 3.52 13 3.72C13 3.92 12.93 4.09 12.79 4.23C12.65 4.37 12.48 4.44 12.28 4.44H1.71999Z"/><path d="M1.71999 11.09C1.51999 11.09 1.34999 11.02 1.20999 10.88C1.06999 10.74 0.99999 10.57 0.99999 10.37C0.99999 10.17 1.06999 10 1.20999 9.86C1.34999 9.72 1.51999 9.65 1.71999 9.65H4.67999C4.87999 9.65 5.04999 9.72 5.18999 9.86C5.32999 10 5.39999 10.17 5.39999 10.37C5.39999 10.57 5.32999 10.74 5.18999 10.88C5.04999 11.02 4.87999 11.09 4.67999 11.09H1.71999Z"/><path d="M9.18999 12.13L11.53 10.2C11.79 9.99 12.2 9.99 12.45 10.2L14.79 12.13C15.2 12.47 14.91 13.05 14.33 13.05H9.63999C9.05999 13.05 8.76999 12.47 9.17999 12.13H9.18999Z"/></svg>';

    const FILTER_SVG_DESC = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.71999 7.77C1.51999 7.77 1.33999 7.7 1.19999 7.56C1.05999 7.42 0.98999 7.25 0.98999 7.05C0.98999 6.85 1.05999 6.68 1.19999 6.54C1.33999 6.4 1.50999 6.33 1.70999 6.33H8.03999C8.23999 6.33 8.41999 6.4 8.55999 6.54C8.69999 6.68 8.76999 6.85 8.76999 7.05C8.76999 7.25 8.69999 7.42 8.55999 7.56C8.41999 7.7 8.24999 7.77 8.04999 7.77H1.71999Z"/><path d="M1.71999 4.44C1.51999 4.44 1.34999 4.37 1.20999 4.23C1.06999 4.09 0.99999 3.92 0.99999 3.72C0.99999 3.52 1.06999 3.35 1.20999 3.21C1.34999 3.07 1.51999 3 1.71999 3H12.28C12.48 3 12.65 3.07 12.79 3.21C12.93 3.35 13 3.52 13 3.72C13 3.92 12.93 4.09 12.79 4.23C12.65 4.37 12.48 4.44 12.28 4.44H1.71999Z"/><path d="M1.71999 11.09C1.51999 11.09 1.34999 11.02 1.20999 10.88C1.06999 10.74 0.99999 10.57 0.99999 10.37C0.99999 10.17 1.06999 10 1.20999 9.86C1.34999 9.72 1.51999 9.65 1.71999 9.65H4.67999C4.87999 9.65 5.04999 9.72 5.18999 9.86C5.32999 10 5.39999 10.17 5.39999 10.37C5.39999 10.57 5.32999 10.74 5.18999 10.88C5.04999 11.02 4.87999 11.09 4.67999 11.09H1.71999Z"/><path d="M14.81 10.96L12.47 12.89C12.21 13.1 11.8 13.1 11.55 12.89L9.20999 10.96C8.79999 10.62 9.08999 10.04 9.66999 10.04H14.36C14.94 10.04 15.23 10.62 14.82 10.96H14.81Z"/></svg>';

    function updateFilterIconSvg(icon, state) {
      if (state === 'asc') {
        icon.innerHTML = FILTER_SVG_ASC;
      } else if (state === 'desc') {
        icon.innerHTML = FILTER_SVG_DESC;
      } else {
        icon.innerHTML = FILTER_SVG_NORMAL;
      }
    }

    // ===============================================================
    // COLUMN DROPDOWN (Sorting / Pinning)
    // ===============================================================

    const colDropdown = document.getElementById('colDropdown');
    let activeFilterIcon = null;
    let activeColIndex = null;
    let activeTable = null;

    // Open dropdown on filter-icon click
    document.addEventListener('click', function(e) {
      const icon = e.target.closest('.filter-icon');
      if (icon) {
        e.stopPropagation();
        if (activeFilterIcon === icon && colDropdown.classList.contains('open')) {
          closeColDropdown();
          return;
        }
        activeFilterIcon = icon;

        // Determine column index and table
        const th = icon.closest('th') || icon.closest('.col-key, .col-value');
        const table = icon.closest('table') || icon.closest('.headers-table');
        activeTable = table;

        if (th && th.tagName === 'TH') {
          const row = th.closest('tr');
          activeColIndex = Array.from(row.children).indexOf(th);
        } else if (th) {
          const head = th.closest('.headers-table-head');
          activeColIndex = Array.from(head.children).indexOf(th);
        }

        // Update active states
        updateDropdownState();

        // Position dropdown with smart flip
        const rect = icon.getBoundingClientRect();
        colDropdown.style.top = '0';
        colDropdown.style.left = '0';
        colDropdown.style.visibility = 'hidden';
        colDropdown.classList.add('open');

        requestAnimationFrame(() => {
          const ddRect = colDropdown.getBoundingClientRect();
          const spaceBelow = window.innerHeight - rect.bottom - 4;
          const spaceAbove = rect.top - 4;

          // Flip above if not enough space below
          if (ddRect.height > spaceBelow && spaceAbove > spaceBelow) {
            colDropdown.style.top = (rect.top - ddRect.height - 4) + 'px';
          } else {
            colDropdown.style.top = (rect.bottom + 4) + 'px';
          }

          // Horizontal: align left, clamp to viewport
          let left = rect.left;
          if (left + ddRect.width > window.innerWidth - 8) {
            left = window.innerWidth - ddRect.width - 8;
          }
          if (left < 8) left = 8;
          colDropdown.style.left = left + 'px';

          colDropdown.style.visibility = '';
        });
        return;
      }

      // Close if clicking outside
      if (!e.target.closest('.col-dropdown')) {
        closeColDropdown();
      }
    });

    function closeColDropdown() {
      colDropdown.classList.remove('open');
      activeFilterIcon = null;
      activeColIndex = null;
      activeTable = null;
    }

    // Close on Escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && colDropdown.classList.contains('open')) {
        closeColDropdown();
      }
    });

    // Update active/selected states in dropdown
    function updateDropdownState() {
      colDropdown.querySelectorAll('.col-dropdown-item').forEach(item => {
        item.classList.remove('active');
      });
      if (activeFilterIcon) {
        const sortDir = activeFilterIcon.dataset.sortDir;
        if (sortDir === 'asc') {
          colDropdown.querySelector('[data-action="sort-asc"]').classList.add('active');
        } else if (sortDir === 'desc') {
          colDropdown.querySelector('[data-action="sort-desc"]').classList.add('active');
        }
        const pinItem = colDropdown.querySelector('[data-action="pin"]');
        if (activeFilterIcon.dataset.pinned === 'true') {
          pinItem.classList.add('active');
          pinItem.innerHTML = pinItem.innerHTML.replace('Pin Column', 'Unpin Column');
        } else {
          pinItem.innerHTML = pinItem.innerHTML.replace('Unpin Column', 'Pin Column');
        }
      }
    }

    // Handle dropdown item clicks
    colDropdown.addEventListener('click', function(e) {
      const item = e.target.closest('.col-dropdown-item');
      if (!item) return;
      const action = item.dataset.action;

      if (action === 'sort-asc' || action === 'sort-desc') {
        const dir = action === 'sort-asc' ? 'asc' : 'desc';
        // Toggle off if already active
        if (activeFilterIcon.dataset.sortDir === dir) {
          delete activeFilterIcon.dataset.sortDir;
          activeFilterIcon.classList.remove('active');
          updateFilterIconSvg(activeFilterIcon, 'normal');
          // Unsort - restore original order
          unsortTable();
        } else {
          // Clear other sort indicators in the same table
          clearSortInTable();
          activeFilterIcon.dataset.sortDir = dir;
          activeFilterIcon.classList.add('active');
          updateFilterIconSvg(activeFilterIcon, dir);
          sortTable(dir);
        }
      } else if (action === 'pin') {
        togglePinColumn();
      }

      closeColDropdown();
    });

    function sortTable(dir) {
      if (!activeTable || activeColIndex === null) return;

      if (activeTable.classList.contains('headers-table')) {
        sortHeadersTable(activeTable, activeColIndex, dir);
      } else {
        sortHtmlTable(activeTable, activeColIndex, dir);
      }
    }

    function unsortTable() {
      // For demo: just show toast
      showToast('Sort cleared');
    }

    function sortHtmlTable(table, colIdx, dir) {
      const tbody = table.querySelector('tbody');
      if (!tbody) return;
      const rows = Array.from(tbody.querySelectorAll('tr'));

      rows.sort((a, b) => {
        const aText = (a.children[colIdx]?.textContent || '').trim().toLowerCase();
        const bText = (b.children[colIdx]?.textContent || '').trim().toLowerCase();
        if (dir === 'asc') return aText.localeCompare(bText);
        return bText.localeCompare(aText);
      });

      rows.forEach(row => tbody.appendChild(row));
      showToast('Column sorted ' + (dir === 'asc' ? 'ascending' : 'descending'));
    }

    function sortHeadersTable(table, colIdx, dir) {
      const body = table.querySelector('.headers-table-body');
      if (!body) return;
      const rows = Array.from(body.querySelectorAll('.headers-table-row'));

      rows.sort((a, b) => {
        const aText = (a.children[colIdx]?.textContent || '').trim().toLowerCase();
        const bText = (b.children[colIdx]?.textContent || '').trim().toLowerCase();
        if (dir === 'asc') return aText.localeCompare(bText);
        return bText.localeCompare(aText);
      });

      rows.forEach(row => body.appendChild(row));
      showToast('Column sorted ' + (dir === 'asc' ? 'ascending' : 'descending'));
    }

    function clearSortInTable() {
      if (!activeTable) return;
      activeTable.querySelectorAll('.filter-icon').forEach(icon => {
        delete icon.dataset.sortDir;
        icon.classList.remove('active');
        updateFilterIconSvg(icon, 'normal');
      });
    }

    function togglePinColumn() {
      if (!activeFilterIcon || !activeTable || activeColIndex === null) return;

      const isPinned = activeFilterIcon.dataset.pinned === 'true';

      if (isPinned) {
        activeFilterIcon.dataset.pinned = 'false';
        // Unpin: remove sticky styling
        unpinColumn(activeTable, activeColIndex);
        showToast('Column unpinned');
      } else {
        activeFilterIcon.dataset.pinned = 'true';
        // Pin: apply sticky styling
        pinColumn(activeTable, activeColIndex);
        showToast('Column pinned');
      }
    }

    function pinColumn(table, colIdx) {
      if (table.classList.contains('headers-table')) {
        // For div-based headers table
        const allRows = table.querySelectorAll('.headers-table-head, .headers-table-row');
        allRows.forEach(row => {
          const cell = row.children[colIdx];
          if (cell) {
            cell.style.position = 'sticky';
            cell.style.left = '0';
            cell.style.zIndex = '2';
            cell.style.background = '#fff';
            cell.style.boxShadow = '2px 0 4px rgba(0,0,0,0.06)';
          }
        });
      } else {
        // For HTML tables
        const cells = table.querySelectorAll('tr > *:nth-child(' + (colIdx + 1) + ')');
        cells.forEach(cell => {
          cell.style.position = 'sticky';
          cell.style.left = '0';
          cell.style.zIndex = '2';
          cell.style.background = '#fff';
          cell.style.boxShadow = '2px 0 4px rgba(0,0,0,0.06)';
        });
      }
    }

    function unpinColumn(table, colIdx) {
      if (table.classList.contains('headers-table')) {
        const allRows = table.querySelectorAll('.headers-table-head, .headers-table-row');
        allRows.forEach(row => {
          const cell = row.children[colIdx];
          if (cell) {
            cell.style.position = '';
            cell.style.left = '';
            cell.style.zIndex = '';
            cell.style.background = '';
            cell.style.boxShadow = '';
          }
        });
      } else {
        const cells = table.querySelectorAll('tr > *:nth-child(' + (colIdx + 1) + ')');
        cells.forEach(cell => {
          cell.style.position = '';
          cell.style.left = '';
          cell.style.zIndex = '';
          cell.style.background = '';
          cell.style.boxShadow = '';
        });
      }
    }

    // ===============================================================
    // TOOLTIPS (help-icon hover/focus)
    // ===============================================================

    let activeTooltip = null;

    function showTooltipFor(icon) {
      hideTooltip();
      const text = icon.dataset.tooltip;
      if (!text) return;

      const tip = document.createElement('div');
      tip.className = 'tooltip-popover';
      tip.textContent = text;
      tip.style.position = 'fixed';
      tip.style.pointerEvents = 'none';
      tip.style.visibility = 'hidden';
      document.body.appendChild(tip);

      requestAnimationFrame(() => {
        const rect = icon.getBoundingClientRect();
        const tipRect = tip.getBoundingClientRect();
        const spaceBelow = window.innerHeight - rect.bottom - 4;
        const spaceAbove = rect.top - 4;

        // Vertical: below by default, flip above if not enough space
        if (tipRect.height > spaceBelow && spaceAbove > spaceBelow) {
          tip.style.top = (rect.top - tipRect.height - 4) + 'px';
        } else {
          tip.style.top = (rect.bottom + 4) + 'px';
        }

        // Horizontal: center on icon, clamp to viewport
        let left = rect.left + rect.width / 2 - tipRect.width / 2;
        if (left + tipRect.width > window.innerWidth - 8) {
          left = window.innerWidth - tipRect.width - 8;
        }
        if (left < 8) left = 8;
        tip.style.left = left + 'px';

        tip.style.visibility = '';
      });

      activeTooltip = tip;
    }

    function hideTooltip() {
      if (activeTooltip) {
        activeTooltip.remove();
        activeTooltip = null;
      }
    }

    // Auto-assign tooltip text from label context if not set
    const tooltipTexts = {
      'API Key': 'API key used for authenticating scan requests.',
      'Generated Report': 'Configure how scan reports are generated and stored.',
      'Blocked Files': 'Files blocked during the scanning process.',
      'Encryption Key Status': 'Shows the age and status of the current encryption key.',
      'Service Status': 'Enable or disable this service.',
      'Host': 'SMTP server hostname or IP address.',
      'Port': 'SMTP server port number (e.g. 25, 465, 587).',
      'Base URL (optional)': 'Base URL used in email notifications for links.',
      'Sender name (optional)': 'Display name shown in outgoing email notifications.',
      'Sender email address (optional)': 'Email address used as the sender for notifications.',
      'Security option': 'TLS/SSL encryption method for SMTP connection.',
      'Telemetry Data Collection': 'Collect and send anonymous usage telemetry data.',
      'Send Telemetry to OPSWAT': 'Share telemetry data with OPSWAT for product improvement.',
    };

    document.querySelectorAll('.help-icon').forEach(icon => {
      if (!icon.dataset.tooltip) {
        const label = icon.closest('.form-label, .panel-field-label, [class*="label"]');
        if (label) {
          const labelText = label.childNodes[0]?.textContent?.trim() || label.textContent.trim();
          icon.dataset.tooltip = tooltipTexts[labelText] || 'More information about this setting.';
        } else {
          icon.dataset.tooltip = 'More information about this setting.';
        }
      }
      icon.addEventListener('mouseenter', () => showTooltipFor(icon));
      icon.addEventListener('mouseleave', hideTooltip);
      icon.addEventListener('focus', () => showTooltipFor(icon));
      icon.addEventListener('blur', hideTooltip);
    });

    // ===============================================================
    // NAV PAGE SWITCHING
    // ===============================================================

    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        closeMobileSidebar();
        const text = this.querySelector('.nav-text')?.textContent?.trim();
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        this.classList.add('active');

        // Hide all pages, show the selected one
        document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
        if (text === 'Dashboard') {
          document.getElementById('dashboardPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else if (text === 'Audit') {
          document.getElementById('auditPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else if (text === 'Settings') {
          document.getElementById('settingsPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else if (text === 'Users') {
          document.getElementById('usersPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else if (text === 'Jobs') {
          document.getElementById('jobsPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
          // Always show list view when navigating to Jobs
          document.getElementById('jobsListView').style.display = 'block';
          document.getElementById('jobDetailView').style.display = 'none';
        } else if (text === 'Workflows') {
          document.getElementById('workflowsPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
          // Always show list view when navigating to Workflows
          document.getElementById('workflowsListView').style.display = 'flex';
          document.getElementById('workflowDetailView').style.display = 'none';
        } else if (text === 'Reports') {
          document.getElementById('reportsPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else if (text === 'Inventory') {
          document.getElementById('inventoryPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else {
          // For other nav items, show settings by default or show toast
          document.getElementById('componentsPage').style.display = 'none';
          document.getElementById('settingsPage').classList.add('active');
          document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
          document.querySelector('.nav-item .nav-text')?.closest('.nav-item')?.classList.add('active');
          showToast(text + ' page coming soon');
          // Re-highlight the correct nav item
          document.querySelectorAll('.nav-item').forEach(n => {
            if (n.querySelector('.nav-text')?.textContent?.trim() === text) n.classList.add('active');
          });
        }
        // Scroll content to top
        document.querySelector('.content').scrollTop = 0;
      });
    });

    // ===============================================================
    // AUDIT: Generate 50 rows of data
    // ===============================================================
    (function generateAuditData() {
      const tbody = document.getElementById('auditTableBody');
      if (!tbody) return;
      const users = [
        { name: 'Alex Johnson', initials: 'A', color: '#c17a5a,#a8624a' },
        { name: 'Emily Johnson', initials: 'E', color: '#6b8faa,#4a6f8a' },
        { name: 'Irene Miller', initials: 'I', color: '#8a7faa,#6a5f8a' },
        { name: 'Sophia Davis', initials: 'S', color: '#7aaa6b,#5a8a4a' },
        { name: 'Michael Chen', initials: 'M', color: '#aa8a6b,#8a6a4a' },
        { name: 'Sarah Wilson', initials: 'S', color: '#6b7aaa,#4a5a8a' },
        { name: 'David Brown', initials: 'D', color: '#aa6b8a,#8a4a6a' },
        null // System
      ];
      const levels = ['Warning', 'Info', 'Error', 'Warning', 'Info', 'Warning'];
      const categories = ['Settings', 'Scan Activity', 'Authentication', 'Scan Activity', 'Settings', 'Authentication', 'Settings'];
      const types = ['Workflow Technologies refreshed', 'File Discovery Failed', 'Logged In', 'Scan Profile Updated', 'API Key Rotated', 'Password Changed', 'Configuration Updated', 'License Renewed', 'User Role Modified', 'Scan Engine Updated'];
      const details = [
        'Scanning modules for Workflow have been updated. New values applied.',
        'Unable to discover files in the configured storage path.',
        'User authentication session initiated from 192.168.1.45.',
        'Scan profile "Default Cloud" settings modified by administrator.',
        'API key rotation completed successfully for all services.',
        'Password change request processed for user account.',
        'System configuration backup created automatically.',
        'License validation check completed with renewed status.',
        'User role permissions updated in access control system.',
        'MetaDefender Core scan engine definitions updated to latest.',
        'Workflow engine restarted after configuration changes.',
        'File quarantine policy updated for blocked file types.',
        'SMTP notification settings verified and connection tested.',
        'Data retention policy applied to audit records older than 30 days.',
        'SSL certificate renewed for API endpoint connections.'
      ];
      const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      const chevronSvg = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M7.99994 10.7499C7.80994 10.7499 7.61994 10.6799 7.46994 10.5299L3.21994 6.27994C2.92994 5.98994 2.92994 5.50994 3.21994 5.21994C3.50994 4.92994 3.98994 4.92994 4.27994 5.21994L7.99994 8.93994L11.7199 5.21994C12.0099 4.92994 12.4899 4.92994 12.7799 5.21994C13.0699 5.50994 13.0699 5.98994 12.7799 6.27994L8.52994 10.5299C8.37994 10.6799 8.18994 10.7499 7.99994 10.7499Z"/></svg>';
      const copySvg = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg>';
      let html = '';
      for (let i = 0; i < 50; i++) {
        const user = users[i % users.length];
        const level = levels[i % levels.length];
        const category = categories[i % categories.length];
        const type = types[i % types.length];
        const detail = details[i % details.length];
        const month = months[i % 12];
        const day = ((i * 3 + 1) % 28) + 1;
        const hour = ((i * 2 + 8) % 24);
        const minute = (i * 7) % 60;
        const dateStr = month + ' ' + String(day).padStart(2,'0') + ', 2025 ' + String(hour).padStart(2,'0') + ':' + String(minute).padStart(2,'0') + ':00';
        const levelTag = level === 'Error' ? 'tag-alert' : level === 'Info' ? 'tag-accent' : 'tag-warn';
        const detailTrunc = detail.length > 20 ? detail.substring(0, 18) + '...' : detail;
        let userCell;
        if (user) {
          userCell = '<div class="audit-user"><span class="audit-avatar" style="background:linear-gradient(135deg,' + user.color + ');">' + user.initials + '</span> ' + user.name + '</div>';
        } else {
          userCell = '<div class="audit-user">System</div>';
        }
        html += '<tr data-expandable data-detail="' + detail.replace(/"/g, '&quot;') + '">';
        html += '<td class="col-expand"><button class="expand-btn" onclick="toggleAuditRow(this)">' + chevronSvg + '</button></td>';
        html += '<td>' + userCell + '</td>';
        html += '<td><span class="tag ' + levelTag + '">' + level + '</span></td>';
        html += '<td><span class="tag-keyword">' + category + '</span></td>';
        html += '<td>' + type + '</td>';
        html += '<td>' + dateStr + '</td>';
        html += '<td class="col-details">' + detailTrunc + '</td>';
        html += '<td class="col-copy"><button class="copy-btn" onclick="copyAuditRow(this)">' + copySvg + '</button></td>';
        html += '</tr>';
      }
      tbody.innerHTML = html;
      window._auditTotal = 1256;
      window._auditUsers = users;
      window._auditLevels = levels;
      window._auditCategories = categories;
      window._auditTypes = types;
      window._auditDetails = details;
      window._auditChevronSvg = chevronSvg;
      window._auditCopySvg = copySvg;
    })();

    function refreshAuditLog() {
      const tbody = document.getElementById('auditTableBody');
      if (!tbody) return;
      const newCount = 3 + Math.floor(Math.random() * 3); // 3-5 new items
      const users = window._auditUsers;
      const levels = window._auditLevels;
      const categories = window._auditCategories;
      const types = window._auditTypes;
      const details = window._auditDetails;
      const chevronSvg = window._auditChevronSvg;
      const copySvg = window._auditCopySvg;
      const now = new Date();
      const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      let html = '';
      for (let i = 0; i < newCount; i++) {
        const user = users[Math.floor(Math.random() * users.length)];
        const level = levels[Math.floor(Math.random() * levels.length)];
        const category = categories[Math.floor(Math.random() * categories.length)];
        const type = types[Math.floor(Math.random() * types.length)];
        const detail = details[Math.floor(Math.random() * details.length)];
        const d = new Date(now.getTime() - i * 60000);
        const dateStr = months[d.getMonth()] + ' ' + String(d.getDate()).padStart(2,'0') + ', ' + d.getFullYear() + ' ' + String(d.getHours()).padStart(2,'0') + ':' + String(d.getMinutes()).padStart(2,'0') + ':' + String(d.getSeconds()).padStart(2,'0');
        const levelTag = level === 'Error' ? 'tag-alert' : level === 'Info' ? 'tag-accent' : 'tag-warn';
        const detailTrunc = detail.length > 20 ? detail.substring(0, 18) + '...' : detail;
        let userCell;
        if (user) {
          userCell = '<div class="audit-user"><span class="audit-avatar" style="background:linear-gradient(135deg,' + user.color + ');">' + user.initials + '</span> ' + user.name + '</div>';
        } else {
          userCell = '<div class="audit-user">System</div>';
        }
        html += '<tr data-expandable data-detail="' + detail.replace(/"/g, '&quot;') + '" style="background:#f0f7ff;">';
        html += '<td class="col-expand"><button class="expand-btn" onclick="toggleAuditRow(this)">' + chevronSvg + '</button></td>';
        html += '<td>' + userCell + '</td>';
        html += '<td><span class="tag ' + levelTag + '">' + level + '</span></td>';
        html += '<td><span class="tag-keyword">' + category + '</span></td>';
        html += '<td>' + type + '</td>';
        html += '<td>' + dateStr + '</td>';
        html += '<td class="col-details">' + detailTrunc + '</td>';
        html += '<td class="col-copy"><button class="copy-btn" onclick="copyAuditRow(this)">' + copySvg + '</button></td>';
        html += '</tr>';
      }
      tbody.insertAdjacentHTML('afterbegin', html);
      // Fade highlight then remove after 2s
      setTimeout(function() {
        tbody.querySelectorAll('tr[style*="f0f7ff"]').forEach(function(tr) {
          tr.style.transition = 'background 0.5s ease';
          tr.style.background = '';
        });
      }, 2000);
      // Update total count
      window._auditTotal += newCount;
      const countEl = document.getElementById('auditTotalCount');
      if (countEl) countEl.textContent = window._auditTotal.toLocaleString();
      // Update pagination info
      const pageInfo = document.getElementById('auditPageInfo');
      if (pageInfo) {
        const perPage = parseInt(document.getElementById('auditPerPage').value) || 50;
        pageInfo.textContent = '1-' + perPage + ' of ' + window._auditTotal.toLocaleString() + ' items';
      }
      showToast(newCount + ' new events added');
    }

    // ===============================================================
    // DARK MODE TOGGLE
    // ===============================================================
    function toggleDarkMode() {
      const html = document.documentElement;
      const isDark = html.dataset.theme === 'dark';
      if (isDark) {
        delete html.dataset.theme;
      } else {
        html.dataset.theme = 'dark';
      }
      // Toggle icon visibility
      document.querySelectorAll('.theme-icon-moon').forEach(function(el) { el.style.display = isDark ? '' : 'none'; });
      document.querySelectorAll('.theme-icon-sun').forEach(function(el) { el.style.display = isDark ? 'none' : ''; });
      // Update theme label in dropdown
      var themeLabel = document.getElementById('avdThemeLabel');
      if (themeLabel) themeLabel.textContent = isDark ? 'Light Theme' : 'Dark Theme';
      // Update active check in theme submenu
      updateAvdThemeChecks(isDark ? 'light' : 'dark');
    }

    // ===============================================================
    // AVATAR DROPDOWN
    // ===============================================================
    function toggleAvatarDropdown(e) {
      e.stopPropagation();
      var dd = document.getElementById('avatarDropdown');
      if (dd.classList.contains('open')) {
        closeAvatarDropdown();
      } else {
        dd.classList.add('open');
        // Always reset to main menu
        showAvdSub('avdMain');
      }
    }

    function closeAvatarDropdown() {
      var dd = document.getElementById('avatarDropdown');
      if (dd) dd.classList.remove('open');
    }

    // Close dropdown on outside click
    document.addEventListener('click', function(e) {
      var dd = document.getElementById('avatarDropdown');
      if (dd && dd.classList.contains('open')) {
        var wrap = dd.closest('.avatar-dropdown-wrap');
        if (!wrap.contains(e.target)) closeAvatarDropdown();
      }
    });

    // Close dropdown on Escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeAvatarDropdown();
    });

    function showAvdSub(id) {
      var dd = document.getElementById('avatarDropdown');
      dd.querySelectorAll('.avd-submenu').forEach(function(s) { s.classList.remove('open'); });
      document.getElementById(id).classList.add('open');
    }

    function setAvdTheme(theme, btn) {
      var html = document.documentElement;
      if (theme === 'dark') {
        html.dataset.theme = 'dark';
      } else if (theme === 'light') {
        delete html.dataset.theme;
      } else {
        // System default — check prefers-color-scheme
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          html.dataset.theme = 'dark';
        } else {
          delete html.dataset.theme;
        }
      }
      var isDark = html.dataset.theme === 'dark';
      document.querySelectorAll('.theme-icon-moon').forEach(function(el) { el.style.display = isDark ? 'none' : ''; });
      document.querySelectorAll('.theme-icon-sun').forEach(function(el) { el.style.display = isDark ? '' : 'none'; });
      var themeLabel = document.getElementById('avdThemeLabel');
      if (themeLabel) themeLabel.textContent = isDark ? 'Dark Theme' : 'Light Theme';
      updateAvdThemeChecks(theme);
    }

    function updateAvdThemeChecks(activeTheme) {
      var themePanel = document.getElementById('avdTheme');
      if (!themePanel) return;
      themePanel.querySelectorAll('.avd-item').forEach(function(item) {
        item.classList.remove('active');
      });
      var labels = { 'light': 'Light Theme', 'dark': 'Dark Theme', 'system': 'System Default' };
      themePanel.querySelectorAll('.avd-item').forEach(function(item) {
        var text = item.querySelector('.avd-item-text');
        if (text && text.textContent === labels[activeTheme]) {
          item.classList.add('active');
        }
      });
    }

    // ===============================================================
    // AVATAR DROPDOWN NAVIGATION
    // ===============================================================
    function avdNavigate(target) {
      closeAvatarDropdown();
      if (target === 'settings' || target === 'profile') {
        // Navigate to Settings page
        document.querySelectorAll('.page-view').forEach(function(p) { p.classList.remove('active'); });
        document.getElementById('componentsPage').style.display = 'none';
        document.getElementById('settingsPage').classList.add('active');
        document.querySelectorAll('.nav-item').forEach(function(n) { n.classList.remove('active'); });
        document.querySelectorAll('.nav-item').forEach(function(n) {
          if (n.querySelector('.nav-text') && n.querySelector('.nav-text').textContent.trim() === 'Settings') n.classList.add('active');
        });
        // Switch to Profile tab
        var profileTab = document.querySelector('.tab[data-tab="profile"]');
        if (profileTab) switchTab(profileTab);
        document.querySelector('.content').scrollTop = 0;
      }
    }

    // ===============================================================
    // NOTIFICATIONS DROPDOWN
    // ===============================================================
    function toggleNotifDropdown(e) {
      e.stopPropagation();
      closeAvatarDropdown();
      var dd = document.getElementById('notifDropdown');
      if (dd.classList.contains('open')) {
        dd.classList.remove('open');
      } else {
        dd.classList.add('open');
      }
    }

    function closeNotifDropdown() {
      var dd = document.getElementById('notifDropdown');
      if (dd) dd.classList.remove('open');
    }

    document.addEventListener('click', function(e) {
      var dd = document.getElementById('notifDropdown');
      if (dd && dd.classList.contains('open')) {
        var wrap = dd.closest('.notif-dropdown-wrap');
        if (!wrap.contains(e.target)) closeNotifDropdown();
      }
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeNotifDropdown();
    });

    function markAllNotifRead() {
      document.querySelectorAll('.notif-msg-dot').forEach(function(d) { d.style.display = 'none'; });
      document.querySelector('.notif-dot').style.display = 'none';
      showToast('All notifications marked as read');
    }

    function notifNavigateLicensing() {
      closeNotifDropdown();
      // Navigate to Settings > Licensing
      document.querySelectorAll('.page-view').forEach(function(p) { p.classList.remove('active'); });
      document.getElementById('componentsPage').style.display = 'none';
      document.getElementById('settingsPage').classList.add('active');
      document.querySelectorAll('.nav-item').forEach(function(n) { n.classList.remove('active'); });
      document.querySelectorAll('.nav-item').forEach(function(n) {
        if (n.querySelector('.nav-text') && n.querySelector('.nav-text').textContent.trim() === 'Settings') n.classList.add('active');
      });
      // Switch to Licensing tab using the existing switchTab function
      var licensingTab = document.querySelector('.tab[data-tab="licensing"]');
      if (licensingTab) switchTab(licensingTab);
      document.querySelector('.content').scrollTop = 0;
    }

    // ===============================================================
    // AUDIT: Row expansion
    // ===============================================================

    function toggleAuditRow(btn) {
      const row = btn.closest('tr');
      const detail = row.dataset.detail;
      const isOpen = btn.classList.contains('open');

      if (isOpen) {
        btn.classList.remove('open');
        const expandedRow = row.nextElementSibling;
        if (expandedRow && expandedRow.classList.contains('audit-expanded-row')) {
          expandedRow.remove();
        }
      } else {
        btn.classList.add('open');
        const colCount = row.children.length;
        const newRow = document.createElement('tr');
        newRow.classList.add('audit-expanded-row');
        const td = document.createElement('td');
        td.setAttribute('colspan', colCount);
        td.textContent = detail;
        newRow.appendChild(td);
        row.after(newRow);
      }
    }

    // ===============================================================
    // AUDIT: Copy row
    // ===============================================================

    function copyAuditRow(btn) {
      const row = btn.closest('tr');
      const cells = row.querySelectorAll('td');
      const text = Array.from(cells).map(c => c.textContent.trim()).filter(t => t).join(' | ');
      navigator.clipboard?.writeText(text).then(() => {
        showNotification('success', 'Description copied');
      }).catch(() => {
        showNotification('success', 'Description copied');
      });
    }

    // ===============================================================
    // AUDIT: Advanced Filters
    // ===============================================================

    function openAdvancedFilters() {
      document.getElementById('advancedFiltersOverlay').classList.add('open');
      document.getElementById('advancedFiltersPanel').classList.add('open');
    }

    function closeAdvancedFilters() {
      document.getElementById('advancedFiltersOverlay').classList.remove('open');
      document.getElementById('advancedFiltersPanel').classList.remove('open');
    }

    function applyAdvancedFilters() {
      closeAdvancedFilters();
      showToast('Filters applied');
    }

    // Close on overlay click
    document.getElementById('advancedFiltersOverlay')?.addEventListener('click', function() {
      closeAdvancedFilters();
    });

    // ===============================================================
    // AUDIT: Search
    // ===============================================================

    document.getElementById('auditSearchInput')?.addEventListener('input', function() {
      const q = this.value.toLowerCase();
      const rows = document.querySelectorAll('#auditTableBody > tr[data-expandable]');
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(q) ? '' : 'none';
        // Also hide expanded rows
        const next = row.nextElementSibling;
        if (next && next.classList.contains('audit-expanded-row')) {
          next.style.display = text.includes(q) ? '' : 'none';
        }
      });
    });

    // ===============================================================
    // BOOT
    // ===============================================================

    initAccessibility();
    initDirtyTracking();

    // ===============================================================
    // WORKFLOWS
    // ===============================================================
    const workflowNames = ['Default Workflow','Email 2025','Finance','Weekly Scan','Doc Library','User Data','Email 2024','Test WF','Full Disk','Quick Scan'];

    window.showWorkflowsList = function() {
      document.getElementById('workflowsListView').style.display = 'flex';
      document.getElementById('workflowDetailView').style.display = 'none';
    };

    window.openWorkflowDetail = function(index) {
      const name = workflowNames[index] || 'Workflow';
      document.getElementById('workflowsListView').style.display = 'none';
      document.getElementById('workflowDetailView').style.display = 'flex';
      document.getElementById('wfDetailTitle').textContent = name;
    };

    window.toggleWfVerdicts = function() {
      const block = document.getElementById('wfVerdictsBlock');
      if (block) block.style.display = block.style.display === 'none' ? 'flex' : 'none';
    };

    // Drag-to-pan for workflow canvas
    (function() {
      var canvas = document.getElementById('wfCanvas');
      if (!canvas) return;
      var isDragging = false, startX, startY, scrollL, scrollT;
      canvas.addEventListener('mousedown', function(e) {
        if (e.target.closest('.wf-step, .wf-action-btn')) return;
        isDragging = true;
        canvas.classList.add('dragging');
        startX = e.pageX - canvas.offsetLeft;
        startY = e.pageY - canvas.offsetTop;
        scrollL = canvas.scrollLeft;
        scrollT = canvas.scrollTop;
        e.preventDefault();
      });
      canvas.addEventListener('mouseleave', function() { isDragging = false; canvas.classList.remove('dragging'); });
      canvas.addEventListener('mouseup', function() { isDragging = false; canvas.classList.remove('dragging'); });
      canvas.addEventListener('mousemove', function(e) {
        if (!isDragging) return;
        e.preventDefault();
        canvas.scrollLeft = scrollL - (e.pageX - canvas.offsetLeft - startX);
        canvas.scrollTop = scrollT - (e.pageY - canvas.offsetTop - startY);
      });
    })();

    // ===============================================================
    // INVENTORY — tab switching + context menus
    // ===============================================================
    document.getElementById('inventoryTabs').addEventListener('click', function(e) {
      const tab = e.target.closest('.tab');
      if (!tab) return;
      const target = tab.getAttribute('data-inv-tab');
      // Toggle tabs
      this.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      // Toggle panels
      document.querySelectorAll('.inv-tab-panel').forEach(p => p.style.display = 'none');
      const panel = document.getElementById('inv-panel-' + target);
      if (panel) panel.style.display = 'block';
    });

    window.toggleInvMenu = function(btn, e) {
      e.stopPropagation();
      const menu = btn.querySelector('.row-action-menu');
      const wasOpen = menu.classList.contains('open');
      // Close all inline menus first
      document.querySelectorAll('.row-action-menu--inline.open').forEach(m => m.classList.remove('open'));
      if (!wasOpen) menu.classList.add('open');
    };

    // Close inventory context menus on outside click
    document.addEventListener('click', function() {
      document.querySelectorAll('.row-action-menu--inline.open').forEach(m => m.classList.remove('open'));
    });

    // ===============================================================
    // INVENTORY — Account Detail View
    // ===============================================================
    var cbSvg = '<svg class="cb-check" viewBox="0 0 16 16" fill="none"><path d="M6.75 11.75c-.26 0-.51-.1-.71-.29l-2.75-2.75a1.003 1.003 0 011.41-1.41l2.04 2.04 5.05-5.05a1.003 1.003 0 011.41 1.41l-5.75 5.75c-.2.2-.45.29-.71.29z" fill="white"/></svg><svg class="cb-semi" viewBox="0 0 16 16" fill="none"><path d="M11 9H5a1 1 0 010-2h6a1 1 0 010 2z" fill="white"/></svg>';
    /* ---- Fake data generator ---- */
    var _providers = [
      { name: 'Amazon S3', cls: 'aws', label: 'aws' },
      { name: 'SharePoint', cls: 'sharepoint', label: 'SP' },
      { name: 'Azure Blob', cls: 'azure', label: 'Az' },
      { name: 'Google Cloud', cls: 'gcloud', label: 'GC' },
      { name: 'Alibaba Cloud', cls: 'alibaba', label: 'Ali' },
      { name: 'Box', cls: 'box', label: 'Bx' }
    ];
    var _groups = ['Default Group', 'Production', 'Development', 'Staging', 'QA', 'Compliance'];
    var _statuses = [
      { s: 'Operational', tag: 'tag-success', w: 55 },
      { s: 'Issues Found', tag: 'tag-alert', w: 18 },
      { s: 'Pending', tag: 'tag-warning', w: 10 },
      { s: 'Error', tag: 'tag-danger', w: 7 },
      { s: 'Testing', tag: 'tag-info', w: 10 }
    ];
    var _unitNames = [
      'production-assets','staging-uploads','dev-test-bucket','backup-archive-01','media-content',
      'log-storage','customer-data','shared-documents','temp-processing','compliance-vault',
      'team-documents','hr-policies','finance-reports','marketing-assets','engineering-wiki',
      'legal-contracts','shared-workspace','executive-briefs','training-materials','data-lake-raw',
      'analytics-output','ml-models','ci-artifacts','container-registry','secrets-backup',
      'cdn-origin','email-archive','audit-logs','disaster-recovery','user-uploads',
      'vendor-exchange','api-cache','session-store','config-backups','release-binaries',
      'scan-quarantine','threat-samples','dlp-exports','soc-evidence','pentest-reports'
    ];
    var _jobTypes = ['Scheduled','Real-Time','On-Demand'];
    var _jobStatuses = [
      { s: 'Completed', tag: 'tag-success' },
      { s: 'In Progress', tag: 'tag-info' },
      { s: 'Failed', tag: 'tag-danger' },
      { s: 'Queued', tag: 'tag-warning' }
    ];
    var _jobNames = [
      'Scheduled File Scan','Real-Time Scan','Weekly Deep Scan','On-Demand Scan',
      'Compliance Check','Backup Verification','New Files Scan','Monthly Full Scan',
      'Quarantine Review','Malware Sweep','Permission Audit','DLP Content Scan',
      'Incremental Scan','Daily Quick Scan','Threat Hunt','Archive Validation'
    ];
    function _rand(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
    function _pick(arr) { return arr[_rand(0, arr.length - 1)]; }
    function _pickWeighted(arr) {
      var total = arr.reduce(function(s, i) { return s + i.w; }, 0);
      var r = Math.random() * total, acc = 0;
      for (var i = 0; i < arr.length; i++) { acc += arr[i].w; if (r < acc) return arr[i]; }
      return arr[arr.length - 1];
    }
    function _uuid() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0; return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
      });
    }
    function _fmtDate(d) {
      var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
      var h = d.getHours(), m = d.getMinutes(), ampm = h >= 12 ? 'PM' : 'AM';
      h = h % 12 || 12;
      return months[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear() + ' '
        + (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m + ' ' + ampm;
    }
    function _randomDate(daysBack) {
      var d = new Date(); d.setDate(d.getDate() - _rand(0, daysBack));
      d.setHours(_rand(0, 23), _rand(0, 59));
      return d;
    }

    function generateAccountsData() {
      var accounts = [
        { name: 'AWS Production', prov: 0, unitCount: _rand(8, 14) },
        { name: 'SharePoint Corporate', prov: 1, unitCount: _rand(6, 10) },
        { name: 'Azure Data Platform', prov: 2, unitCount: _rand(5, 9) },
        { name: 'GCP Analytics', prov: 3, unitCount: _rand(3, 7) },
        { name: 'Alibaba Cloud OSS', prov: 4, unitCount: _rand(2, 5) },
        { name: 'Box Enterprise', prov: 5, unitCount: _rand(2, 4) }
      ];
      var usedNames = {};
      return accounts.map(function(acctDef) {
        var prov = _providers[acctDef.prov];
        var units = [];
        var opCount = 0, issCount = 0, pendCount = 0;
        for (var i = 0; i < acctDef.unitCount; i++) {
          var uName;
          do { uName = _pick(_unitNames); } while (usedNames[uName]);
          usedNames[uName] = true;
          var st = _pickWeighted(_statuses);
          if (st.s === 'Operational') opCount++;
          else if (st.s === 'Issues Found' || st.s === 'Error') issCount++;
          else pendCount++;
          var grp = _pick(_groups);
          var extraGroups = Math.random() < 0.3 ? _rand(1, 3) : 0;
          var fileCount = st.s === 'Pending' ? 0 : (st.s === 'Error' ? _rand(0, 50) : _rand(0, 120000));
          var lastDate = st.s === 'Pending' ? 'Never' : _fmtDate(_randomDate(st.s === 'Error' ? 30 : 14));
          units.push({
            name: uName,
            status: st.s,
            statusTag: st.tag,
            clientId: _uuid(),
            group: grp,
            groups: extraGroups,
            files: fileCount,
            lastScanned: lastDate
          });
        }
        // Determine account-level status from worst unit
        var acctStatus = 'Operational', acctTag = 'tag-success';
        if (issCount > 0) { acctStatus = 'Issues Found'; acctTag = 'tag-alert'; }
        if (units.some(function(u) { return u.status === 'Error'; })) { acctStatus = 'Error'; acctTag = 'tag-danger'; }
        // Generate jobs for this account
        var jobs = [];
        var jobCount = _rand(3, 12);
        for (var j = 0; j < jobCount; j++) {
          var jst = j === 0 && Math.random() < 0.4 ? _jobStatuses[1] : _pick(_jobStatuses);
          var jFiles = jst.s === 'Failed' ? 0 : _rand(50, 50000);
          var jDet = jst.s === 'Completed' ? _rand(0, Math.ceil(jFiles * 0.03)) : 0;
          var targetUnit = units.length ? _pick(units).name : uName;
          jobs.push({
            name: _pick(_jobNames),
            status: jst.s,
            statusTag: jst.tag,
            type: _pick(_jobTypes),
            files: jFiles,
            detections: jDet,
            date: _fmtDate(_randomDate(60)),
            storageUnit: targetUnit
          });
        }
        jobs.sort(function(a, b) { return new Date(b.date) - new Date(a.date); });
        // Donut data derived from units
        var totalFiles = units.reduce(function(s, u) { return s + u.files; }, 0);
        var cleanPct = totalFiles > 0 ? _rand(55, 95) : 0;
        var suspPct = totalFiles > 0 ? _rand(3, Math.max(4, 100 - cleanPct - 5)) : 0;
        var malPct = Math.max(0, 100 - cleanPct - suspPct);
        return {
          name: acctDef.name,
          provider: prov.name,
          providerClass: prov.cls,
          providerLabel: prov.label,
          status: acctStatus,
          statusTag: acctTag,
          totalUnits: units.length,
          operational: opCount,
          issues: issCount,
          pending: pendCount,
          group: _pick(_groups),
          units: units,
          jobs: jobs,
          donutData: {
            verdicts: { clean: cleanPct, suspicious: suspPct, malicious: malPct },
            fileTypes: { documents: _rand(20, 55), images: _rand(10, 30), archives: _rand(10, 25), other: _rand(5, 15) },
            scanStatus: { scanned: _rand(60, 95), pending: _rand(3, 20), failed: _rand(1, 10) }
          }
        };
      });
    }

    var accountsData = generateAccountsData();

    /* ---- Render accounts list table ---- */
    function renderAccountsList() {
      var tbody = document.getElementById('accountsBody');
      if (!tbody) return;
      var html = '';
      accountsData.forEach(function(acct, idx) {
        // Determine overall status — worst status from units
        var statusMap = { 'Error': 4, 'Issues Found': 3, 'Pending': 2, 'Testing': 1, 'Operational': 0 };
        var worstStatus = 'Operational', worstTag = 'tag-success', worstScore = 0;
        acct.units.forEach(function(u) {
          var score = statusMap[u.status] || 0;
          if (score > worstScore) { worstScore = score; worstStatus = u.status; worstTag = u.statusTag; }
        });
        if (acct.units.length === 0) { worstStatus = 'No Units'; worstTag = 'tag-neutral'; }
        html += '<tr onclick="openAccountDetail(' + idx + ')" style="cursor:pointer;">'
          + '<td>' + acct.name + '</td>'
          + '<td><span class="tag ' + worstTag + '">' + worstStatus + '</span></td>'
          + '<td><div class="inv-provider"><span class="inv-provider-icon ' + acct.providerClass + '"><span style="font-size:8px;' + (acct.providerClass === 'aws' ? 'letter-spacing:-0.5px;' : '') + '">' + acct.providerLabel + '</span></span> ' + acct.provider + '</div></td>'
          + '<td>' + acct.units.length + '</td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu row-action-menu--inline"><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="5"/><path d="M8 5.5v5M5.5 8h5"/></svg> Account Settings</div><div class="inv-context-item danger" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Delete Account</div></div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;
      var countEl = document.getElementById('accountsCount');
      if (countEl) countEl.textContent = accountsData.length;
    }
    renderAccountsList();

    /* ---- Build flat list of all units (for dashboard filter) ---- */
    var _allUnitsFlat = [];
    accountsData.forEach(function(acct) {
      acct.units.forEach(function(u) {
        _allUnitsFlat.push({ unit: u, acct: acct });
      });
    });

    /* ---- Dashboard state ---- */
    var _dashCurrentClientId = _allUnitsFlat.length > 0 ? _allUnitsFlat[0].unit.clientId : null;
    var _dashCurrentPeriod = 30; // days — 7, 30, 90

    /* ---- Populate Dashboard scoped to a single unit + time period ---- */
    function populateDashboard(clientId, periodDays) {
      if (clientId !== undefined && clientId !== null) _dashCurrentClientId = clientId;
      if (periodDays !== undefined && periodDays !== null) _dashCurrentPeriod = periodDays;
      clientId = _dashCurrentClientId;
      periodDays = _dashCurrentPeriod;

      // Find the target unit + its parent account
      var target = null;
      for (var i = 0; i < _allUnitsFlat.length; i++) {
        if (_allUnitsFlat[i].unit.clientId === clientId) { target = _allUnitsFlat[i]; break; }
      }
      if (!target) target = _allUnitsFlat[0]; // fallback to first
      var unit = target.unit, acct = target.acct;

      // Period scale factor (baseline = 30d)
      var pScale = periodDays / 30;

      // Jobs scoped to this unit (filter account jobs by storageUnit name)
      var unitJobs = acct.jobs.filter(function(j) { return j.storageUnit === unit.name; });
      // If none matched, generate a few for this unit
      if (unitJobs.length === 0) {
        for (var jj = 0; jj < _rand(2, 5); jj++) {
          var jst = _pick(_jobStatuses);
          var jFiles = jst.s === 'Failed' ? 0 : _rand(50, 50000);
          var jDet = jst.s === 'Completed' ? _rand(0, Math.ceil(jFiles * 0.03)) : 0;
          unitJobs.push({ name: _pick(_jobNames), status: jst.s, statusTag: jst.tag, type: _pick(_jobTypes), files: jFiles, detections: jDet, date: _fmtDate(_randomDate(60)), storageUnit: unit.name });
        }
      }
      // Filter jobs by time period
      var cutoff = new Date(); cutoff.setDate(cutoff.getDate() - periodDays);
      var periodJobs = unitJobs.filter(function(j) { return new Date(j.date) >= cutoff; });
      // Always show at least some jobs for the period
      if (periodJobs.length === 0) periodJobs = unitJobs.slice(0, Math.max(1, Math.round(unitJobs.length * pScale)));
      var runningJobs = 0, pastJobs = 0;
      periodJobs.forEach(function(j) { if (j.status === 'In Progress') runningJobs++; else pastJobs++; });

      var totalFiles = Math.round(unit.files * pScale) || 0;
      var fmt = function(n) { return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ','); };
      var barPct = function(v, m) { return m > 0 ? Math.round(v / m * 100) + '%' : '0%'; };

      // Derived stats
      var skippedFailed = Math.round(totalFiles * (_rand(5, 15) / 10000)) || _rand(5, 30);
      var goodFiles = Math.max(0, totalFiles - skippedFailed);
      var cached = Math.round(goodFiles * (_rand(88, 96) / 100));
      var scanned = goodFiles - cached;
      var blocked = Math.round(scanned * (_rand(3, 8) / 100));
      var allowed = scanned - blocked;

      var threatTotal = Math.round(scanned * (_rand(10, 25) / 100)) || _rand(50, 300);
      var km = Math.round(threatTotal * 0.65), mb = Math.round(threatTotal * 0.05);
      var ve = Math.round(threatTotal * 0.12), rm = Math.round(threatTotal * 0.13);
      var bp = Math.max(0, threatTotal - km - mb - ve - rm);

      var dlpTotal = Math.round(scanned * (_rand(2, 6) / 100)) || _rand(10, 60);
      var pi = Math.round(dlpTotal * 0.35), st = Math.round(dlpTotal * 0.22);
      var cc = Math.round(dlpTotal * 0.20), ssn = Math.round(dlpTotal * 0.12);
      var dlpOt = Math.max(0, dlpTotal - pi - st - cc - ssn);

      var sanTotal = Math.round(scanned * (_rand(20, 45) / 100)) || _rand(50, 200);
      var im = Math.round(sanTotal * 0.40), hy = Math.round(sanTotal * 0.28);
      var js = Math.round(sanTotal * 0.14), sc = Math.round(sanTotal * 0.10);
      var sanOt = Math.max(0, sanTotal - im - hy - js - sc);

      var dp = document.getElementById('dashboardPage');
      if (!dp) return;

      // 1. Info bar — show selected unit info + provider icon
      var provIcon = document.getElementById('dashProviderIcon');
      if (provIcon) {
        var firstLetter = acct.provider.charAt(0).toUpperCase();
        provIcon.innerHTML = '<span class="dash-provider-letter">' + firstLetter + '</span>';
      }
      var infoSections = dp.querySelectorAll('.info-bar .info-bar-section');
      if (infoSections[0]) {
        var v = infoSections[0].querySelector('.info-bar-value');
        if (v) v.textContent = unit.name;
      }
      if (infoSections[1]) {
        var v = infoSections[1].querySelector('.info-bar-value');
        if (v) v.innerHTML = '<span class="tag ' + unit.statusTag + '">' + unit.status + '</span>';
      }
      if (infoSections[2]) {
        var cid = unit.clientId;
        var vt = infoSections[2].querySelector('.info-bar-value-text');
        if (vt) vt.textContent = cid;
        var cb = infoSections[2].querySelector('.copy-btn');
        if (cb) cb.setAttribute('onclick', "navigator.clipboard.writeText('" + cid + "').then(function(){showNotification('success','Copied to clipboard')})");
      }

      // 2. Banner
      var bd = dp.querySelector('.banner-desc');
      if (bd) bd.textContent = runningJobs + ' job' + (runningJobs !== 1 ? 's' : '') + ' currently running';

      // 3. Job summary count
      var jc = dp.querySelector('.audit-card-title .count');
      if (jc) jc.innerHTML = pastJobs + ' Past <span class="accent">(+' + runningJobs + ' Running)</span>';

      // 4. Donut lockups
      var donuts = dp.querySelectorAll('.dash-donut-lockup');
      if (donuts[0]) { var vv = donuts[0].querySelectorAll('.dash-legend-val'); if(vv[0]) vv[0].innerHTML = fmt(totalFiles) + ' <span class="dash-delta">(+' + fmt(_rand(10,200)) + ')</span>'; if(vv[1]) vv[1].innerHTML = fmt(skippedFailed) + ' <span class="dash-delta">(+' + _rand(1,5) + ')</span>'; }
      if (donuts[1]) { var vv = donuts[1].querySelectorAll('.dash-legend-val'); if(vv[0]) vv[0].textContent = fmt(cached); if(vv[1]) vv[1].innerHTML = fmt(scanned) + ' <span class="dash-delta">(+' + fmt(_rand(20,200)) + ')</span>'; }
      if (donuts[2]) { var vv = donuts[2].querySelectorAll('.dash-legend-val'); if(vv[0]) vv[0].innerHTML = fmt(allowed) + ' <span class="dash-delta">(+' + fmt(_rand(5,50)) + ')</span>'; if(vv[1]) vv[1].innerHTML = fmt(blocked) + ' <span class="dash-delta">(+' + _rand(1,10) + ')</span>'; }

      // 5. Stat cards: [Threats, DLP, Sanitized]
      var cards = dp.querySelectorAll('.dash-stat-card');
      function fillCard(card, total, vals) {
        if (!card) return;
        var tv = card.querySelector('.dash-stat-total-val');
        var d = _rand(1, Math.max(2, Math.round(total * 0.08))), pct = total > 0 ? Math.round(d/total*100) : 0;
        if (tv) tv.innerHTML = fmt(total) + ' <span class="dash-trend-arrow dash-trend-up"><svg viewBox="0 0 12 12" fill="currentColor"><path d="M6 2l4 5H2l4-5z"/></svg></span><span class="dash-trend-text">+' + fmt(d) + ', +' + pct + '%</span>';
        var lr = card.querySelectorAll('.dash-stat-legend-val');
        var mx = Math.max.apply(null, vals);
        lr.forEach(function(el,i) { if (i<vals.length) el.textContent = fmt(vals[i]); });
        var bc = card.querySelectorAll('.dash-bar-col');
        bc.forEach(function(col,i) { if (i<vals.length) { var lb = col.querySelector('.dash-bar-label'); var fl = col.querySelector('.dash-bar-fill'); if(lb) lb.textContent = fmt(vals[i]); if(fl) fl.style.height = barPct(vals[i], mx); } });
      }
      fillCard(cards[0], threatTotal, [km, mb, ve, rm, bp]);
      fillCard(cards[1], dlpTotal, [pi, st, cc, ssn, dlpOt]);
      fillCard(cards[2], sanTotal, [im, hy, js, sc, sanOt]);

      // 6. Trend chart — date spacing based on period
      var tCols = dp.querySelectorAll('.dash-trend-col');
      var tStep = Math.max(1, Math.round(periodDays / tCols.length));
      tCols.forEach(function(col, i) {
        var segs = col.querySelectorAll('.dash-trend-seg');
        var tp = _rand(20, 90), dP = Math.round(tp * _rand(15,35) / 100), sP = Math.round(tp * _rand(30,60) / 100);
        if (segs[0]) segs[0].style.height = tp + '%';
        if (segs[1]) segs[1].style.height = dP + '%';
        if (segs[2]) segs[2].style.height = sP + '%';
        var dl = col.querySelector('.dash-trend-x-label');
        if (dl) { var dd = new Date(); dd.setDate(dd.getDate() - (tCols.length - 1 - i) * tStep); var mn = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']; dl.textContent = mn[dd.getMonth()] + ' ' + dd.getDate(); }
      });

      // 7. Remediation rings
      var rItems = dp.querySelectorAll('.dash-rem-item');
      var rPcts = [_rand(80,98), _rand(30,55), _rand(12,30), _rand(10,25), _rand(5,18), _rand(2,10)];
      rItems.forEach(function(item, i) {
        if (i >= rPcts.length) return;
        var p = rPcts[i];
        var pe = item.querySelector('.dash-rem-ring-pct'); if (pe) pe.textContent = p + '%';
        var rf = item.querySelector('.dash-rem-ring-fill');
        if (rf) { var c = 2 * Math.PI * 22; rf.setAttribute('stroke-dasharray', (c*p/100).toFixed(2) + ' ' + (c - c*p/100).toFixed(2)); }
      });

      // 8. File type distribution — scaled by period
      var ftCounts = [_rand(300,600), _rand(200,400), _rand(150,350), _rand(100,250), _rand(80,200), _rand(50,150), _rand(30,100), _rand(10,60)].map(function(v) { return Math.round(v * pScale); });
      var tmCells = dp.querySelectorAll('.dash-tm-count');
      tmCells.forEach(function(el,i) { if (i<ftCounts.length) el.textContent = fmt(ftCounts[i]); });
      var ftTotal = ftCounts.reduce(function(s,v){return s+v;}, 0);
      var ftTotalEl = dp.querySelector('.dash-filetype-legend-total');
      if (ftTotalEl) ftTotalEl.textContent = fmt(ftTotal);
      var ftVals = dp.querySelectorAll('.dash-ftl-val');
      ftVals.forEach(function(el,i) { if (i<ftCounts.length) el.textContent = fmt(ftCounts[i]); });
      var ftBars = dp.querySelectorAll('.dash-ftl-bar');
      var ftMax = Math.max.apply(null, ftCounts);
      ftBars.forEach(function(el,i) { if (i<ftCounts.length) el.style.width = barPct(ftCounts[i], ftMax); });

      // 9. Jobs in Range table — scoped to this unit + period
      var jirCard = null;
      dp.querySelectorAll('.dash-card').forEach(function(c) { var h = c.querySelector('h3'); if (h && h.textContent.trim() === 'Jobs in Range') jirCard = c; });
      var jirBody = jirCard ? jirCard.querySelector('tbody') : null;
      var jirCount = jirCard ? jirCard.querySelector('.count') : null;
      var recentJobs = periodJobs.sort(function(a,b) { return new Date(b.date) - new Date(a.date); }).slice(0, 5);
      if (jirCount) jirCount.textContent = recentJobs.length;
      if (jirBody) {
        var jTypeTags = { 'Scheduled': 'dash-jt-scheduled', 'Real-Time': 'dash-jt-realtime', 'On-Demand': 'dash-jt-scan-now' };
        var jStatusTags = { 'Completed': 'tag-success', 'In Progress': 'tag-running', 'Failed': 'tag-alert', 'Queued': 'tag-warning' };
        var jStatusLabels = { 'Completed': 'Complete', 'In Progress': 'Running', 'Failed': 'Failed', 'Queued': 'Queued' };
        var jh = '';
        recentJobs.forEach(function(j) {
          var pct = j.status === 'Completed' ? 100 : j.status === 'Failed' ? _rand(10,40) : j.status === 'In Progress' ? _rand(20,85) : 0;
          var barStyle = j.status === 'Failed' ? 'background:var(--danger);' : '';
          jh += '<tr><td>' + j.name + '</td>'
            + '<td><span class="tag ' + (jStatusTags[j.status]||'tag-info') + '">' + (jStatusLabels[j.status]||j.status) + '</span></td>'
            + '<td><span class="dash-job-type-tag ' + (jTypeTags[j.type]||'dash-jt-scheduled') + '">' + j.type + ' Scan</span></td>'
            + '<td><div class="jobs-files-progress"><span>' + fmt(j.files) + '</span><div class="jobs-files-bar"><div class="jobs-files-bar-fill" style="width:' + pct + '%;' + barStyle + '"></div></div><span style="color:var(--text-muted);font-size:12px;">' + pct + '%</span></div></td>'
            + '<td class="jobs-detections' + (j.detections === 0 ? ' none' : '') + '">' + (j.detections > 0 ? fmt(j.detections) : '\u2014') + '</td>'
            + '<td>' + j.date + '</td></tr>';
        });
        jirBody.innerHTML = jh;
      }

      // 10. Dashboard filter dropdown — populate with all units, no aggregate
      var fm = document.getElementById('dashUnitFilterMenu');
      if (fm) {
        var fh = '';
        _allUnitsFlat.forEach(function(entry) {
          var u = entry.unit;
          var isActive = u.clientId === unit.clientId ? ' active' : '';
          fh += '<div class="filter-menu-item' + isActive + '" data-value="' + u.clientId + '" onclick="selectDashUnit(\'' + u.clientId + '\',\'' + u.name.replace(/'/g, "\\'") + '\',this)">' + u.name + '</div>';
        });
        fm.innerHTML = fh;
      }

      // Update filter button text to show selected unit
      var filterText = document.getElementById('dashUnitFilterText');
      if (filterText) filterText.textContent = unit.name;
    }

    /* ---- Dashboard unit selection handler ---- */
    window.selectDashUnit = function(clientId, label, el) {
      // Update active state + close menu
      var menu = el.parentElement;
      menu.querySelectorAll('.filter-menu-item').forEach(function(item) { item.classList.remove('active'); });
      el.classList.add('active');
      el.closest('.filter-btn-wrap').classList.remove('open');
      // Re-populate entire dashboard for selected unit (keep current period)
      populateDashboard(clientId, null);
    };

    /* ---- Dashboard period selection handler ---- */
    window.selectDashPeriod = function(days, label, el) {
      // Update active state + close menu
      var menu = el.parentElement;
      menu.querySelectorAll('.filter-menu-item').forEach(function(item) { item.classList.remove('active'); });
      el.classList.add('active');
      el.closest('.filter-btn-wrap').classList.remove('open');
      // Update button text
      document.getElementById('dashPeriodText').textContent = label;
      // Re-populate dashboard with new period (keep current unit)
      populateDashboard(null, days);
    };

    // Initial render — first unit, 30 days
    populateDashboard(_dashCurrentClientId, 30);

    window._acctDetailIdx = 0;

    /* ---- Pagination state ---- */
    var acctUnitsPage = 1, acctUnitsPerPageNum = 10;
    var acctJobsPage = 1, acctJobsPerPageNum = 10;

    /* ---- Open account detail ---- */
    window.openAccountDetail = function(index) {
      var acct = accountsData[index];
      if (!acct) return;
      window._acctDetailIdx = index;

      // Update header
      document.getElementById('acctDetailTitle').textContent = acct.name;

      // Update overview stats
      document.getElementById('acctStatTotal').textContent = acct.totalUnits;
      document.getElementById('acctStatOp').textContent = acct.operational;
      document.getElementById('acctStatIssues').textContent = acct.issues;
      document.getElementById('acctStatPending').textContent = acct.pending;
      document.getElementById('acctGroupName').textContent = acct.group;
      document.getElementById('acctUnitsCount').textContent = acct.units.length;
      document.getElementById('acctJobsCount').textContent = acct.jobs.length;

      // Update settings panel name
      var nameInput = document.getElementById('acctSettingsName');
      if (nameInput) nameInput.value = acct.name;

      // Reset tabs to units
      document.querySelectorAll('#acctDetailTabs .tab').forEach(function(t) { t.classList.remove('active'); });
      document.querySelector('#acctDetailTabs .tab[data-acct-tab="units"]').classList.add('active');
      document.querySelectorAll('.acct-tab-panel').forEach(function(p) { p.classList.remove('active'); });
      document.getElementById('acct-panel-units').classList.add('active');

      // Render tables
      acctUnitsPage = 1;
      acctJobsPage = 1;
      renderAcctUnits(acct);
      renderAcctJobs(acct);
      renderAcctDonuts(acct);

      // Update job summary meta
      if (acct.jobs.length > 0) {
        document.getElementById('acctJobSummaryMeta').textContent = acct.jobs[0].type + ' \u00B7 ' + acct.jobs[0].date;
        document.getElementById('acctJobSummaryLink').style.display = '';
      } else {
        document.getElementById('acctJobSummaryMeta').textContent = 'No jobs found';
        document.getElementById('acctJobSummaryLink').style.display = 'none';
      }

      // Toggle views — hide parent header + tabs when in detail
      document.getElementById('accountsListView').style.display = 'none';
      document.getElementById('accountDetailView').style.display = 'block';
      document.getElementById('inventoryPageHeader').style.display = 'none';
      document.getElementById('inventoryTabs').style.display = 'none';
      document.querySelector('.content').scrollTop = 0;
    };

    /* ---- Show accounts list ---- */
    window.showAccountsList = function() {
      document.getElementById('accountDetailView').style.display = 'none';
      document.getElementById('accountsListView').style.display = '';
      document.getElementById('inventoryPageHeader').style.display = '';
      document.getElementById('inventoryTabs').style.display = '';
    };

    /* ---- Account detail tabs ---- */
    document.getElementById('acctDetailTabs').addEventListener('click', function(e) {
      var tab = e.target.closest('.tab');
      if (!tab) return;
      var target = tab.getAttribute('data-acct-tab');
      this.querySelectorAll('.tab').forEach(function(t) { t.classList.remove('active'); });
      tab.classList.add('active');
      document.querySelectorAll('.acct-tab-panel').forEach(function(p) { p.classList.remove('active'); });
      var panel = document.getElementById('acct-panel-' + target);
      if (panel) panel.classList.add('active');
    });

    /* ---- Actions dropdown ---- */
    window.toggleAcctActionsMenu = function(e) {
      e.stopPropagation();
      var menu = document.getElementById('acctActionsMenu');
      menu.classList.toggle('open');
    };
    document.addEventListener('click', function() {
      var menu = document.getElementById('acctActionsMenu');
      if (menu) menu.classList.remove('open');
      var grpMenu = document.getElementById('grpActionsMenu');
      if (grpMenu) grpMenu.classList.remove('open');
    });

    /* ================================================================
       GROUPS TAB — Data + Logic
       ================================================================ */
    /* Derive groups from accountsData — each unit has a .group property */
    var groupMap = {};
    accountsData.forEach(function(acct) {
      acct.units.forEach(function(u) {
        var gName = u.group;
        if (!groupMap[gName]) groupMap[gName] = { name: gName, provs: {}, units: [], opCount: 0, errCount: 0, testCount: 0 };
        var g = groupMap[gName];
        g.units.push({
          name: u.name, provider: acct.providerClass, providerName: acct.provider, providerLabel: acct.providerLabel,
          status: u.status, statusTag: u.statusTag, account: acct.name, groups: gName,
          extraGroups: u.groups, clientId: u.clientId, lastJob: u.lastScanned
        });
        g.provs[acct.providerClass] = true;
        if (u.status === 'Operational') g.opCount++;
        else if (u.status === 'Error' || u.status === 'Issues Found') g.errCount++;
        else if (u.status === 'Testing') g.testCount++;
      });
    });
    var groupsData = Object.keys(groupMap).map(function(key) {
      var g = groupMap[key];
      var status = 'Operational', statusTag = 'tag-success';
      if (g.errCount > 0) { status = 'Issues Found'; statusTag = 'tag-alert'; }
      var provKeys = Object.keys(g.provs);
      var jobs = [];
      g.units.slice(0, Math.min(g.units.length, 5)).forEach(function(u) {
        var jst = _pick(_jobStatuses);
        jobs.push({ name: _pick(_jobNames), status: jst.s, statusTag: jst.tag, type: _pick(_jobTypes),
          files: _rand(100, 15000), detections: _rand(0, 12), date: _fmtDate(_randomDate(30)), storageUnit: u.name });
      });
      return { name: key, status: status, statusTag: statusTag, storageUnits: g.units.length,
        providers: provKeys, extraProviders: Math.max(0, provKeys.length - 3),
        totalUnits: g.units.length, operational: g.opCount, errors: g.errCount, testing: g.testCount,
        units: g.units, jobs: jobs };
    });

    var grpPage = 1, grpPerPageNum = 10;
    var grpUnitsPage = 1, grpUnitsPerPageNum = 10;
    var grpJobsPage = 1, grpJobsPerPageNum = 10;
    window._grpDetailIdx = 0;

    function providerIcon(key) {
      var labels = { aws: 'aws', sharepoint: 'SP', azure: 'Az', gcloud: 'GC', alibaba: 'Ali', box: 'Bx' };
      var label = labels[key] || key;
      var style = key === 'aws' ? ' style="font-size:8px;letter-spacing:-0.5px;"' : ' style="font-size:8px;"';
      return '<span class="inv-provider-icon ' + key + '"><span' + style + '>' + label + '</span></span>';
    }

    /* ---- Render groups list ---- */
    function renderGroupsList() {
      var tbody = document.getElementById('groupsBody');
      var search = (document.getElementById('groupsSearch').value || '').toLowerCase();
      var filtered = groupsData.filter(function(g) { return !search || g.name.toLowerCase().indexOf(search) !== -1; });
      var perPage = grpPerPageNum;
      var totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
      if (grpPage > totalPages) grpPage = totalPages;
      var start = (grpPage - 1) * perPage;
      var pageItems = filtered.slice(start, start + perPage);

      document.getElementById('groupsCount').textContent = filtered.length;

      var html = '';
      pageItems.forEach(function(g, i) {
        var provHtml = '';
        var maxShow = 3;
        g.providers.slice(0, maxShow).forEach(function(p) { provHtml += providerIcon(p); });
        if (g.extraProviders) provHtml += ' <span class="count-more">+' + g.extraProviders + ' more</span>';
        else if (g.providers.length > maxShow) provHtml += ' <span class="count-more">+' + (g.providers.length - maxShow) + ' more</span>';

        html += '<tr onclick="openGroupDetail(' + (start + i) + ')" style="cursor:pointer;">'
          + '<td class="col-cb" onclick="event.stopPropagation()"><div class="cb" onclick="toggleCb(this,event)">' + cbSvg + '</div></td>'
          + '<td>' + g.name + '</td>'
          + '<td><span class="tag ' + g.statusTag + '">' + g.status + '</span></td>'
          + '<td>' + g.storageUnits + '</td>'
          + '<td><div style="display:flex;align-items:center;gap:4px;">' + provHtml + '</div></td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>'
          + '<div class="row-action-menu row-action-menu--inline">'
          + '<div class="row-action-menu-item" onclick="event.stopPropagation();openSlidePanel(\'editJobPanel\')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div>'
          + '<div class="row-action-menu-item" onclick="event.stopPropagation();openSlidePanel(\'grpSettingsPanel\')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="5"/><path d="M8 5.5v5M5.5 8h5"/></svg> Group Settings</div>'
          + '<div class="inv-context-item danger" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Delete Group</div>'
          + '</div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;

      // Pagination
      var info = document.getElementById('groupsPageInfo');
      info.textContent = filtered.length ? (start + 1) + '-' + Math.min(start + perPage, filtered.length) + ' of ' + filtered.length + ' items' : '0 items';
      document.getElementById('groupsPrev').disabled = grpPage <= 1;
      document.getElementById('groupsNext').disabled = grpPage >= totalPages;
      var sel = document.getElementById('groupsPageSelect');
      sel.innerHTML = '';
      for (var p = 1; p <= totalPages; p++) { var o = document.createElement('option'); o.textContent = 'Page ' + p; o.selected = p === grpPage; sel.appendChild(o); }

      // Hide pagination if 10 or less
      document.getElementById('groupsPagination').style.display = filtered.length <= 10 ? 'none' : '';
    }

    // Groups search
    document.getElementById('groupsSearch').addEventListener('input', function() { grpPage = 1; renderGroupsList(); });
    // Groups pagination
    document.getElementById('groupsPrev').addEventListener('click', function() { if (grpPage > 1) { grpPage--; renderGroupsList(); } });
    document.getElementById('groupsNext').addEventListener('click', function() { grpPage++; renderGroupsList(); });
    document.getElementById('groupsPageSelect').addEventListener('change', function() { grpPage = this.selectedIndex + 1; renderGroupsList(); });
    document.getElementById('groupsPerPage').addEventListener('change', function() { grpPerPageNum = parseInt(this.value); grpPage = 1; renderGroupsList(); });

    /* ---- Open group detail ---- */
    window.openGroupDetail = function(index) {
      var grp = groupsData[index];
      if (!grp) return;
      window._grpDetailIdx = index;

      document.getElementById('grpDetailTitle').textContent = grp.name;
      document.getElementById('grpStatTotal').textContent = grp.totalUnits;
      document.getElementById('grpStatOp').textContent = grp.operational;
      document.getElementById('grpStatErrors').textContent = grp.errors;
      document.getElementById('grpStatTesting').textContent = grp.testing;
      document.getElementById('grpUnitsCount').textContent = grp.units.length;
      document.getElementById('grpJobsCount').textContent = grp.jobs.length;

      // Reset tabs
      document.querySelectorAll('#grpDetailTabs .tab').forEach(function(t) { t.classList.remove('active'); });
      document.querySelector('#grpDetailTabs .tab[data-grp-tab="units"]').classList.add('active');
      document.querySelectorAll('.grp-tab-panel').forEach(function(p) { p.classList.remove('active'); });
      document.getElementById('grp-panel-units').classList.add('active');

      grpUnitsPage = 1;
      grpJobsPage = 1;
      renderGrpUnits(grp);
      renderGrpJobs(grp);

      document.getElementById('groupsListView').style.display = 'none';
      document.getElementById('groupDetailView').style.display = 'block';
      document.getElementById('inventoryPageHeader').style.display = 'none';
      document.getElementById('inventoryTabs').style.display = 'none';
      document.querySelector('.content').scrollTop = 0;
    };

    window.showGroupsList = function() {
      document.getElementById('groupDetailView').style.display = 'none';
      document.getElementById('groupsListView').style.display = '';
      document.getElementById('inventoryPageHeader').style.display = '';
      document.getElementById('inventoryTabs').style.display = '';
    };

    /* ---- Group detail tabs ---- */
    document.getElementById('grpDetailTabs').addEventListener('click', function(e) {
      var tab = e.target.closest('.tab');
      if (!tab) return;
      var target = tab.getAttribute('data-grp-tab');
      this.querySelectorAll('.tab').forEach(function(t) { t.classList.remove('active'); });
      tab.classList.add('active');
      document.querySelectorAll('.grp-tab-panel').forEach(function(p) { p.classList.remove('active'); });
      var panel = document.getElementById('grp-panel-' + target);
      if (panel) panel.classList.add('active');
    });

    /* ---- Group actions dropdown ---- */
    window.toggleGrpActionsMenu = function(e) {
      e.stopPropagation();
      document.getElementById('grpActionsMenu').classList.toggle('open');
    };

    /* ---- Render group units table ---- */
    function renderGrpUnits(grp) {
      var tbody = document.getElementById('grpUnitsBody');
      var units = grp.units;
      var search = (document.getElementById('grpUnitsSearch').value || '').toLowerCase();
      var filtered = units.filter(function(u) { return !search || u.name.toLowerCase().indexOf(search) !== -1 || u.clientId.toLowerCase().indexOf(search) !== -1; });
      var perPage = grpUnitsPerPageNum;
      var totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
      if (grpUnitsPage > totalPages) grpUnitsPage = totalPages;
      var start = (grpUnitsPage - 1) * perPage;
      var pageItems = filtered.slice(start, start + perPage);

      var html = '';
      pageItems.forEach(function(u) {
        var groupExtra = u.extraGroups > 0 ? ' <span class="count-more">+' + u.extraGroups + ' more</span>' : '';
        html += '<tr>'
          + '<td class="col-cb"><div class="cb" onclick="toggleCb(this,event)">' + cbSvg + '</div></td>'
          + '<td class="col-pinned">' + u.name + '</td>'
          + '<td><div style="display:flex;align-items:center;gap:6px;">' + providerIcon(u.provider) + ' ' + u.providerName + '</div></td>'
          + '<td><span class="tag ' + u.statusTag + '">' + u.status + '</span></td>'
          + '<td style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px;">' + u.account + '</td>'
          + '<td><span class="tag-keyword">' + u.groups + '</span>' + groupExtra + '</td>'
          + '<td><div style="display:flex;align-items:center;gap:4px;"><span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100px;">' + u.clientId + '</span> <button class="btn-icon-xs" onclick="copyClientId(\'' + u.clientId + '\', event)" title="Copy"><svg viewBox="0 0 16 16" fill="currentColor" style="width:12px;height:12px;"><path d="M4 2a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H6a2 2 0 01-2-2V2zm8 0H6v8h6V2zM2 4a2 2 0 00-2 2v8a2 2 0 002 2h6a2 2 0 002-2v-1h-1.5v1a.5.5 0 01-.5.5H2a.5.5 0 01-.5-.5V6a.5.5 0 01.5-.5h1V4H2z"/></svg></button></div></td>'
          + '<td style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:140px;">' + u.lastJob + '</td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>'
          + '<div class="row-action-menu row-action-menu--inline">'
          + '<div class="row-action-menu-item" onclick="event.stopPropagation();openSlidePanel(\'editJobPanel\')"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div>'
          + '<div class="row-action-menu-item"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 3h12M2 8h12M2 13h12"/></svg> View Last Job Report</div>'
          + '<div class="inv-context-item danger" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Remove Unit</div>'
          + '</div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;

      // Pagination
      var info = document.getElementById('grpUnitsPageInfo');
      info.textContent = filtered.length ? (start + 1) + '-' + Math.min(start + perPage, filtered.length) + ' of ' + filtered.length + ' items' : '0 items';
      document.getElementById('grpUnitsPrev').disabled = grpUnitsPage <= 1;
      document.getElementById('grpUnitsNext').disabled = grpUnitsPage >= totalPages;
      var sel = document.getElementById('grpUnitsPageSelect');
      sel.innerHTML = '';
      for (var p = 1; p <= totalPages; p++) { var o = document.createElement('option'); o.textContent = 'Page ' + p; o.selected = p === grpUnitsPage; sel.appendChild(o); }
      document.getElementById('grpUnitsPagination').style.display = filtered.length <= 10 ? 'none' : '';
    }

    // Group units search
    document.getElementById('grpUnitsSearch').addEventListener('input', function() { grpUnitsPage = 1; renderGrpUnits(groupsData[window._grpDetailIdx]); });
    // Group units pagination
    document.getElementById('grpUnitsPrev').addEventListener('click', function() { if (grpUnitsPage > 1) { grpUnitsPage--; renderGrpUnits(groupsData[window._grpDetailIdx]); } });
    document.getElementById('grpUnitsNext').addEventListener('click', function() { var grp = groupsData[window._grpDetailIdx]; var total = Math.ceil(grp.units.length / grpUnitsPerPageNum); if (grpUnitsPage < total) { grpUnitsPage++; renderGrpUnits(grp); } });
    document.getElementById('grpUnitsPageSelect').addEventListener('change', function() { grpUnitsPage = this.selectedIndex + 1; renderGrpUnits(groupsData[window._grpDetailIdx]); });
    document.getElementById('grpUnitsPerPage').addEventListener('change', function() { grpUnitsPerPageNum = parseInt(this.value); grpUnitsPage = 1; renderGrpUnits(groupsData[window._grpDetailIdx]); });

    /* ---- Render group jobs table ---- */
    function renderGrpJobs(grp) {
      var tbody = document.getElementById('grpJobsBody');
      var jobs = grp.jobs;
      var search = (document.getElementById('grpJobsSearch').value || '').toLowerCase();
      var filtered = jobs.filter(function(j) { return !search || j.name.toLowerCase().indexOf(search) !== -1; });
      var perPage = grpJobsPerPageNum;
      var totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
      if (grpJobsPage > totalPages) grpJobsPage = totalPages;
      var start = (grpJobsPage - 1) * perPage;
      var pageItems = filtered.slice(start, start + perPage);

      var html = '';
      pageItems.forEach(function(j) {
        html += '<tr>'
          + '<td class="col-cb"><div class="cb" onclick="toggleCb(this,event)">' + cbSvg + '</div></td>'
          + '<td class="col-pinned">' + j.name + '</td>'
          + '<td><span class="tag ' + j.statusTag + '">' + j.status + '</span></td>'
          + '<td>' + j.type + '</td>'
          + '<td>' + j.files.toLocaleString() + '</td>'
          + '<td>' + j.detections + '</td>'
          + '<td>' + j.date + '</td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>'
          + '<div class="row-action-menu row-action-menu--inline">'
          + '<div class="row-action-menu-item"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 3h12M2 8h12M2 13h12"/></svg> View Report</div>'
          + '</div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;

      document.getElementById('grpJobsCount').textContent = filtered.length;
      var info = document.getElementById('grpJobsPageInfo');
      info.textContent = filtered.length ? (start + 1) + '-' + Math.min(start + perPage, filtered.length) + ' of ' + filtered.length + ' items' : '0 items';
      document.getElementById('grpJobsPrev').disabled = grpJobsPage <= 1;
      document.getElementById('grpJobsNext').disabled = grpJobsPage >= totalPages;
      var sel = document.getElementById('grpJobsPageSelect');
      sel.innerHTML = '';
      for (var p = 1; p <= totalPages; p++) { var o = document.createElement('option'); o.textContent = 'Page ' + p; o.selected = p === grpJobsPage; sel.appendChild(o); }
      document.getElementById('grpJobsPagination').style.display = filtered.length <= 10 ? 'none' : '';
    }

    // Group jobs search
    document.getElementById('grpJobsSearch').addEventListener('input', function() { grpJobsPage = 1; renderGrpJobs(groupsData[window._grpDetailIdx]); });
    // Group jobs pagination
    document.getElementById('grpJobsPrev').addEventListener('click', function() { if (grpJobsPage > 1) { grpJobsPage--; renderGrpJobs(groupsData[window._grpDetailIdx]); } });
    document.getElementById('grpJobsNext').addEventListener('click', function() { var grp = groupsData[window._grpDetailIdx]; var total = Math.ceil(grp.jobs.length / grpJobsPerPageNum); if (grpJobsPage < total) { grpJobsPage++; renderGrpJobs(grp); } });
    document.getElementById('grpJobsPageSelect').addEventListener('change', function() { grpJobsPage = this.selectedIndex + 1; renderGrpJobs(groupsData[window._grpDetailIdx]); });
    document.getElementById('grpJobsPerPage').addEventListener('change', function() { grpJobsPerPageNum = parseInt(this.value); grpJobsPage = 1; renderGrpJobs(groupsData[window._grpDetailIdx]); });

    // Initial render
    renderGroupsList();

    /* ---- Copy Client ID ---- */
    window.copyClientId = function(text, e) {
      e.stopPropagation();
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text);
      }
      var btn = e.currentTarget;
      btn.style.color = 'var(--green-800)';
      setTimeout(function() { btn.style.color = ''; }, 1200);
    };

    /* ---- Render Storage Units table ---- */
    function renderAcctUnits(acct) {
      var tbody = document.getElementById('acctUnitsBody');
      var units = acct.units;
      var search = (document.getElementById('acctUnitsSearch').value || '').toLowerCase();
      var filtered = units.filter(function(u) { return !search || u.name.toLowerCase().indexOf(search) !== -1 || u.clientId.toLowerCase().indexOf(search) !== -1; });
      var perPage = acctUnitsPerPageNum;
      var totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
      if (acctUnitsPage > totalPages) acctUnitsPage = totalPages;
      var start = (acctUnitsPage - 1) * perPage;
      var pageItems = filtered.slice(start, start + perPage);
      var html = '';
      pageItems.forEach(function(u) {
        var groupExtra = u.groups > 0 ? ' <span class="count-more">+' + u.groups + '</span>' : '';
        html += '<tr>'
          + '<td class="col-cb"><div class="cb" onclick="toggleCb(this,event)">' + cbSvg + '</div></td>'
          + '<td class="col-pinned"><div style="display:flex;align-items:center;gap:8px;"><span class="inv-provider-icon ' + acct.providerClass + '">' + acct.providerLabel + '</span> ' + u.name + '</div></td>'
          + '<td><span class="tag ' + u.statusTag + '">' + u.status + '</span></td>'
          + '<td><span class="tag tag-keyword">' + u.group + '</span>' + groupExtra + '</td>'
          + '<td><div class="acct-client-id"><span class="acct-client-id-text" title="' + u.clientId + '">' + u.clientId + '</span><svg class="acct-copy-btn" onclick="copyClientId(\'' + u.clientId + '\', event)" viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg></div></td>'
          + '<td>' + u.lastScanned + '</td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu row-action-menu--inline"><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="5"/><path d="M8 5.5v5M5.5 8h5"/></svg> Edit Unit</div><div class="inv-context-item danger" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Delete Unit</div></div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;

      // Pagination
      var pageSelect = document.getElementById('acctUnitsPageSelect');
      pageSelect.innerHTML = '';
      for (var i = 1; i <= totalPages; i++) {
        pageSelect.innerHTML += '<option' + (i === acctUnitsPage ? ' selected' : '') + '>Page ' + i + '</option>';
      }
      var rangeEnd = Math.min(start + perPage, filtered.length);
      document.getElementById('acctUnitsPageInfo').textContent = filtered.length ? (start + 1) + '-' + rangeEnd + ' of ' + filtered.length + ' items' : '0 items';
      // Update prev/next disabled state
      document.getElementById('acctUnitsPrev').disabled = (acctUnitsPage <= 1);
      document.getElementById('acctUnitsNext').disabled = (acctUnitsPage >= totalPages);
    }

    /* ---- Render Jobs table ---- */
    function renderAcctJobs(acct) {
      var tbody = document.getElementById('acctJobsBody');
      var jobs = acct.jobs;
      var search = (document.getElementById('acctJobsSearch').value || '').toLowerCase();
      var filtered = jobs.filter(function(j) { return !search || j.name.toLowerCase().indexOf(search) !== -1; });
      var perPage = acctJobsPerPageNum;
      var totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
      if (acctJobsPage > totalPages) acctJobsPage = totalPages;
      var start = (acctJobsPage - 1) * perPage;
      var pageItems = filtered.slice(start, start + perPage);
      var html = '';
      pageItems.forEach(function(j) {
        var detColor = j.detections > 0 ? 'var(--red-600)' : 'var(--green-600)';
        html += '<tr>'
          + '<td class="col-cb"><div class="cb" onclick="toggleCb(this,event)">' + cbSvg + '</div></td>'
          + '<td class="col-pinned">' + j.name + '</td>'
          + '<td><span class="tag ' + j.statusTag + '">' + j.status + '</span></td>'
          + '<td>' + j.files.toLocaleString() + '</td>'
          + '<td><span style="display:inline-flex;align-items:center;gap:6px;"><span style="width:8px;height:8px;border-radius:50%;background:' + detColor + ';display:inline-block;"></span> ' + j.detections + '</span></td>'
          + '<td>' + (j.storageUnit || '') + '</td>'
          + '<td>' + j.date + '</td>'
          + '<td>' + j.type + '</td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu row-action-menu--inline"><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M1 8h14"/><path d="M8 1v14"/></svg> View Details</div><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Re-run</div></div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;

      // Pagination
      var pageSelect = document.getElementById('acctJobsPageSelect');
      pageSelect.innerHTML = '';
      for (var i = 1; i <= totalPages; i++) {
        pageSelect.innerHTML += '<option' + (i === acctJobsPage ? ' selected' : '') + '>Page ' + i + '</option>';
      }
      var rangeEnd = Math.min(start + perPage, filtered.length);
      document.getElementById('acctJobsPageInfo').textContent = filtered.length ? (start + 1) + '-' + rangeEnd + ' of ' + filtered.length + ' items' : '0 items';
      // Update prev/next disabled state
      document.getElementById('acctJobsPrev').disabled = (acctJobsPage <= 1);
      document.getElementById('acctJobsNext').disabled = (acctJobsPage >= totalPages);
    }

    /* ---- Donut chart rendering ---- */
    function renderAcctDonuts(acct) {
      var d = acct.donutData;
      var container = document.getElementById('acctDonutRow');
      var r = 15.9155;
      var circ = 100; // 2*PI*r ~ 100

      function donutSVG(title, segments) {
        // segments: [{pct, color, label}]
        var svg = '<div class="acct-donut-item"><svg class="acct-donut-svg" viewBox="0 0 36 36">';
        var offset = 0;
        var total = segments.reduce(function(s, seg) { return s + seg.pct; }, 0);
        // Background circle
        svg += '<circle cx="18" cy="18" r="' + r + '" fill="none" stroke="var(--border-200)" stroke-width="3"/>';
        if (total > 0) {
          segments.forEach(function(seg) {
            if (seg.pct > 0) {
              svg += '<circle cx="18" cy="18" r="' + r + '" fill="none" stroke="' + seg.color + '" stroke-width="3" stroke-dasharray="' + seg.pct + ', ' + (circ - seg.pct) + '" stroke-dashoffset="-' + offset + '"/>';
            }
            offset += seg.pct;
          });
          // Center text
          svg += '<text x="18" y="18" text-anchor="middle" dominant-baseline="central" fill="var(--text-strong)" font-size="8" font-weight="500">' + total + '%</text>';
        } else {
          svg += '<text x="18" y="18" text-anchor="middle" dominant-baseline="central" fill="var(--text-muted)" font-size="6">N/A</text>';
        }
        svg += '</svg>';
        // Labels
        svg += '<div class="acct-donut-labels">';
        svg += '<div style="font-size:12px; font-weight:500; color:var(--text-strong); margin-bottom:4px;">' + title + '</div>';
        segments.forEach(function(seg) {
          svg += '<div class="acct-donut-label-row"><span class="acct-donut-dot" style="background:' + seg.color + ';"></span> ' + seg.label + ' <span>' + seg.pct + '%</span></div>';
        });
        svg += '</div></div>';
        return svg;
      }

      var html = '';
      html += donutSVG('Verdicts', [
        { pct: d.verdicts.clean, color: 'var(--green-800)', label: 'Clean' },
        { pct: d.verdicts.suspicious, color: 'var(--yellow-700)', label: 'Suspicious' },
        { pct: d.verdicts.malicious, color: 'var(--red-700)', label: 'Malicious' }
      ]);
      html += donutSVG('File Types', [
        { pct: d.fileTypes.documents, color: 'var(--blue-700)', label: 'Documents' },
        { pct: d.fileTypes.images, color: 'var(--green-800)', label: 'Images' },
        { pct: d.fileTypes.archives, color: 'var(--yellow-700)', label: 'Archives' },
        { pct: d.fileTypes.other, color: 'var(--text-muted)', label: 'Other' }
      ]);
      html += donutSVG('Scan Status', [
        { pct: d.scanStatus.scanned, color: 'var(--green-800)', label: 'Scanned' },
        { pct: d.scanStatus.pending, color: 'var(--yellow-700)', label: 'Pending' },
        { pct: d.scanStatus.failed, color: 'var(--red-700)', label: 'Failed' }
      ]);
      container.innerHTML = html;
    }

    /* ---- Pagination event listeners ---- */
    document.getElementById('acctUnitsPrev').addEventListener('click', function() {
      if (acctUnitsPage > 1) { acctUnitsPage--; renderAcctUnits(accountsData[window._acctDetailIdx]); }
    });
    document.getElementById('acctUnitsNext').addEventListener('click', function() {
      var acct = accountsData[window._acctDetailIdx];
      var total = Math.max(1, Math.ceil(acct.units.length / acctUnitsPerPageNum));
      if (acctUnitsPage < total) { acctUnitsPage++; renderAcctUnits(acct); }
    });
    document.getElementById('acctUnitsPageSelect').addEventListener('change', function() {
      acctUnitsPage = this.selectedIndex + 1;
      renderAcctUnits(accountsData[window._acctDetailIdx]);
    });
    document.getElementById('acctUnitsPerPage').addEventListener('change', function() {
      acctUnitsPerPageNum = parseInt(this.value);
      acctUnitsPage = 1;
      renderAcctUnits(accountsData[window._acctDetailIdx]);
    });
    document.getElementById('acctUnitsSearch').addEventListener('input', function() {
      acctUnitsPage = 1;
      renderAcctUnits(accountsData[window._acctDetailIdx]);
    });

    document.getElementById('acctJobsPrev').addEventListener('click', function() {
      if (acctJobsPage > 1) { acctJobsPage--; renderAcctJobs(accountsData[window._acctDetailIdx]); }
    });
    document.getElementById('acctJobsNext').addEventListener('click', function() {
      var acct = accountsData[window._acctDetailIdx];
      var total = Math.max(1, Math.ceil(acct.jobs.length / acctJobsPerPageNum));
      if (acctJobsPage < total) { acctJobsPage++; renderAcctJobs(acct); }
    });
    document.getElementById('acctJobsPageSelect').addEventListener('change', function() {
      acctJobsPage = this.selectedIndex + 1;
      renderAcctJobs(accountsData[window._acctDetailIdx]);
    });
    document.getElementById('acctJobsPerPage').addEventListener('change', function() {
      acctJobsPerPageNum = parseInt(this.value);
      acctJobsPage = 1;
      renderAcctJobs(accountsData[window._acctDetailIdx]);
    });
    document.getElementById('acctJobsSearch').addEventListener('input', function() {
      acctJobsPage = 1;
      renderAcctJobs(accountsData[window._acctDetailIdx]);
    });

    // ===============================================================
    // INVENTORY — All Units tab (flattened across accounts)
    // ===============================================================
    var allUnitsPage = 1, allUnitsPerPageNum = 10;
    var allUnitsFilters = { status: [], group: [], provider: [] };

    /* Build flat list of all units from all accounts */
    function getAllUnitsFlat() {
      var flat = [];
      accountsData.forEach(function(acct) {
        acct.units.forEach(function(u) {
          flat.push({
            name: u.name,
            provider: acct.provider,
            providerClass: acct.providerClass,
            providerLabel: acct.providerLabel,
            status: u.status,
            statusTag: u.statusTag,
            account: acct.name,
            group: u.group,
            groups: u.groups,
            clientId: u.clientId,
            lastScanned: u.lastScanned
          });
        });
      });
      return flat;
    }

    function getFilteredUnits() {
      var allUnits = getAllUnitsFlat();
      var search = (document.getElementById('allUnitsSearch').value || '').toLowerCase();
      return allUnits.filter(function(u) {
        if (search && u.name.toLowerCase().indexOf(search) === -1
          && u.clientId.toLowerCase().indexOf(search) === -1
          && u.account.toLowerCase().indexOf(search) === -1
          && u.provider.toLowerCase().indexOf(search) === -1) return false;
        if (allUnitsFilters.status.length && allUnitsFilters.status.indexOf(u.status) === -1) return false;
        if (allUnitsFilters.group.length && allUnitsFilters.group.indexOf(u.group) === -1) return false;
        if (allUnitsFilters.provider.length && allUnitsFilters.provider.indexOf(u.provider) === -1) return false;
        return true;
      });
    }

    function renderAllUnits() {
      var tbody = document.getElementById('allUnitsBody');
      var filtered = getFilteredUnits();

      // Update count badge
      document.getElementById('allUnitsCount').textContent = filtered.length;

      var perPage = allUnitsPerPageNum;
      var totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
      if (allUnitsPage > totalPages) allUnitsPage = totalPages;
      var start = (allUnitsPage - 1) * perPage;
      var pageItems = filtered.slice(start, start + perPage);
      var html = '';
      pageItems.forEach(function(u) {
        var groupExtra = u.groups > 0 ? ' <span class="count-more">+' + u.groups + '</span>' : '';
        html += '<tr>'
          + '<td class="col-cb"><div class="cb" onclick="toggleCb(this,event)">' + cbSvg + '</div></td>'
          + '<td class="col-pinned"><div style="display:flex;align-items:center;gap:8px;"><span class="inv-provider-icon ' + u.providerClass + '">' + u.providerLabel + '</span> ' + u.name + '</div></td>'
          + '<td>' + u.provider + '</td>'
          + '<td><span class="tag ' + u.statusTag + '">' + u.status + '</span></td>'
          + '<td>' + u.account + '</td>'
          + '<td><span class="tag tag-keyword">' + u.group + '</span>' + groupExtra + '</td>'
          + '<td><div class="acct-client-id"><span class="acct-client-id-text" title="' + u.clientId + '">' + u.clientId + '</span><svg class="acct-copy-btn" onclick="copyClientId(\'' + u.clientId + '\', event)" viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg></div></td>'
          + '<td style="white-space:nowrap;">' + u.lastScanned + '</td>'
          + '<td class="col-action"><div class="row-action-btn" onclick="toggleInvMenu(this, event)" style="position:relative"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu row-action-menu--inline"><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 10v3h3M14 6V3h-3"/><path d="M14 3L9 8M2 13l5-5"/></svg> Create Job</div><div class="row-action-menu-item" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="8" cy="8" r="5"/><path d="M8 5.5v5M5.5 8h5"/></svg> Unit Settings</div><div class="inv-context-item danger" onclick="event.stopPropagation()"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 4h10M6 4V3h4v1M5 4v8.5a1 1 0 001 1h4a1 1 0 001-1V4"/></svg> Delete Unit</div></div></div></td>'
          + '</tr>';
      });
      tbody.innerHTML = html;

      // Pagination
      var pageSelect = document.getElementById('allUnitsPageSelect');
      pageSelect.innerHTML = '';
      for (var i = 1; i <= totalPages; i++) {
        pageSelect.innerHTML += '<option' + (i === allUnitsPage ? ' selected' : '') + '>Page ' + i + '</option>';
      }
      var rangeEnd = Math.min(start + perPage, filtered.length);
      document.getElementById('allUnitsPageInfo').textContent = filtered.length ? (start + 1) + '-' + rangeEnd + ' of ' + filtered.length + ' items' : '0 items';
      document.getElementById('allUnitsPrev').disabled = (allUnitsPage <= 1);
      document.getElementById('allUnitsNext').disabled = (allUnitsPage >= totalPages);

      // Update filter button active states
      document.querySelectorAll('#allUnitsHeader .btn-menu').forEach(function(btn) {
        var key = btn.getAttribute('data-filter');
        if (key && allUnitsFilters[key] && allUnitsFilters[key].length > 0) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });

      // Reset bulk bar (new rows have no checked cbs)
      if (typeof updateBulkBar === 'function') updateBulkBar('allUnitsBody');
    }

    /* ---- Filter dropdown system ---- */
    function getUniqueValues(key) {
      var all = getAllUnitsFlat();
      var seen = {};
      return all.reduce(function(arr, u) {
        var val = u[key];
        if (!seen[val]) { seen[val] = true; arr.push(val); }
        return arr;
      }, []).sort();
    }

    function openFilterDropdown(btn, filterKey, e) {
      e.stopPropagation();
      // Close any open dropdown first
      var existing = document.querySelector('.filter-dropdown.open');
      if (existing && existing._filterBtn !== btn) {
        existing.classList.remove('open');
        existing.remove();
      }
      if (existing && existing._filterBtn === btn) {
        existing.classList.remove('open');
        existing.remove();
        return;
      }
      var values = getUniqueValues(filterKey);
      var activeVals = allUnitsFilters[filterKey] || [];
      var dd = document.createElement('div');
      dd.className = 'filter-dropdown open';
      dd._filterBtn = btn;
      var html = '<div class="filter-dropdown-header">' + filterKey.charAt(0).toUpperCase() + filterKey.slice(1) + '</div>';
      values.forEach(function(val) {
        var checked = activeVals.indexOf(val) !== -1;
        html += '<label class="filter-dropdown-item">'
          + '<div class="cb' + (checked ? ' checked' : '') + '" onclick="toggleFilterCb(this, event)">' + cbSvg + '</div>'
          + '<span>' + val + '</span></label>';
      });
      html += '<div class="filter-dropdown-footer">'
        + '<button class="btn-text" onclick="clearFilter(\'' + filterKey + '\', this)">Clear</button>'
        + '<button class="btn-primary" style="height:28px; padding:0 12px; font-size:13px;" onclick="applyFilter(\'' + filterKey + '\', this)">Apply</button>'
        + '</div>';
      dd.innerHTML = html;
      btn.style.position = 'relative';
      btn.appendChild(dd);
    }

    window.toggleFilterCb = function(el, e) {
      e.preventDefault();
      e.stopPropagation();
      el.classList.toggle('checked');
    };

    window.clearFilter = function(key, btn) {
      var dd = btn.closest('.filter-dropdown');
      dd.querySelectorAll('.cb').forEach(function(cb) { cb.classList.remove('checked'); });
    };

    window.applyFilter = function(key, btn) {
      var dd = btn.closest('.filter-dropdown');
      var selected = [];
      dd.querySelectorAll('.filter-dropdown-item').forEach(function(item) {
        if (item.querySelector('.cb.checked')) {
          selected.push(item.querySelector('span').textContent);
        }
      });
      allUnitsFilters[key] = selected;
      allUnitsPage = 1;
      dd.classList.remove('open');
      dd.remove();
      renderAllUnits();
    };

    // Close filter dropdowns on outside click
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.filter-dropdown') && !e.target.closest('.btn-menu[data-filter]')) {
        document.querySelectorAll('.filter-dropdown.open').forEach(function(dd) { dd.classList.remove('open'); dd.remove(); });
      }
    });

    // Wire filter buttons
    document.querySelectorAll('#allUnitsHeader .btn-menu').forEach(function(btn, i) {
      var keys = ['status', 'group', 'provider'];
      btn.setAttribute('data-filter', keys[i]);
      btn.addEventListener('click', function(e) { openFilterDropdown(btn, keys[i], e); });
    });

    /* Pagination handlers */
    document.getElementById('allUnitsPrev').addEventListener('click', function() {
      if (allUnitsPage > 1) { allUnitsPage--; renderAllUnits(); }
    });
    document.getElementById('allUnitsNext').addEventListener('click', function() {
      var total = Math.max(1, Math.ceil(getFilteredUnits().length / allUnitsPerPageNum));
      if (allUnitsPage < total) { allUnitsPage++; renderAllUnits(); }
    });
    document.getElementById('allUnitsPageSelect').addEventListener('change', function() {
      allUnitsPage = this.selectedIndex + 1;
      renderAllUnits();
    });
    document.getElementById('allUnitsPerPage').addEventListener('change', function() {
      allUnitsPerPageNum = parseInt(this.value) || 10;
      allUnitsPage = 1;
      renderAllUnits();
    });
    document.getElementById('allUnitsSearch').addEventListener('input', function() {
      allUnitsPage = 1;
      renderAllUnits();
    });

    /* Initial render on units tab activation */
    document.getElementById('inventoryTabs').addEventListener('click', function(e) {
      var tab = e.target.closest('.tab');
      if (tab && tab.getAttribute('data-inv-tab') === 'units') {
        renderAllUnits();
      }
    });

    // ===============================================================
    // HASH ROUTING — #components accessible via URL only (hidden from nav)
    // ===============================================================
    function showComponentsPage() {
      document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
      document.getElementById('componentsPage').style.display = 'flex';
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      document.querySelector('.content').scrollTop = 0;
    }

    function handleHash() {
      if (window.location.hash === '#components') {
        showComponentsPage();
      }
    }

    handleHash();
    window.addEventListener('hashchange', handleHash);

    // ===============================================================
    // USERS PAGE — data and interactions
    // ===============================================================
    (function initUsersPage() {
      const avatarColors = [
        '#c17a5a', '#6b8faa', '#8a7faa', '#7aaa6b', '#aa8a6b',
        '#6b7aaa', '#aa6b8a', '#5a9a8a', '#9a6b5a', '#7a8aaa'
      ];

      const activeUsers = [
        { name: 'Alex Johnson', initials: 'A', username: 'alex.johnson', email: 'alex.johnson@opswat.com', permissions: 'Admin', color: avatarColors[0] },
        { name: 'Emily Chen', initials: 'E', username: 'emily.chen', email: 'emily.chen@opswat.com', permissions: 'Read-Write', color: avatarColors[1] },
        { name: 'Michael Davis', initials: 'M', username: 'michael.davis', email: 'michael.davis@opswat.com', permissions: 'Read-Only', color: avatarColors[2] },
        { name: 'Sarah Wilson', initials: 'S', username: 'sarah.wilson', email: 'sarah.wilson@opswat.com', permissions: 'Read-Write', color: avatarColors[3] },
        { name: 'David Brown', initials: 'D', username: 'david.brown', email: 'david.brown@opswat.com', permissions: 'Read-Only', color: avatarColors[4] },
        { name: 'Rachel Kim', initials: 'R', username: 'rachel.kim', email: 'rachel.kim@opswat.com', permissions: 'Read-Write', color: avatarColors[5] },
        { name: 'James Miller', initials: 'J', username: 'james.miller', email: 'james.miller@opswat.com', permissions: 'Admin', color: avatarColors[6] },
        { name: 'Olivia Garcia', initials: 'O', username: 'olivia.garcia', email: 'olivia.garcia@opswat.com', permissions: 'Read-Only', color: avatarColors[7] },
        { name: 'William Lee', initials: 'W', username: 'william.lee', email: 'william.lee@opswat.com', permissions: 'Read-Write', color: avatarColors[8] },
        { name: 'Sophia Martinez', initials: 'S', username: 'sophia.martinez', email: 'sophia.martinez@opswat.com', permissions: 'Read-Only', color: avatarColors[9] },
        { name: 'Lucas Anderson', initials: 'L', username: 'lucas.anderson', email: 'lucas.anderson@opswat.com', permissions: 'Read-Write', color: avatarColors[0] },
        { name: 'Natalie Thomas', initials: 'N', username: 'natalie.thomas', email: 'natalie.thomas@opswat.com', permissions: 'Admin', color: avatarColors[1] }
      ];
      let activeUsersPage = 1;
      let activeUsersPerPage = 10;

      const pendingUsers = [];

      function renderActiveUsers() {
        const tbody = document.getElementById('activeUsersBody');
        if (!tbody) return;
        const searchTerm = (document.getElementById('activeUsersSearch').value || '').trim().toLowerCase();
        // Filter with original indices preserved
        const filtered = activeUsers.map((u, i) => ({ user: u, origIndex: i }))
          .filter(({ user: u }) => {
            if (!searchTerm) return true;
            return u.name.toLowerCase().includes(searchTerm) ||
                   u.username.toLowerCase().includes(searchTerm) ||
                   u.email.toLowerCase().includes(searchTerm) ||
                   u.permissions.toLowerCase().includes(searchTerm);
          });
        const total = filtered.length;
        const totalPages = Math.max(1, Math.ceil(total / activeUsersPerPage));
        if (activeUsersPage > totalPages) activeUsersPage = totalPages;
        const start = (activeUsersPage - 1) * activeUsersPerPage;
        const end = Math.min(start + activeUsersPerPage, total);
        const pageUsers = filtered.slice(start, end);

        tbody.innerHTML = pageUsers.map(({ user: u, origIndex: i }) => {
          return `
          <tr>
            <td>
              <div class="user-name-cell">
                <div class="user-avatar" style="background:${u.color}">${u.initials}</div>
                <span class="user-name-text">${u.name}</span>
              </div>
            </td>
            <td>${u.username}</td>
            <td>${u.email}</td>
            <td>${u.permissions}</td>
            <td><span class="tag tag-success">Active</span></td>
            <td class="col-action"><div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="editActiveUser(${i})"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="row-action-menu-item danger" onclick="deleteActiveUser(${i})"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
          </tr>`;
        }).join('');
        document.getElementById('activeUsersCount').textContent = activeUsers.length;

        // Update pagination controls
        const pageInfo = document.getElementById('activeUsersPageInfo');
        if (pageInfo) pageInfo.textContent = total === 0 ? '0 of 0 items' : (start + 1) + '-' + end + ' of ' + total + ' items';
        const prevBtn = document.getElementById('activeUsersPrev');
        const nextBtn = document.getElementById('activeUsersNext');
        if (prevBtn) prevBtn.disabled = activeUsersPage <= 1;
        if (nextBtn) nextBtn.disabled = activeUsersPage >= totalPages;
        const pageSelect = document.getElementById('activeUsersPageSelect');
        if (pageSelect) {
          pageSelect.innerHTML = '';
          for (let p = 1; p <= totalPages; p++) {
            const opt = document.createElement('option');
            opt.textContent = 'Page ' + p;
            opt.selected = p === activeUsersPage;
            pageSelect.appendChild(opt);
          }
        }
        // Hide pagination when items fit on one page
        const paginationEl = document.getElementById('activeUsersPagination');
        if (paginationEl) paginationEl.style.display = total <= activeUsersPerPage ? 'none' : 'flex';
      }

      function renderPendingUsers() {
        const emptyState = document.getElementById('pendingEmptyState');
        const tableWrap = document.getElementById('pendingUsersTableWrap');
        const tbody = document.getElementById('pendingUsersBody');
        const countEl = document.getElementById('pendingUsersCount');
        if (!tbody) return;

        countEl.textContent = pendingUsers.length;

        if (pendingUsers.length === 0) {
          emptyState.style.display = 'flex';
          tableWrap.style.display = 'none';
          return;
        }

        const searchTerm = (document.getElementById('pendingUsersSearch').value || '').trim().toLowerCase();
        const filtered = pendingUsers.map((u, i) => ({ user: u, origIndex: i }))
          .filter(({ user: u }) => {
            if (!searchTerm) return true;
            return u.name.toLowerCase().includes(searchTerm) ||
                   u.username.toLowerCase().includes(searchTerm) ||
                   u.email.toLowerCase().includes(searchTerm) ||
                   u.permissions.toLowerCase().includes(searchTerm);
          });

        emptyState.style.display = 'none';
        tableWrap.style.display = 'block';
        tbody.innerHTML = filtered.map(({ user: u, origIndex: i }) => `
          <tr>
            <td>
              <div class="user-name-cell">
                <div class="user-avatar" style="background:${u.color}">${u.initials}</div>
                <span class="user-name-text">${u.name}</span>
              </div>
            </td>
            <td>${u.username}</td>
            <td>${u.email}</td>
            <td>${u.permissions}</td>
            <td><span class="tag tag-caution">Pending</span></td>
            <td class="col-action"><div class="row-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="row-action-menu"><button class="row-action-menu-item" onclick="approvePendingUser(${i})"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>Approve</button><button class="row-action-menu-item danger" onclick="denyPendingUser(${i})"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"/></svg>Deny</button></div></div></td>
          </tr>
        `).join('');
      }

      // Global functions for action menus
      window.editActiveUser = function(index) {
        if (event) event.stopPropagation();
        const u = activeUsers[index];
        if (!u) return;
        document.querySelectorAll('.row-action-menu.open').forEach(m => m.classList.remove('open'));
        document.getElementById('editUserFullName').value = u.name;
        document.getElementById('editUserUsername').value = u.username;
        document.getElementById('editUserEmail').value = u.email;
        document.getElementById('editUserPermissions').value = u.permissions;
        openSlidePanel('editUserPanel');
        window._editingUserIndex = index;
      };

      window.deleteActiveUser = function(index) {
        if (event) event.stopPropagation();
        document.querySelectorAll('.row-action-menu.open').forEach(m => m.classList.remove('open'));
        activeUsers.splice(index, 1);
        renderActiveUsers();
        showToast('User deleted');
      };

      window.approvePendingUser = function(index) {
        if (event) event.stopPropagation();
        const u = pendingUsers.splice(index, 1)[0];
        document.querySelectorAll('.row-action-menu.open').forEach(m => m.classList.remove('open'));
        if (u) {
          activeUsers.push(u);
          renderPendingUsers();
          renderActiveUsers();
          showToast(u.name + ' approved');
        }
      };

      window.denyPendingUser = function(index) {
        if (event) event.stopPropagation();
        const u = pendingUsers.splice(index, 1)[0];
        document.querySelectorAll('.row-action-menu.open').forEach(m => m.classList.remove('open'));
        renderPendingUsers();
        if (u) showToast(u.name + ' denied');
      };

      window.addUser = function() {
        const name = document.getElementById('addUserFullName').value.trim();
        if (!name) { showToast('Full Name is required'); return; }
        const username = document.getElementById('addUserUsername').value.trim() || name.toLowerCase().replace(/\s+/g, '.');
        const email = document.getElementById('addUserEmail').value.trim() || username + '@opswat.com';
        const permissions = document.getElementById('addUserPermissions').value;
        const initials = name.charAt(0).toUpperCase();
        const color = avatarColors[activeUsers.length % avatarColors.length];

        pendingUsers.push({ name, initials, username, email, permissions, color });
        renderPendingUsers();
        closeSlidePanel('addUserPanel');
        // Clear form
        document.getElementById('addUserFullName').value = '';
        document.getElementById('addUserUsername').value = '';
        document.getElementById('addUserEmail').value = '';
        document.getElementById('addUserPassword').value = '';
        document.getElementById('addUserConfirmPassword').value = '';
        document.getElementById('addUserPermissions').value = 'Read-Only';
        showToast(name + ' added to pending');
      };

      window.saveUser = function() {
        const index = window._editingUserIndex;
        if (index == null || !activeUsers[index]) return;
        activeUsers[index].name = document.getElementById('editUserFullName').value.trim();
        activeUsers[index].username = document.getElementById('editUserUsername').value.trim();
        activeUsers[index].email = document.getElementById('editUserEmail').value.trim();
        activeUsers[index].permissions = document.getElementById('editUserPermissions').value;
        activeUsers[index].initials = activeUsers[index].name.charAt(0).toUpperCase();
        renderActiveUsers();
        closeSlidePanel('editUserPanel');
        showToast('User updated');
      };

      renderActiveUsers();
      renderPendingUsers();

      // Pagination controls
      document.getElementById('activeUsersPrev').addEventListener('click', function() {
        if (activeUsersPage > 1) { activeUsersPage--; renderActiveUsers(); }
      });
      document.getElementById('activeUsersNext').addEventListener('click', function() {
        const searchTerm = (document.getElementById('activeUsersSearch').value || '').trim().toLowerCase();
        const filteredCount = searchTerm ? activeUsers.filter(u => u.name.toLowerCase().includes(searchTerm) || u.username.toLowerCase().includes(searchTerm) || u.email.toLowerCase().includes(searchTerm) || u.permissions.toLowerCase().includes(searchTerm)).length : activeUsers.length;
        const totalPages = Math.ceil(filteredCount / activeUsersPerPage);
        if (activeUsersPage < totalPages) { activeUsersPage++; renderActiveUsers(); }
      });
      document.getElementById('activeUsersPageSelect').addEventListener('change', function() {
        activeUsersPage = this.selectedIndex + 1;
        renderActiveUsers();
      });
      document.getElementById('activeUsersPerPage').addEventListener('change', function() {
        activeUsersPerPage = parseInt(this.value);
        activeUsersPage = 1;
        renderActiveUsers();
      });

      // Search event listeners
      document.getElementById('activeUsersSearch').addEventListener('input', function() {
        activeUsersPage = 1;
        renderActiveUsers();
      });
      document.getElementById('pendingUsersSearch').addEventListener('input', function() {
        renderPendingUsers();
      });
    })();

    // ===============================================================
    // JOBS PAGE — data and interactions
    // ===============================================================
    (function initJobsPage() {

      // ---- Data ----
      // ---- Derive Jobs-page arrays from accountsData ----
      var _jobWorkflows = ['Default Workflow', 'Quick Scan', 'Deep Scan', 'Compliance Workflow', 'Custom Workflow'];
      var _jobPartitions = ['All Partitions', 'Partition A', 'Partition B', 'Partition C'];
      var _jobPriorities = ['High', 'Medium', 'Low'];
      var _jobFrequencies = ['Daily', 'Weekly', 'Monthly'];
      var _elapsedTimes = ['00:12:45', '00:34:22', '01:08:33', '02:34:12', '03:45:10', '05:12:45'];
      var _durations = ['00:32:18', '00:45:12', '01:05:44', '01:23:45', '02:10:30', '03:15:22'];
      var _startsInVals = ['2h 15m', '6h 22m', '12h 30m', '18h 45m', '1d 8h', '2d 14h', '4d 2h', '7d 12h', '12d 8h'];

      const activeJobs = [];
      const upcomingJobs = [];
      const pastJobs = [];
      var _jobId = 1;

      accountsData.forEach(function(acct) {
        var provLabel = acct.provider;
        acct.jobs.forEach(function(j) {
          var unitLabel = provLabel + ' – ' + j.storageUnit;
          var wf = _pick(_jobWorkflows);
          var part = _pick(_jobPartitions);
          var pri = _pick(_jobPriorities);
          var typeLabel = j.type === 'Scheduled' ? 'Scheduled File Scan' : j.type === 'Real-Time' ? 'Real-Time Scan' : 'On-Demand Scan';

          if (j.status === 'In Progress') {
            // Active (running) job
            var pct = _rand(10, 95);
            var processed = Math.round(j.files * pct / 100);
            activeJobs.push({
              id: _jobId++,
              name: j.name,
              type: typeLabel,
              status: 'Running',
              detections: j.detections,
              filesProcessed: processed,
              filesTotal: j.files || _rand(500, 10000),
              storageUnit: unitLabel,
              elapsedTime: _pick(_elapsedTimes),
              startTime: j.date,
              progress: pct,
              workflow: wf,
              partition: part,
              priority: pri
            });
          } else if (j.status === 'Queued') {
            // Upcoming job
            upcomingJobs.push({
              id: _jobId++,
              name: j.name,
              frequency: _pick(_jobFrequencies),
              storageUnit: unitLabel,
              startsIn: _pick(_startsInVals),
              workflow: wf,
              partition: part,
              priority: pri
            });
          } else {
            // Past job (Completed, Failed)
            var statusLabel = j.status === 'Failed' ? 'Stopped' : j.status;
            pastJobs.push({
              id: _jobId++,
              name: j.name,
              type: typeLabel,
              status: statusLabel,
              detections: j.detections,
              filesProcessed: j.files,
              filesTotal: j.files,
              storageUnit: unitLabel,
              duration: _pick(_durations),
              date: j.date,
              workflow: wf,
              partition: part,
              priority: pri
            });
          }
        });
      });

      // Sort past jobs by date descending
      pastJobs.sort(function(a, b) { return new Date(b.date) - new Date(a.date); });

      // Processed files data for job detail
      const processedFiles = [];
      const fileNames = ['document_report_2026.pdf', 'user_data_export.csv', 'config_backup.json', 'application_logs.zip', 'financial_statement_q4.xlsx', 'employee_records.docx', 'system_image_v2.iso', 'database_dump.sql', 'analytics_dashboard.html', 'security_audit.pdf', 'network_traffic.pcap', 'firmware_update.bin', 'email_archive.mbox', 'codebase_snapshot.tar.gz', 'customer_feedback.csv'];
      const verdicts = ['No Threat', 'No Threat', 'No Threat', 'Detected', 'No Threat', 'No Threat', 'Suspicious', 'No Threat', 'No Threat', 'No Threat', 'Detected', 'No Threat', 'No Threat', 'No Threat', 'Benign'];
      const fileTypes = ['PDF', 'CSV', 'JSON', 'ZIP', 'XLSX', 'DOCX', 'ISO', 'SQL', 'HTML', 'PDF', 'PCAP', 'BIN', 'MBOX', 'TAR.GZ', 'CSV'];
      for (let i = 0; i < 35; i++) {
        processedFiles.push({
          name: fileNames[i % fileNames.length],
          verdict: verdicts[i % verdicts.length],
          detections: verdicts[i % verdicts.length] === 'Detected' ? Math.floor(Math.random() * 5) + 1 : 0,
          fileType: fileTypes[i % fileTypes.length],
          scanDate: 'Feb ' + String(24 - Math.floor(i / 8)).padStart(2, '0') + ', 2026 ' + String(8 + (i % 12)).padStart(2, '0') + ':' + String((i * 7) % 60).padStart(2, '0') + ':00'
        });
      }

      let pastJobsPage = 1;
      let pastJobsPerPage = 10;
      let processedFilesPageNum = 1;
      let processedFilesPerPageNum = 10;
      let currentDetailJob = null;

      // ---- Custom checkbox helpers ----
      // (cbSvg defined earlier at top of Inventory section)

      // Three-dot icon for row actions
      const moreIconSvg = `<svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>`;

      // Map tbody id → card header id
      const tbodyToHeader = {
        processedFilesBody: 'processedFilesHeader',
        allUnitsBody: 'allUnitsHeader'
      };

      window.toggleCb = function(el, e) {
        if (e) e.stopPropagation();
        el.classList.toggle('checked');
        el.classList.remove('semi');
        // Toggle selected class on the row
        const tr = el.closest('tr');
        if (tr) tr.classList.toggle('selected', el.classList.contains('checked'));
        // Update header cb state + bulk bar
        const td = el.closest('td');
        if (td) {
          const table = td.closest('table');
          if (table) {
            updateHeaderCb(table);
            const tbody = table.querySelector('tbody');
            if (tbody && tbody.id) updateBulkBar(tbody.id);
          }
        }
      };

      window.toggleAllCb = function(headerCb) {
        const table = headerCb.closest('table');
        if (!table) return;
        const tbody = table.querySelector('tbody');
        if (!tbody) return;
        const isChecked = headerCb.classList.contains('checked') || headerCb.classList.contains('semi');
        const cbs = tbody.querySelectorAll('.cb');
        const rows = tbody.querySelectorAll('tr');
        if (isChecked) {
          headerCb.classList.remove('checked', 'semi');
          cbs.forEach(cb => cb.classList.remove('checked', 'semi'));
          rows.forEach(r => r.classList.remove('selected'));
        } else {
          headerCb.classList.add('checked');
          headerCb.classList.remove('semi');
          cbs.forEach(cb => { cb.classList.add('checked'); cb.classList.remove('semi'); });
          rows.forEach(r => r.classList.add('selected'));
        }
        if (tbody.id) updateBulkBar(tbody.id);
      };

      function updateHeaderCb(table) {
        const headerCb = table.querySelector('thead .cb');
        const bodyCbs = table.querySelectorAll('tbody .cb');
        if (!headerCb || bodyCbs.length === 0) return;
        const checked = table.querySelectorAll('tbody .cb.checked').length;
        headerCb.classList.remove('checked', 'semi');
        if (checked === bodyCbs.length) headerCb.classList.add('checked');
        else if (checked > 0) headerCb.classList.add('semi');
      }

      window.toggleAllJobsCb = function(headerCb, tbodyId) {
        const tbody = document.getElementById(tbodyId);
        if (!tbody) return;
        const isChecked = headerCb.classList.contains('checked') || headerCb.classList.contains('semi');
        const cbs = tbody.querySelectorAll('.cb');
        const rows = tbody.querySelectorAll('tr');
        if (isChecked) {
          headerCb.classList.remove('checked', 'semi');
          cbs.forEach(cb => cb.classList.remove('checked', 'semi'));
          rows.forEach(r => r.classList.remove('selected'));
        } else {
          headerCb.classList.add('checked');
          headerCb.classList.remove('semi');
          cbs.forEach(cb => { cb.classList.add('checked'); cb.classList.remove('semi'); });
          rows.forEach(r => r.classList.add('selected'));
        }
        updateBulkBar(tbodyId);
      };

      // ---- Bulk action bar ----
      function updateBulkBar(tbodyId) {
        const headerId = tbodyToHeader[tbodyId];
        if (!headerId) return;
        const header = document.getElementById(headerId);
        const tbody = document.getElementById(tbodyId);
        if (!header || !tbody) return;
        const count = tbody.querySelectorAll('.cb.checked').length;
        const bulkCount = header.querySelector('[data-bulk-count]');
        if (bulkCount) bulkCount.textContent = count + ' selected';
        if (count > 0) {
          header.classList.add('selected');
        } else {
          header.classList.remove('selected');
        }
      }

      window.bulkAction = function(action, tbodyId) {
        const tbody = document.getElementById(tbodyId);
        if (!tbody) return;
        const count = tbody.querySelectorAll('.cb.checked').length;
        showToast(action.charAt(0).toUpperCase() + action.slice(1) + ' applied to ' + count + ' item(s).');
      };

      // ---- Row action menu ----
      let activeRowMenuBtn = null;
      window.openRowMenu = function(btn, e) {
        e.stopPropagation();
        const menu = document.getElementById('rowActionMenu');
        if (!menu) return;
        // Close if same button
        if (activeRowMenuBtn === btn && menu.classList.contains('open')) {
          menu.classList.remove('open');
          activeRowMenuBtn = null;
          return;
        }
        activeRowMenuBtn = btn;
        const rect = btn.getBoundingClientRect();
        menu.style.top = (rect.bottom + 4) + 'px';
        menu.style.left = (rect.right - 200) + 'px';
        menu.classList.add('open');
      };

      // Close row action menu on outside click
      document.addEventListener('click', function() {
        const menu = document.getElementById('rowActionMenu');
        if (menu) menu.classList.remove('open');
        activeRowMenuBtn = null;
      });

      // Handle row action menu item clicks
      document.getElementById('rowActionMenu')?.addEventListener('click', function(e) {
        const item = e.target.closest('.row-action-menu-item');
        if (item) {
          const action = item.dataset.action;
          showToast('Row action: ' + action);
          this.classList.remove('open');
          activeRowMenuBtn = null;
        }
      });

      // ---- Render Active Jobs ----
      function renderActiveJobs() {
        const tbody = document.getElementById('activeJobsBody');
        const countEl = document.getElementById('activeJobsCount');
        const emptyEl = document.getElementById('activeJobsEmpty');
        const tableWrap = document.getElementById('activeJobsTableWrap');
        if (!tbody) return;

        const searchTerm = (document.getElementById('activeJobsSearch').value || '').trim().toLowerCase();
        const filtered = activeJobs.map((j, i) => ({ job: j, origIndex: i }))
          .filter(({ job: j }) => {
            if (!searchTerm) return true;
            return j.name.toLowerCase().includes(searchTerm) ||
                   j.type.toLowerCase().includes(searchTerm) ||
                   j.status.toLowerCase().includes(searchTerm) ||
                   j.storageUnit.toLowerCase().includes(searchTerm);
          });
        countEl.textContent = activeJobs.length;
        if (filtered.length === 0 && activeJobs.length === 0) {
          emptyEl.style.display = 'flex';
          tableWrap.style.display = 'none';
          return;
        }
        emptyEl.style.display = 'none';
        tableWrap.style.display = 'block';

        tbody.innerHTML = filtered.map(({ job: j, origIndex: i }) => {
          const detClass = j.detections > 0 ? 'jobs-detections' : 'jobs-detections none';
          const statusTag = j.status === 'Running' ? 'tag-success' : 'tag-caution';
          const pct = Math.round((j.filesProcessed / j.filesTotal) * 100);
          return `<tr class="jobs-row-with-progress" style="cursor:pointer;" onclick="openJobDetail(${i}, 'active')">
            <td class="col-pinned">${j.name}</td>
            <td><span class="tag ${statusTag}">${j.status}</span></td>
            <td>${j.type}</td>
            <td><span class="${detClass}">${j.detections > 0 ? j.detections : '—'}</span></td>
            <td>${j.filesProcessed.toLocaleString()} / ${j.filesTotal.toLocaleString()}</td>
            <td>${j.storageUnit}</td>
            <td class="jobs-elapsed">${j.elapsedTime}</td>
            <td>${j.startTime}<span class="jobs-progress-fill" style="width:${pct}%"></span></td>
            <td class="col-action" onclick="event.stopPropagation()"><button class="row-action-btn" onclick="openRowMenu(this,event)">${moreIconSvg}</button></td>
          </tr>`;
        }).join('');
      }

      // ---- Render Upcoming Jobs ----
      function renderUpcomingJobs() {
        const tbody = document.getElementById('upcomingJobsBody');
        const countEl = document.getElementById('upcomingJobsCount');
        const emptyEl = document.getElementById('upcomingJobsEmpty');
        const tableWrap = document.getElementById('upcomingJobsTableWrap');
        if (!tbody) return;

        const searchTerm = (document.getElementById('upcomingJobsSearch').value || '').trim().toLowerCase();
        const filtered = upcomingJobs.filter(j => {
          if (!searchTerm) return true;
          return j.name.toLowerCase().includes(searchTerm) ||
                 j.frequency.toLowerCase().includes(searchTerm) ||
                 j.storageUnit.toLowerCase().includes(searchTerm);
        });
        countEl.textContent = upcomingJobs.length;
        if (filtered.length === 0 && upcomingJobs.length === 0) {
          emptyEl.style.display = 'flex';
          tableWrap.style.display = 'none';
          return;
        }
        emptyEl.style.display = 'none';
        tableWrap.style.display = 'block';

        tbody.innerHTML = filtered.map((j, i) => `<tr>
          <td>${j.name}</td>
          <td>${j.frequency}</td>
          <td>${j.storageUnit}</td>
          <td>${j.startsIn}</td>
          <td class="col-action"><button class="row-action-btn" onclick="openRowMenu(this,event)">${moreIconSvg}</button></td>
        </tr>`).join('');
      }

      // ---- Render Past Jobs ----
      function renderPastJobs() {
        const tbody = document.getElementById('pastJobsBody');
        const countEl = document.getElementById('pastJobsCount');
        if (!tbody) return;

        const searchTerm = (document.getElementById('pastJobsSearch').value || '').trim().toLowerCase();
        const filtered = pastJobs.map((j, i) => ({ job: j, origIndex: i }))
          .filter(({ job: j }) => {
            if (!searchTerm) return true;
            return j.name.toLowerCase().includes(searchTerm) ||
                   j.type.toLowerCase().includes(searchTerm) ||
                   j.status.toLowerCase().includes(searchTerm) ||
                   j.storageUnit.toLowerCase().includes(searchTerm);
          });

        const total = filtered.length;
        countEl.textContent = pastJobs.length;
        const totalPages = Math.max(1, Math.ceil(total / pastJobsPerPage));
        if (pastJobsPage > totalPages) pastJobsPage = totalPages;
        const start = (pastJobsPage - 1) * pastJobsPerPage;
        const end = Math.min(start + pastJobsPerPage, total);
        const page = filtered.slice(start, end);

        tbody.innerHTML = page.map(({ job: j, origIndex: i }) => {
          const detClass = j.detections > 0 ? 'jobs-detections' : 'jobs-detections none';
          const statusTag = j.status === 'Completed' ? 'tag-success' : j.status === 'Stopped' ? 'tag-caution' : 'tag-neutral';
          return `<tr style="cursor:pointer;" onclick="openJobDetail(${i}, 'past')">
            <td class="col-pinned">${j.name}</td>
            <td><span class="tag ${statusTag}">${j.status}</span></td>
            <td>${j.type}</td>
            <td><span class="${detClass}">${j.detections > 0 ? j.detections : '—'}</span></td>
            <td>${j.filesProcessed.toLocaleString()} / ${j.filesTotal.toLocaleString()}</td>
            <td>${j.storageUnit}</td>
            <td class="jobs-elapsed">${j.duration}</td>
            <td>${j.date}</td>
            <td class="col-action" onclick="event.stopPropagation()"><button class="row-action-btn" onclick="openRowMenu(this,event)">${moreIconSvg}</button></td>
          </tr>`;
        }).join('');

        // Update pagination
        const pageInfo = document.getElementById('pastJobsPageInfo');
        if (pageInfo) pageInfo.textContent = total === 0 ? '0 of 0 items' : (start + 1) + '-' + end + ' of ' + total + ' items';
        const prevBtn = document.getElementById('pastJobsPrev');
        const nextBtn = document.getElementById('pastJobsNext');
        if (prevBtn) prevBtn.disabled = pastJobsPage <= 1;
        if (nextBtn) nextBtn.disabled = pastJobsPage >= totalPages;
        const pageSelect = document.getElementById('pastJobsPageSelect');
        if (pageSelect) {
          pageSelect.innerHTML = '';
          for (let p = 1; p <= totalPages; p++) {
            const opt = document.createElement('option');
            opt.textContent = 'Page ' + p;
            opt.selected = p === pastJobsPage;
            pageSelect.appendChild(opt);
          }
        }
        const paginationEl = document.getElementById('pastJobsPagination');
        if (paginationEl) paginationEl.style.display = total <= pastJobsPerPage ? 'none' : 'flex';
      }

      // ---- Render Processed Files (Job Detail) ----
      function renderProcessedFiles() {
        const tbody = document.getElementById('processedFilesBody');
        if (!tbody) return;
        const searchTerm = (document.getElementById('processedFilesSearch').value || '').trim().toLowerCase();
        const filtered = processedFiles.filter(f => {
          if (!searchTerm) return true;
          return f.name.toLowerCase().includes(searchTerm) || f.fileType.toLowerCase().includes(searchTerm) || f.verdict.toLowerCase().includes(searchTerm);
        });
        const total = filtered.length;
        const totalPages = Math.max(1, Math.ceil(total / processedFilesPerPageNum));
        if (processedFilesPageNum > totalPages) processedFilesPageNum = totalPages;
        const start = (processedFilesPageNum - 1) * processedFilesPerPageNum;
        const end = Math.min(start + processedFilesPerPageNum, total);
        const page = filtered.slice(start, end);

        document.getElementById('processedFilesCount').textContent = processedFiles.length;

        tbody.innerHTML = page.map(f => {
          let verdictClass = 'verdict-neutral';
          if (f.verdict === 'Detected') verdictClass = 'verdict-detected';
          else if (f.verdict === 'Suspicious') verdictClass = 'verdict-warn';
          else if (f.verdict === 'Benign') verdictClass = 'verdict-completed';
          const detClass = f.detections > 0 ? 'jobs-detections' : 'jobs-detections none';
          return `<tr>
            <td class="col-cb"><div class="cb" onclick="toggleCb(this,event)">${cbSvg}</div></td>
            <td class="col-pinned">${f.name}</td>
            <td><span class="verdict ${verdictClass}"><span class="verdict-dot"></span><span class="verdict-text">${f.verdict}</span></span></td>
            <td><span class="${detClass}">${f.detections > 0 ? f.detections : '—'}</span></td>
            <td><span class="tag-keyword">${f.fileType}</span></td>
            <td>${f.scanDate}</td>
            <td class="col-action"><button class="row-action-btn" onclick="openRowMenu(this,event)">${moreIconSvg}</button></td>
          </tr>`;
        }).join('');

        // Update pagination
        const pageInfo = document.getElementById('processedFilesPageInfo');
        if (pageInfo) pageInfo.textContent = total === 0 ? '0 of 0 items' : (start + 1) + '-' + end + ' of ' + total + ' items';
        const prevBtn = document.getElementById('processedFilesPrev');
        const nextBtn = document.getElementById('processedFilesNext');
        if (prevBtn) prevBtn.disabled = processedFilesPageNum <= 1;
        if (nextBtn) nextBtn.disabled = processedFilesPageNum >= totalPages;
        const pageSelect = document.getElementById('processedFilesPageSelect');
        if (pageSelect) {
          pageSelect.innerHTML = '';
          for (let p = 1; p <= totalPages; p++) {
            const opt = document.createElement('option');
            opt.textContent = 'Page ' + p;
            opt.selected = p === processedFilesPageNum;
            pageSelect.appendChild(opt);
          }
        }
        const paginationEl = document.getElementById('processedFilesPagination');
        if (paginationEl) paginationEl.style.display = total <= processedFilesPerPageNum ? 'none' : 'flex';
      }

      // ---- Open Job Detail ----
      window.openJobDetail = function(index, source) {
        const job = source === 'active' ? activeJobs[index] : pastJobs[index];
        if (!job) return;
        currentDetailJob = job;

        document.getElementById('jobsListView').style.display = 'none';
        document.getElementById('jobDetailView').style.display = 'block';
        document.getElementById('jobDetailTitle').textContent = job.name;

        // Show/hide cancel and report buttons
        const cancelBtn = document.getElementById('jobDetailCancelBtn');
        const reportBtn = document.getElementById('jobDetailReportBtn');
        if (job.status === 'Running') {
          cancelBtn.style.display = '';
          reportBtn.style.display = 'none';
        } else {
          cancelBtn.style.display = 'none';
          reportBtn.style.display = job.status === 'Completed' ? '' : 'none';
        }

        // Status banner
        const bannerEl = document.getElementById('jobStatusBanner');
        if (job.status === 'Completed') {
          bannerEl.style.display = '';
          bannerEl.innerHTML = '<div class="job-completed-banner"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm3.78 5.28l-4.25 4.25a.75.75 0 01-1.06 0l-2.25-2.25a.75.75 0 111.06-1.06L7 8.94l3.72-3.72a.75.75 0 111.06 1.06z"/></svg>Job completed successfully on ' + (job.date || job.startTime) + '</div>';
        } else if (job.status === 'Stopped') {
          bannerEl.style.display = '';
          bannerEl.innerHTML = '<div class="job-stopped-banner"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>Job was stopped on ' + (job.date || job.startTime) + '</div>';
        } else {
          bannerEl.style.display = 'none';
        }

        // Job info grid
        const statusTag = job.status === 'Running' ? 'tag-success' : job.status === 'Completed' ? 'tag-success' : job.status === 'Stopped' ? 'tag-caution' : 'tag-neutral';
        const infoGrid = document.getElementById('jobInfoGrid');
        infoGrid.innerHTML = `
          <div class="job-info-item">
            <span class="job-info-label">Storage Unit</span>
            <span class="job-info-value">${job.storageUnit}</span>
          </div>
          <div class="job-info-item">
            <span class="job-info-label">Scan Type</span>
            <span class="job-info-value">${job.type}</span>
          </div>
          <div class="job-info-item">
            <span class="job-info-label">Status</span>
            <span class="job-info-value"><span class="tag ${statusTag}">${job.status}</span></span>
          </div>
          <div class="job-info-item">
            <span class="job-info-label">Workflow</span>
            <span class="job-info-value">${job.workflow || 'Default Workflow'}</span>
          </div>
          <div class="job-info-item">
            <span class="job-info-label">Partition</span>
            <span class="job-info-value">${job.partition || 'All Partitions'}</span>
          </div>
          <div class="job-info-item">
            <span class="job-info-label">Started</span>
            <span class="job-info-value">${job.startTime || job.date}</span>
          </div>
          <div class="job-info-item">
            <span class="job-info-label">Priority</span>
            <span class="job-info-value">${job.priority || 'Medium'}</span>
          </div>
        `;

        // Summary stats
        const summaryEl = document.getElementById('jobSummaryStats');
        const threats = job.detections || 0;
        const clean = (job.filesProcessed || 0) - threats;
        summaryEl.innerHTML = `
          <div class="job-summary-stat">
            <span class="job-summary-stat-label">Files Processed</span>
            <span class="job-summary-stat-value">${(job.filesProcessed || 0).toLocaleString()}</span>
          </div>
          <div class="job-summary-stat">
            <span class="job-summary-stat-label">Threats Detected</span>
            <span class="job-summary-stat-value${threats > 0 ? ' alert' : ''}">${threats}</span>
          </div>
          <div class="job-summary-stat">
            <span class="job-summary-stat-label">Clean Files</span>
            <span class="job-summary-stat-value success">${clean.toLocaleString()}</span>
          </div>
        `;

        processedFilesPageNum = 1;
        renderProcessedFiles();
        document.querySelector('.content').scrollTop = 0;
      };

      // ---- Show Jobs List ----
      window.showJobsList = function() {
        document.getElementById('jobsListView').style.display = 'block';
        document.getElementById('jobDetailView').style.display = 'none';
        currentDetailJob = null;
        document.querySelector('.content').scrollTop = 0;
      };

      // ---- Edit Upcoming Job ----
      window.editUpcomingJob = function(index) {
        const j = upcomingJobs[index];
        if (!j) return;
        document.getElementById('editJobTitle').textContent = 'Edit Job';
        document.getElementById('editJobName').value = j.name;
        // Set priority
        document.querySelectorAll('#editJobPriority .priority-toggle-btn').forEach(b => {
          b.classList.toggle('active', b.dataset.priority === j.priority);
        });
        openSlidePanel('editJobPanel');
      };

      // ---- Create Job ----
      window.createJob = function() {
        const name = document.getElementById('editJobName').value.trim();
        if (!name) { showToast('Scan Name is required'); return; }
        const activePriorityBtn = document.querySelector('#editJobPriority .priority-toggle-btn.active');
        const priority = activePriorityBtn ? activePriorityBtn.dataset.priority : 'Medium';
        const workflow = document.getElementById('editJobWorkflow').value;
        const partition = document.getElementById('editJobPartition').value;
        const storageUnit = document.getElementById('editJobStorageUnit').value;

        // Check which scan type is selected
        const activeTab = document.querySelector('#editJobScanTypeTabs .tab.active');
        const scanType = activeTab ? activeTab.dataset.tab : 'scan-now';

        if (scanType === 'schedule-scan') {
          upcomingJobs.push({
            id: Date.now(),
            name: name,
            frequency: document.getElementById('editJobReoccurrence')?.value || 'Once',
            storageUnit: storageUnit,
            startsIn: '24h 0m',
            workflow: workflow,
            partition: partition,
            priority: priority
          });
          renderUpcomingJobs();
          showToast('Scheduled job created: ' + name);
        } else {
          activeJobs.push({
            id: Date.now(),
            name: name,
            type: scanType === 'realtime-scan' ? 'Real-Time Scan' : 'Scheduled File Scan',
            status: 'Running',
            detections: 0,
            filesProcessed: 0,
            filesTotal: 1000,
            storageUnit: storageUnit,
            elapsedTime: '00:00:00',
            startTime: new Date().toLocaleDateString('en-US', { month: 'short', day: '2-digit', year: 'numeric' }) + ' ' + new Date().toLocaleTimeString('en-US', { hour12: false }),
            progress: 0,
            workflow: workflow,
            partition: partition,
            priority: priority
          });
          renderActiveJobs();
          showToast('Job started: ' + name);
        }

        closeSlidePanel('editJobPanel');
        // Reset form
        document.getElementById('editJobName').value = '';
        document.getElementById('editJobTitle').textContent = 'New Job';
      };

      // ---- Cancel Job Modal ----
      window.openCancelJobModal = function() {
        document.getElementById('cancelJobModal').classList.add('open');
      };
      window.closeCancelJobModal = function() {
        document.getElementById('cancelJobModal').classList.remove('open');
      };
      window.confirmCancelJob = function() {
        if (currentDetailJob) {
          const idx = activeJobs.findIndex(j => j.id === currentDetailJob.id);
          if (idx !== -1) {
            const cancelled = activeJobs.splice(idx, 1)[0];
            cancelled.status = 'Cancelled';
            cancelled.duration = cancelled.elapsedTime;
            cancelled.date = cancelled.startTime;
            pastJobs.unshift(cancelled);
          }
          closeCancelJobModal();
          showJobsList();
          renderActiveJobs();
          renderPastJobs();
          showToast('Job cancelled');
        }
      };

      // ---- Job Details Panel ----
      window.populateJobDetailsPanel = function() {
        if (!currentDetailJob) return;
        const j = currentDetailJob;
        const body = document.getElementById('jobDetailsPanelBody');
        body.innerHTML = `
          <div class="panel-field">
            <span class="panel-field-label">Job Name</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.name}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Job Type</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.type}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Status</span>
            <span class="tag ${j.status === 'Running' ? 'tag-success' : j.status === 'Completed' ? 'tag-success' : 'tag-caution'}">${j.status}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Storage Unit</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.storageUnit}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Workflow</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.workflow || 'Default Workflow'}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Partition</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.partition || 'All Partitions'}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Priority</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.priority || 'Medium'}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Started</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.startTime || j.date}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Duration / Elapsed</span>
            <span style="font-size:14px; color:var(--text-strong);">${j.elapsedTime || j.duration || '—'}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Files Processed</span>
            <span style="font-size:14px; color:var(--text-strong);">${(j.filesProcessed || 0).toLocaleString()} / ${(j.filesTotal || 0).toLocaleString()}</span>
          </div>
          <div class="panel-field">
            <span class="panel-field-label">Detections</span>
            <span style="font-size:14px; color:${j.detections > 0 ? '#d40031' : 'var(--text-strong)'}; font-weight:${j.detections > 0 ? '500' : '400'};">${j.detections || 0}</span>
          </div>
        `;
      };

      // Override openSlidePanel for job details to populate content
      const origOpenSlidePanel = window.openSlidePanel || openSlidePanel;
      const wrappedOpen = function(id) {
        if (id === 'jobDetailsPanel') {
          populateJobDetailsPanel();
        }
        origOpenSlidePanel(id);
      };
      // Don't override globally - instead use event delegation
      // Patch the onclick for job details button
      const jobDetailsBtn = document.querySelector('#jobDetailView .btn-outline[onclick*="jobDetailsPanel"]');
      if (jobDetailsBtn) {
        jobDetailsBtn.onclick = function() {
          populateJobDetailsPanel();
          openSlidePanel('jobDetailsPanel');
        };
      }

      // ---- Advanced Filters ----
      window.toggleAfChip = function(el) {
        el.classList.toggle('selected');
      };
      window.resetJobsFilters = function() {
        document.querySelectorAll('.af-chip.selected').forEach(c => c.classList.remove('selected'));
        document.getElementById('jobsFilterDetections').value = 'Any';
        document.getElementById('jobsFilterDateFrom').value = '';
        document.getElementById('jobsFilterDateTo').value = '';
      };
      window.applyJobsFilters = function() {
        closeSlidePanel('jobsFiltersPanel');
        renderPastJobs();
        showToast('Filters applied');
      };

      // ---- Edit Job Panel: Scan Type Tabs ----
      document.querySelectorAll('#editJobScanTypeTabs .tab').forEach(tab => {
        tab.addEventListener('click', function() {
          document.querySelectorAll('#editJobScanTypeTabs .tab').forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          // Show reoccurrence field only for schedule scan
          const reoccField = document.getElementById('editJobReoccurrenceField');
          if (reoccField) reoccField.style.display = this.dataset.tab === 'schedule-scan' ? '' : 'none';
        });
      });

      // ---- Priority Toggle ----
      document.querySelectorAll('#editJobPriority .priority-toggle-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('#editJobPriority .priority-toggle-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // ---- Past Jobs Pagination ----
      document.getElementById('pastJobsPrev').addEventListener('click', function() {
        if (pastJobsPage > 1) { pastJobsPage--; renderPastJobs(); }
      });
      document.getElementById('pastJobsNext').addEventListener('click', function() {
        const searchTerm = (document.getElementById('pastJobsSearch').value || '').trim().toLowerCase();
        const filteredCount = searchTerm ? pastJobs.filter(j => j.name.toLowerCase().includes(searchTerm) || j.type.toLowerCase().includes(searchTerm)).length : pastJobs.length;
        const totalPages = Math.ceil(filteredCount / pastJobsPerPage);
        if (pastJobsPage < totalPages) { pastJobsPage++; renderPastJobs(); }
      });
      document.getElementById('pastJobsPageSelect').addEventListener('change', function() {
        pastJobsPage = this.selectedIndex + 1;
        renderPastJobs();
      });
      document.getElementById('pastJobsPerPage').addEventListener('change', function() {
        pastJobsPerPage = parseInt(this.value);
        pastJobsPage = 1;
        renderPastJobs();
      });
      document.getElementById('pastJobsSearch').addEventListener('input', function() {
        pastJobsPage = 1;
        renderPastJobs();
      });
      document.getElementById('activeJobsSearch').addEventListener('input', function() {
        renderActiveJobs();
      });
      document.getElementById('upcomingJobsSearch').addEventListener('input', function() {
        renderUpcomingJobs();
      });

      // ---- Processed Files Pagination ----
      document.getElementById('processedFilesPrev').addEventListener('click', function() {
        if (processedFilesPageNum > 1) { processedFilesPageNum--; renderProcessedFiles(); }
      });
      document.getElementById('processedFilesNext').addEventListener('click', function() {
        const totalPages = Math.ceil(processedFiles.length / processedFilesPerPageNum);
        if (processedFilesPageNum < totalPages) { processedFilesPageNum++; renderProcessedFiles(); }
      });
      document.getElementById('processedFilesPageSelect').addEventListener('change', function() {
        processedFilesPageNum = this.selectedIndex + 1;
        renderProcessedFiles();
      });
      document.getElementById('processedFilesPerPage').addEventListener('change', function() {
        processedFilesPerPageNum = parseInt(this.value);
        processedFilesPageNum = 1;
        renderProcessedFiles();
      });
      document.getElementById('processedFilesSearch').addEventListener('input', function() {
        processedFilesPageNum = 1;
        renderProcessedFiles();
      });

      // ---- Initial Render ----
      renderActiveJobs();
      renderUpcomingJobs();
      renderPastJobs();
    })();

  </script>
</body>
</html>