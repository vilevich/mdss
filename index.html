<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MetaDefender Storage Security - Settings</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    @font-face { font-family: 'Simplon Norm'; src: url('fonts/simplonnorm-regular-webfont.woff2') format('woff2'); font-weight: 400; font-style: normal; font-display: swap; }
    @font-face { font-family: 'Simplon Norm'; src: url('fonts/simplonnorm-medium-webfont.woff2') format('woff2'); font-weight: 500; font-style: normal; font-display: swap; }
    @font-face { font-family: 'Simplon Norm'; src: url('fonts/simplonnorm-bold-webfont.woff2') format('woff2'); font-weight: 700; font-style: normal; font-display: swap; }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --font: 'Roboto', sans-serif;
      --font-brand: 'Simplon Norm', sans-serif;
      --text-strong: #0c121d;
      --text-subtle: #344565;
      --text-muted: #6b7a90;
      --surface-bg: #f8f9f9;
      --surface-card: #ffffff;
      --border-200: #dee0e4;
      --border-card: #ebecee;
      --border-bg: #ebecee;
      --primary: #1d6bfc;
      --primary-hover: #1854c3;
      --toggle-active: #1d6bfc;
      --toggle-inactive: #c7ccd5;
      --tab-bg: #ebecee;
      --tab-active-bg: #1a2138;
      --tab-text: #344565;
      --tab-active-text: #ffffff;
      --shadow-card: 1px 3px 4px -2px rgba(12,18,29,0.04), 2px 2px 4px 0px rgba(12,18,29,0.04);
      --radius: 4px;
      --sidebar-width: 260px;
      --sidebar-collapsed: 60px;
      --header-bg: #1a2138;
    }

    body {
      font-family: var(--font);
      font-size: 14px;
      line-height: 1.5;
      color: var(--text-strong);
      background: var(--surface-bg);
      min-height: 100vh;
    }

    /* ===== LAYOUT ===== */
    .app { display: flex; flex-direction: column; height: 100vh; }

    /* ===== HEADER ===== */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 56px;
      padding: 0 20px;
      background: var(--surface-bg);
      color: var(--text-strong);
      flex-shrink: 0;
      z-index: 10;
      border-bottom: 1px solid var(--border-bg);
    }
    .header-left { display: flex; align-items: center; gap: 12px; margin-left: -7px; }
    .header-logo { display: flex; align-items: center; gap: 10px; }
    .header-logo-icon {
      width: 28px; height: 28px;
      background: var(--header-bg);
      border-radius: 4px;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 12px; color: #fff;
    }
    .header-logo-text { display: flex; flex-direction: column; gap: 4px; font-family: var(--font-brand); }
    .header-logo-text span:first-child { font-size: 10px; font-weight: 400; line-height: 10px; color: #0C121D; letter-spacing: 0.5px; text-transform: uppercase; }
    .header-logo-text span:last-child { font-size: 16px; font-weight: 500; line-height: 16px; color: #0C121D; }
    .sidebar-toggle {
      width: 32px; height: 32px; border-radius: var(--radius);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-subtle); background: none; border: none;
    }
    .sidebar-toggle:hover { color: var(--text-strong); background: rgba(0,0,0,0.06); }
    .sidebar-toggle svg { width: 18px; height: 18px; }
    .header-right { display: flex; align-items: center; gap: 8px; }
    .header-icon {
      width: 32px; height: 32px; border-radius: var(--radius);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-subtle);
    }
    .header-icon:hover { color: var(--text-strong); background: rgba(0,0,0,0.06); }
    .header-icon svg { width: 18px; height: 18px; }
    .notif-dot {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 8px;
      height: 8px;
      border-radius: 9999px;
      background: #FF003D;
      pointer-events: none;
    }
    .header-avatar {
      width: 32px; height: 32px; border-radius: 50%;
      background: linear-gradient(135deg, #6b7faa, #4a5f8a);
      border: 2px solid rgba(0,0,0,0.1);
      margin-left: 12px;
      display: flex; align-items: center; justify-content: center;
      font-size: 14px; font-weight: 500; color: #fff;
      cursor: pointer;
    }

    /* ===== MAIN ===== */
    .main { display: flex; flex: 1; min-height: 0; }

    /* ===== SIDEBAR ===== */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--surface-bg);
      border-right: 1px solid var(--border-bg);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      transition: width 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
    }
    .sidebar.collapsed {
      width: var(--sidebar-collapsed);
    }
    .content {
      transition: flex 0.25s cubic-bezier(0.4, 0, 0.2, 1) 0.03s;
    }
    .sidebar-nav {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
      padding: 8px;
    }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: var(--radius);
      font-size: 14px;
      color: var(--text-subtle);
      cursor: pointer;
      text-decoration: none;
      height: 40px;
      white-space: nowrap;
      overflow: hidden;
    }
    .nav-item:hover { background: rgba(0,0,0,0.04); }
    .nav-item.active { background: #E8F0FF; color: var(--text-strong); font-weight: 500; }
    .nav-item svg { width: 18px; height: 18px; flex-shrink: 0; }
    .nav-text { opacity: 1; transition: opacity 0.12s ease; }
    .sidebar.collapsed .nav-item { padding: 8px 12px; }
    .sidebar.collapsed .nav-text { opacity: 0; pointer-events: none; }
    .nav-divider { height: 1px; background: var(--border-200); margin: 2px 0; }
    .sidebar-footer { padding: 20px; display: flex; flex-direction: column; align-items: flex-start; gap: 4px; overflow: hidden; opacity: 1; transition: opacity 0.12s ease; font-family: var(--font-brand); }
    .sidebar-footer-brand { height: 18px; width: auto; flex-shrink: 0; }
    .sidebar-footer-tagline { font-size: 12px; font-weight: 400; color: var(--text-muted); white-space: nowrap; }
    .sidebar.collapsed .sidebar-footer { opacity: 0; pointer-events: none; }

    /* ===== CONTENT ===== */
    .content {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      min-width: 0;
    }

    /* Page Header */
    .page-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .page-title { font-size: 24px; font-weight: 400; color: var(--text-strong); }
    .btn-export {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 0 12px;
      height: 32px;
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
    }
    .btn-export:hover { background: var(--primary-hover); }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 0;
      background: var(--tab-bg);
      border-radius: var(--radius);
      margin-bottom: 12px;
      width: fit-content;
    }
    .tab {
      padding: 8px 12px;
      font-size: 14px;
      color: var(--tab-text);
      cursor: pointer;
      border-radius: var(--radius);
      white-space: nowrap;
      border: none;
      background: transparent;
      font-family: var(--font);
      transition: background 0.15s, color 0.15s;
    }
    .tab:hover { background: rgba(0,0,0,0.04); }
    .tab.active {
      background: var(--tab-active-bg);
      color: var(--tab-active-text);
      font-weight: 400;
    }

    /* Tab Panels */
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    /* Settings Cards */
    .settings-card {
      background: var(--surface-card);
      border: 1px solid var(--border-card);
      border-radius: var(--radius);
      box-shadow: var(--shadow-card);
      overflow: hidden;
      margin-bottom: 12px;
    }
    .settings-card:last-child { margin-bottom: 0; }
    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      height: 56px;
      min-height: 56px;
      border-bottom: 1px solid var(--border-card);
    }
    .card-header h2 { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .card-header .btn-outline { align-self: center; }
    .card-header-actions { display: flex; gap: 8px; align-items: center; }
    .card-header-with-desc { height: auto; min-height: 56px; padding: 16px 20px; flex-direction: column; align-items: flex-start; }
    .card-header-with-desc .card-header-top { display: flex; align-items: center; justify-content: space-between; width: 100%; }
    .card-header-desc { font-size: 14px; font-weight: 400; color: #344565; margin-top: 8px; line-height: 16px; }
    .btn-discard {
      padding: 0 16px;
      background: transparent;
      color: var(--text-strong);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      display: none;
      height: 32px;
    }
    .btn-discard:hover { background: rgba(0,0,0,0.03); }
    .btn-discard:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }
    .settings-card.dirty .btn-discard { display: inline-flex; align-items: center; }
    .btn-save {
      padding: 0 16px;
      background: var(--surface-bg);
      color: var(--text-muted);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: default;
      pointer-events: none;
      height: 32px;
      display: inline-flex;
      align-items: center;
      transition: background 0.2s, color 0.2s, border-color 0.2s;
    }
    .settings-card.dirty .btn-save {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
      cursor: pointer;
      pointer-events: auto;
    }
    .settings-card.dirty .btn-save:hover { background: var(--primary-hover); }
    .settings-card.dirty .btn-save:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }
    .card-content {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      column-gap: 12px;
      row-gap: 20px;
    }
    .card-content > * {
      grid-column: 1 / -1;
    }

    /* Banner */
    .banner {
      background: var(--surface-bg);
      border-radius: var(--radius);
      padding: 20px;
      display: flex;
      gap: 20px;
    }
    .banner-icon { flex-shrink: 0; color: #e6a817; }
    .banner-icon svg { width: 16px; height: 16px; }
    .banner-content { display: flex; flex-direction: column; gap: 2px; }
    .banner-title { font-size: 16px; font-weight: 500; color: var(--text-strong); line-height: 1.14; }
    .banner-desc { font-size: 14px; color: var(--text-subtle); line-height: 1.14; margin-top: 2px; }

    /* Form Rows */
    .form-row {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    .form-row--top {
      align-items: flex-start;
    }
    .form-label {
      width: 266px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      gap: 4px;
      min-height: 32px;
      font-size: 14px;
      color: var(--text-strong);
    }
    .help-icon {
      width: 16px; height: 16px;
      color: var(--text-muted);
      flex-shrink: 0;
      cursor: help;
    }
    .help-icon svg { width: 16px; height: 16px; }
    .form-value {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .form-value--inline {
      flex-direction: row;
      align-items: center;
      gap: 8px;
    }

    /* Radio */
    .radio-group { display: flex; flex-direction: column; gap: 12px; }
    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      min-height: 32px;
      user-select: none;
    }
    .radio-circle {
      width: 16px; height: 16px;
      border-radius: 50%;
      border: 2px solid var(--toggle-inactive);
      flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
      transition: border-color 0.15s;
    }
    .radio-option.selected .radio-circle { border-color: var(--primary); }
    .radio-option.selected .radio-circle::after {
      content: '';
      width: 8px; height: 8px;
      border-radius: 50%;
      background: var(--primary);
    }
    .radio-label { font-size: 14px; color: var(--text-strong); }

    /* Toggle Switch */
    .toggle-row { display: flex; align-items: center; gap: 12px; }
    .toggle-switch {
      width: 28px; height: 16px;
      border-radius: 9999px;
      background: var(--toggle-inactive);
      position: relative;
      cursor: pointer;
      flex-shrink: 0;
      border: 1px solid var(--toggle-inactive);
      transition: background 0.15s, border-color 0.15s;
    }
    .toggle-switch.active {
      background: var(--toggle-active);
      border-color: var(--toggle-active);
    }
    .toggle-thumb {
      width: 12px; height: 12px;
      border-radius: 50%;
      background: #fff;
      position: absolute;
      top: 1px; left: 1px;
      box-shadow: 0 0 6px -4px rgba(0,0,0,0.48), 0 2px 6px -4px rgba(0,0,0,0.48);
      transition: left 0.15s;
    }
    .toggle-switch.active .toggle-thumb { left: 13px; }
    .toggle-label { font-size: 14px; color: var(--text-strong); }

    /* Input */
    .input-field {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      background: #fff;
      font-family: var(--font);
      font-size: 14px;
      color: var(--text-strong);
      height: 32px;
      min-width: 0;
    }
    .input-field:focus-within { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,107,252,0.15); }
    .input-field input {
      border: none;
      outline: none;
      font-family: var(--font);
      font-size: 14px;
      color: var(--text-subtle);
      flex: 1;
      min-width: 0;
      background: transparent;
    }
    .input-field input::placeholder { color: var(--text-muted); }
    .input-clear {
      width: 14px; height: 14px;
      cursor: pointer;
      color: var(--text-muted);
      flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
    }
    .input-clear:hover { color: var(--text-strong); }
    .input-clear svg { width: 14px; height: 14px; }

    /* Password eye icon */
    .input-eye {
      width: 16px; height: 16px;
      cursor: pointer;
      color: var(--text-muted);
      flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
    }
    .input-eye:hover { color: var(--text-strong); }
    .input-eye svg { width: 16px; height: 16px; }

    /* Table */
    .headers-table {
      width: 100%;
      border: 1px solid var(--border-card);
      border-radius: var(--radius);
      overflow: hidden;
    }
    .headers-table-head {
      display: flex;
      align-items: center;
      background: #fff;
      border-bottom: 1px solid var(--border-card);
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-strong);
    }
    .headers-table-head .col-key { flex: 1; display: flex; align-items: center; position: relative; padding-right: 36px; }
    .headers-table-head .col-value { flex: 1; display: flex; align-items: center; position: relative; padding-right: 36px; }
    .headers-table-head .filter-icon { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); margin-left: 0; }
    .headers-table-head .col-actions { width: 40px; }
    .filter-icon { display: inline-flex; width: 16px; height: 16px; justify-content: center; align-items: center; color: var(--text-muted); cursor: pointer; vertical-align: middle; margin-left: 4px; flex-shrink: 0; }
    .filter-icon:hover { color: var(--text-strong); }
    .filter-icon.active { color: var(--primary); }
    .filter-icon svg { width: 16px; height: 16px; }

    /* ===== COLUMN DROPDOWN (Sorting / Pinning) ===== */
    .col-dropdown {
      position: fixed;
      z-index: 9999;
      background: #fff;
      border: 1px solid var(--border-200);
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(12,18,29,0.12), 0 1px 4px rgba(12,18,29,0.08);
      min-width: 200px;
      padding: 8px 0;
      display: none;
    }
    .col-dropdown.open { display: block; }
    .col-dropdown-section { padding: 8px 16px 4px; }
    .col-dropdown-section-title {
      font-size: 12px;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 4px;
    }
    .col-dropdown-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
      color: var(--text-strong);
      transition: background 0.1s;
    }
    .col-dropdown-item:hover { background: var(--surface-bg); }
    .col-dropdown-item.active { color: var(--primary); font-weight: 500; }
    .col-dropdown-item svg { width: 16px; height: 16px; flex-shrink: 0; }
    .col-dropdown-divider { height: 1px; background: var(--border-200); margin: 4px 0; }

    .headers-table-row {
      display: flex;
      align-items: center;
      padding: 0 16px;
      height: 56px;
      border-bottom: 1px solid var(--border-card);
      font-size: 14px;
    }
    .headers-table-row:last-child { border-bottom: none; }
    .headers-table-row .col-key { flex: 1; color: var(--text-strong); }
    .headers-table-row .col-value { flex: 1; color: var(--text-subtle); }
    .headers-table-row .col-actions {
      width: 40px;
      display: flex; align-items: center; justify-content: center;
    }
    .edit-icon { width: 16px; height: 16px; color: var(--text-muted); cursor: pointer; display: inline-flex; align-items: center; justify-content: center; }
    .edit-icon svg { width: 16px; height: 16px; }
    .edit-icon:hover { color: var(--text-strong); }

    /* Headers Input Row */
    .headers-input-row { display: flex; gap: 8px; align-items: center; }
    .headers-input-row .input-field { flex: 1; }
    .btn-add-header {
      padding: 0 12px;
      background: transparent;
      color: var(--text-strong);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      height: 32px;
      display: inline-flex;
      align-items: center;
    }
    .btn-add-header:hover { background: rgba(0,0,0,0.03); }

    /* Radio inline */
    .radio-inline { display: flex; align-items: center; gap: 16px; }

    /* API Key */
    .api-key-status { font-size: 14px; color: var(--text-muted); }
    .btn-generate {
      padding: 0 12px;
      background: transparent;
      color: var(--text-strong);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      height: 32px;
      display: inline-flex;
      align-items: center;
      align-self: flex-start;
      width: fit-content;
    }
    .btn-generate:hover { background: rgba(0,0,0,0.03); }

    /* ===== SCAN POOLS ===== */
    .promo-banner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #e8f0fe;
      border: 1px solid #c5d9fc;
      border-radius: var(--radius);
      padding: 12px 20px;
      margin-bottom: 12px;
    }
    .promo-banner-text { font-size: 14px; color: var(--text-strong); }
    .promo-banner-text strong { font-weight: 500; }
    .btn-primary {
      padding: 0 16px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
    }
    .btn-primary:hover { background: var(--primary-hover); }
    .btn-outline {
      padding: 0 12px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      color: var(--text-strong);
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      align-self: flex-start;
      width: fit-content;
    }
    .btn-outline:hover { background: rgba(0,0,0,0.03); }
    .btn-outline.danger { color: #d9534f; border-color: #d9534f; }
    .btn-outline.danger:hover { background: rgba(217,83,79,0.05); }
    .pool-card { margin-bottom: 12px; }
    .pool-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      height: 56px;
      min-height: 56px;
      border-bottom: 1px solid var(--border-card);
    }
    .pool-card-header-left { display: flex; align-items: center; gap: 12px; min-width: 0; }
    .pool-drag-handle {
      display: flex; align-items: center; justify-content: center;
      width: 16px; height: 16px; flex-shrink: 0;
      cursor: grab; color: var(--text-muted);
      margin-right: -4px;
    }
    .pool-drag-handle:active { cursor: grabbing; }
    .pool-drag-handle svg { width: 16px; height: 16px; }
    .pool-card.dragging { opacity: 0.4; }
    .pool-card.flip-animate { transition: transform 0.15s cubic-bezier(0.2,0,0,1); }
    .pool-card-header-left h2 { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .pool-instance-count {
      font-size: 14px;
      color: var(--primary);
      font-weight: 400;
    }
    .pool-card-header-right { display: flex; gap: 8px; }
    .pool-table {
      width: 100%;
      border-collapse: collapse;
    }
    .pool-table thead th {
      text-align: left;
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-strong);
      background: #fff;
      border-bottom: 1px solid var(--border-card);
      position: relative;
      padding-right: 44px;
      line-height: 16px;
    }
    .pool-table thead th .filter-icon { position: absolute; right: 16px; top: 50%; transform: translateY(-50%); margin-left: 0; }
    .pool-table tbody td {
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      color: var(--text-subtle);
      border-bottom: 1px solid var(--border-card);
      vertical-align: middle;
      line-height: 16px;
    }
    .pool-table tbody tr:last-child td { border-bottom: none; }
    .pool-table tbody tr:hover td { background: #F8F9F9; }
    .pool-table .col-url { width: 32%; }
    .pool-table .col-av { width: 22%; }
    .pool-table .col-api { width: 20%; }
    .pool-table .col-timeout { width: 20%; }
    .pool-table .col-actions { width: 48px; text-align: center; padding-right: 16px; overflow: visible; position: relative; }
    .av-badge {
      display: inline-block;
      padding: 4px 10px;
      border: 1px solid var(--border-200);
      border-radius: 0;
      font-size: 14px;
      color: var(--text-subtle);
      background: var(--surface-card);
    }
    .api-dots { letter-spacing: 2px; color: var(--text-muted); }
    .pool-action-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: 32px; height: 32px; border: none; background: none;
      border-radius: 4px; cursor: pointer; color: var(--text-muted);
      position: relative;
    }
    .pool-action-btn:hover { background: rgba(0,0,0,0.05); color: var(--text-strong); }
    .pool-action-btn svg { width: 16px; height: 16px; }
    .pool-action-menu {
      position: fixed;
      background: var(--surface-card); border: 1px solid var(--border-200);
      border-radius: 8px; box-shadow: 0 4px 16px rgba(0,0,0,0.10);
      min-width: 160px; padding: 4px; z-index: 9999;
      display: none;
    }
    .pool-action-menu.open { display: block; }
    .pool-action-menu-item {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 12px; border: none; background: none;
      width: 100%; font-size: 14px; color: var(--text-subtle);
      cursor: pointer; border-radius: 4px; white-space: nowrap;
    }
    .pool-action-menu-item:hover { background: rgba(0,0,0,0.04); }
    .pool-action-menu-item svg { width: 16px; height: 16px; flex-shrink: 0; }
    .pool-action-menu-item.danger { color: #d9534f; }
    .pool-action-menu-item.danger:hover { background: rgba(217,83,79,0.06); }

    /* ===== NOTIFICATION TOAST (reusable) ===== */
    .top-toast {
      position: fixed;
      top: 76px;
      right: 20px;
      background: var(--surface-card);
      border: 1px solid var(--border-card);
      border-left: 4px solid var(--primary);
      border-radius: var(--radius);
      padding: 16px 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 1001;
      display: flex;
      gap: 12px;
      align-items: flex-start;
      max-width: 380px;
      opacity: 0;
      transform: translateX(100px);
      pointer-events: none;
      transition: opacity 0.3s, transform 0.3s;
    }
    .top-toast.visible { opacity: 1; transform: translateX(0); pointer-events: auto; }
    .top-toast.type-info { border-left-color: var(--primary); }
    .top-toast.type-success { border-left-color: #34a853; }
    .top-toast.type-warning { border-left-color: #e6a817; }
    .top-toast.type-error { border-left-color: #ea4335; }
    .top-toast-icon { flex-shrink: 0; }
    .top-toast.type-info .top-toast-icon { color: var(--primary); }
    .top-toast.type-success .top-toast-icon { color: #34a853; }
    .top-toast.type-warning .top-toast-icon { color: #e6a817; }
    .top-toast.type-error .top-toast-icon { color: #ea4335; }
    .top-toast-icon svg { width: 16px; height: 16px; }
    .top-toast-content { flex: 1; }
    .top-toast-title { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .top-toast-desc { font-size: 14px; color: var(--text-subtle); margin-top: 2px; }
    .top-toast-close { cursor: pointer; color: var(--text-muted); flex-shrink: 0; }
    .top-toast-close:hover { color: var(--text-strong); }
    .top-toast-close svg { width: 14px; height: 14px; }
    .file-upload-field {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      background: #fff;
      height: 32px;
      max-width: 340px;
      cursor: pointer;
    }
    .file-upload-field:hover { border-color: var(--primary); }
    .file-upload-field input[type="file"] { display: none; }
    .file-upload-text { flex: 1; font-size: 14px; color: var(--text-muted); }
    .file-upload-text.has-file { color: var(--text-strong); }
    .file-upload-icon { color: var(--text-muted); flex-shrink: 0; }
    .file-upload-icon svg { width: 16px; height: 16px; }
    .encryption-status { font-size: 14px; color: var(--text-subtle); }

    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: #1b2a4a;
      color: #fff;
      padding: 12px 20px;
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transform: translateY(100px);
      opacity: 0;
      transition: transform 0.25s, opacity 0.25s;
      z-index: 1000;
    }
    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* ===== WCAG 2.2 AA Compliance ===== */

    /* Skip-to-content link */
    .skip-link {
      position: absolute;
      top: -100px;
      left: 8px;
      background: var(--primary);
      color: #fff;
      padding: 8px 16px;
      border-radius: var(--radius);
      font-size: 14px;
      font-weight: 500;
      z-index: 9999;
      text-decoration: none;
    }
    .skip-link:focus { top: 8px; }

    /* Global focus-visible indicator (WCAG 2.4.7 / 2.4.11) */
    :focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
    /* Remove default outline when not keyboard-navigating */
    :focus:not(:focus-visible) { outline: none; }

    /* Buttons & interactive elements: 24px minimum target (WCAG 2.5.8) */
    .toggle-switch { min-width: 28px; min-height: 16px; }
    .radio-option { min-height: 36px; padding: 4px 0; }
    .input-clear, .input-eye, .edit-icon { min-width: 16px; min-height: 16px; display: inline-flex; align-items: center; justify-content: center; }
    .pool-icons svg { min-width: 16px; min-height: 16px; padding: 0; }

    /* Override input focus-within outline to not show double ring */
    .input-field:focus-within { outline: none; }

    /* Toggle keyboard focus */
    .toggle-switch:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }
    .radio-option:focus-visible .radio-circle { outline: 2px solid var(--primary); outline-offset: 2px; }

    /* Contrast fixes: bump muted text from #6b7a90 to #566479 (passes 4.5:1 on white) */
    .input-field input::placeholder { color: #566479; }
    .api-key-status { color: #566479; }
    .file-upload-text { color: #566479; }
    .sidebar-footer-tagline { color: #566479; font-size: 12px; }

    /* Improve line-height for readability (WCAG 1.4.12) */
    .banner-desc, .top-toast-desc, .encryption-status { line-height: 1.5; }

    /* Toast live region styling */
    .toast[role="status"] { /* inherits existing styles */ }

    /* File upload focus */
    .file-upload-field:focus-within { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,107,252,0.15); }

    /* Nav item focus */
    .nav-item:focus-visible { outline: 2px solid var(--primary); outline-offset: -2px; }

    /* Tab focus */
    .tab:focus-visible { outline: 2px solid var(--primary); outline-offset: -2px; }

    /* ===== WCAG 2.2 AA — Screen-reader only utility ===== */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* ===== WCAG 2.2 AA — Radio option focus (2.4.7 / 2.4.13) ===== */
    .radio-option:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
      border-radius: var(--radius);
    }

    /* ===== WCAG 2.2 AA — File upload keyboard focus ===== */
    .file-upload-field:focus-visible {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(29,107,252,0.15);
      outline: none;
    }

    /* ===== WCAG 2.2 AA — Help icon focus ===== */
    .help-icon:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
      border-radius: 50%;
    }

    /* ===== WCAG 2.2 AA — Icon button focus ===== */
    .edit-icon:focus-visible,
    .pool-icons svg:focus-visible,
    .input-clear:focus-visible,
    .input-eye:focus-visible,
    .top-toast-close:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
      border-radius: 2px;
    }

    /* ===== WCAG 2.3.3 / 2.2 — Reduced motion (prefers-reduced-motion) ===== */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
      .toast { transition: none; }
      .top-toast { transition: none; }
      .toggle-thumb { transition: none; }
      .toggle-switch { transition: none; }
      .tab { transition: none; }
    }

    /* ===== WCAG — Windows High Contrast Mode (forced-colors) ===== */
    @media (forced-colors: active) {
      .toggle-switch {
        border: 2px solid ButtonText;
      }
      .toggle-switch.active {
        background: Highlight;
        border-color: Highlight;
      }
      .toggle-thumb {
        background: ButtonText;
      }
      .radio-circle {
        border-color: ButtonText;
      }
      .radio-option.selected .radio-circle {
        border-color: Highlight;
      }
      .radio-option.selected .radio-circle::after {
        background: Highlight;
      }
      .input-field {
        border-color: ButtonText;
      }
      .input-field:focus-within {
        border-color: Highlight;
      }
      .btn-save, .btn-discard, .btn-primary, .btn-outline, .btn-export, .btn-generate, .btn-add-header {
        border: 1px solid ButtonText;
      }
      .settings-card.dirty .btn-save {
        background: Highlight;
        color: HighlightText;
        border-color: Highlight;
      }
      .tab.active {
        border: 2px solid Highlight;
      }
      :focus-visible {
        outline: 2px solid Highlight;
      }
    }

    /* ===== MODAL / DIALOG ===== */
    .modal-overlay {
      position: fixed; inset: 0;
      background: rgba(12,18,29,0.45);
      z-index: 2000;
      display: flex; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none;
      transition: opacity 0.2s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: auto; }
    .modal {
      background: var(--surface-card);
      border-radius: 8px;
      box-shadow: 0 8px 32px rgba(12,18,29,0.18);
      width: 480px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 24px;
    }
    .modal-header {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 16px;
    }
    .modal-header h2 { font-size: 16px; font-weight: 500; color: var(--text-strong); margin: 0; }
    .modal-close {
      width: 28px; height: 28px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-muted); border: none; background: none;
      border-radius: var(--radius);
    }
    .modal-close:hover { color: var(--text-strong); background: rgba(0,0,0,0.04); }
    .modal-close svg { width: 16px; height: 16px; }
    .modal-divider { height: 1px; background: var(--border-200); margin: 16px 0; }
    .modal-body { display: flex; flex-direction: column; gap: 16px; }
    .modal-field { display: flex; flex-direction: column; gap: 6px; }
    .modal-field-label { font-size: 14px; font-weight: 500; color: var(--text-subtle); }
    .modal-footer {
      display: flex; justify-content: flex-end; gap: 8px;
      margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border-200);
    }
    .modal-instructions { font-size: 14px; color: var(--text-subtle); line-height: 1.5; }
    .modal-instructions a { color: var(--primary); text-decoration: none; }
    .modal-instructions a:hover { text-decoration: underline; }

    /* ===== SLIDE-OUT PANEL ===== */
    .slide-panel-overlay {
      position: fixed; inset: 0;
      background: rgba(12,18,29,0.3);
      z-index: 2000;
      opacity: 0; pointer-events: none;
      transition: opacity 0.2s;
    }
    .slide-panel-overlay.open { opacity: 1; pointer-events: auto; }
    .slide-panel {
      position: fixed; top: 0; right: -400px; bottom: 0;
      width: 400px;
      background: var(--surface-card);
      box-shadow: -4px 0 24px rgba(12,18,29,0.12);
      z-index: 2001;
      display: flex; flex-direction: column;
      transition: right 0.25s ease;
    }
    .slide-panel.open { right: 0; }
    #addScanPoolPanel { width: 420px; right: -420px; }
    #addScanPoolPanel.open { right: 0; }
    .slide-panel-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 24px;
      height: 56px; min-height: 56px;
      border-bottom: 1px solid var(--border-200);
    }
    .slide-panel-header h2 { font-size: 16px; font-weight: 500; line-height: 18px; margin: 0; }
    .slide-panel-header .modal-close { width: 20px; height: 20px; }
    .slide-panel-header .modal-close svg { width: 10px; height: 10px; }
    .slide-panel-body {
      flex: 1; overflow-y: auto;
      padding: 20px;
      display: flex; flex-direction: column; gap: 20px;
    }
    .slide-panel-footer {
      display: flex; justify-content: flex-end; gap: 8px;
      padding: 16px 24px;
      border-top: 1px solid var(--border-200);
    }

    /* ===== SELECT / DROPDOWN ===== */
    .select-field {
      display: flex; align-items: center;
      padding: 0 12px;
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      background: #fff;
      font-family: var(--font);
      font-size: 14px;
      color: var(--text-strong);
      height: 32px;
      max-width: 340px;
      cursor: pointer;
      appearance: none;
      -webkit-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M7.99994 10.7499C7.80994 10.7499 7.61994 10.6799 7.46994 10.5299L3.21994 6.27994C2.92994 5.98994 2.92994 5.50994 3.21994 5.21994C3.50994 4.92994 3.98994 4.92994 4.27994 5.21994L7.99994 8.93994L11.7199 5.21994C12.0099 4.92994 12.4899 4.92994 12.7799 5.21994C13.0699 5.50994 13.0699 5.98994 12.7799 6.27994L8.52994 10.5299C8.37994 10.6799 8.18994 10.7499 7.99994 10.7499Z' fill='%236b7a90'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      padding-right: 28px;
    }
    .select-field:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,107,252,0.15); outline: none; }
    .select-field:focus-visible { outline: 2px solid var(--primary); outline-offset: 2px; }

    /* ===== INPUT WITH SUFFIX (e.g. "days") ===== */
    .input-with-suffix {
      display: flex; align-items: center; gap: 0;
      max-width: 180px;
    }
    .input-with-suffix .input-field { border-radius: var(--radius) 0 0 var(--radius); flex: 1; }
    .input-suffix {
      padding: 0 12px; height: 32px;
      display: flex; align-items: center;
      font-size: 14px; color: var(--text-muted);
      background: var(--surface-bg);
      border: 1px solid var(--border-200);
      border-left: none;
      border-radius: 0 var(--radius) var(--radius) 0;
    }

    /* ===== STATUS DOT ===== */
    .status-dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 6px;
    }
    .status-dot.green { background: #34a853; }
    .status-dot.red { background: #ea4335; }

    /* ===== CELL ACTION ICON (unified action column component) ===== */
    /* Covers: expand chevron, copy, edit, delete, view — all 16×16 icon in 56×56 cell */
    .cell-action {
      width: 16px; height: 16px;
      display: inline-flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-muted);
      background: none; border: none; border-radius: var(--radius);
      flex-shrink: 0; padding: 0;
    }
    .cell-action:hover { color: var(--text-strong); }
    .cell-action svg { width: 16px; height: 16px; }
    /* Action column cell: 56px wide, centers the icon */
    td.col-action, th.col-action {
      width: 56px; text-align: center; padding: 0 !important;
    }

    /* ===== COPY BUTTON (legacy, maps to cell-action) ===== */
    .copy-btn {
      width: 16px; height: 16px;
      display: inline-flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-muted);
      background: none; border: none; border-radius: var(--radius);
      flex-shrink: 0; padding: 0;
    }
    .copy-btn:hover { color: var(--text-strong); }
    .copy-btn svg { width: 16px; height: 16px; }

    /* ===== LICENSE BADGE ===== */
    .license-badge {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 8px; font-size: 14px; font-family: var(--font);
      font-weight: 400; line-height: 16px; white-space: nowrap;
    }
    .license-badge.green { background: var(--ds-success-100); color: var(--ds-success-text); }
    .license-badge.red { background: var(--ds-alert-100); color: var(--ds-alert-text); }

    .license-empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }
    .license-empty-illustration {
      width: 120px;
      height: 120px;
      margin-bottom: 20px;
      opacity: 0.7;
    }
    .license-empty-title {
      font-size: 16px;
      font-weight: 500;
      color: var(--text-strong);
      margin-bottom: 4px;
    }
    .license-empty-desc {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 24px;
    }

    .license-warning-banner {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: #fce8e6;
      color: #c5221f;
      font-size: 14px;
      border-bottom: 1px solid #f5c6c2;
    }
    .license-warning-banner a { color: #c5221f; font-weight: 500; }
    .license-warning-banner svg { width: 16px; height: 16px; flex-shrink: 0; }

    /* ===== DATA TABLE (External Loggers) ===== */
    .data-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }
    .data-table thead th {
      text-align: left;
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-strong);
      background: #fff;
      border-bottom: 1px solid var(--border-card);
      position: relative;
      padding-right: 44px;
      line-height: 16px;
    }
    .data-table thead th .filter-icon { position: absolute; right: 16px; top: 50%; transform: translateY(-50%); margin-left: 0; }
    .data-table tbody td {
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      color: var(--text-subtle);
      border-bottom: 1px solid var(--border-card);
      vertical-align: middle;
      line-height: 16px;
    }
    .data-table tbody tr:last-child td { border-bottom: none; }
    .data-table tbody tr:hover td { background: #F8F9F9; }
    .data-table .col-actions-cell {
      display: flex; gap: 8px; align-items: center; justify-content: flex-end;
    }
    .data-table .col-actions-cell svg {
      width: 16px; height: 16px; cursor: pointer; color: var(--text-muted);
    }
    .data-table .col-actions-cell svg:hover { color: var(--text-strong); }

    /* ===== SLIDE-PANEL FIELD ROW ===== */
    .panel-field { display: flex; flex-direction: column; gap: 6px; }
    .panel-field-label { font-size: 14px; font-weight: 500; color: var(--text-subtle); }
    .panel-field .input-field { max-width: none; }
    .panel-field .select-field { max-width: none; }

    /* Tooltip popover */
    .tooltip-popover {
      position: fixed;
      background: var(--surface-card);
      border: 1px solid var(--border-200);
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 14px;
      color: var(--text-subtle);
      line-height: 1.4;
      box-shadow: 0 4px 16px rgba(12,18,29,0.12), 0 1px 4px rgba(12,18,29,0.08);
      max-width: 260px;
      z-index: 10000;
      pointer-events: none;
    }

    @media (prefers-reduced-motion: reduce) {
      .modal-overlay, .slide-panel-overlay { transition: none; }
      .slide-panel { transition: none; }
      .sidebar { transition: none; }
    }

    /* ===== RESPONSIVE: Tablet (<=1024px) ===== */
    @media (max-width: 1024px) {
      .sidebar { width: var(--sidebar-collapsed); }
      .sidebar .nav-item { padding: 8px 12px; }
      .sidebar .nav-text { opacity: 0; pointer-events: none; }
      .sidebar .sidebar-footer { opacity: 0; pointer-events: none; }
      .form-row { flex-direction: column; gap: 4px; align-items: flex-start; }
      .form-label { width: auto; min-height: auto; padding: 0; }
      .input-field, .select-field { max-width: none !important; }
      .tabs { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    }

    /* ===== RESPONSIVE: Mobile (<=768px) ===== */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .app.sidebar-open .sidebar {
        display: flex;
        position: fixed;
        top: 56px; left: 0; bottom: 0;
        width: 260px;
        z-index: 1500;
        box-shadow: 4px 0 24px rgba(0,0,0,0.12);
      }
      .app.sidebar-open .sidebar-mobile-overlay {
        display: block;
        position: fixed; inset: 0; top: 56px;
        background: rgba(0,0,0,0.3);
        z-index: 1499;
      }
      .sidebar-mobile-overlay { display: none; }
      .content { padding: 16px; }
      .page-header { flex-direction: column; align-items: flex-start; gap: 12px; }
      .tabs { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
      .tab { flex-shrink: 0; }
      .form-row { flex-direction: column; gap: 4px; align-items: flex-start; }
      .form-label { width: auto; }
      .input-field, .select-field { max-width: none !important; }
      .input-with-suffix { max-width: none; }
      .modal { width: calc(100vw - 32px); max-width: 480px; }
      .slide-panel { width: 100%; right: -100%; }
      .slide-panel.open { right: 0; }
      .pool-table { display: block; overflow-x: auto; }
      .data-table { display: block; overflow-x: auto; }
      .header-logo-text { display: none; }
      .radio-inline { flex-wrap: wrap; }
    }

    /* ===== RESPONSIVE: Small Mobile (<=480px) ===== */
    @media (max-width: 480px) {
      .content { padding: 12px; }
      .card-content { padding: 16px; column-gap: 8px; row-gap: 16px; }
      .card-header { padding: 0 16px; }
      .page-title { font-size: 20px; }
      .header { padding: 0 12px; }
      .headers-input-row { flex-direction: column; }
      .headers-input-row .input-field { width: 100%; }
      .pool-card-header { flex-direction: column; align-items: flex-start; gap: 8px; padding: 12px 16px; height: auto; min-height: auto; }
      .pool-card-header-right { flex-wrap: wrap; }
    }

    /* ===== AUDIT PAGE ===== */
    .page-view { display: none; }
    .page-view.active { display: block; }

    /* Full-height table page layout */
    .page-view.table-page { display: none; flex-direction: column; height: calc(100vh - 56px - 40px); }
    .page-view.table-page.active { display: flex; }
    .table-page .audit-card { flex: 1; display: flex; flex-direction: column; min-height: 0; overflow: hidden; }
    .table-page .audit-table-scroll { flex: 1; overflow: auto; min-height: 0; }
    .table-page .audit-pagination { flex-shrink: 0; }

    .audit-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
    .audit-header h1 { font-size: 24px; font-weight: 500; color: var(--text-strong); }

    .audit-card {
      background: var(--surface-card);
      border: 1px solid var(--border-card);
      border-radius: var(--radius);
      box-shadow: var(--shadow-card);
      overflow: hidden;
    }
    .audit-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      height: 56px;
      border-bottom: 1px solid var(--border-card);
    }
    .audit-card-header.with-desc {
      height: auto; min-height: 56px; padding: 16px 20px;
      flex-wrap: wrap;
    }
    .audit-card-header.with-desc .audit-card-title-group { display: flex; flex-direction: column; gap: 8px; }
    .audit-card-header.with-desc .audit-card-title-row { display: flex; align-items: center; justify-content: space-between; width: 100%; }
    .audit-card-title { display: flex; align-items: center; gap: 8px; }
    .audit-card-title h3 { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .audit-card-title .count { font-size: 14px; font-weight: 400; color: #344565; }
    .audit-card-desc { font-size: 14px; font-weight: 400; color: #344565; line-height: 16px; }
    .audit-card-actions { display: flex; align-items: center; gap: 8px; }
    .audit-search {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 4px 4px 8px;
      height: 32px;
      border: 1px solid var(--border-200);
      border-radius: var(--radius);
      background: #fff;
      width: 240px;
      box-sizing: border-box;
    }
    .audit-search:focus-within { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,107,252,0.15); }
    .audit-search svg { width: 14px; height: 14px; color: #344565; flex-shrink: 0; }
    .audit-search input { border: none; outline: none; font-size: 14px; font-family: var(--font); color: #344565; flex: 1; background: transparent; }
    .audit-search input:not(:placeholder-shown) { color: #0C121D; }
    .audit-search input::placeholder { color: #344565; }
    .audit-search:focus-within svg { color: #0C121D; }
    .audit-filter-btn {
      width: 32px; height: 32px; border-radius: var(--radius);
      border: 1px solid var(--border-200);
      background: #fff; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--text-muted);
    }
    .audit-filter-btn:hover { color: var(--text-strong); border-color: var(--text-muted); }
    .audit-filter-btn:focus-within, .audit-filter-btn:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,107,252,0.15); outline: none; }
    .audit-filter-btn svg { width: 16px; height: 16px; }

    /* Audit Table */
    .audit-table { width: 100%; border-collapse: separate; border-spacing: 0; }
    .audit-table thead th {
      text-align: left;
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-strong);
      background: #fff;
      border-bottom: 1px solid var(--border-card);
      white-space: nowrap;
      position: relative;
      padding-right: 44px;
      line-height: 16px;
    }
    .audit-table thead th .filter-icon { position: absolute; right: 16px; top: 50%; transform: translateY(-50%); margin-left: 0; }
    .audit-table tbody td {
      padding: 0 16px;
      height: 56px;
      font-size: 14px;
      color: var(--text-subtle);
      border-bottom: 1px solid var(--border-card);
      vertical-align: middle;
      line-height: 16px;
      white-space: nowrap;
    }
    .audit-table tbody tr:last-child td { border-bottom: none; }
    .audit-table tbody tr:hover td { background: #F8F9F9; }
    .audit-table .col-expand { width: 56px; text-align: center; padding: 0 !important; }
    .audit-table .col-user { min-width: 150px; }
    .audit-table .col-level { width: 100px; }
    .audit-table .col-category { width: 130px; }
    .audit-table .col-type { min-width: 180px; }
    .audit-table .col-date { min-width: 180px; white-space: nowrap; }
    .audit-table .col-details { min-width: 120px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; padding-right: 8px; }
    .audit-table .col-copy { width: 56px; text-align: center; padding: 0 !important; }
    .audit-table td.col-details { max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

    /* Expand/collapse chevron */
    .expand-btn {
      width: 16px; height: 16px;
      border: none; background: none; cursor: pointer;
      display: inline-flex; align-items: center; justify-content: center;
      color: var(--text-muted);
      border-radius: var(--radius);
      transition: transform 0.15s ease;
      padding: 0;
    }
    .expand-btn:hover { color: var(--text-strong); }
    .expand-btn svg { width: 16px; height: 16px; }
    .expand-btn.open { transform: rotate(180deg); }

    /* Expanded row */
    .audit-expanded-row td {
      padding: 12px 16px 12px 60px !important;
      background: #ffffff;
      font-size: 14px;
      color: var(--text-subtle);
      line-height: 1.5;
      border-bottom: 1px solid var(--border-card);
    }

    /* User cell with avatar */
    .audit-user { display: flex; align-items: center; gap: 8px; }
    .audit-avatar {
      width: 24px; height: 24px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 10px; font-weight: 500; color: #fff;
      flex-shrink: 0;
    }
    .audit-avatar.system { background: none; }

    /* Level badge */
    .level-badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 10px;
      border-radius: var(--radius);
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
    }
    .level-badge.warning { background: #FFF3CD; color: #856404; }
    .level-badge.error { background: #F8D7DA; color: #721C24; }
    .level-badge.info { background: #D1ECF1; color: #0C5460; }
    .level-badge.success { background: #D4EDDA; color: #155724; }

    /* Category badge */
    .category-badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 10px;
      border-radius: var(--radius);
      font-size: 12px;
      font-weight: 400;
      border: 1px solid var(--border-200);
      background: #fff;
      color: var(--text-subtle);
      white-space: nowrap;
    }

    /* Copy button (audit) — inherits from base .copy-btn above */

    /* Pagination */
    .audit-pagination {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
      border-top: 1px solid var(--border-card);
      font-size: 14px;
      color: var(--text-subtle);
    }
    .audit-pagination-left { display: flex; align-items: center; gap: 8px; }
    .audit-pagination-left select {
      appearance: none; -webkit-appearance: none;
      padding: 4px 24px 4px 8px;
      border: 1px solid var(--border-200); border-radius: var(--radius);
      font-size: 14px; font-family: var(--font); color: var(--text-strong);
      background: #fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M7.99994 10.7499C7.80994 10.7499 7.61994 10.6799 7.46994 10.5299L3.21994 6.27994C2.92994 5.98994 2.92994 5.50994 3.21994 5.21994C3.50994 4.92994 3.98994 4.92994 4.27994 5.21994L7.99994 8.93994L11.7199 5.21994C12.0099 4.92994 12.4899 4.92994 12.7799 5.21994C13.0699 5.50994 13.0699 5.98994 12.7799 6.27994L8.52994 10.5299C8.37994 10.6799 8.18994 10.7499 7.99994 10.7499Z' fill='%236b7a90'/%3E%3C/svg%3E") no-repeat right 4px center;
      cursor: pointer; height: 28px;
    }
    .audit-pagination-right { display: flex; align-items: center; gap: 4px; }
    .audit-page-btn {
      width: 28px; height: 28px;
      border: 1px solid var(--border-200); border-radius: var(--radius);
      background: #fff; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--text-muted); font-size: 14px;
    }
    .audit-page-btn:hover { color: var(--text-strong); border-color: var(--text-muted); }
    .audit-page-btn:disabled { opacity: 0.4; cursor: default; }
    .audit-page-btn svg { width: 14px; height: 14px; }
    .audit-page-select {
      appearance: none; -webkit-appearance: none;
      padding: 4px 24px 4px 8px;
      border: 1px solid var(--border-200); border-radius: var(--radius);
      font-size: 14px; font-family: var(--font); color: var(--text-strong);
      background: #fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M7.99994 10.7499C7.80994 10.7499 7.61994 10.6799 7.46994 10.5299L3.21994 6.27994C2.92994 5.98994 2.92994 5.50994 3.21994 5.21994C3.50994 4.92994 3.98994 4.92994 4.27994 5.21994L7.99994 8.93994L11.7199 5.21994C12.0099 4.92994 12.4899 4.92994 12.7799 5.21994C13.0699 5.50994 13.0699 5.98994 12.7799 6.27994L8.52994 10.5299C8.37994 10.6799 8.18994 10.7499 7.99994 10.7499Z' fill='%236b7a90'/%3E%3C/svg%3E") no-repeat right 4px center;
      cursor: pointer; height: 28px;
    }

    /* ===== DESIGN SYSTEM: Tags, Badges, Chips, Verdicts, Severities ===== */

    /* --- Color Tokens (Light Mode) --- */
    :root {
      --ds-neutral-100: #f8f9f9;   --ds-neutral-text: #0c121d;   --ds-neutral-700: #475b81;
      --ds-inactive-100: #f8f9f9;  --ds-inactive-text: #6b7a90;  --ds-inactive-700: #a9b2c4;
      --ds-secure-100: #e0f5f0;    --ds-secure-text: #004d3a;    --ds-secure-700: #006c4c;   --ds-secure-fill: #006c4c;
      --ds-success-100: #dffff5;   --ds-success-text: #002318;   --ds-success-700: #00b37a;  --ds-success-fill: #00b37a;
      --ds-accent-100: #e8f0ff;    --ds-accent-text: #0d2654;    --ds-accent-700: #1d6bfc;   --ds-accent-fill: #1d6bfc;
      --ds-guide-100: #ede8ff;     --ds-guide-text: #2d1a6e;     --ds-guide-700: #7c5ce0;    --ds-guide-fill: #7c5ce0;
      --ds-alert-100: #ffdfdb;     --ds-alert-text: #7e001d;     --ds-alert-700: #e83b3b;    --ds-alert-fill: #e83b3b;
      --ds-warn-100: #ffebde;      --ds-warn-text: #802b00;      --ds-warn-700: #e87c1e;     --ds-warn-fill: #e87c1e;
      --ds-caution-100: #fff4cc;   --ds-caution-text: #5d4200;   --ds-caution-700: #d4a800;  --ds-caution-fill: #d4a800;
    }

    /* --- Tags (Status) — filled background, no border --- */
    .tag {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 8px; font-size: 14px; font-family: var(--font);
      font-weight: 400; line-height: 16px; white-space: nowrap;
    }
    .tag-neutral   { background: var(--ds-neutral-100);  color: var(--ds-neutral-text); }
    .tag-inactive  { background: var(--ds-inactive-100); color: var(--ds-inactive-text); }
    .tag-secure    { background: var(--ds-secure-fill);   color: #fff; }
    .tag-success   { background: var(--ds-success-100);  color: var(--ds-success-text); }
    .tag-accent    { background: var(--ds-accent-100);   color: var(--ds-accent-text); }
    .tag-guide     { background: var(--ds-guide-fill);    color: #fff; }
    .tag-alert     { background: var(--ds-alert-100);    color: var(--ds-alert-text); }
    .tag-warn      { background: var(--ds-warn-100);     color: var(--ds-warn-text); }
    .tag-caution   { background: var(--ds-caution-100);  color: var(--ds-caution-text); }

    /* --- Tags (Keyword) — bordered, no fill --- */
    .tag-keyword {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 8px; font-size: 14px; font-family: var(--font);
      font-weight: 400; line-height: 16px; white-space: nowrap;
      border: 1px solid var(--border-200); color: var(--text-subtle);
    }

    /* Tag Group */
    .tag-group { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; }

    /* --- Badges (Dots) — 8px colored circles --- */
    .badge-dot {
      width: 8px; height: 8px; border-radius: 9999px; flex-shrink: 0; display: inline-block;
    }
    .badge-dot-neutral   { background: var(--ds-neutral-700); }
    .badge-dot-inactive  { background: var(--ds-inactive-700); }
    .badge-dot-secure    { background: var(--ds-secure-700); }
    .badge-dot-success   { background: var(--ds-success-700); }
    .badge-dot-accent    { background: var(--ds-accent-700); }
    .badge-dot-guide     { background: var(--ds-guide-700); }
    .badge-dot-alert     { background: var(--ds-alert-700); }
    .badge-dot-warn      { background: var(--ds-warn-700); }
    .badge-dot-caution   { background: var(--ds-caution-700); }

    /* --- Badges (Numbers) — 16px tall rounded rectangles with count --- */
    .badge-number {
      display: inline-flex; align-items: center; justify-content: center;
      height: 16px; min-width: 16px; padding: 2px 4px;
      border-radius: 4px; font-size: 12px; font-family: var(--font);
      font-weight: 400; line-height: 14px; color: #fff; white-space: nowrap;
    }
    .badge-number-neutral   { background: #344565; }
    .badge-number-inactive  { background: #a9b2c4; }
    .badge-number-secure    { background: var(--ds-secure-700); }
    .badge-number-success   { background: var(--ds-success-700); }
    .badge-number-accent    { background: var(--ds-accent-700); }
    .badge-number-guide     { background: var(--ds-guide-700); }
    .badge-number-alert     { background: var(--ds-alert-700); }
    .badge-number-warn      { background: var(--ds-warn-700); }
    .badge-number-caution   { background: var(--ds-caution-700); color: #1a1400; }

    /* --- Chips — 24px height, rounded-2px, filled bg --- */
    .chip {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      padding: 4px 8px; height: 24px; box-sizing: border-box;
      border-radius: 2px; font-size: 14px; font-family: var(--font);
      font-weight: 400; line-height: 16px; white-space: nowrap;
      border: 1px solid transparent;
    }
    .chip-default    { background: #ebecee; color: #0c121d; }
    .chip-disabled   { background: #ebecee; color: #a9b2c4; cursor: not-allowed; opacity: 0.6; }
    .chip-inactive   { background: transparent; color: #6b7a90; border-color: var(--border-200); }
    .chip-secure     { background: var(--ds-secure-700); color: #fff; }
    .chip-success    { background: var(--ds-success-700); color: #fff; }
    .chip-accent     { background: var(--ds-accent-700); color: #fff; }
    .chip-guide      { background: var(--ds-guide-700); color: #fff; }
    .chip-alert      { background: var(--ds-alert-700); color: #fff; }
    .chip-warn       { background: var(--ds-warn-700); color: #fff; }
    .chip-caution    { background: var(--ds-caution-700); color: #1a1400; }
    /* Chip selected (removable) */
    .chip-selected { position: relative; padding-right: 24px; }
    .chip-selected .chip-remove {
      position: absolute; right: 4px; top: 50%; transform: translateY(-50%);
      width: 12px; height: 12px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; opacity: 0.7; border: none; background: none; color: inherit; padding: 0;
    }
    .chip-selected .chip-remove:hover { opacity: 1; }
    .chip-selected .chip-remove svg { width: 10px; height: 10px; }

    /* --- Verdicts — dot + text inline --- */
    .verdict {
      display: inline-flex; align-items: center; gap: 8px;
      font-size: 14px; font-family: var(--font); font-weight: 400;
      line-height: 16px; white-space: nowrap;
    }
    .verdict-dot {
      width: 8px; height: 8px; border-radius: 9999px; flex-shrink: 0;
    }
    .verdict-text { color: var(--ds-neutral-text); }
    /* Verdict color variants */
    .verdict-neutral .verdict-dot     { background: var(--ds-neutral-700); }
    .verdict-neutral .verdict-text    { color: #a9b2c4; }
    .verdict-not-active .verdict-dot  { background: var(--ds-inactive-700); }
    .verdict-not-active .verdict-text { color: #a9b2c4; }
    .verdict-detected .verdict-dot    { background: var(--ds-alert-700); }
    .verdict-detected .verdict-text   { color: var(--ds-alert-text); }
    .verdict-progress .verdict-dot    { background: var(--ds-accent-700); }
    .verdict-progress .verdict-text   { color: var(--ds-accent-text); }
    .verdict-completed .verdict-dot   { background: var(--ds-success-700); }
    .verdict-completed .verdict-text  { color: var(--ds-success-text); }
    .verdict-failed .verdict-dot      { background: var(--ds-alert-700); }
    .verdict-failed .verdict-text     { color: var(--ds-alert-text); }
    .verdict-secure .verdict-dot      { background: var(--ds-secure-700); }
    .verdict-secure .verdict-text     { color: var(--ds-secure-text); }
    .verdict-warn .verdict-dot        { background: var(--ds-warn-700); }
    .verdict-warn .verdict-text       { color: var(--ds-warn-text); }
    .verdict-accent .verdict-dot      { background: var(--ds-accent-700); }
    .verdict-accent .verdict-text     { color: var(--ds-accent-text); }
    .verdict-guide .verdict-dot       { background: var(--ds-guide-700); }
    .verdict-guide .verdict-text      { color: var(--ds-guide-text); }
    .verdict-caution .verdict-dot     { background: var(--ds-caution-700); }
    .verdict-caution .verdict-text    { color: var(--ds-caution-text); }

    /* --- Severities — triangle icon + text inline --- */
    .severity {
      display: inline-flex; align-items: center; gap: 8px;
      font-size: 14px; font-family: var(--font); font-weight: 400;
      line-height: 16px; white-space: nowrap; color: var(--text-subtle);
    }
    .severity-icon {
      width: 16px; height: 16px; flex-shrink: 0; display: inline-flex;
      align-items: center; justify-content: center;
    }
    .severity-icon svg { width: 16px; height: 16px; }
    .severity-critical .severity-icon { color: var(--ds-alert-700); }
    .severity-high .severity-icon     { color: var(--ds-alert-700); }
    .severity-medium .severity-icon   { color: var(--ds-warn-700); }
    .severity-low .severity-icon      { color: var(--ds-caution-700); }
    .severity-none .severity-icon     { color: var(--ds-neutral-700); }

    /* ===== DARK MODE ===== */
    [data-theme="dark"] {
      --surface-bg: #0c121d;
      --surface-card: #141b27;
      --header-bg: #0c121d;
      --tab-bg: #141b27;
      --border-bg: #141b27;
      --border-200: #344565;
      --border-card: #24324b;
      --text-strong: #ffffff;
      --text-subtle: #a9b2c4;
      --text-muted: #6b7a90;
      --primary: #4d8dff;
      --primary-hover: #3a7df5;

      /* Tag/badge tokens dark */
      --ds-neutral-100: #172234;   --ds-neutral-text: #ffffff;   --ds-neutral-700: #6b7a90;
      --ds-inactive-100: #172234;  --ds-inactive-text: #6b7a90;  --ds-inactive-700: #475b81;
      --ds-secure-100: #003d2b;    --ds-secure-text: #b3ffe8;    --ds-secure-700: #00b37a;   --ds-secure-fill: #006c4c;
      --ds-success-100: #003d2b;   --ds-success-text: #b3ffe8;   --ds-success-700: #00b37a;  --ds-success-fill: #006c4c;
      --ds-accent-100: #0d2654;    --ds-accent-text: #c6dafe;    --ds-accent-700: #4d8dff;   --ds-accent-fill: #0d2654;
      --ds-guide-100: #1e1250;     --ds-guide-text: #c8b8ff;     --ds-guide-700: #a78bfa;    --ds-guide-fill: #7c5ce0;
      --ds-alert-100: #4d0011;     --ds-alert-text: #ffbab7;     --ds-alert-700: #ff6b6b;    --ds-alert-fill: #7e001d;
      --ds-warn-100: #4d1a00;      --ds-warn-text: #ffab6f;      --ds-warn-700: #ffab6f;     --ds-warn-fill: #802b00;
      --ds-caution-100: #3d3200;   --ds-caution-text: #ffe599;   --ds-caution-700: #ffe599;  --ds-caution-fill: #5d4200;
    }
    [data-theme="dark"] body { background: var(--surface-bg); color: var(--text-subtle); }
    [data-theme="dark"] .sidebar { background: var(--header-bg); border-color: var(--border-card); }
    [data-theme="dark"] .sidebar .nav-item { color: var(--text-subtle); }
    [data-theme="dark"] .sidebar .nav-item.active { background: rgba(29,107,252,0.25); color: #fff; }
    [data-theme="dark"] .sidebar .nav-item:hover:not(.active) { background: rgba(255,255,255,0.04); }
    [data-theme="dark"] .main-header { background: var(--header-bg); border-color: var(--border-card); }
    [data-theme="dark"] .header { background: var(--surface-bg); border-color: var(--border-card); }
    [data-theme="dark"] .header .header-logo-text span { color: #fff; }
    [data-theme="dark"] .header-icon { color: #fff; }
    [data-theme="dark"] .header-icon:hover { background: rgba(255,255,255,0.08); color: #fff; }
    [data-theme="dark"] .sidebar-toggle { color: #fff; }
    [data-theme="dark"] .sidebar-toggle:hover { background: rgba(255,255,255,0.08); color: #fff; }
    [data-theme="dark"] .tabs { background: var(--tab-bg); border-color: var(--border-card); }
    [data-theme="dark"] .tab { color: var(--text-subtle); }
    [data-theme="dark"] .tab.active { color: #fff; border-bottom-color: var(--primary); }
    [data-theme="dark"] .settings-card { background: var(--surface-card); border-color: var(--border-card); }
    [data-theme="dark"] .card-header { border-color: var(--border-card); }
    [data-theme="dark"] .card-header h2 { color: #fff; }
    [data-theme="dark"] .form-label { color: var(--text-subtle); }
    [data-theme="dark"] .input-field { background: var(--surface-bg); border-color: var(--border-200); color: #fff; }
    [data-theme="dark"] .input-field input { color: #fff; }
    [data-theme="dark"] .select-field { background: var(--surface-bg); border-color: var(--border-200); color: #fff; }
    [data-theme="dark"] .btn-save { background: var(--surface-bg); border-color: var(--border-200); color: var(--text-muted); }
    [data-theme="dark"] .settings-card.dirty .btn-save { background: var(--primary); color: #fff; border-color: var(--primary); }
    [data-theme="dark"] .btn-discard { border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .btn-outline { border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .btn-outline:hover { background: rgba(255,255,255,0.04); }
    [data-theme="dark"] .pool-table thead th,
    [data-theme="dark"] .data-table thead th,
    [data-theme="dark"] .headers-table-head { background: var(--surface-card); color: var(--text-subtle); border-color: var(--border-card); }
    [data-theme="dark"] .pool-table tbody td,
    [data-theme="dark"] .data-table tbody td,
    [data-theme="dark"] .headers-table-row { border-color: var(--border-card); color: var(--text-subtle); }
    [data-theme="dark"] .pool-table tbody tr:hover td,
    [data-theme="dark"] .data-table tbody tr:hover td,
    [data-theme="dark"] .audit-table tbody tr:hover td { background: rgba(255,255,255,0.03); }
    [data-theme="dark"] .audit-card { background: var(--surface-card); border-color: var(--border-card); }
    [data-theme="dark"] .audit-card-header { border-color: var(--border-card); }
    [data-theme="dark"] .audit-card-title h3 { color: #fff; }
    [data-theme="dark"] .audit-table thead th { background: var(--surface-card); color: var(--text-subtle); border-color: var(--border-card); }
    [data-theme="dark"] .audit-table tbody td { border-color: var(--border-card); color: var(--text-subtle); }
    [data-theme="dark"] .audit-search { background: var(--surface-bg); border-color: var(--border-200); }
    [data-theme="dark"] .audit-search input { color: #fff; }
    [data-theme="dark"] .audit-search svg { color: var(--text-subtle); }
    [data-theme="dark"] .audit-filter-btn { background: var(--surface-bg); border-color: var(--border-200); color: var(--text-muted); }
    [data-theme="dark"] .audit-pagination { border-color: var(--border-card); color: var(--text-muted); }
    [data-theme="dark"] .audit-page-btn { background: var(--surface-bg); border-color: var(--border-200); color: var(--text-muted); }
    [data-theme="dark"] .audit-page-select,
    [data-theme="dark"] .audit-pagination-left select { background: var(--surface-bg); border-color: var(--border-200); color: #fff; }
    [data-theme="dark"] .advanced-filters-panel { background: var(--surface-card); }
    [data-theme="dark"] .af-header { border-color: var(--border-card); }
    [data-theme="dark"] .af-header h3 { color: #fff; }
    [data-theme="dark"] .af-field select { background: var(--surface-bg); border-color: var(--border-200); color: #fff; }
    [data-theme="dark"] .af-field-label { color: var(--text-subtle); }
    [data-theme="dark"] .af-footer { border-color: var(--border-card); }
    [data-theme="dark"] .toast { background: #344565; }
    [data-theme="dark"] .tag-keyword { border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .chip-default { background: #24324b; color: #fff; }
    [data-theme="dark"] .chip-inactive { border-color: var(--border-200); color: var(--text-muted); }
    [data-theme="dark"] .badge-number-neutral { background: #6b7a90; }
    [data-theme="dark"] .file-upload-field { background: var(--surface-bg); border-color: var(--border-200); }
    [data-theme="dark"] .modal-content { background: var(--surface-card); border-color: var(--border-card); }
    [data-theme="dark"] .modal-header { border-color: var(--border-card); }
    [data-theme="dark"] .modal-header h2 { color: #fff; }
    [data-theme="dark"] .panel-content { background: var(--surface-card); border-color: var(--border-card); }
    [data-theme="dark"] .panel-header { border-color: var(--border-card); }
    [data-theme="dark"] .panel-header h2 { color: #fff; }
    [data-theme="dark"] .toggle-slider { background: #344565; }
    [data-theme="dark"] .form-value { color: var(--text-subtle); }
    [data-theme="dark"] .radio-circle { border-color: var(--border-200); }
    [data-theme="dark"] .promo-banner { background: rgba(29,107,252,0.08); border-color: rgba(29,107,252,0.2); }
    [data-theme="dark"] .warning-banner { background: rgba(232,123,30,0.08); border-color: rgba(232,123,30,0.2); }
    [data-theme="dark"] .content-title h1 { color: #fff; }
    [data-theme="dark"] .page-title h1 { color: #fff; }
    [data-theme="dark"] .pool-card-header { border-color: var(--border-card); }
    [data-theme="dark"] .pool-card-header h2 { color: #fff; }
    [data-theme="dark"] .sidebar-footer { border-color: var(--border-card); }
    [data-theme="dark"] .sidebar-footer-brand path { fill: #ffffff; }
    [data-theme="dark"] .av-badge { background: var(--surface-bg); border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .pool-action-btn:hover { background: rgba(255,255,255,0.06); }
    [data-theme="dark"] .pool-action-menu { background: var(--surface-card); border-color: var(--border-200); }
    [data-theme="dark"] .pool-action-menu-item:hover { background: rgba(255,255,255,0.04); }
    [data-theme="dark"] .filter-icon { color: var(--text-muted); }
    [data-theme="dark"] .audit-user { color: #fff; }
    [data-theme="dark"] .audit-table tbody td .audit-user { color: #fff; }
    [data-theme="dark"] .expand-btn { color: var(--text-subtle); }
    [data-theme="dark"] .expand-btn:hover { color: #fff; }
    [data-theme="dark"] .copy-btn { color: var(--text-subtle); }
    [data-theme="dark"] .copy-btn:hover { color: #fff; }
    [data-theme="dark"] .btn-primary { background: var(--primary); border-color: var(--primary); color: #fff; }
    [data-theme="dark"] .btn-export { border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .audit-detail-row td { color: var(--text-muted); }
    [data-theme="dark"] .notif-dot { background: #ff6e75; }
    [data-theme="dark"] .header-avatar { border-color: rgba(255,255,255,0.1); }
    [data-theme="dark"] .af-footer .btn-outline { border-color: var(--border-200); color: var(--text-subtle); }
    [data-theme="dark"] .af-footer .btn-primary { background: var(--primary); color: #fff; }
    [data-theme="dark"] .af-footer .af-results-text { color: var(--text-muted); }

    /* Theme toggle button */
    .theme-toggle {
      width: 32px; height: 32px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-subtle); background: none; border: none;
      margin-left: 4px; padding: 0;
    }
    .theme-toggle:hover { color: var(--text-strong); background: rgba(0,0,0,0.06); }
    .theme-toggle svg { width: 18px; height: 18px; }
    [data-theme="dark"] .theme-toggle { color: #fff; }
    [data-theme="dark"] .theme-toggle:hover { background: rgba(255,255,255,0.08); }

    /* Advanced Filters Drawer */
    .advanced-filters-overlay {
      position: fixed; inset: 0; z-index: 2000;
      background: rgba(0,0,0,0.4);
      opacity: 0; visibility: hidden;
      transition: opacity 0.25s ease, visibility 0.25s ease;
    }
    .advanced-filters-overlay.open { opacity: 1; visibility: visible; }
    .advanced-filters-panel {
      position: fixed; top: 0; right: 0; z-index: 2001;
      background: #fff;
      width: 420px; height: 100vh;
      box-shadow: -4px 0 24px rgba(12,18,29,0.12);
      display: flex; flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .advanced-filters-overlay.open + .advanced-filters-panel,
    .advanced-filters-panel.open { transform: translateX(0); }
    .af-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 24px;
      height: 56px;
      border-bottom: 1px solid var(--border-200);
      flex-shrink: 0;
    }
    .af-header h3 { font-size: 14px; font-weight: 500; color: var(--text-strong); }
    .af-close {
      width: 28px; height: 28px; border: none; background: none;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      color: var(--text-muted); border-radius: var(--radius);
    }
    .af-close:hover { color: var(--text-strong); background: rgba(0,0,0,0.04); }
    .af-close svg { width: 16px; height: 16px; }
    .af-body { padding: 24px; display: flex; flex-direction: column; gap: 16px; flex: 1; overflow-y: auto; }
    .af-field { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: center; }
    .af-field-label { font-size: 14px; color: var(--text-subtle); min-height: 32px; display: flex; align-items: center; }
    .af-field select {
      width: 100%;
      padding: 0 12px; height: 32px;
      border: 1px solid var(--border-200); border-radius: var(--radius);
      font-size: 14px; font-family: var(--font); color: var(--text-strong);
      background: #fff; appearance: none; -webkit-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M7.99994 10.7499C7.80994 10.7499 7.61994 10.6799 7.46994 10.5299L3.21994 6.27994C2.92994 5.98994 2.92994 5.50994 3.21994 5.21994C3.50994 4.92994 3.98994 4.92994 4.27994 5.21994L7.99994 8.93994L11.7199 5.21994C12.0099 4.92994 12.4899 4.92994 12.7799 5.21994C13.0699 5.50994 13.0699 5.98994 12.7799 6.27994L8.52994 10.5299C8.37994 10.6799 8.18994 10.7499 7.99994 10.7499Z' fill='%236b7a90'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      padding-right: 28px; cursor: pointer;
    }
    .af-field select:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29,107,252,0.15); outline: none; }
    .af-footer {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 24px;
      border-top: 1px solid var(--border-200);
      flex-shrink: 0;
    }
    .af-footer-info { font-size: 14px; color: var(--text-muted); }
    .af-footer-actions { display: flex; gap: 8px; }

    /* ===== Avatar Dropdown Menu ===== */
    .avatar-dropdown-wrap { position: relative; }
    .avatar-dropdown {
      position: absolute; top: calc(100% + 8px); right: 0; z-index: 3000;
      width: 260px; padding: 12px;
      background: var(--surface-card, #fff);
      border: 1px solid var(--border-card, #EBECEE);
      border-radius: 4px;
      box-shadow: 2px 4px 4px -2px rgba(12,18,29,0.12), 0 3px 16px -2px rgba(12,18,29,0.12);
      display: none; flex-direction: column; gap: 0;
      font-family: var(--font);
    }
    .avatar-dropdown.open { display: flex; }

    /* User info header */
    .avd-user {
      display: flex; align-items: center;
      padding: 12px 16px 12px 12px; margin: 0;
      width: 100%;
      box-sizing: border-box;
    }
    .avd-user-info { display: flex; flex-direction: column; gap: 4px; min-width: 0; }
    .avd-user-name {
      font-size: 14px; font-weight: 500; line-height: 16px; color: var(--text-strong);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .avd-user-email {
      font-size: 14px; line-height: 16px; color: var(--text-subtle);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }

    /* Divider */
    .avd-divider {
      height: 1px; background: var(--border-200);
      width: 100%; margin: 12px 0;
    }
    .avd-back + .avd-divider {
      margin: 12px -12px; width: calc(100% + 24px);
    }

    .avd-group {
      display: flex; flex-direction: column;
    }

    /* Menu items */
    .avd-item {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 12px; margin: 0; border-radius: 4px;
      font-size: 14px; line-height: 16px; color: var(--text-strong);
      cursor: pointer; border: none; background: none;
      width: 100%; height: 32px; box-sizing: border-box;
      text-align: left; font-family: var(--font);
      transition: background 0.15s;
    }
    .avd-item:hover { background: rgba(0,0,0,0.04); }
    .avd-item svg { width: 16px; height: 16px; flex-shrink: 0; color: var(--text-subtle); }
    .avd-item .avd-chevron { margin-left: auto; width: 16px; height: 16px; color: var(--text-muted); }
    .avd-item .avd-flag { width: 20px; height: 16px; border-radius: 2px; flex-shrink: 0; }
    .avd-item-text { flex: 1; min-width: 0; }
    .avd-item-subtle { color: var(--text-subtle); font-size: 14px; }

    /* Submenu */
    .avd-submenu {
      display: none; flex-direction: column; gap: 0;
    }
    .avd-submenu.open { display: flex; }
    .avd-back {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 12px; margin: 0; border-radius: 4px;
      font-size: 14px; line-height: 16px; color: var(--text-subtle);
      cursor: pointer; border: none; background: none;
      width: 100%; height: 32px; box-sizing: border-box;
      text-align: left; font-family: var(--font);
    }
    .avd-back:hover { background: rgba(0,0,0,0.04); }
    .avd-back svg { width: 16px; height: 16px; }

    /* Active check for theme/lang items */
    .avd-item .avd-check { margin-left: auto; width: 16px; height: 16px; color: var(--primary); display: none; }
    .avd-item.active .avd-check { display: block; }

    /* Dark mode overrides */
    [data-theme="dark"] .avatar-dropdown {
      background: var(--surface-card); border-color: var(--border-card);
      box-shadow: 2px 4px 4px rgba(0,0,0,0.3), 0 3px 16px rgba(0,0,0,0.3);
    }
    [data-theme="dark"] .avd-item:hover { background: rgba(255,255,255,0.06); }
    [data-theme="dark"] .avd-back:hover { background: rgba(255,255,255,0.06); }

    /* Component demo wrapper for standalone previews */
    .avd-demo-container {
      display: flex; gap: 24px; flex-wrap: wrap; align-items: flex-start;
    }
    .avd-demo-block {
      position: relative; width: 260px;
    }
    .avd-demo-block .avatar-dropdown {
      position: static; display: flex;
    }

    /* ===== Notifications Dropdown ===== */
    .notif-dropdown-wrap { position: relative; }
    .notif-dropdown {
      position: absolute; top: calc(100% + 8px); right: 0; z-index: 3000;
      width: 320px;
      background: var(--surface-card, #fff);
      border: 1px solid var(--border-card);
      border-radius: 4px;
      box-shadow: 2px 4px 4px rgba(12,18,29,0.12), 0 3px 16px rgba(12,18,29,0.12);
      display: none; flex-direction: column;
      font-family: var(--font);
      overflow: hidden;
    }
    .notif-dropdown.open { display: flex; }

    /* Header */
    .notif-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 16px;
      border-bottom: 1px solid var(--border-200);
    }
    .notif-header-title {
      font-size: 14px; font-weight: 500; color: var(--text-strong);
    }
    .notif-header-action {
      font-size: 14px; font-weight: 500; color: var(--primary);
      cursor: pointer; background: none; border: none; font-family: var(--font);
      padding: 0;
    }
    .notif-header-action:hover { text-decoration: underline; }

    /* Message list */
    .notif-list {
      display: flex; flex-direction: column; gap: 0;
      max-height: 400px; overflow-y: auto;
      padding: 8px;
    }

    /* Message item */
    .notif-msg {
      display: flex; flex-direction: column; gap: 12px;
      padding: 12px; border-radius: 4px;
      cursor: pointer;
      transition: background 0.15s;
    }
    .notif-msg:hover { background: rgba(0,0,0,0.02); }
    .notif-msg-top { display: flex; flex-direction: column; gap: 8px; }
    .notif-msg-title-row {
      display: flex; align-items: center; gap: 8px;
    }
    .notif-msg-title {
      flex: 1; font-size: 14px; font-weight: 500; color: var(--text-strong);
      min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .notif-msg-dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: #475b81; flex-shrink: 0;
    }
    .notif-msg-body {
      font-size: 14px; font-weight: 400; color: var(--text-subtle);
      line-height: 1.33; display: -webkit-box; -webkit-line-clamp: 3;
      -webkit-box-orient: vertical; overflow: hidden;
    }
    .notif-msg-bottom {
      display: flex; align-items: center; gap: 12px;
    }
    .notif-msg-time {
      flex: 1; font-size: 12px; color: var(--text-subtle);
    }

    /* Divider between messages */
    .notif-divider {
      height: 1px; background: var(--border-200);
      margin: 0 4px;
    }

    /* Empty state */
    .notif-empty {
      display: flex; flex-direction: column; align-items: center;
      gap: 16px; padding: 32px 20px; text-align: center;
    }
    .notif-empty-icon {
      position: relative; display: inline-flex;
    }
    .notif-empty-icon svg { width: 64px; height: 48px; }
    .notif-empty-badge {
      position: absolute; bottom: -4px; right: -8px;
      display: inline-flex; height: 16px; min-height: 16px; max-height: 16px;
      padding: 2px 4px; align-items: center;
      border-radius: 4px; background: var(--exception-surface-badge-number, #344565);
      color: #fff; font-size: 12px; font-weight: 400; line-height: 1;
    }
    .notif-empty-title {
      font-size: 14px; font-weight: 500; color: var(--text-strong);
    }
    .notif-empty-subtitle {
      font-size: 14px; color: var(--text-subtle); margin-top: -12px;
    }

    /* Dark mode overrides */
    [data-theme="dark"] .notif-dropdown {
      background: var(--surface-card); border-color: var(--border-card);
      box-shadow: 2px 4px 4px rgba(0,0,0,0.3), 0 3px 16px rgba(0,0,0,0.3);
    }
    [data-theme="dark"] .notif-msg:hover { background: rgba(255,255,255,0.04); }
    [data-theme="dark"] .notif-msg-dot { background: #6b7a90; }

  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <div class="app">
    <!-- Header -->
    <header class="header" role="banner">
      <div class="header-left">
        <button class="sidebar-toggle" aria-label="Toggle sidebar" onclick="toggleSidebar()">
          <svg class="sidebar-icon-extended" viewBox="0 0 16 16" fill="currentColor"><path d="M2 2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zm12-1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2z"/><path d="M13 4a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z"/></svg>
          <svg class="sidebar-icon-collapsed" style="display:none" viewBox="0 0 16 16" fill="currentColor"><path d="M14 2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zM2 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2z"/><path d="M3 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z"/></svg>
        </button>
        <div class="header-logo">
          <div class="header-logo-text">
            <span>METADEFENDER</span>
            <span>Storage Security</span>
          </div>
        </div>
      </div>
      <div class="header-right">
        <div class="header-icon">
          <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
        </div>
        <div class="notif-dropdown-wrap">
          <div class="header-icon" style="position: relative; cursor:pointer;" onclick="toggleNotifDropdown(event)">
            <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.62984 13.13C8.13984 13.62 7.34984 13.62 6.85984 13.13C6.56984 12.84 6.08984 12.84 5.79984 13.13C5.50984 13.42 5.50984 13.9 5.79984 14.19C6.33984 14.73 7.03984 14.99 7.73984 14.99C8.43984 14.99 9.14984 14.72 9.67984 14.19C9.96984 13.9 9.96984 13.42 9.67984 13.13C9.38984 12.84 8.90984 12.84 8.61984 13.13H8.62984Z"/><path d="M14.1698 10.63C13.3598 10.07 12.4998 8.17 12.4998 5.75C12.4998 3.13 10.3698 1 7.74984 1C5.12984 1 2.99984 3.13 2.99984 5.75C2.99984 8.17 2.13984 10.07 1.32984 10.63C1.05984 10.82 0.939844 11.16 1.03984 11.47C1.13984 11.78 1.42984 12 1.75984 12H13.7598C14.0898 12 14.3798 11.79 14.4798 11.47C14.5798 11.16 14.4598 10.82 14.1898 10.63H14.1698Z"/></svg>
            <span class="notif-dot" style="display:none;"></span>
          </div>
          <!-- Notifications Dropdown -->
          <div class="notif-dropdown" id="notifDropdown">
            <div class="notif-header">
              <span class="notif-header-title">Notifications</span>
              <button class="notif-header-action" onclick="markAllNotifRead()">Mark all read</button>
            </div>
            <div class="notif-list" id="notifList">
              <!-- License Expired notification (hidden until expiration triggers) -->
              <div class="notif-msg" id="notifLicenseExpired" style="display:none;" onclick="notifNavigateLicensing()">
                <div class="notif-msg-top">
                  <div class="notif-msg-title-row">
                    <span class="notif-msg-title">License Expired</span>
                    <span class="notif-msg-dot"></span>
                  </div>
                  <div class="notif-msg-body">Your MetaDefender Storage Security license has expired. Scanning and protection features are now disabled. Please renew your license to restore full functionality.</div>
                </div>
                <div class="notif-msg-bottom">
                  <span class="notif-msg-time">Just now</span>
                </div>
              </div>
              <!-- Empty state (shown by default) -->
              <div class="notif-empty" id="notifEmptyState">
                <div class="notif-empty-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="64" height="48" viewBox="0 0 64 48" fill="none"><path d="M3 0.150391H61C62.574 0.150391 63.8496 1.42599 63.8496 3V35C63.8496 36.574 62.574 37.8496 61 37.8496H11.9453L11.9043 37.8848L0.150391 47.6797V3C0.150391 1.42599 1.42599 0.150391 3 0.150391Z" fill="url(#paint0_linear_18490_25811)" stroke="url(#paint1_linear_18490_25811)" stroke-width="0.3"/><circle cx="16.5" cy="19" r="4.35" fill="#607497" stroke="url(#paint2_linear_18490_25811)" stroke-width="0.3"/><circle cx="32" cy="19" r="4.35" fill="#607497" stroke="url(#paint3_linear_18490_25811)" stroke-width="0.3"/><circle cx="47.5" cy="19" r="4.35" fill="#607497" stroke="url(#paint4_linear_18490_25811)" stroke-width="0.3"/><defs><linearGradient id="paint0_linear_18490_25811" x1="32" y1="0" x2="32" y2="48" gradientUnits="userSpaceOnUse"><stop stop-color="#DEE0E4"/><stop offset="1" stop-color="#A9B2C4"/></linearGradient><linearGradient id="paint1_linear_18490_25811" x1="32" y1="0" x2="32" y2="48" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="paint2_linear_18490_25811" x1="16.5" y1="14.5" x2="16.5" y2="23.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="paint3_linear_18490_25811" x1="32" y1="14.5" x2="32" y2="23.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient><linearGradient id="paint4_linear_18490_25811" x1="47.5" y1="14.5" x2="47.5" y2="23.5" gradientUnits="userSpaceOnUse"><stop stop-color="#A9B2C4"/><stop offset="1" stop-color="#607497"/></linearGradient></defs></svg>
                  <span class="notif-empty-badge">0</span>
                </div>
                <div class="notif-empty-title">No Notifications</div>
                <div class="notif-empty-subtitle">Check back for important messages.</div>
              </div>
            </div>
          </div>
        </div>
        <div class="avatar-dropdown-wrap">
          <div class="header-avatar" onclick="toggleAvatarDropdown(event)" style="cursor:pointer;">E</div>
          <!-- Avatar Dropdown -->
          <div class="avatar-dropdown" id="avatarDropdown">
            <!-- Main Menu -->
            <div class="avd-submenu open" id="avdMain">
              <div class="avd-group">
                <div class="avd-user">
                  <div class="avd-user-info">
                    <div class="avd-user-name">Elvijs Vilevics</div>
                    <div class="avd-user-email">elvijs@opswat.com</div>
                  </div>
                </div>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
                <button class="avd-item" onclick="showAvdSub('avdOrg')">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11 6C10.4477 6 10 6.44772 10 7H9V14H11V12H12V14H14V7H13C13 6.44772 12.5523 6 12 6H11ZM13 11H12V10H13V11ZM11 11H10V10H11V11ZM13 9H12V8H13V9ZM11 9H10V8H11V9Z"/><path d="M5 2C4.72386 2 4.5 2.22386 4.5 2.5V3H4C3.44772 3 3 3.44772 3 4H2V14H4V12H6V14H8V4H7C7 3.44772 6.55228 3 6 3H5.5V2.5C5.5 2.22386 5.27614 2 5 2ZM7 11H6V10H7V11ZM4 11H3V10H4V11ZM7 9H6V8H7V9ZM4 9H3V8H4V9ZM7 7H6V6H7V7ZM4 7H3V6H4V7ZM6 5H4V4H6V5Z"/></svg>
                  <span class="avd-item-text">Organization</span>
                  <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.74945 12.9999C5.55945 12.9999 5.36945 12.9299 5.21945 12.7799C4.92945 12.4899 4.92945 12.0099 5.21945 11.7199L8.93945 7.99994L5.21945 4.27994C4.92945 3.98994 4.92945 3.50994 5.21945 3.21994C5.50945 2.92994 5.98945 2.92994 6.27945 3.21994L10.5295 7.46994C10.8195 7.75994 10.8195 8.23994 10.5295 8.52994L6.27945 12.7799C6.12945 12.9299 5.93945 12.9999 5.74945 12.9999Z"/></svg>
                </button>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
                <button class="avd-item" onclick="avdNavigate('profile')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M7.99023 10C8.60018 10 9.30032 10.0896 9.99023 10.2695C10.1201 10.2995 10.2598 10.3399 10.3896 10.3799C11.7795 10.8198 12.9802 11.5998 12.9805 12.6396H13V14H3V12.6396C3.00027 11.5999 4.20005 10.8198 5.58984 10.3799C6.38984 10.1299 7.26023 10 7.99023 10Z"/><path d="M8 3C8.76989 3 9.47003 3.28966 10 3.76953C10.62 4.30953 11 5.11 11 6C11 6.88994 10.6199 7.68973 10 8.21973C9.47 8.70973 8.77 9 8 9C7.23 9 6.53 8.70973 6 8.21973C5.38008 7.68973 5 6.88994 5 6C5 4.34 6.34 3 8 3Z"/></svg>
                <span class="avd-item-text">Profile</span>
              </button>
              <button class="avd-item" onclick="avdNavigate('settings')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.2101 8.46C13.2201 8.31 13.2301 8.16 13.2301 8C13.2301 7.84 13.2201 7.69 13.2101 7.54C13.2001 7.4 13.1801 7.25 13.1601 7.11L14.1201 6.26C14.4801 5.95 14.5601 5.42 14.3301 5.01L13.7501 4.01C13.5101 3.6 13.0201 3.41 12.5701 3.56L11.3301 3.97C11.1001 3.78 10.8601 3.61 10.6001 3.46C10.3301 3.32 10.0601 3.19 9.78005 3.08L9.54005 1.81C9.45005 1.34 9.04005 1 8.56005 1H7.41005C6.93005 1 6.52005 1.34 6.43005 1.81L6.19005 3.08C5.91005 3.19 5.64005 3.32 5.37005 3.46C5.11005 3.61 4.87005 3.78 4.64005 3.97L3.40005 3.56C2.95005 3.41 2.46005 3.6 2.22005 4.01L1.64005 5.01C1.40005 5.42 1.49005 5.95 1.85005 6.26L2.81005 7.11C2.79005 7.25 2.77005 7.4 2.76005 7.54C2.75005 7.69 2.74005 7.84 2.74005 8C2.74005 8.16 2.75005 8.31 2.76005 8.46C2.77005 8.6 2.79005 8.75 2.81005 8.89L1.85005 9.74C1.49005 10.05 1.41005 10.58 1.64005 10.99L2.22005 11.99C2.46005 12.4 2.95005 12.59 3.40005 12.44L4.64005 12.03C4.87005 12.22 5.11005 12.39 5.37005 12.54C5.64005 12.68 5.91005 12.81 6.19005 12.92L6.43005 14.19C6.52005 14.66 6.93005 15 7.41005 15H8.56005C9.04005 15 9.45005 14.66 9.54005 14.19L9.78005 12.92C10.0601 12.81 10.3301 12.68 10.6001 12.54C10.8601 12.39 11.1001 12.22 11.3301 12.03L12.5701 12.44C13.0201 12.59 13.5101 12.4 13.7501 11.99L14.3301 10.99C14.5701 10.58 14.4801 10.05 14.1201 9.74L13.1601 8.89C13.1801 8.75 13.2001 8.6 13.2101 8.46ZM8.57005 10.94C6.45005 11.34 4.64005 9.53 5.04005 7.41C5.26005 6.23 6.22005 5.27 7.40005 5.05C9.52005 4.65 11.3301 6.46 10.9301 8.58C10.7101 9.76 9.75005 10.72 8.57005 10.94Z"/></svg>
                <span class="avd-item-text">Settings</span>
              </button>
              <button class="avd-item">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14 2H2C1.45 2 1 2.45 1 3V14.5L3.5 12H14C14.55 12 15 11.55 15 11V3C15 2.45 14.55 2 14 2Z"/></svg>
                <span class="avd-item-text">Support</span>
              </button>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
              <button class="avd-item" onclick="showAvdSub('avdTheme')">
                <svg class="theme-icon-moon" viewBox="0 0 16 16" fill="currentColor"><path d="M14.4379 10.1415C14.6279 9.71649 14.1169 9.35449 13.6899 9.54049C12.6773 9.98079 11.5557 10.1061 10.4709 9.90018C9.38608 9.69424 8.38839 9.16655 7.60762 8.38578C6.82686 7.60502 6.29917 6.60733 6.09323 5.52253C5.88728 4.43774 6.01262 3.31607 6.45292 2.30349C6.63892 1.87649 6.27692 1.36549 5.85292 1.55549C4.89004 1.98495 4.04606 2.64214 3.39374 3.47042C2.74142 4.2987 2.30033 5.2732 2.10851 6.30991C1.91668 7.34662 1.97988 8.41443 2.29265 9.42128C2.60541 10.4281 3.15837 11.3438 3.90383 12.0893C4.6493 12.8349 5.5649 13.388 6.57172 13.7008C7.57853 14.0137 8.64633 14.0771 9.68306 13.8853C10.7198 13.6936 11.6944 13.2527 12.5227 12.6004C13.3511 11.9482 14.0084 11.1043 14.4379 10.1415Z"/></svg>
                <svg class="theme-icon-sun" viewBox="0 0 16 16" fill="currentColor" style="display:none;"><path d="M8 11C9.65 11 11 9.66 11 8C11 6.34 9.65 5 8 5C6.35 5 5 6.34 5 8C5 9.66 6.35 11 8 11Z"/><path d="M14.25 7.25C14.6642 7.25 15 7.58579 15 8C15 8.41421 14.6642 8.75 14.25 8.75H13.25C12.8358 8.75 12.5 8.41421 12.5 8C12.5 7.58579 12.8358 7.25 13.25 7.25H14.25Z"/><path d="M11.8897 3.04973C12.1826 2.75684 12.6573 2.75685 12.9502 3.04973C13.2431 3.34262 13.2431 3.81738 12.9502 4.11028L12.2403 4.82024C11.9474 5.11313 11.4726 5.11313 11.1797 4.82024C10.8869 4.52734 10.8868 4.05258 11.1797 3.75969L11.8897 3.04973Z"/><path d="M7.25 2.75V1.75C7.25 1.33579 7.58579 1 8 1C8.41421 1 8.75 1.33579 8.75 1.75V2.75C8.75 3.16421 8.41421 3.5 8 3.5C7.58579 3.5 7.25 3.16421 7.25 2.75Z"/><path d="M3.04973 3.04973C3.34262 2.75684 3.81738 2.75684 4.11028 3.04973L4.82024 3.75969L4.87199 3.81633C5.11234 4.11091 5.09485 4.54562 4.82024 4.82024C4.54562 5.09485 4.11091 5.11234 3.81633 4.87199L3.75969 4.82024L3.04973 4.11028C2.75684 3.81738 2.75684 3.34262 3.04973 3.04973Z"/><path d="M2.75 7.25C3.16421 7.25 3.5 7.58579 3.5 8C3.5 8.41421 3.16421 8.75 2.75 8.75H1.75C1.33579 8.75 1 8.41421 1 8C1 7.58579 1.33579 7.25 1.75 7.25H2.75Z"/><path d="M3.75969 11.1797C4.05258 10.8868 4.52734 10.8869 4.82024 11.1797C5.11313 11.4726 5.11313 11.9474 4.82024 12.2403L4.11028 12.9502C3.81738 13.2431 3.34262 13.2431 3.04973 12.9502C2.75685 12.6573 2.75684 12.1826 3.04973 11.8897L3.75969 11.1797Z"/><path d="M7.25 14.25V13.25C7.25 12.8358 7.58579 12.5 8 12.5C8.41421 12.5 8.75 12.8358 8.75 13.25V14.25C8.75 14.6642 8.41421 15 8 15C7.58579 15 7.25 14.6642 7.25 14.25Z"/><path d="M11.1797 11.1797C11.4726 10.8868 11.9474 10.8868 12.2403 11.1797L12.9502 11.8897L13.002 11.9463C13.2423 12.2409 13.2249 12.6756 12.9502 12.9502C12.6756 13.2249 12.2409 13.2423 11.9463 13.002L11.8897 12.9502L11.1797 12.2403C10.8868 11.9474 10.8868 11.4726 11.1797 11.1797Z"/></svg>
                <span class="avd-item-text" id="avdThemeLabel">Light Theme</span>
                <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.74945 12.9999C5.55945 12.9999 5.36945 12.9299 5.21945 12.7799C4.92945 12.4899 4.92945 12.0099 5.21945 11.7199L8.93945 7.99994L5.21945 4.27994C4.92945 3.98994 4.92945 3.50994 5.21945 3.21994C5.50945 2.92994 5.98945 2.92994 6.27945 3.21994L10.5295 7.46994C10.8195 7.75994 10.8195 8.23994 10.5295 8.52994L6.27945 12.7799C6.12945 12.9299 5.93945 12.9999 5.74945 12.9999Z"/></svg>
              </button>
              <button class="avd-item" onclick="showAvdSub('avdLang')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.996 5.00155C11.1422 5.0016 11.2851 5.04435 11.4072 5.12456C11.5294 5.20476 11.6254 5.31891 11.6834 5.45295L14.9306 12.943C14.9726 13.0337 14.9961 13.1319 14.9995 13.2318C15.003 13.3316 14.9865 13.4312 14.9509 13.5246C14.9153 13.618 14.8613 13.7033 14.7922 13.7755C14.7231 13.8477 14.6402 13.9054 14.5485 13.9451C14.4567 13.9849 14.358 14.0058 14.258 14.0068C14.158 14.0078 14.0588 13.9887 13.9663 13.9508C13.8738 13.9129 13.7899 13.8569 13.7193 13.786C13.6488 13.7152 13.5932 13.6309 13.5558 13.5382L12.8844 11.9923H9.10668L8.43726 13.5382C8.3583 13.7206 8.21009 13.8641 8.02525 13.9373C7.8404 14.0104 7.63406 14.0072 7.45162 13.9282C7.26918 13.8493 7.12558 13.7012 7.05241 13.5164C6.97924 13.3316 6.98249 13.1254 7.06146 12.943L10.3086 5.45295C10.3667 5.31891 10.4627 5.20476 10.5848 5.12456C10.707 5.04435 10.8499 5.0016 10.996 5.00155ZM9.75711 10.4943H12.235L10.996 7.63406L9.75711 10.4943ZM5.00126 1.00684C5.19999 1.00684 5.39059 1.08575 5.53112 1.22622C5.67165 1.36668 5.7506 1.5572 5.7506 1.75584V3.01518C6.6189 3.04074 7.4853 3.11107 8.34634 3.2259C8.54336 3.25238 8.72178 3.35602 8.84235 3.51399C8.96293 3.67197 9.01578 3.87135 8.98928 4.06828C8.96278 4.26521 8.8591 4.44355 8.70106 4.56407C8.54301 4.68459 8.34353 4.73742 8.14651 4.71093C7.92671 4.68097 7.7069 4.655 7.48509 4.63104C7.13359 5.84275 6.60645 6.99648 5.92045 8.0555C6.15725 8.3591 6.40803 8.64971 6.6718 8.92735C6.80893 9.07117 6.88328 9.26355 6.87851 9.46217C6.87373 9.66079 6.79021 9.84938 6.64632 9.98644C6.50243 10.1235 6.30997 10.1978 6.11126 10.1931C5.91255 10.1883 5.72388 10.1048 5.58675 9.96098C5.38423 9.74824 5.18896 9.52874 5.00126 9.30285C4.18461 10.2846 3.22824 11.1413 2.16273 11.8455C1.99685 11.955 1.79423 11.9942 1.59946 11.9544C1.40468 11.9146 1.23371 11.7991 1.12413 11.6333C1.01456 11.4675 0.975374 11.2649 1.01519 11.0702C1.05501 10.8756 1.17057 10.7047 1.33645 10.5951C2.38365 9.90296 3.311 9.04483 4.08206 8.0545C3.88453 7.75012 3.69986 7.43759 3.52854 7.11774C3.43487 6.94253 3.41466 6.73731 3.47237 6.54721C3.53009 6.35711 3.66098 6.19772 3.83627 6.10409C4.01156 6.01046 4.21688 5.99026 4.40706 6.04795C4.59725 6.10563 4.75671 6.23647 4.85039 6.41168C4.89934 6.50156 4.9493 6.59244 5.00026 6.68232C5.38792 6.00322 5.70764 5.27918 5.95143 4.52118C4.58303 4.4671 3.21252 4.53059 1.855 4.71093C1.65798 4.73742 1.45851 4.68459 1.30046 4.56407C1.14241 4.44355 1.03873 4.26521 1.01223 4.06828C0.985733 3.87135 1.03858 3.67197 1.15916 3.51399C1.27973 3.35602 1.45815 3.25238 1.65517 3.2259C2.50743 3.11205 3.37367 3.04114 4.25091 3.01518V1.75584C4.25091 1.6574 4.27032 1.55992 4.30805 1.46898C4.34577 1.37804 4.40105 1.29543 4.47074 1.22586C4.54043 1.1563 4.62316 1.10115 4.71419 1.06356C4.80522 1.02598 4.90277 1.00671 5.00126 1.00684Z"/></svg>
                <span class="avd-item-text">English</span>
                <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M5.74945 12.9999C5.55945 12.9999 5.36945 12.9299 5.21945 12.7799C4.92945 12.4899 4.92945 12.0099 5.21945 11.7199L8.93945 7.99994L5.21945 4.27994C4.92945 3.98994 4.92945 3.50994 5.21945 3.21994C5.50945 2.92994 5.98945 2.92994 6.27945 3.21994L10.5295 7.46994C10.8195 7.75994 10.8195 8.23994 10.5295 8.52994L6.27945 12.7799C6.12945 12.9299 5.93945 12.9999 5.74945 12.9999Z"/></svg>
              </button>
              </div>
              <div class="avd-divider"></div>
              <div class="avd-group">
              <button class="avd-item avd-item-subtle" style="display:none;">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2.29055 11.76L4.55055 9.5L5.61055 10.56L4.45055 11.72H6.83055C7.24055 11.72 7.58055 12.06 7.58055 12.47C7.58055 12.88 7.24055 13.22 6.83055 13.22H4.45055L5.61055 14.38L4.55055 15.44L2.29055 13.18C1.90055 12.79 1.90055 12.16 2.29055 11.77V11.76Z"/><path d="M13.7105 4.68L11.4505 6.94L10.3905 5.88L11.5505 4.72H9.17055C8.76055 4.72 8.42055 4.38 8.42055 3.97C8.42055 3.56 8.76055 3.22 9.17055 3.22H11.5505L10.3905 2.06L11.4505 1L13.7105 3.26C14.1005 3.65 14.1005 4.28 13.7105 4.67V4.68Z"/><path d="M3.00055 4.22V7.22H4.50055V4.72H13.0005V3.22H4.00055C3.45055 3.22 3.00055 3.67 3.00055 4.22Z"/><path d="M13.0005 12.22V9.22H11.5005V11.72H3.00055V13.22H12.0005C12.5505 13.22 13.0005 12.77 13.0005 12.22Z"/></svg>
                <span class="avd-item-text">Switch to New Version</span>
              </button>
              <button class="avd-item">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.54 8.75H6.75C6.34 8.75 6 8.41 6 8C6 7.59 6.34 7.25 6.75 7.25H11.54L10.38 6.09L11.44 5.03L13.7 7.29C14.09 7.68 14.09 8.31 13.7 8.7L11.44 10.96L10.38 9.9L11.54 8.74V8.75Z"/><path d="M8 14H3C2.45 14 2 13.55 2 13V3C2 2.45 2.45 2 3 2H8V3.5H3.5V12.5H8V14Z"/></svg>
                <span class="avd-item-text">Logout</span>
              </button>
              </div>
            </div>
            <!-- Theme Submenu -->
            <div class="avd-submenu" id="avdTheme">
              <button class="avd-back" onclick="showAvdSub('avdMain')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99945 12.9999C9.80945 12.9999 9.61945 12.9299 9.46945 12.7799L5.21945 8.52994C4.92945 8.23994 4.92945 7.75994 5.21945 7.46994L9.46945 3.21994C9.75945 2.92994 10.2395 2.92994 10.5295 3.21994C10.8195 3.50994 10.8195 3.98994 10.5295 4.27994L6.80945 7.99994L10.5295 11.7199C10.8195 12.0099 10.8195 12.4899 10.5295 12.7799C10.3795 12.9299 10.1895 12.9999 9.99945 12.9999Z"/></svg>
                Back
              </button>
              <div class="avd-divider"></div>
              <button class="avd-item active" onclick="setAvdTheme('light', this)">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 11C9.65 11 11 9.66 11 8C11 6.34 9.65 5 8 5C6.35 5 5 6.34 5 8C5 9.66 6.35 11 8 11Z"/><path d="M14.25 7.25C14.6642 7.25 15 7.58579 15 8C15 8.41421 14.6642 8.75 14.25 8.75H13.25C12.8358 8.75 12.5 8.41421 12.5 8C12.5 7.58579 12.8358 7.25 13.25 7.25H14.25Z"/><path d="M11.8897 3.04973C12.1826 2.75684 12.6573 2.75685 12.9502 3.04973C13.2431 3.34262 13.2431 3.81738 12.9502 4.11028L12.2403 4.82024C11.9474 5.11313 11.4726 5.11313 11.1797 4.82024C10.8869 4.52734 10.8868 4.05258 11.1797 3.75969L11.8897 3.04973Z"/><path d="M7.25 2.75V1.75C7.25 1.33579 7.58579 1 8 1C8.41421 1 8.75 1.33579 8.75 1.75V2.75C8.75 3.16421 8.41421 3.5 8 3.5C7.58579 3.5 7.25 3.16421 7.25 2.75Z"/><path d="M3.04973 3.04973C3.34262 2.75684 3.81738 2.75684 4.11028 3.04973L4.82024 3.75969L4.87199 3.81633C5.11234 4.11091 5.09485 4.54562 4.82024 4.82024C4.54562 5.09485 4.11091 5.11234 3.81633 4.87199L3.75969 4.82024L3.04973 4.11028C2.75684 3.81738 2.75684 3.34262 3.04973 3.04973Z"/><path d="M2.75 7.25C3.16421 7.25 3.5 7.58579 3.5 8C3.5 8.41421 3.16421 8.75 2.75 8.75H1.75C1.33579 8.75 1 8.41421 1 8C1 7.58579 1.33579 7.25 1.75 7.25H2.75Z"/><path d="M3.75969 11.1797C4.05258 10.8868 4.52734 10.8869 4.82024 11.1797C5.11313 11.4726 5.11313 11.9474 4.82024 12.2403L4.11028 12.9502C3.81738 13.2431 3.34262 13.2431 3.04973 12.9502C2.75685 12.6573 2.75684 12.1826 3.04973 11.8897L3.75969 11.1797Z"/><path d="M7.25 14.25V13.25C7.25 12.8358 7.58579 12.5 8 12.5C8.41421 12.5 8.75 12.8358 8.75 13.25V14.25C8.75 14.6642 8.41421 15 8 15C7.58579 15 7.25 14.6642 7.25 14.25Z"/><path d="M11.1797 11.1797C11.4726 10.8868 11.9474 10.8868 12.2403 11.1797L12.9502 11.8897L13.002 11.9463C13.2423 12.2409 13.2249 12.6756 12.9502 12.9502C12.6756 13.2249 12.2409 13.2423 11.9463 13.002L11.8897 12.9502L11.1797 12.2403C10.8868 11.9474 10.8868 11.4726 11.1797 11.1797Z"/></svg>
                <span class="avd-item-text">Light Theme</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item" onclick="setAvdTheme('dark', this)">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.4379 10.1415C14.6279 9.71649 14.1169 9.35449 13.6899 9.54049C12.6773 9.98079 11.5557 10.1061 10.4709 9.90018C9.38608 9.69424 8.38839 9.16655 7.60762 8.38578C6.82686 7.60502 6.29917 6.60733 6.09323 5.52253C5.88728 4.43774 6.01262 3.31607 6.45292 2.30349C6.63892 1.87649 6.27692 1.36549 5.85292 1.55549C4.89004 1.98495 4.04606 2.64214 3.39374 3.47042C2.74142 4.2987 2.30033 5.2732 2.10851 6.30991C1.91668 7.34662 1.97988 8.41443 2.29265 9.42128C2.60541 10.4281 3.15837 11.3438 3.90383 12.0893C4.6493 12.8349 5.5649 13.388 6.57172 13.7008C7.57853 14.0137 8.64633 14.0771 9.68306 13.8853C10.7198 13.6936 11.6944 13.2527 12.5227 12.6004C13.3511 11.9482 14.0084 11.1043 14.4379 10.1415Z"/></svg>
                <span class="avd-item-text">Dark Theme</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item" onclick="setAvdTheme('system', this)">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2zm0 1.5a.5.5 0 00-.5.5v4h4.75V3.5H4zm4.75 5H3.5V12a.5.5 0 00.5.5h4.75V8.5zm1.5-5v9.5H12a.5.5 0 00.5-.5V4a.5.5 0 00-.5-.5h-1.75z"/></svg>
                <span class="avd-item-text">System Default</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
            </div>
            <!-- Organization Submenu -->
            <div class="avd-submenu" id="avdOrg">
              <button class="avd-back" onclick="showAvdSub('avdMain')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99945 12.9999C9.80945 12.9999 9.61945 12.9299 9.46945 12.7799L5.21945 8.52994C4.92945 8.23994 4.92945 7.75994 5.21945 7.46994L9.46945 3.21994C9.75945 2.92994 10.2395 2.92994 10.5295 3.21994C10.8195 3.50994 10.8195 3.98994 10.5295 4.27994L6.80945 7.99994L10.5295 11.7199C10.8195 12.0099 10.8195 12.4899 10.5295 12.7799C10.3795 12.9299 10.1895 12.9999 9.99945 12.9999Z"/></svg>
                Back
              </button>
              <div class="avd-divider"></div>
              <button class="avd-item active">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11 6C10.4477 6 10 6.44772 10 7H9V14H11V12H12V14H14V7H13C13 6.44772 12.5523 6 12 6H11ZM13 11H12V10H13V11ZM11 11H10V10H11V11ZM13 9H12V8H13V9ZM11 9H10V8H11V9Z"/><path d="M5 2C4.72386 2 4.5 2.22386 4.5 2.5V3H4C3.44772 3 3 3.44772 3 4H2V14H4V12H6V14H8V4H7C7 3.44772 6.55228 3 6 3H5.5V2.5C5.5 2.22386 5.27614 2 5 2ZM7 11H6V10H7V11ZM4 11H3V10H4V11ZM7 9H6V8H7V9ZM4 9H3V8H4V9ZM7 7H6V6H7V7ZM4 7H3V6H4V7ZM6 5H4V4H6V5Z"/></svg>
                <span class="avd-item-text">OPSWAT Inc.</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
            </div>
            <!-- Language Submenu -->
            <div class="avd-submenu" id="avdLang">
              <button class="avd-back" onclick="showAvdSub('avdMain')">
                <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.99945 12.9999C9.80945 12.9999 9.61945 12.9299 9.46945 12.7799L5.21945 8.52994C4.92945 8.23994 4.92945 7.75994 5.21945 7.46994L9.46945 3.21994C9.75945 2.92994 10.2395 2.92994 10.5295 3.21994C10.8195 3.50994 10.8195 3.98994 10.5295 4.27994L6.80945 7.99994L10.5295 11.7199C10.8195 12.0099 10.8195 12.4899 10.5295 12.7799C10.3795 12.9299 10.1895 12.9999 9.99945 12.9999Z"/></svg>
                Back
              </button>
              <div class="avd-divider"></div>
              <button class="avd-item active">
                <svg class="avd-flag" viewBox="0 0 20 16" fill="none"><path d="M20 0H0v16h20V0Z" fill="#F0F0F0"/><path d="M20 3.5H0v1.8h20V3.5ZM20 0H0v1.8h20V0ZM20 7.1H0v1.8h20V7.1ZM20 10.6H0v1.8h20v-1.8ZM20 14.1H0V16h20v-1.9Z" fill="#D80027"/><path d="M10 0H0v8.9h10V0Z" fill="#2E52B2"/><path d="M3.9 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L3.9 3.5ZM4.06 6.27L3.9 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM1.86 6.27L1.7 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM1.7 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L1.7 3.5ZM3.9 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L3.9 1.4ZM1.7 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L1.7 1.4ZM6.1 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L6.1 3.5ZM6.26 6.27L6.1 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM8.47 6.27L8.3 5.68l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52ZM8.3 3.5l-.16.6h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L8.3 3.5ZM6.1 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L6.1 1.4ZM8.3 1.4l-.16.59h-.52l.42.37-.16.59.42-.37.42.37-.16-.59.42-.37h-.52L8.3 1.4Z" fill="#F0F0F0"/></svg>
                <span class="avd-item-text">English</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item">
                <svg class="avd-flag" viewBox="0 0 20 16" fill="none"><path d="M20 0H0v16h20V0Z" fill="#D80027"/><path d="M20 0H0v5.3h20V0Z" fill="#000"/><path d="M20 10.7H0V16h20v-5.3Z" fill="#FFDA44"/></svg>
                <span class="avd-item-text">Deutsch</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
              <button class="avd-item">
                <svg class="avd-flag" viewBox="0 0 20 16" fill="none"><path d="M20 0H0v16h20V0Z" fill="#F0F0F0"/><path d="M10 11.9a3.9 3.9 0 100-7.8 3.9 3.9 0 000 7.8Z" fill="#D80027"/></svg>
                <span class="avd-item-text">&#26085;&#26412;&#35486;</span>
                <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M6.75055 11.7501C6.49055 11.7501 6.24055 11.6501 6.04055 11.4601L3.29055 8.71006C2.90055 8.32006 2.90055 7.69006 3.29055 7.30006C3.68055 6.91006 4.31055 6.91006 4.70055 7.30006L6.74055 9.34006L11.7905 4.29006C12.1805 3.90006 12.8105 3.90006 13.2005 4.29006C13.5905 4.68006 13.5905 5.31006 13.2005 5.70006L7.45055 11.4501C7.25055 11.6501 7.00055 11.7401 6.74055 11.7401L6.75055 11.7501Z"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main -->
    <div class="main">
      <!-- Mobile sidebar overlay -->
      <div class="sidebar-mobile-overlay" onclick="closeMobileSidebar()"></div>
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar" role="complementary" aria-label="Settings navigation">
        <nav class="sidebar-nav" aria-label="Main navigation">
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M7.5 7.5V3.5H14.5C15.05 3.5 15.5 3.9 15.5 4.39V7.5H7.5Z"/><path d="M1.5 12.61V9.5H8.5V13.5H2.36C1.88 13.5 1.5 13.1 1.5 12.61Z"/><path d="M6 5.5C6 4.11929 4.88071 3 3.5 3C2.11929 3 1 4.11929 1 5.5C1 6.88071 2.11929 8 3.5 8C4.88071 8 6 6.88071 6 5.5Z"/><path d="M10.5 9.5H15.5V12.5C15.5 13.05 15.05 13.5 14.5 13.5H10.5V9.5Z"/></svg><span class="nav-text">Dashboard</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5 2V5H2V3C2 2.45 2.45 2 3 2H5Z"/><path d="M5 9.5V6.5H2V9.5H5Z"/><path d="M5 11V14H3C2.45 14 2 13.55 2 13V11H5Z"/><path d="M14 3V5H6.5V2H13C13.55 2 14 2.45 14 3Z"/><path d="M6.5 14V11H14V13C14 13.55 13.55 14 13 14H6.5Z"/><path d="M14 9.5V6.5H6.5V9.5H14Z"/></svg><span class="nav-text">Reports</span></a>
          <div class="nav-divider"></div>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.5 4.05L13.25 3.9L8.5 1.13C8.35 1.04 8.17 1 8 1C7.83 1 7.65 1.04 7.5 1.13L2.75 3.9L2.5 4.05C2.19 4.23 2 4.56 2 4.91V10.77C2 11.12 2.19 11.45 2.5 11.63L7.25 14.4L7.5 14.55C7.65 14.64 7.83 14.68 8 14.68C8.17 14.68 8.35 14.64 8.5 14.55L8.75 14.4L13.5 11.63C13.81 11.45 14 11.12 14 10.77V4.91C14 4.56 13.81 4.23 13.5 4.05ZM12.5 6.09L8.75 8.27V12.66L8 13.1L7.25 12.66V8.27L3.5 6.09V5.2L4.23 4.77L8 6.97L11.77 4.77L12.5 5.2V6.09Z"/></svg><span class="nav-text">Inventory</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 14H14V10H12.75V8C12.75 7.59 12.41 7.25 12 7.25L8.75 7.25V6H10V2L6 2V6H7.25V7.25L4 7.25C3.59 7.25 3.25 7.59 3.25 8L3.25 10H2L2 14H6V10H4.75L4.75 8.75L11.25 8.75V10H10L10 14Z"/></svg><span class="nav-text">Workflows</span></a>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 6V4.75H8.75V11.25H10V10H14V14H10V12.75H8C7.59 12.75 7.25 12.41 7.25 12V8.75H6.25L4 11L1 8L4 5L6.25 7.25H7.25V4C7.25 3.59 7.59 3.25 8 3.25H10V2H14V6H10Z"/></svg><span class="nav-text">Jobs</span></a>
          <div class="nav-divider"></div>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 6C13 7.57 11.8 8.85 10.27 8.98C10.18 9 10.09 9 10 9C10.03 8.97 10.06 8.93 10.08 8.89C10.66 8.07 11 7.08 11 6C11 4.92 10.63 3.83 10 3C11.66 3 13 4.34 13 6Z"/><path d="M15 12.64V14H13V12.64C13 11.71 12.64 10.92 12.05 10.28C13.58 10.69 15 11.51 15 12.64Z"/><path d="M9 6C9 6.89 8.62 7.69 8 8.22C7.47 8.71 6.77 9 6 9C5.23 9 4.53 8.71 4 8.22C3.38 7.69 3 6.89 3 6C3 4.34 4.34 3 6 3C6.77 3 7.47 3.29 8 3.77C8.62 4.31 9 5.11 9 6Z"/><path d="M11 12.64V14H1V12.64C1 11.6 2.2 10.82 3.59 10.38C4.39 10.13 5.26 10 5.99 10C6.6 10 7.3 10.09 7.99 10.27C8.12 10.3 8.26 10.34 8.39 10.38C9.78 10.82 10.98 11.6 10.98 12.64H11Z"/></svg><span class="nav-text">Users</span></a>
          <a class="nav-item active" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.2101 8.46C13.2201 8.31 13.2301 8.16 13.2301 8C13.2301 7.84 13.2201 7.69 13.2101 7.54C13.2001 7.4 13.1801 7.25 13.1601 7.11L14.1201 6.26C14.4801 5.95 14.5601 5.42 14.3301 5.01L13.7501 4.01C13.5101 3.6 13.0201 3.41 12.5701 3.56L11.3301 3.97C11.1001 3.78 10.8601 3.61 10.6001 3.46C10.3301 3.32 10.0601 3.19 9.78005 3.08L9.54005 1.81C9.45005 1.34 9.04005 1 8.56005 1H7.41005C6.93005 1 6.52005 1.34 6.43005 1.81L6.19005 3.08C5.91005 3.19 5.64005 3.32 5.37005 3.46C5.11005 3.61 4.87005 3.78 4.64005 3.97L3.40005 3.56C2.95005 3.41 2.46005 3.6 2.22005 4.01L1.64005 5.01C1.40005 5.42 1.49005 5.95 1.85005 6.26L2.81005 7.11C2.79005 7.25 2.77005 7.4 2.76005 7.54C2.75005 7.69 2.74005 7.84 2.74005 8C2.74005 8.16 2.75005 8.31 2.76005 8.46C2.77005 8.6 2.79005 8.75 2.81005 8.89L1.85005 9.74C1.49005 10.05 1.41005 10.58 1.64005 10.99L2.22005 11.99C2.46005 12.4 2.95005 12.59 3.40005 12.44L4.64005 12.03C4.87005 12.22 5.11005 12.39 5.37005 12.54C5.64005 12.68 5.91005 12.81 6.19005 12.92L6.43005 14.19C6.52005 14.66 6.93005 15 7.41005 15H8.56005C9.04005 15 9.45005 14.66 9.54005 14.19L9.78005 12.92C10.0601 12.81 10.3301 12.68 10.6001 12.54C10.8601 12.39 11.1001 12.22 11.3301 12.03L12.5701 12.44C13.0201 12.59 13.5101 12.4 13.7501 11.99L14.3301 10.99C14.5701 10.58 14.4801 10.05 14.1201 9.74L13.1601 8.89C13.1801 8.75 13.2001 8.6 13.2101 8.46ZM8.57005 10.94C6.45005 11.34 4.64005 9.53 5.04005 7.41C5.26005 6.23 6.22005 5.27 7.40005 5.05C9.52005 4.65 11.3301 6.46 10.9301 8.58C10.7101 9.76 9.75005 10.72 8.57005 10.94Z"/></svg><span class="nav-text">Settings</span></a>
          <div class="nav-divider"></div>
          <a class="nav-item" href="#"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12 2H11.5V5H4.5V2H4C3.45 2 3 2.45 3 3V13C3 13.55 3.45 14 4 14H12C12.55 14 13 13.55 13 13V3C13 2.45 12.55 2 12 2ZM11 11.5H5C4.59 11.5 4.25 11.16 4.25 10.75C4.25 10.34 4.59 10 5 10H11C11.41 10 11.75 10.34 11.75 10.75C11.75 11.16 11.41 11.5 11 11.5ZM11 8.5H5C4.59 8.5 4.25 8.16 4.25 7.75C4.25 7.34 4.59 7 5 7H11C11.41 7 11.75 7.34 11.75 7.75C11.75 8.16 11.41 8.5 11 8.5Z"/><path d="M10 2V3.5H6V2H7C7 1.45 7.45 1 8 1C8.55 1 9 1.45 9 2H10Z"/></svg><span class="nav-text">Audit</span></a>
        </nav>
        <div class="sidebar-footer">
          <svg class="sidebar-footer-brand" viewBox="0 0 114 18" fill="none"><path d="M8.80491 0C6.66754 0 4.76356 0.719826 3.37305 1.90643V4.27473C4.5572 2.9874 6.4882 1.85484 8.83193 1.85484C12.6423 1.85484 15.5782 4.84224 15.5782 8.85902V14.3941C16.8409 13.0551 17.6394 11.1241 17.6394 8.85902C17.6369 3.75882 13.6987 0 8.80491 0Z" fill="#0C121D"/><path d="M2.08578 8.70425V3.16675C0.823009 4.50567 0 6.43667 0 8.70425C0 13.802 3.94062 17.5608 8.832 17.5608C10.9694 17.5608 12.8733 16.841 14.2909 15.6544V13.2861C13.0797 14.5734 11.1241 15.706 8.80743 15.706C4.99702 15.706 2.08578 12.694 2.08578 8.70179V8.70425Z" fill="#0C121D"/><path d="M29.3974 0.282471H23.4226V17.2758H25.4322V2.03413H29.3728C31.6134 2.03413 32.773 3.42465 32.773 5.2279C32.773 7.03115 31.6134 8.39464 29.3728 8.39464H26.695V10.1463H29.3974C32.746 10.1463 34.8293 8.08509 34.8293 5.20333C34.8293 2.32157 32.746 0.282471 29.3974 0.282471Z" fill="#0C121D"/><path d="M49.2259 3.99221L50.695 2.88422C49.6656 1.23574 47.7076 0 45.4425 0C44.7718 0 44.1552 0.103183 43.5876 0.282526V2.18896C44.1552 1.95802 44.8234 1.85484 45.3909 1.85484C46.9362 1.85484 48.3267 2.62626 49.2283 3.99221H49.2259Z" fill="#0C121D"/><path d="M46.9336 8.08506L45.0542 7.18343C43.5089 6.43658 42.3248 5.87153 42.3248 4.06828V0.874512C41.089 1.62136 40.239 2.8571 40.239 4.45399C40.239 6.84931 42.0939 8.03346 44.0765 8.98668L45.9829 9.8883C47.6559 10.6867 48.8155 11.3034 48.8155 13.1337V16.61C50.1028 15.7869 50.9013 14.4996 50.9013 12.8241C50.9013 10.532 49.4346 9.27166 46.9361 8.08751L46.9336 8.08506Z" fill="#0C121D"/><path d="M40.6517 12.7971L39.158 13.9051C40.4699 16.1457 42.7374 17.5607 45.3637 17.5607C46.1621 17.5607 46.882 17.4305 47.5527 17.1996V15.3202C46.882 15.5511 46.1105 15.7059 45.3907 15.7059C43.2018 15.7059 41.6835 14.367 40.6541 12.7971H40.6517Z" fill="#0C121D"/><path d="M54.8174 0.282471L61.2811 17.5608H62.0009L62.7207 15.8091L57.0309 0.282471H54.8174Z" fill="#0C121D"/><path d="M73.6899 11.4582L74.7709 14.1115L79.9227 0.282471H77.7337L73.6899 11.4582Z" fill="#0C121D"/><path d="M67.0223 0L62.4651 11.4067L63.4159 14.0329L67.381 4.09294L72.7638 17.5608H73.5106L74.1027 15.9123L67.7422 0H67.0223Z" fill="#0C121D"/><path d="M86.0548 12.1659L88.7573 5.88401L87.7033 3.3855L81.7285 17.4184H83.8389L85.281 13.9692H92.2335L91.4621 12.1659H86.0548Z" fill="#0C121D"/><path d="M89.0914 0.142578L88.3716 1.76403L95.0662 17.4184H97.2036L89.8407 0.142578H89.0914Z" fill="#0C121D"/><path d="M112.241 0.282471H98.26V2.08572H112.241V0.282471Z" fill="#0C121D"/><path d="M106.242 3.34619H104.232V17.2759H106.242V3.34619Z" fill="#0C121D"/><path d="M112.263 14.9788C111.536 14.9788 110.934 15.5856 110.934 16.3349C110.934 17.0842 111.536 17.6861 112.263 17.6861C112.991 17.6861 113.583 17.0793 113.583 16.3349C113.583 15.5905 112.993 14.9788 112.263 14.9788Z" fill="#0C121D"/></svg>
          <div class="sidebar-footer-tagline">Protecting the World's Critical Infrastructure</div>
        </div>
      </aside>

      <!-- Content Area -->
      <main class="content" id="main-content" role="main">

        <!-- ==================== SETTINGS PAGE ==================== -->
        <div id="settingsPage" class="page-view active">
        <!-- Page Header -->
        <div class="page-header">
          <h1 class="page-title">Settings</h1>
          <button class="btn-export" title="Includes Accounts, Groups, Storage Units, RTP Scans, Workflow Snapshots, Scan Instances, Scan Pools, Workflows, Scan Schedules, SSO Config">Export</button>
        </div>

        <!-- Tabs -->
        <div class="tabs" id="settingsTabs" role="tablist" aria-label="Settings sections">
          <button class="tab active" role="tab" aria-selected="true" aria-controls="panel-profile" data-tab="profile">Profile</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-scan-pools" data-tab="scan-pools">Scan Pools</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-security" data-tab="security">Security</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-smtp" data-tab="smtp">SMTP</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-notifications" data-tab="notifications">Notifications</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-licensing" data-tab="licensing">Licensing</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-sso" data-tab="sso">SSO</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-data" data-tab="data">Data</button>
        </div>

        <!-- ==================== PROFILE TAB ==================== -->
        <div class="tab-panel active" id="panel-profile">

          <!-- Personal Information Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Personal Information</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Warning</div>
                  <div class="banner-desc">Changing email or password requires re-login.</div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Full Name</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="Elvis Vilevich">
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Email</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="email" value="email@email.com">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Password Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Password</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Warning</div>
                  <div class="banner-desc">Changing password requires re-login.</div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">New Password</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="password1234">
                    <span class="input-clear" onclick="clearInput(this)">
                      <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
                    </span>
                    <span class="input-eye" onclick="togglePassword(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Repeat Password</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="password12345">
                    <span class="input-clear" onclick="clearInput(this)">
                      <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
                    </span>
                    <span class="input-eye" onclick="togglePassword(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Configure API Key Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Configure API Key</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row form-row--top">
                <div class="form-label">
                  API Key
                  <span class="help-icon">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
                  </span>
                </div>
                <div class="form-value">
                  <span class="api-key-status" id="apiKeyStatus">Not generated</span>
                  <button class="btn-generate" id="btnGenerateKey" onclick="generateApiKey()">Generate API Key</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== NOTIFICATIONS TAB ==================== -->
        <div class="tab-panel" id="panel-notifications">

          <!-- Email Notifications Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Email Notifications</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Attention</div>
                  <div class="banner-desc">This feature requires the SMTP Server to be configured</div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Generated Report
                  <span class="help-icon">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
                  </span>
                </div>
                <div class="form-value">
                  <div class="radio-group" data-radio-group="generated-report">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Only to the owner</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">To all registered users</span>
                    </label>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">User Registration Requests</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Blocked Files
                  <span class="help-icon">
                    <svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg>
                  </span>
                </div>
                <div class="form-value">
                  <div class="radio-group" data-radio-group="blocked-files">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">To all registered users</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Only to the file owner</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">To the file owner and all registered users</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Webhook Notifications Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Webhook Notifications</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Upon Scan Completion</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Upon File Scan</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                    <div class="radio-inline" style="margin-left: 16px;" data-radio-group="webhook-file-scan">
                      <label class="radio-option selected">
                        <div class="radio-circle"></div>
                        <span class="radio-label">Blocked files</span>
                      </label>
                      <label class="radio-option">
                        <div class="radio-circle"></div>
                        <span class="radio-label">All files</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Destination Address</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="https://webhook.site/748c1c48-f41...">
                    <span class="input-clear" onclick="clearInput(this)">
                      <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
                    </span>
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">Headers</div>
                <div class="form-value">
                  <div class="headers-input-row">
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Enter key" class="header-key-input">
                    </div>
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Value" class="header-value-input">
                    </div>
                    <button class="btn-add-header" onclick="addHeader(this)">Add Header</button>
                  </div>
                  <div class="headers-table">
                    <div class="headers-table-head">
                      <div class="col-key">Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-value">Value <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-actions"></div>
                    </div>
                    <div class="headers-table-body">
                      <div class="headers-table-row">
                        <div class="col-key">Authorization:</div>
                        <div class="col-value">Bearer sk_test_abc123xyz</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                      <div class="headers-table-row">
                        <div class="col-key">X-API-Key:</div>
                        <div class="col-value">your-api-key-here</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Request Type</div>
                <div class="form-value">
                  <div class="radio-inline" data-radio-group="request-type">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">POST</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">PUT</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- RabbitMQ Notifications Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>RabbitMQ Notifications</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Upon a File Scan</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active">
                      <div class="toggle-thumb"></div>
                    </div>
                    <span class="toggle-label">Enabled</span>
                    <div class="radio-inline" style="margin-left: 16px;" data-radio-group="rabbitmq-file-scan">
                      <label class="radio-option selected">
                        <div class="radio-circle"></div>
                        <span class="radio-label">Blocked files</span>
                      </label>
                      <label class="radio-option">
                        <div class="radio-circle"></div>
                        <span class="radio-label">All files</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">RabbitMQ URL</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" placeholder="Enter RabbitMQ URL">
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">Headers</div>
                <div class="form-value">
                  <div class="headers-input-row">
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Enter key" class="header-key-input">
                    </div>
                    <div class="input-field" style="flex: 1;">
                      <input type="text" placeholder="Value" class="header-value-input">
                    </div>
                    <button class="btn-add-header" onclick="addHeader(this)">Add Header</button>
                  </div>
                  <div class="headers-table">
                    <div class="headers-table-head">
                      <div class="col-key">Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-value">Value <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></div>
                      <div class="col-actions"></div>
                    </div>
                    <div class="headers-table-body">
                      <div class="headers-table-row">
                        <div class="col-key">Authorization:</div>
                        <div class="col-value">Bearer sk_test_abc123xyz</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                      <div class="headers-table-row">
                        <div class="col-key">X-API-Key:</div>
                        <div class="col-value">your-api-key-here</div>
                        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== SCAN POOLS TAB ==================== -->
        <div class="tab-panel" id="panel-scan-pools">
          <!-- Promo Banner -->
          <div class="promo-banner">
            <div class="promo-banner-text"><strong>Add a New Scan Pool</strong>&nbsp; Boost overall scan performance by integrating another scan pool</div>
            <button class="btn-primary" onclick="openSlidePanel('addScanPoolPanel')">Add Pool</button>
          </div>

          <!-- Default MetaDefender Cloud Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>Default MetaDefender Cloud Scan Pool</h2>
                <span class="pool-instance-count">1 instance</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>https://api.metadefender.com/v4/</td>
                  <td><span class="av-badge">Metascan 8 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>01:00:00</td>
                  <td><div class="pool-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="pool-action-menu"><button class="pool-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="pool-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Default MetaDefender Core Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>Default MetaDefender Core Scan Pool</h2>
                <span class="pool-instance-count">1 instance</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>https://mdcore.opswat-mdss.net/</td>
                  <td><span class="av-badge">Metascan 8 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>01:00:00</td>
                  <td><div class="pool-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="pool-action-menu"><button class="pool-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="pool-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- My Custom Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>My Custom Scan Pool</h2>
                <span class="pool-instance-count">2 instances</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>https://mdcore.opswat-mdss.net/</td>
                  <td><span class="av-badge">Metascan 8 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>01:00:00</td>
                  <td><div class="pool-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="pool-action-menu"><button class="pool-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="pool-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
                <tr>
                  <td>inventory_update_nov2022</td>
                  <td><span class="av-badge">Metascan 12 Engines</span></td>
                  <td><span class="api-dots">••••••••••</span></td>
                  <td>09:15:00</td>
                  <td><div class="pool-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="pool-action-menu"><button class="pool-action-menu-item" onclick="showToast('Edit instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="pool-action-menu-item danger" onclick="showToast('Delete instance')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Another Scan Pool -->
          <div class="settings-card pool-card">
            <div class="pool-card-header">
              <div class="pool-card-header-left">
                <span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>
                <h2>Another Scan Pool</h2>
                <span class="pool-instance-count">21 instances</span>
              </div>
              <div class="pool-card-header-right">
                <button class="btn-outline" onclick="showToast('Add Instance dialog would open')">Add Instance</button>
              </div>
            </div>
            <table class="pool-table">
              <thead>
                <tr>
                  <th class="col-url">Scan Instance URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-av">AV Package <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-api">API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-timeout">Timeout <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th class="col-actions"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5" style="text-align:center; color:var(--text-muted); padding: 20px;">21 instances configured. Click Add Instance to manage.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ==================== SECURITY TAB ==================== -->
        <div class="tab-panel" id="panel-security">

          <!-- Encryption Key Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Encryption Key</h2>
            </div>
            <div class="card-content">
              <div class="banner">
                <div class="banner-icon">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                </div>
                <div class="banner-content">
                  <div class="banner-title">Warning</div>
                  <div class="banner-desc">Generating a new key is not reversible and will result in logging out of the application from all the profiles.</div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Encryption Key Status
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <span class="encryption-status">Last encryption key generated is older than 90 days (4 months ago)</span>
                  <button class="btn-outline" onclick="showNotification('success', 'Encryption key generated', 'A new encryption key has been generated. All users will be logged out.')" title="This password is required for importing the configuration file. Please store it securely as it cannot be recovered.">Generate New</button>
                </div>
              </div>
            </div>
          </div>

          <!-- SSL Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>SSL</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Service Status
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">SSL Certificate</div>
                <div class="form-value">
                  <div class="file-upload-field" onclick="this.querySelector('input').click()">
                    <input type="file" onchange="handleFileUpload(this)">
                    <span class="file-upload-text">Add file</span>
                    <span class="file-upload-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1v10M4 7l4 4 4-4M2 13h12v2H2z"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">SSL Key</div>
                <div class="form-value">
                  <div class="file-upload-field" onclick="this.querySelector('input').click()">
                    <input type="file" onchange="handleFileUpload(this)">
                    <span class="file-upload-text">Add file</span>
                    <span class="file-upload-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1v10M4 7l4 4 4-4M2 13h12v2H2z"/></svg></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Single User Session Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Single User Session</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Service Status
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== SMTP TAB ==================== -->
        <div class="tab-panel" id="panel-smtp">
          <!-- Configuration Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Configuration</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Service Status</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Active</span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Host
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="smtp.sendgrid.net">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Port
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="587">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Base URL (optional)
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="https://demo.opswat-mdss.net/">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Sender name (optional)
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="John Doe">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">
                  Sender email address (optional)
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="email" value="example@mail.com">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Authentication Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Authentication</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Domain (optional)</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="company.com">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Username (optional)</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="apikey">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-label">Password</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="supersecretpassword123">
                    <span class="input-eye" onclick="togglePassword(this)">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Advanced Settings Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Advanced Settings</h2>
              <div class="card-header-actions"><button class="btn-discard" aria-label="Discard changes">Discard</button><button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button></div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Ignore certificate warnings</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>

              <div class="form-row form-row--top">
                <div class="form-label">
                  Security option
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="radio-group" data-radio-group="security-option">
                    <label class="radio-option selected">
                      <div class="radio-circle"></div>
                      <span class="radio-label">None</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Auto</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Connecting using SSL or TLS immediately</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Elevate the connection using StartTLS command</span>
                    </label>
                    <label class="radio-option">
                      <div class="radio-circle"></div>
                      <span class="radio-label">Elevate the connection using StartTLS command if it is available</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== LICENSING TAB ==================== -->
        <div class="tab-panel" id="panel-licensing">
          <!-- State 1: Empty / No License -->
          <div id="licenseEmptyState">
            <div class="settings-card">
              <div class="card-header">
                <h2>Active License</h2>
              </div>
              <div class="license-empty-state">
                <svg class="license-empty-illustration" viewBox="0 0 120 120" fill="none">
                  <rect x="20" y="30" width="80" height="60" rx="4" fill="#E8ECF0" stroke="#C4CDD5" stroke-width="1.5"/>
                  <rect x="30" y="45" width="40" height="4" rx="2" fill="#C4CDD5"/>
                  <rect x="30" y="55" width="60" height="4" rx="2" fill="#C4CDD5"/>
                  <rect x="30" y="65" width="50" height="4" rx="2" fill="#C4CDD5"/>
                  <rect x="30" y="75" width="30" height="4" rx="2" fill="#C4CDD5"/>
                  <path d="M85 25L95 35L85 35V25Z" fill="#C4CDD5"/>
                  <path d="M65 25H85V35H95V75" stroke="#C4CDD5" stroke-width="1.5" fill="none"/>
                  <circle cx="90" cy="80" r="18" fill="#E8F0FF" stroke="#4A6FA5" stroke-width="1.5"/>
                  <path d="M84 80L88 84L96 76" stroke="#4A6FA5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>
                <div class="license-empty-title">Your do not have a valid license.</div>
                <div class="license-empty-desc">Certain features are currently disabled.<br>Please contact <a href="#" style="color:var(--primary); text-decoration:none;">OPSWAT Sales</a> to get your license.</div>
                <button class="btn-primary" onclick="openModal('addLicenseModal')">Add License</button>
              </div>
            </div>
          </div>

          <!-- State 2: Active License -->
          <div id="licenseActiveState" style="display:none;">
            <div class="settings-card">
              <div class="card-header">
                <h2>Active License</h2>
              </div>
              <div class="card-content">
                <div class="form-row">
                  <div class="form-label">Deployment ID</div>
                  <div class="form-value">
                    <span style="font-size:14px; color:var(--text-subtle); font-family:monospace;">MDSSChuLmMLF4oneXGZP4jz4qx9xH2YDfib14</span>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-label">Product ID</div>
                  <div class="form-value">
                    <span style="font-size:14px; color:var(--text-subtle);">MD-SUPPLY-CHAIN-SA-EVAL</span>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-label">Expiration Date</div>
                  <div class="form-value">
                    <span id="licenseExpBadge" class="license-badge green">Dec 31, 2026</span>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-label">Name</div>
                  <div class="form-value">
                    <span style="font-size:14px; color:var(--text-subtle);">MetaDefender Software Supply Chain - Standalone - Evaluation</span>
                  </div>
                </div>
                <div style="display:flex; gap:8px;">
                  <button class="btn-outline" onclick="deactivateLicense()" title="The current instance will be deactivated">Deactivate</button>
                  <button class="btn-outline" onclick="openModal('addLicenseModal')">Activate New License</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== SSO TAB ==================== -->
        <div class="tab-panel" id="panel-sso">
          <div class="settings-card">
            <div class="card-header">
              <h2>SSO Configuration</h2>
              <div class="card-header-actions">
                <button class="btn-discard" aria-label="Discard changes">Discard</button>
                <button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button>
              </div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">Service Status</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Active</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">SSO Type</div>
                <div class="form-value">
                  <select class="select-field">
                    <option selected>Open ID Connect</option>
                    <option>SAML 2.0</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">SSO Provider</div>
                <div class="form-value">
                  <select class="select-field">
                    <option selected>Okta</option>
                    <option>Azure AD</option>
                    <option>Auth0</option>
                    <option>Custom</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Client ID</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="0oahpipezgAHp3Iez5d7">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Client Secret</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="password" value="supersecretclientsecret123">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                    <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Authority URL</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="https://dev-17591912.okta.com/oa...">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">ReadOnly Role Name</div>
                <div class="form-value">
                  <div class="input-field" style="max-width: 340px;">
                    <input type="text" value="Everyone">
                    <span class="input-clear" onclick="clearInput(this)"><svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ==================== DATA TAB ==================== -->
        <div class="tab-panel" id="panel-data">

          <!-- Telemetry Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Telemetry</h2>
              <div class="card-header-actions">
                <button class="btn-discard" aria-label="Discard changes">Discard</button>
                <button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button>
              </div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Telemetry Data Collection
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Send Telemetry to OPSWAT <span class="help-icon" title="Includes Accounts, Groups, Storage Units, RTP Scans, Workflow Snapshots, Scan Instances, Scan Pools, Workflows, Scan Schedules, SSO Config"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span></div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0" aria-label="Send Telemetry to OPSWAT"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row form-row--top">
                <div class="form-label">Collectors</div>
                <div class="form-value">
                  <table class="data-table" style="border: 1px solid var(--border-card); border-radius: var(--radius); overflow: hidden;">
                    <thead>
                      <tr>
                        <th>Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Metric Endpoint URL <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Metric API Key <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th>Metric Protocol <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                        <th style="width:40px;"></th>
                      </tr>
                    </thead>
                    <tbody id="collectorsTableBody">
                      <tr>
                        <td><span class="av-badge">OPSWAT Collector</span></td>
                        <td>http://&lt;OPTEL_ADDRES...</td>
                        <td>-</td>
                        <td>gRPC</td>
                        <td><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></td>
                      </tr>
                    </tbody>
                  </table>
                  <button class="btn-outline" onclick="openSlidePanel('addCollectorPanel')">Add Collector</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Data Retention Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>Data Retention</h2>
              <div class="card-header-actions">
                <button class="btn-discard" aria-label="Discard changes">Discard</button>
                <button class="btn-save" aria-label="Save changes" aria-disabled="true">Save</button>
              </div>
            </div>
            <div class="card-content">
              <div class="form-row">
                <div class="form-label">
                  Telemetry Data Collection
                  <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
                </div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Clean up audit records older than</div>
                <div class="form-value">
                  <div class="input-with-suffix">
                    <div class="input-field"><input type="number" value="15" style="width:60px;"></div>
                    <span class="input-suffix">days</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Reports retention</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Clean up reports older than</div>
                <div class="form-value">
                  <div class="input-with-suffix">
                    <div class="input-field"><input type="number" value="15" style="width:60px;"></div>
                    <span class="input-suffix">days</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">RTP history retention</div>
                <div class="form-value">
                  <div class="toggle-row">
                    <div class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"><div class="toggle-thumb"></div></div>
                    <span class="toggle-label">Enabled</span>
                  </div>
                </div>
              </div>
              <div class="form-row">
                <div class="form-label">Clean up RTP history older than</div>
                <div class="form-value">
                  <div class="input-with-suffix">
                    <div class="input-field"><input type="number" value="15" style="width:60px;"></div>
                    <span class="input-suffix">days</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- External Loggers Configurations Card -->
          <div class="settings-card">
            <div class="card-header">
              <h2>External Loggers Configurations</h2>
              <button class="btn-outline" onclick="openSlidePanel('addLoggerPanel')" style="display:flex; align-items:center; gap:6px;">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2"><line x1="6" y1="1" x2="6" y2="11"/><line x1="1" y1="6" x2="11" y2="6"/></svg>
                Add Server
              </button>
            </div>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Server Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Status <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Address <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th>Topic <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                  <th style="width:40px;"></th>
                </tr>
              </thead>
              <tbody id="loggersTableBody">
                <tr>
                  <td>Syslog UDP Integration</td>
                  <td><span class="status-dot green"></span>Enabled</td>
                  <td>5.5.5.5:514</td>
                  <td>-</td>
                  <td><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></td>
                </tr>
                <tr>
                  <td>Syslog UDP Integration</td>
                  <td><span class="status-dot red"></span>Disabled</td>
                  <td>5.4.5.5:514</td>
                  <td>-</td>
                  <td><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        </div><!-- /settingsPage -->

        <!-- ==================== AUDIT PAGE ==================== -->
        <div id="auditPage" class="page-view table-page">
          <div class="page-header">
            <h1 class="page-title">Audit</h1>
            <button class="btn-outline" onclick="refreshAuditLog()">Refresh</button>
          </div>

          <div class="audit-card">
            <div class="audit-card-header">
              <div class="audit-card-title">
                <h2>System Events Log</h2>
                <span class="count" id="auditTotalCount">1,256</span>
              </div>
              <div class="audit-card-actions">
                <div class="audit-search">
                  <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="7" cy="7" r="5.5"/><path d="M11 11l3.5 3.5"/></svg>
                  <input type="text" placeholder="Search for Files or Hash" id="auditSearchInput">
                </div>
                <button class="audit-filter-btn" onclick="openAdvancedFilters()" title="Advanced Filters">
                  <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.75 7.15V2H3.25V7.15C2.52 7.45 2 8.16 2 9C2 9.84 2.52 10.55 3.25 10.85V14H4.75V10.85C5.48 10.55 6 9.84 6 9C6 8.16 5.48 7.45 4.75 7.15Z"/><path d="M10 5C10 4.16 9.48 3.45 8.75 3.15V2H7.25V3.15C6.52 3.45 6 4.16 6 5C6 5.84 6.52 6.55 7.25 6.85V14H8.75V6.85C9.48 6.55 10 5.84 10 5Z"/><path d="M14 11C14 10.16 13.48 9.45 12.75 9.15V2H11.25V9.15C10.52 9.45 10 10.16 10 11C10 11.84 10.52 12.55 11.25 12.85V14H12.75V12.85C13.48 12.55 14 11.84 14 11Z"/></svg>
                </button>
              </div>
            </div>

            <div class="audit-table-scroll">
              <table class="audit-table" id="auditTable">
                <thead>
                  <tr>
                    <th class="col-expand"></th>
                    <th class="col-user">User <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-level">Level <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-category">Category <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-type">Type <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-date">Date <span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span></th>
                    <th class="col-details">Details</th>
                    <th class="col-copy"></th>
                  </tr>
                </thead>
                <tbody id="auditTableBody">
                  <!-- Rows generated by JS -->
                </tbody>
              </table>
            </div>

            <div class="audit-pagination">
              <div class="audit-pagination-left">
                <select id="auditPerPage">
                  <option>10</option>
                  <option>25</option>
                  <option selected>50</option>
                  <option>100</option>
                </select>
                <span>items per page</span>
                <span style="margin-left: 8px; color: var(--text-muted);">|</span>
                <span id="auditPageInfo" style="margin-left: 8px;">1-50 of 1,256 items</span>
              </div>
              <div class="audit-pagination-right">
                <button class="audit-page-btn" disabled><svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z"/></svg></button>
                <select class="audit-page-select">
                  <option selected>Page 1</option>
                  <option>Page 2</option>
                  <option>Page 3</option>
                  <option>Page 4</option>
                  <option>Page 5</option>
                  <option>Page 6</option>
                  <option>Page 7</option>
                  <option>Page 8</option>
                  <option>Page 9</option>
                  <option>Page 10</option>
                  <option>Page 11</option>
                  <option>Page 12</option>
                  <option>Page 13</option>
                  <option>Page 14</option>
                  <option>Page 15</option>
                  <option>Page 16</option>
                  <option>Page 17</option>
                  <option>Page 18</option>
                  <option>Page 19</option>
                  <option>Page 20</option>
                  <option>Page 21</option>
                  <option>Page 22</option>
                  <option>Page 23</option>
                  <option>Page 24</option>
                  <option>Page 25</option>
                  <option>Page 26</option>
                </select>
                <button class="audit-page-btn"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.646 1.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L10.293 8 4.646 2.354a.5.5 0 010-.708z"/></svg></button>
              </div>
            </div>
          </div>
        </div><!-- /auditPage -->

        <!-- ==================== COMPONENTS SHOWCASE ==================== -->
        <div id="componentsPage" class="page-view" style="display:none; flex-direction:column; gap:20px; padding:20px;">
          <div style="display:flex; align-items:center; justify-content:space-between;">
            <h1 style="font-size:20px; font-weight:500; color:var(--text-strong);">Design System Components</h1>
            <button class="btn-outline" onclick="toggleDarkMode()">Toggle Dark Mode</button>
          </div>

          <!-- Tags (Status) -->
          <div class="settings-card">
            <div class="card-header"><h2>Tags — Status</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="tag-group">
                <span class="tag tag-neutral">Neutral</span>
                <span class="tag tag-inactive">Inactive</span>
                <span class="tag tag-secure">Secure</span>
                <span class="tag tag-success">Success</span>
                <span class="tag tag-accent">Accent</span>
                <span class="tag tag-guide">Guide</span>
                <span class="tag tag-alert">Alert</span>
                <span class="tag tag-warn">Warn</span>
                <span class="tag tag-caution">Caution</span>
              </div>
            </div>
          </div>

          <!-- Tags (Keyword) -->
          <div class="settings-card">
            <div class="card-header"><h2>Tags — Keyword</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="tag-group">
                <span class="tag-keyword">Neutral</span>
                <span class="tag-keyword">Inactive</span>
                <span class="tag-keyword">Secure</span>
                <span class="tag-keyword">Success</span>
                <span class="tag-keyword">Accent</span>
                <span class="tag-keyword">Guide</span>
                <span class="tag-keyword">Alert</span>
                <span class="tag-keyword">Warn</span>
                <span class="tag-keyword">Caution</span>
              </div>
            </div>
          </div>

          <!-- Scan Status Chips -->
          <div class="settings-card">
            <div class="card-header"><h2>Scan Status Chips</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="tag-group">
                <span class="tag tag-neutral">Allowed</span>
                <span class="tag tag-accent">Blocked</span>
                <span class="tag tag-success">Complete</span>
                <span class="tag tag-alert">Failed</span>
                <span class="tag tag-alert">Skipped</span>
                <span class="tag tag-warn">Pending</span>
              </div>
            </div>
          </div>

          <!-- Badges -->
          <div class="settings-card">
            <div class="card-header"><h2>Badges — Dots</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; align-items:center; gap:12px;">
                <span class="badge-dot badge-dot-neutral"></span>
                <span class="badge-dot badge-dot-inactive"></span>
                <span class="badge-dot badge-dot-secure"></span>
                <span class="badge-dot badge-dot-success"></span>
                <span class="badge-dot badge-dot-accent"></span>
                <span class="badge-dot badge-dot-guide"></span>
                <span class="badge-dot badge-dot-alert"></span>
                <span class="badge-dot badge-dot-warn"></span>
                <span class="badge-dot badge-dot-caution"></span>
              </div>
            </div>
          </div>

          <div class="settings-card">
            <div class="card-header"><h2>Badges — Numbers</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; align-items:center; gap:12px;">
                <span class="badge-number badge-number-neutral">12</span>
                <span class="badge-number badge-number-inactive">12</span>
                <span class="badge-number badge-number-secure">12</span>
                <span class="badge-number badge-number-success">12</span>
                <span class="badge-number badge-number-accent">12</span>
                <span class="badge-number badge-number-guide">12</span>
                <span class="badge-number badge-number-alert">12</span>
                <span class="badge-number badge-number-warn">12</span>
                <span class="badge-number badge-number-caution">12</span>
              </div>
            </div>
          </div>

          <!-- Chips -->
          <div class="settings-card">
            <div class="card-header"><h2>Chips</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center;">
                <span class="chip chip-default">Label</span>
                <span class="chip chip-disabled">Label</span>
                <span class="chip chip-inactive">Label</span>
                <span class="chip chip-secure">Label</span>
                <span class="chip chip-success">Label</span>
                <span class="chip chip-accent">Label</span>
                <span class="chip chip-guide">Label</span>
                <span class="chip chip-alert">Label</span>
                <span class="chip chip-warn">Label</span>
                <span class="chip chip-caution">Label</span>
              </div>
              <div style="display:flex; flex-wrap:wrap; gap:8px; align-items:center;">
                <span class="chip chip-default chip-selected">Label<button class="chip-remove"><svg viewBox="0 0 10 10" fill="currentColor"><path d="M8.5 1.5L1.5 8.5M1.5 1.5l7 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" fill="none"/></svg></button></span>
                <span class="chip chip-accent chip-selected">Label<button class="chip-remove"><svg viewBox="0 0 10 10" fill="currentColor"><path d="M8.5 1.5L1.5 8.5M1.5 1.5l7 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" fill="none"/></svg></button></span>
                <span class="chip chip-alert chip-selected">Label<button class="chip-remove"><svg viewBox="0 0 10 10" fill="currentColor"><path d="M8.5 1.5L1.5 8.5M1.5 1.5l7 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" fill="none"/></svg></button></span>
              </div>
            </div>
          </div>

          <!-- Verdicts -->
          <div class="settings-card">
            <div class="card-header"><h2>Verdicts</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; flex-wrap:wrap; gap:16px; align-items:center;">
                <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Neutral</span></span>
                <span class="verdict verdict-not-active"><span class="verdict-dot"></span><span class="verdict-text">Not Active</span></span>
                <span class="verdict verdict-secure"><span class="verdict-dot"></span><span class="verdict-text">Secure</span></span>
                <span class="verdict verdict-completed"><span class="verdict-dot"></span><span class="verdict-text">Success</span></span>
                <span class="verdict verdict-accent"><span class="verdict-dot"></span><span class="verdict-text">Accent</span></span>
                <span class="verdict verdict-guide"><span class="verdict-dot"></span><span class="verdict-text">Guide</span></span>
                <span class="verdict verdict-detected"><span class="verdict-dot"></span><span class="verdict-text">Alert</span></span>
                <span class="verdict verdict-warn"><span class="verdict-dot"></span><span class="verdict-text">Warn</span></span>
                <span class="verdict verdict-caution"><span class="verdict-dot"></span><span class="verdict-text">Caution</span></span>
              </div>
            </div>
          </div>

          <!-- Scan Verdicts -->
          <div class="settings-card">
            <div class="card-header"><h2>Scan Verdicts</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:12px;">
              <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Not Detected</span></span>
              <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Not Supported</span></span>
              <span class="verdict verdict-neutral"><span class="verdict-dot"></span><span class="verdict-text">Excluded</span></span>
              <span class="verdict verdict-not-active"><span class="verdict-dot"></span><span class="verdict-text">Not Active</span></span>
              <span class="verdict verdict-detected"><span class="verdict-dot"></span><span class="verdict-text">Detected</span></span>
              <span class="verdict verdict-warn"><span class="verdict-dot"></span><span class="verdict-text">5/16 Detected</span></span>
              <span class="verdict verdict-progress"><span class="verdict-dot"></span><span class="verdict-text">In Progress</span></span>
              <span class="verdict verdict-completed"><span class="verdict-dot"></span><span class="verdict-text">Completed</span></span>
              <span class="verdict verdict-failed"><span class="verdict-dot"></span><span class="verdict-text">Failed</span></span>
            </div>
          </div>

          <!-- Severities -->
          <div class="settings-card">
            <div class="card-header"><h2>Severities</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div style="display:flex; flex-direction:column; gap:12px;">
                <span class="severity severity-critical"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Malicious</span>
                <span class="severity severity-critical"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Likely Malicious</span>
                <span class="severity severity-high"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Suspicious</span>
                <span class="severity severity-medium"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Benign</span>
                <span class="severity severity-none"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.2"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>No Threat</span>
              </div>
              <div style="height:1px; background:var(--border-200); margin:4px 0;"></div>
              <div style="display:flex; flex-direction:column; gap:12px;">
                <span class="severity severity-critical"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Critical</span>
                <span class="severity severity-high"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>High</span>
                <span class="severity severity-medium"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Medium</span>
                <span class="severity severity-low"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>Low</span>
                <span class="severity severity-none"><span class="severity-icon"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.2"><path d="M8.58 1.39a.67.67 0 00-1.16 0l-6.5 11.24A.67.67 0 001.5 13.67h13a.67.67 0 00.58-1.04L8.58 1.39z"/></svg></span>None</span>
              </div>
            </div>
          </div>

          <!-- Avatar Dropdown Menu -->
          <div class="settings-card">
            <div class="card-header"><h2>Avatar Dropdown — User Menu</h2></div>
            <div class="card-content" style="display:flex; flex-direction:column; gap:16px;">
              <div class="avd-demo-container">

                <!-- Main Menu Demo -->
                <div class="avd-demo-block">
                  <div style="font-size:12px; font-weight:500; color:var(--text-muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">Main Menu</div>
                  <div class="avatar-dropdown" style="position:static; display:flex;">
                    <!-- User Info -->
                    <div class="avd-user">
                      <div class="avd-avatar">E</div>
                      <div class="avd-user-info">
                        <div class="avd-user-name">Elvijs Vilevics</div>
                        <div class="avd-user-email">elvijs@opswat.com</div>
                      </div>
                    </div>
                    <div class="avd-divider"></div>
                    <!-- Navigation Items -->
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 4H3V3h10v1zm0 4H3V7h10v1zm-3 4H3v-1h7v1z"/></svg>
                      <span class="avd-item-text">Organization</span>
                      <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M6.47 4.22a.75.75 0 011.06 0l3.25 3.25a.75.75 0 010 1.06l-3.25 3.25a.75.75 0 01-1.06-1.06L9.19 8 6.47 5.28a.75.75 0 010-1.06z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 8a3 3 0 100-6 3 3 0 000 6zm0 1c-3.31 0-6 1.79-6 4v1h12v-1c0-2.21-2.69-4-6-4z"/></svg>
                      <span class="avd-item-text">Profile</span>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.21 8.46c.01-.15.02-.3.02-.46s-.01-.31-.02-.46a6.5 6.5 0 00-.05-.43l.96-.85a.58.58 0 00.12-.74l-.58-1a.58.58 0 00-.67-.2l-1.24.41a5.5 5.5 0 00-.73-.51 5.6 5.6 0 00-.82-.38l-.24-1.27A.57.57 0 009.56 2H8.41a.57.57 0 00-.56.43l-.24 1.27c-.28.11-.55.24-.82.38-.26.15-.5.32-.73.51l-1.24-.41a.58.58 0 00-.67.2l-.58 1a.58.58 0 00.12.74l.96.85a5 5 0 00-.05.43c-.01.15-.02.3-.02.46s.01.31.02.46c.01.14.03.29.05.43l-.96.85a.58.58 0 00-.12.74l.58 1c.24.41.73.56 1.18.41l1.24-.41c.23.19.47.36.73.51.27.14.54.27.82.38l.24 1.27c.09.25.48.43.56.43h1.15c.48 0 .89-.34.98-.81l.24-1.27c.28-.11.55-.24.82-.38.26-.15.5-.32.73-.51l1.24.41c.45.15.94-.04 1.18-.45l.58-1a.58.58 0 00-.21-.74l-.96-.85c.02-.14.04-.29.05-.43zM8.57 10.94c-2.12.4-3.93-1.41-3.53-3.53.22-1.18 1.18-2.14 2.36-2.36 2.12-.4 3.93 1.41 3.53 3.53-.22 1.18-1.18 2.14-2.36 2.36z"/></svg>
                      <span class="avd-item-text">Settings</span>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm.75 10.5h-1.5v-1.5h1.5v1.5zm0-3h-1.5V4.5h1.5v4z"/></svg>
                      <span class="avd-item-text">Support</span>
                    </button>
                    <div class="avd-divider"></div>
                    <!-- Preferences -->
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 2a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 2zm0 9.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zm5.5-3.75a.75.75 0 010 1.5h-1.5a.75.75 0 010-1.5h1.5zm-10 0a.75.75 0 010 1.5H2a.75.75 0 010-1.5h1.5zm8.19-3.94a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 01-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-7.38 7.38a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm7.38 0a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 011.06-1.06l1.06 1.06zM4.31 5.37a.75.75 0 01-1.06 0L2.19 4.31a.75.75 0 111.06-1.06l1.06 1.06a.75.75 0 010 1.06zM8 12.25a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V13a.75.75 0 01.75-.75z"/></svg>
                      <span class="avd-item-text">Light Theme</span>
                      <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M6.47 4.22a.75.75 0 011.06 0l3.25 3.25a.75.75 0 010 1.06l-3.25 3.25a.75.75 0 01-1.06-1.06L9.19 8 6.47 5.28a.75.75 0 010-1.06z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.25 1.57a.75.75 0 00-1.5 0V2A6.003 6.003 0 002 8a6.003 6.003 0 004.75 5.87v.56a.75.75 0 001.5 0v-.56A6.003 6.003 0 0014 8a6.003 6.003 0 00-4.75-5.87V1.57zM8 3.5A4.5 4.5 0 003.5 8 4.5 4.5 0 008 12.5 4.5 4.5 0 0012.5 8 4.5 4.5 0 008 3.5z"/></svg>
                      <span class="avd-item-text">English</span>
                      <svg class="avd-chevron" viewBox="0 0 16 16" fill="currentColor"><path d="M6.47 4.22a.75.75 0 011.06 0l3.25 3.25a.75.75 0 010 1.06l-3.25 3.25a.75.75 0 01-1.06-1.06L9.19 8 6.47 5.28a.75.75 0 010-1.06z"/></svg>
                    </button>
                    <div class="avd-divider"></div>
                    <!-- Switch version -->
                    <button class="avd-item avd-item-subtle">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM8 0a8 8 0 100 16A8 8 0 008 0zm.75 4.75a.75.75 0 00-1.5 0v4.5a.75.75 0 001.5 0v-4.5z"/></svg>
                      <span class="avd-item-text">Switch to New Version</span>
                    </button>
                    <div class="avd-divider"></div>
                    <!-- Logout -->
                    <button class="avd-item avd-item-logout">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M2 3a1 1 0 011-1h5.5a.75.75 0 010 1.5H3.5v9h5a.75.75 0 010 1.5H3a1 1 0 01-1-1V3z"/><path d="M11.22 4.72a.75.75 0 011.06 0l2.5 2.5a.75.75 0 010 1.06l-2.5 2.5a.75.75 0 01-1.06-1.06l1.22-1.22H6.75a.75.75 0 010-1.5h5.69l-1.22-1.22a.75.75 0 010-1.06z"/></svg>
                      <span class="avd-item-text">Logout</span>
                    </button>
                  </div>
                </div>

                <!-- Theme Submenu Demo -->
                <div class="avd-demo-block">
                  <div style="font-size:12px; font-weight:500; color:var(--text-muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">Theme Submenu</div>
                  <div class="avatar-dropdown" style="position:static; display:flex;">
                    <button class="avd-back">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.53 11.78a.75.75 0 01-1.06 0L5.22 8.53a.75.75 0 010-1.06l3.25-3.25a.75.75 0 011.06 1.06L6.81 8l2.72 2.72a.75.75 0 010 1.06z"/></svg>
                      Back
                    </button>
                    <button class="avd-item active">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 2a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 2zm0 9.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zm5.5-3.75a.75.75 0 010 1.5h-1.5a.75.75 0 010-1.5h1.5zm-10 0a.75.75 0 010 1.5H2a.75.75 0 010-1.5h1.5zm8.19-3.94a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 01-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-7.38 7.38a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm7.38 0a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 011.06-1.06l1.06 1.06zM4.31 5.37a.75.75 0 01-1.06 0L2.19 4.31a.75.75 0 111.06-1.06l1.06 1.06a.75.75 0 010 1.06zM8 12.25a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V13a.75.75 0 01.75-.75z"/></svg>
                      <span class="avd-item-text">Light Theme</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.54 1a.75.75 0 00-.48 1.31 5.25 5.25 0 01-2.37 9.2.75.75 0 00-.3 1.4A7 7 0 0014.95 7.14a.75.75 0 00-.93-.77A5.23 5.23 0 018.54 1z"/></svg>
                      <span class="avd-item-text">Dark Theme</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 2h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2zm0 1.5a.5.5 0 00-.5.5v4h4.75V3.5H4zm4.75 5H3.5V12a.5.5 0 00.5.5h4.75V8.5zm1.5-5v9.5H12a.5.5 0 00.5-.5V4a.5.5 0 00-.5-.5h-1.75z"/></svg>
                      <span class="avd-item-text">System Default</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.13 1.72a.75.75 0 011.06.06l2 2.25a.75.75 0 01-.06 1.06l-2 1.75a.75.75 0 11-.99-1.13l.72-.63H6a3.25 3.25 0 100 6.5h5.25a.75.75 0 010 1.5H6a4.75 4.75 0 110-9.5h5.88l-.75-.84a.75.75 0 01.06-1.06z"/></svg>
                      <span class="avd-item-text">My Theme</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                  </div>
                </div>

                <!-- Language Submenu Demo -->
                <div class="avd-demo-block">
                  <div style="font-size:12px; font-weight:500; color:var(--text-muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px;">Language Submenu</div>
                  <div class="avatar-dropdown" style="position:static; display:flex;">
                    <button class="avd-back">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M9.53 11.78a.75.75 0 01-1.06 0L5.22 8.53a.75.75 0 010-1.06l3.25-3.25a.75.75 0 011.06 1.06L6.81 8l2.72 2.72a.75.75 0 010 1.06z"/></svg>
                      Back
                    </button>
                    <button class="avd-item active">
                      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.25 1.57a.75.75 0 00-1.5 0V2A6.003 6.003 0 002 8a6.003 6.003 0 004.75 5.87v.56a.75.75 0 001.5 0v-.56A6.003 6.003 0 0014 8a6.003 6.003 0 00-4.75-5.87V1.57zM8 3.5A4.5 4.5 0 003.5 8 4.5 4.5 0 008 12.5 4.5 4.5 0 0012.5 8 4.5 4.5 0 008 3.5z"/></svg>
                      <span class="avd-item-text">English</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">Deutsch</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">Fran&ccedil;ais</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">Espa&ntilde;ol</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                    <button class="avd-item">
                      <span class="avd-item-text">&#26085;&#26412;&#35486;</span>
                      <svg class="avd-check" viewBox="0 0 16 16" fill="currentColor"><path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/></svg>
                    </button>
                  </div>
                </div>

              </div>
            </div>
          </div>

        </div><!-- /componentsPage -->

      </main>
    </div>
  </div>

  <!-- Reusable Notification Toast (top-right) -->
  <div class="top-toast" id="notificationToast" role="alert" aria-live="assertive">
    <div class="top-toast-icon">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm-.5 4v5h1V5h-1zm0 6v1h1v-1h-1z"/></svg>
    </div>
    <div class="top-toast-content">
      <div class="top-toast-title"></div>
      <div class="top-toast-desc"></div>
    </div>
    <div class="top-toast-close" onclick="dismissNotification()">
      <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
    </div>
  </div>

  <!-- Column Dropdown (Sorting / Pinning) -->
  <div class="col-dropdown" id="colDropdown">
    <div class="col-dropdown-section">
      <div class="col-dropdown-section-title">Sorting</div>
    </div>
    <div class="col-dropdown-item" data-action="sort-asc">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3.5a.5.5 0 01.5.5v7.793l2.146-2.147a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 01.708-.708L7.5 11.793V4a.5.5 0 01.5-.5z" transform="rotate(180 8 8)"/></svg>
      Ascending
    </div>
    <div class="col-dropdown-item" data-action="sort-desc">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3.5a.5.5 0 01.5.5v7.793l2.146-2.147a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 01.708-.708L7.5 11.793V4a.5.5 0 01.5-.5z"/></svg>
      Descending
    </div>
    <div class="col-dropdown-divider"></div>
    <div class="col-dropdown-item" data-action="pin">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4.5 2a.5.5 0 01.5.5v2h6v-2a.5.5 0 011 0v2.5a.5.5 0 01-.5.5H8.5v6.5a.5.5 0 01-1 0V5.5H4.5A.5.5 0 014 5V2.5a.5.5 0 01.5-.5z"/></svg>
      Pin Column
    </div>
  </div>

  <!-- Toast (bottom-right snackbar) -->
  <div class="toast" id="toast"></div>

  <!-- ==================== ACTIVATE NEW LICENSE MODAL ==================== -->
  <div class="modal-overlay" id="addLicenseModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-labelledby="addLicenseModalTitle" aria-modal="true">
      <div class="modal-header">
        <h2 id="addLicenseModalTitle">Activate License</h2>
        <button class="modal-close" aria-label="Close dialog" onclick="closeModal('addLicenseModal')">
          <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
        </button>
      </div>
      <div class="radio-group" data-radio-group="license-activation-type">
        <label class="radio-option selected" onclick="showLicenseMode('online')">
          <div class="radio-circle"></div>
          <span class="radio-label">Online Activation</span>
        </label>
        <label class="radio-option" onclick="showLicenseMode('offline')">
          <div class="radio-circle"></div>
          <span class="radio-label">Offline Activation</span>
        </label>
      </div>
      <div class="modal-divider"></div>

      <!-- Online Activation Mode -->
      <div class="modal-body" id="licenseOnlineMode">
        <div class="modal-field">
          <label class="modal-field-label" for="licenseKeyInput">License Key</label>
          <div class="input-field" style="max-width:none;">
            <input type="password" id="licenseKeyInput" value="" placeholder="Enter your license key" style="flex:1;" onfocus="prefillLicenseKey(this)">
            <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
          </div>
        </div>
      </div>

      <!-- Offline Activation Mode -->
      <div class="modal-body" id="licenseOfflineMode" style="display:none;">
        <div class="modal-instructions">
          <strong>Copy down your Deployment ID</strong><br><br>
          Go to <a href="#">my.opswat.com</a><br><br>
          Activate and download your license file<br>
          You will need your activation key and the Deployment ID<br><br>
          Upload the license file below
        </div>
        <div class="modal-field">
          <label class="modal-field-label">Deployment ID</label>
          <div class="input-field" style="max-width:none;">
            <input type="text" value="MDSShV4GCrt5ByrTC2V6pD0B8Ea0yBa6WCv3" readonly style="flex:1; color:var(--text-subtle);">
            <button class="copy-btn" aria-label="Copy Deployment ID" onclick="navigator.clipboard?.writeText(this.previousElementSibling.value); showNotification('success', 'Description copied')">
              <svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg>
            </button>
          </div>
        </div>
        <div class="modal-field">
          <label class="modal-field-label">License Key File</label>
          <div class="file-upload-field" onclick="this.querySelector('input').click()" tabindex="0" role="button">
            <input type="file" onchange="handleFileUpload(this)">
            <span class="file-upload-text">Select file</span>
            <span class="file-upload-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1v10M4 7l4 4 4-4M2 13h12v2H2z"/></svg></span>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-outline" onclick="closeModal('addLicenseModal')">Cancel</button>
        <button class="btn-primary" onclick="activateLicense()">Activate</button>
      </div>
    </div>
  </div>

  <!-- ==================== ADVANCED FILTERS DRAWER ==================== -->
  <div class="advanced-filters-overlay" id="advancedFiltersOverlay"></div>
  <div class="advanced-filters-panel" id="advancedFiltersPanel">
    <div class="af-header">
      <h3>Advanced Filters</h3>
      <button class="af-close" onclick="closeAdvancedFilters()"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M11.7647 3.16797C12.0591 2.92776 12.4939 2.94534 12.7686 3.21973C13.043 3.49412 13.0601 3.92806 12.8203 4.22266L12.7686 4.28028L9.06153 7.98926L12.7725 11.6963L12.8242 11.7529C13.0644 12.0474 13.0469 12.4822 12.7725 12.7568C12.4797 13.0496 12.0049 13.0495 11.7119 12.7568L8.00196 9.04981L4.2959 12.7607L4.23926 12.8125C3.9448 13.0527 3.51 13.0351 3.23536 12.7607C2.94258 12.468 2.94268 11.9931 3.23536 11.7002L6.94141 7.99024L3.23145 4.28418L3.17969 4.22754C2.93948 3.93308 2.95706 3.49828 3.23145 3.22364C3.50584 2.94924 3.93978 2.93206 4.23438 3.17188L4.292 3.22364L8.00098 6.92969L11.708 3.21973L11.7647 3.16797Z"/></svg></button>
    </div>
    <div class="af-body">
      <div class="af-field">
        <span class="af-field-label">Category</span>
        <select id="afCategory">
          <option selected>All Categories</option>
          <option>Scan Activity</option>
          <option>Settings</option>
          <option>Authentication</option>
        </select>
      </div>
      <div class="af-field">
        <span class="af-field-label">Level</span>
        <select id="afLevel">
          <option selected>All Levels</option>
          <option>Warning</option>
          <option>Error</option>
          <option>Info</option>
        </select>
      </div>
      <div class="af-field">
        <span class="af-field-label">Time Format</span>
        <select id="afTimeFormat">
          <option selected>Local</option>
          <option>UTC</option>
        </select>
      </div>
    </div>
    <div class="af-footer">
      <span class="af-footer-info">134,785 files meet the filter criteria.</span>
      <div class="af-footer-actions">
        <button class="btn-outline" onclick="closeAdvancedFilters()">Revert</button>
        <button class="btn-primary" onclick="applyAdvancedFilters()">Apply</button>
      </div>
    </div>
  </div>

  <!-- ==================== UNSAVED CHANGES MODAL ==================== -->
  <div class="modal-overlay" id="unsavedModal" aria-hidden="true">
    <div class="modal" role="alertdialog" aria-labelledby="unsavedModalTitle" aria-describedby="unsavedModalDesc" aria-modal="true" style="width:420px;">
      <div class="modal-header">
        <h2 id="unsavedModalTitle">Unsaved Changes</h2>
        <button class="modal-close" aria-label="Close dialog" onclick="closeModal('unsavedModal')">
          <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
        </button>
      </div>
      <p id="unsavedModalDesc" style="font-size:14px; color:var(--text-subtle); line-height:1.5; margin-bottom:20px;">
        You have unsaved changes on the page you are about to leave. Are you sure you want to continue?
      </p>
      <div class="modal-footer" style="border-top:none; padding-top:0; margin-top:0;">
        <button class="btn-outline" onclick="closeModal('unsavedModal')">Stay on Page</button>
        <button class="btn-primary" onclick="closeModal('unsavedModal'); showToast('Changes discarded')">Leave Anyway</button>
      </div>
    </div>
  </div>

  <!-- ==================== ADD COLLECTOR SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addCollectorOverlay" onclick="closeSlidePanel('addCollectorPanel')"></div>
  <div class="slide-panel" id="addCollectorPanel" role="dialog" aria-labelledby="addCollectorTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addCollectorTitle">Add Collector</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addCollectorPanel')">
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <label class="panel-field-label" for="collectorName">Collector Name</label>
        <div class="input-field"><input type="text" id="collectorName" placeholder="Enter name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="collectorEndpoint">Metric Endpoint URL</label>
        <div class="input-field"><input type="text" id="collectorEndpoint" placeholder="Enter URL"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="collectorApiKey">Metric API Key</label>
        <div class="input-field">
          <input type="password" id="collectorApiKey" placeholder="Enter API Key">
          <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
        </div>
      </div>
      <div class="panel-field">
        <span class="panel-field-label">Metric Protocol</span>
        <div class="radio-group" data-radio-group="collector-protocol">
          <label class="radio-option selected">
            <div class="radio-circle"></div>
            <span class="radio-label">gRPC</span>
          </label>
          <label class="radio-option">
            <div class="radio-circle"></div>
            <span class="radio-label">HTTP/Protobuf</span>
          </label>
          <label class="radio-option">
            <div class="radio-circle"></div>
            <span class="radio-label">HTTP / JSON</span>
          </label>
        </div>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addCollectorPanel')">Cancel</button>
      <button class="btn-primary" onclick="addCollectorRow()">Add Collector</button>
    </div>
  </div>

  <!-- ==================== ADD EXTERNAL LOGGER SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addLoggerOverlay" onclick="closeSlidePanel('addLoggerPanel')"></div>
  <div class="slide-panel" id="addLoggerPanel" role="dialog" aria-labelledby="addLoggerTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addLoggerTitle">Add External Logger</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addLoggerPanel')">
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <div style="display:flex; align-items:center; gap:12px;">
          <span class="panel-field-label" style="margin:0;">Status</span>
          <span class="help-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M14.46 5.32L14.35 5.08C13.2 2.6 10.68 1 7.97 1C4.09 1 1 4.1 1 8.03C1 10.76 2.59 13.28 5.12 14.34L5.37 14.44L5.4 14.46C7.98 15.56 10.97 14.96 12.96 12.95L13.14 12.76C14.99 10.75 15.52 7.85 14.46 5.32ZM8 12.25C7.59 12.25 7.25 11.91 7.25 11.5C7.25 11.09 7.59 10.75 8 10.75C8.41 10.75 8.75 11.09 8.75 11.5C8.75 11.91 8.41 12.25 8 12.25ZM8.74 9.4C8.67 9.74 8.36 10 8 10C7.59 10 7.25 9.66 7.25 9.25V8.75C7.25 8.34 7.59 8 8 8C8.69 8 9.25 7.44 9.25 6.75C9.25 6.06 8.69 5.5 8 5.5C7.31 5.5 6.75 6.06 6.75 6.75C6.75 7.16 6.41 7.5 6 7.5C5.59 7.5 5.25 7.16 5.25 6.75C5.25 5.23 6.48 4 8 4C9.52 4 10.75 5.23 10.75 6.75C10.75 8.01 9.9 9.08 8.74 9.4Z"/></svg></span>
          <div class="toggle-switch" role="switch" aria-checked="false" tabindex="0" aria-label="Logger status"><div class="toggle-thumb"></div></div>
          <span class="toggle-label">Enabled</span>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerType">Integration Type</label>
        <select class="select-field" id="loggerType" style="max-width:none;">
          <option selected>Syslog UDP Integration</option>
          <option>Syslog TCP Integration</option>
          <option>Syslog TLS Integration</option>
        </select>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerAddress">Server Address</label>
        <div class="input-field"><input type="text" id="loggerAddress" value="5.5.5.5"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerPort">Server Point</label>
        <div class="input-field"><input type="text" id="loggerPort" placeholder="Enter API Key"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerFacility">Facility</label>
        <select class="select-field" id="loggerFacility" style="max-width:none;">
          <option selected>User Level Messages</option>
          <option>Local0</option>
          <option>Local1</option>
          <option>Local2</option>
        </select>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="loggerFormat">Output Format</label>
        <select class="select-field" id="loggerFormat" style="max-width:none;">
          <option selected>RFC5424</option>
          <option>RFC3164</option>
          <option>JSON</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addLoggerPanel')">Discard</button>
      <button class="btn-primary" onclick="addLoggerRow()">Add Instance</button>
    </div>
  </div>

  <!-- ==================== ADD SCAN POOL SLIDE-OUT PANEL ==================== -->
  <div class="slide-panel-overlay" id="addScanPoolOverlay" onclick="closeSlidePanel('addScanPoolPanel')"></div>
  <div class="slide-panel" id="addScanPoolPanel" role="dialog" aria-labelledby="addScanPoolTitle" aria-modal="true">
    <div class="slide-panel-header">
      <h2 id="addScanPoolTitle">Add Scan Pool</h2>
      <button class="modal-close" aria-label="Close panel" onclick="closeSlidePanel('addScanPoolPanel')">
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"><line x1="2" y1="2" x2="12" y2="12"/><line x1="12" y1="2" x2="2" y2="12"/></svg>
      </button>
    </div>
    <div class="slide-panel-body">
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolName">Name</label>
        <div class="input-field"><input type="text" id="scanPoolName" placeholder="Enter pool name"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolType">Type</label>
        <select class="select-field" id="scanPoolType" style="max-width:none;">
          <option selected>MetaDefender Core</option>
          <option>MetaDefender Cloud</option>
        </select>
      </div>
      <hr style="border:none; border-top:1px solid var(--border-200); margin:0;">
      <div class="panel-field">
        <label class="panel-field-label" style="display:flex; align-items:baseline; gap:6px;">Add Scan Instance <span style="font-weight:400; color:var(--text-muted); font-size:14px;">(optional)</span></label>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolUrl">URL</label>
        <div class="input-field"><input type="text" id="scanPoolUrl" placeholder="Enter instance URL"></div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolApiKey">API Key (optional)</label>
        <div class="input-field">
          <input type="password" id="scanPoolApiKey" placeholder="Enter API Key">
          <span class="input-eye" onclick="togglePassword(this)"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg></span>
        </div>
      </div>
      <div class="panel-field">
        <label class="panel-field-label" for="scanPoolTimeout">Timeout</label>
        <select class="select-field" id="scanPoolTimeout" style="max-width:none;">
          <option selected>01:00:00</option>
          <option>00:30:00</option>
          <option>02:00:00</option>
          <option>04:00:00</option>
        </select>
      </div>
    </div>
    <div class="slide-panel-footer">
      <button class="btn-outline" onclick="closeSlidePanel('addScanPoolPanel')">Cancel</button>
      <button class="btn-primary" onclick="addScanPool()">Add Scan Pool</button>
    </div>
  </div>

  <script>
    // ===============================================================
    // DIRTY STATE TRACKING — detects changes within each settings card
    // and activates Save/Discard buttons accordingly
    // ===============================================================

    function captureCardState(card) {
      const state = {};
      // Text / email / password / number inputs
      card.querySelectorAll('input[type="text"], input[type="email"], input[type="password"], input[type="number"]').forEach((input, i) => {
        state['input_' + i] = input.value;
      });
      // Select dropdowns
      card.querySelectorAll('select').forEach((sel, i) => {
        state['select_' + i] = sel.value;
      });
      // Toggle switches
      card.querySelectorAll('.toggle-switch').forEach((toggle, i) => {
        state['toggle_' + i] = toggle.classList.contains('active');
      });
      // Radio groups
      card.querySelectorAll('.radio-group, .radio-inline, [data-radio-group]').forEach((group, i) => {
        const sel = group.querySelector('.radio-option.selected');
        state['radio_' + i] = sel ? sel.querySelector('.radio-label').textContent : '';
      });
      // File uploads
      card.querySelectorAll('.file-upload-text').forEach((ft, i) => {
        state['file_' + i] = ft.textContent;
      });
      // Header table row counts (webhook / RabbitMQ)
      card.querySelectorAll('.headers-table-body').forEach((tbody, i) => {
        state['headerRows_' + i] = tbody.querySelectorAll('.headers-table-row').length;
      });
      return state;
    }

    function checkDirty(card) {
      if (!card._initialState) return;
      const current = captureCardState(card);
      const isDirty = JSON.stringify(current) !== JSON.stringify(card._initialState);
      card.classList.toggle('dirty', isDirty);
      const saveBtn = card.querySelector('.btn-save');
      if (saveBtn) saveBtn.setAttribute('aria-disabled', isDirty ? 'false' : 'true');
    }

    function restoreCardState(card) {
      if (!card._initialState) return;
      const s = card._initialState;
      // Restore inputs
      card.querySelectorAll('input[type="text"], input[type="email"], input[type="password"], input[type="number"]').forEach((input, i) => {
        if (s['input_' + i] !== undefined) input.value = s['input_' + i];
      });
      // Restore selects
      card.querySelectorAll('select').forEach((sel, i) => {
        if (s['select_' + i] !== undefined) sel.value = s['select_' + i];
      });
      // Restore toggles
      card.querySelectorAll('.toggle-switch').forEach((toggle, i) => {
        const wasActive = s['toggle_' + i];
        toggle.classList.toggle('active', wasActive);
        toggle.setAttribute('aria-checked', String(wasActive));
        const label = toggle.parentElement.querySelector('.toggle-label');
        if (label) {
          if (label.textContent === 'Active' || label.textContent === 'Inactive') {
            label.textContent = wasActive ? 'Active' : 'Inactive';
          } else {
            label.textContent = wasActive ? 'Enabled' : 'Disabled';
          }
        }
      });
      // Restore radios (including ARIA state)
      card.querySelectorAll('.radio-group, .radio-inline, [data-radio-group]').forEach((group, i) => {
        const target = s['radio_' + i];
        group.querySelectorAll('.radio-option').forEach(opt => {
          const lbl = opt.querySelector('.radio-label');
          const isMatch = lbl && lbl.textContent === target;
          opt.classList.toggle('selected', isMatch);
          opt.setAttribute('aria-checked', String(isMatch));
          opt.setAttribute('tabindex', isMatch ? '0' : '-1');
        });
      });
      // Restore file upload labels
      card.querySelectorAll('.file-upload-text').forEach((ft, i) => {
        if (s['file_' + i] !== undefined) {
          ft.textContent = s['file_' + i];
          ft.classList.toggle('has-file', ft.textContent !== 'Add file');
        }
      });
      // Clear dirty state
      card.classList.remove('dirty');
      const saveBtn = card.querySelector('.btn-save');
      if (saveBtn) saveBtn.setAttribute('aria-disabled', 'true');
    }

    function initDirtyTracking() {
      document.querySelectorAll('.settings-card').forEach(card => {
        if (!card.querySelector('.btn-save')) return;
        card._initialState = captureCardState(card);
        card.addEventListener('input', () => checkDirty(card));
        card.addEventListener('change', () => checkDirty(card));
      });
    }

    // ===============================================================
    // TAB SWITCHING — with full ARIA state management
    // ===============================================================

    const tablist = document.getElementById('settingsTabs');
    const tabs = Array.from(tablist.querySelectorAll('.tab'));

    function switchTab(tab) {
      tabs.forEach(t => {
        t.classList.remove('active');
        t.setAttribute('aria-selected', 'false');
        t.setAttribute('tabindex', '-1');
      });
      tab.classList.add('active');
      tab.setAttribute('aria-selected', 'true');
      tab.setAttribute('tabindex', '0');

      document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
      const panelId = 'panel-' + tab.dataset.tab;
      const panel = document.getElementById(panelId);
      if (panel) {
        panel.classList.add('active');
        panel.setAttribute('tabindex', '-1');
      }

      // Dismiss any open notification when switching tabs
      dismissNotification();
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => switchTabWithDirtyCheck(tab));
    });

    // Arrow key navigation for tablist (WCAG 2.4.11 / keyboard pattern)
    tablist.addEventListener('keydown', (e) => {
      const currentIndex = tabs.indexOf(document.activeElement);
      if (currentIndex === -1) return;
      let newIndex;
      if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
        e.preventDefault();
        newIndex = (currentIndex + 1) % tabs.length;
      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
        e.preventDefault();
        newIndex = (currentIndex - 1 + tabs.length) % tabs.length;
      } else if (e.key === 'Home') {
        e.preventDefault();
        newIndex = 0;
      } else if (e.key === 'End') {
        e.preventDefault();
        newIndex = tabs.length - 1;
      } else {
        return;
      }
      tabs[newIndex].focus();
      switchTabWithDirtyCheck(tabs[newIndex]);
    });

    // Initialise roving tabindex
    tabs.forEach(tab => {
      tab.setAttribute('tabindex', tab.classList.contains('active') ? '0' : '-1');
    });

    // ===============================================================
    // TOGGLE SWITCHES & RADIO BUTTONS — event delegation
    // ===============================================================

    document.addEventListener('click', (e) => {
      // --- Toggle switches ---
      const toggle = e.target.closest('.toggle-switch');
      if (toggle) {
        toggle.classList.toggle('active');
        const isActive = toggle.classList.contains('active');
        toggle.setAttribute('aria-checked', String(isActive));
        const label = toggle.parentElement.querySelector('.toggle-label');
        if (label) {
          if (label.textContent === 'Active' || label.textContent === 'Inactive') {
            label.textContent = isActive ? 'Active' : 'Inactive';
          } else {
            label.textContent = isActive ? 'Enabled' : 'Disabled';
          }
        }
        const card = toggle.closest('.settings-card');
        if (card) checkDirty(card);
      }

      // --- Radio buttons ---
      const radio = e.target.closest('.radio-option');
      if (radio) {
        const group = radio.closest('.radio-group, .radio-inline, [data-radio-group]');
        if (group) {
          group.querySelectorAll('.radio-option').forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-checked', 'false');
            o.setAttribute('tabindex', '-1');
          });
          radio.classList.add('selected');
          radio.setAttribute('aria-checked', 'true');
          radio.setAttribute('tabindex', '0');
        }
        const card = radio.closest('.settings-card');
        if (card) checkDirty(card);
      }

      // --- Discard button ---
      if (e.target.closest('.btn-discard')) {
        const card = e.target.closest('.settings-card');
        if (card) restoreCardState(card);
      }

      // --- Save button ---
      if (e.target.closest('.btn-save')) {
        const card = e.target.closest('.settings-card');
        if (card && card.classList.contains('dirty')) {
          card._initialState = captureCardState(card);
          card.classList.remove('dirty');
          const saveBtn = card.querySelector('.btn-save');
          if (saveBtn) saveBtn.setAttribute('aria-disabled', 'true');
          showToast('Settings saved');
        }
      }
    });

    // ===============================================================
    // KEYBOARD: comprehensive handler (WCAG 2.1.1 / 2.1.2 / 2.4.13)
    // ===============================================================

    document.addEventListener('keydown', (e) => {

      // --- Toggle switches: Enter / Space ---
      const toggle = e.target.closest('.toggle-switch');
      if (toggle && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        toggle.click();
        return;
      }

      // --- Radio groups: Arrow key navigation (roving tabindex) ---
      const radioOption = e.target.closest('.radio-option');
      if (radioOption) {
        const group = radioOption.closest('.radio-group, .radio-inline, [data-radio-group]');
        if (!group) return;
        const options = Array.from(group.querySelectorAll('.radio-option'));
        const idx = options.indexOf(radioOption);
        if (idx === -1) return;

        let newIdx;
        if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
          e.preventDefault();
          newIdx = (idx + 1) % options.length;
        } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
          e.preventDefault();
          newIdx = (idx - 1 + options.length) % options.length;
        } else if (e.key === ' ' || e.key === 'Enter') {
          e.preventDefault();
          // Select this option
          options.forEach(o => {
            o.classList.remove('selected');
            o.setAttribute('aria-checked', 'false');
            o.setAttribute('tabindex', '-1');
          });
          radioOption.classList.add('selected');
          radioOption.setAttribute('aria-checked', 'true');
          radioOption.setAttribute('tabindex', '0');
          const card = group.closest('.settings-card');
          if (card) checkDirty(card);
          return;
        } else {
          return;
        }

        // Move focus and selection
        options.forEach(o => {
          o.classList.remove('selected');
          o.setAttribute('aria-checked', 'false');
          o.setAttribute('tabindex', '-1');
        });
        options[newIdx].classList.add('selected');
        options[newIdx].setAttribute('aria-checked', 'true');
        options[newIdx].setAttribute('tabindex', '0');
        options[newIdx].focus();
        const card = group.closest('.settings-card');
        if (card) checkDirty(card);
        return;
      }

      // --- File upload fields: Enter / Space ---
      const fileField = e.target.closest('.file-upload-field');
      if (fileField && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        const fileInput = fileField.querySelector('input[type="file"]');
        if (fileInput) fileInput.click();
        return;
      }

      // --- Edit icons: Enter / Space ---
      const editIcon = e.target.closest('.edit-icon');
      if (editIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        editIcon.click();
        return;
      }

      // --- Clear input icons: Enter / Space ---
      const clearIcon = e.target.closest('.input-clear');
      if (clearIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        clearInput(clearIcon);
        return;
      }

      // --- Password eye icons: Enter / Space ---
      const eyeIcon = e.target.closest('.input-eye');
      if (eyeIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        togglePassword(eyeIcon);
        return;
      }

      // --- Toast close: Enter / Space ---
      const toastClose = e.target.closest('.top-toast-close');
      if (toastClose && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        dismissNotification();
        return;
      }

      // --- Pool icon SVGs: Enter / Space ---
      const poolIcon = e.target.closest('.pool-icons svg');
      if (poolIcon && (e.key === 'Enter' || e.key === ' ')) {
        e.preventDefault();
        poolIcon.click();
        return;
      }

      // --- Escape key: dismiss notification toast if visible ---
      if (e.key === 'Escape') {
        const nToast = document.getElementById('notificationToast');
        if (nToast && nToast.classList.contains('visible')) {
          dismissNotification();
          return;
        }
      }
    });

    // ===============================================================
    // UTILITY FUNCTIONS
    // ===============================================================

    function clearInput(el) {
      const field = el.closest('.input-field');
      const input = field.querySelector('input');
      if (input) {
        input.value = '';
        input.focus();
        const card = field.closest('.settings-card');
        if (card) checkDirty(card);
      }
    }

    function togglePassword(el) {
      const input = el.closest('.input-field').querySelector('input');
      if (!input) return;
      if (input.type === 'password') {
        input.type = 'text';
        el.innerHTML = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/><line x1="2" y1="14" x2="14" y2="2" stroke="currentColor" stroke-width="1.5"/></svg>';
      } else {
        input.type = 'password';
        el.innerHTML = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3C4.364 3 1.258 5.073 0 8c1.258 2.927 4.364 5 8 5s6.742-2.073 8-5c-1.258-2.927-4.364-5-8-5zm0 8.333A3.335 3.335 0 014.667 8 3.335 3.335 0 018 4.667 3.335 3.335 0 0111.333 8 3.335 3.335 0 018 11.333zM8 6a2 2 0 100 4 2 2 0 000-4z"/></svg>';
      }
    }

    function addHeader(btn) {
      const row = btn.closest('.headers-input-row');
      const keyInput = row.querySelector('.header-key-input');
      const valueInput = row.querySelector('.header-value-input');
      const key = keyInput.value.trim();
      const value = valueInput.value.trim();

      if (!key || !value) {
        showToast('Please enter both key and value');
        return;
      }

      const tableBody = row.closest('.form-value').querySelector('.headers-table-body');
      const newRow = document.createElement('div');
      newRow.className = 'headers-table-row';
      newRow.innerHTML = `
        <div class="col-key">${escapeHtml(key)}</div>
        <div class="col-value">${escapeHtml(value)}</div>
        <div class="col-actions"><span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span></div>
      `;
      tableBody.appendChild(newRow);

      keyInput.value = '';
      valueInput.value = '';
      keyInput.focus();
      showToast('Header added');
      const card = btn.closest('.settings-card');
      if (card) checkDirty(card);
    }

    function generateApiKey() {
      const chars = 'abcdef0123456789';
      let key = 'sk_';
      for (let i = 0; i < 32; i++) key += chars[Math.floor(Math.random() * chars.length)];

      const status = document.getElementById('apiKeyStatus');
      status.textContent = key;
      status.style.color = 'var(--text-strong)';
      status.style.fontFamily = 'monospace';

      const btn = document.getElementById('btnGenerateKey');
      btn.textContent = 'Regenerate API Key';

      showNotification('success', 'API key generated', 'Your new API key has been created. Save to apply changes.');

      // Manually mark the card dirty (API key status is not a standard input)
      const card = status.closest('.settings-card');
      if (card) {
        card.classList.add('dirty');
        const saveBtn = card.querySelector('.btn-save');
        if (saveBtn) saveBtn.setAttribute('aria-disabled', 'false');
      }
    }

    // ===============================================================
    // TOAST (bottom snackbar)
    // ===============================================================

    function showToast(msg) {
      showNotification('info', msg);
    }

    // ===============================================================
    // NOTIFICATION (top-right reusable toast — info/success/warning/error)
    // ===============================================================

    const notificationIcons = {
      info:    '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm-.5 4v5h1V5h-1zm0 6v1h1v-1h-1z"/></svg>',
      success: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm3.354 4.646a.5.5 0 010 .708l-4 4a.5.5 0 01-.708 0l-2-2a.5.5 0 01.708-.708L7 9.293l3.646-3.647a.5.5 0 01.708 0z"/></svg>',
      warning: '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 00-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 01-1.1 0L7.1 5.995A.905.905 0 018 5zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></svg>',
      error:   '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 110 14A7 7 0 018 1zm0 3a.75.75 0 00-.75.75v4.5a.75.75 0 001.5 0v-4.5A.75.75 0 008 4zm0 8a1 1 0 100-2 1 1 0 000 2z"/></svg>'
    };

    function showNotification(type, title, desc) {
      const toast = document.getElementById('notificationToast');
      if (!toast) return;

      // Clear auto-dismiss timer
      clearTimeout(toast._timer);

      // Remove previous type classes
      toast.classList.remove('type-info', 'type-success', 'type-warning', 'type-error', 'visible');

      // Set type
      const validType = ['info', 'success', 'warning', 'error'].includes(type) ? type : 'info';
      toast.classList.add('type-' + validType);

      // Set icon
      const iconEl = toast.querySelector('.top-toast-icon');
      if (iconEl) iconEl.innerHTML = notificationIcons[validType];

      // Set content
      const titleEl = toast.querySelector('.top-toast-title');
      const descEl = toast.querySelector('.top-toast-desc');
      if (titleEl) titleEl.textContent = title || '';
      if (descEl) {
        descEl.textContent = desc || '';
        descEl.style.display = desc ? '' : 'none';
      }

      // Show with animation (force reflow for screen reader re-announcement)
      requestAnimationFrame(() => {
        toast.classList.add('visible');
      });

      // Auto-dismiss after 5 seconds
      toast._timer = setTimeout(() => dismissNotification(), 5000);
    }

    function dismissNotification() {
      const toast = document.getElementById('notificationToast');
      if (!toast) return;
      toast.classList.remove('visible');
      clearTimeout(toast._timer);
    }

    // ===============================================================
    // SIDEBAR TOGGLE
    // ===============================================================

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const app = document.querySelector('.app');
      const isMobile = window.innerWidth <= 768;
      const extIcon = document.querySelector('.sidebar-icon-extended');
      const colIcon = document.querySelector('.sidebar-icon-collapsed');

      if (isMobile) {
        app.classList.toggle('sidebar-open');
      } else {
        sidebar.classList.toggle('collapsed');
      }

      const isCollapsed = sidebar.classList.contains('collapsed');
      if (extIcon && colIcon) {
        extIcon.style.display = isCollapsed ? 'none' : '';
        colIcon.style.display = isCollapsed ? '' : 'none';
      }
    }

    function closeMobileSidebar() {
      const app = document.querySelector('.app');
      app.classList.remove('sidebar-open');
    }

    // ===============================================================
    // FILE UPLOAD
    // ===============================================================

    function handleFileUpload(input) {
      const label = input.closest('.file-upload-field').querySelector('.file-upload-text');
      if (input.files.length > 0) {
        label.textContent = input.files[0].name;
        label.classList.add('has-file');
        showToast('File selected: ' + input.files[0].name);
        const card = input.closest('.settings-card');
        if (card) checkDirty(card);
      }
    }

    // ===============================================================
    // ESCAPE HTML (XSS prevention)
    // ===============================================================

    function escapeHtml(text) {
      const d = document.createElement('div');
      d.textContent = text;
      return d.innerHTML;
    }

    // ===============================================================
    // ACCESSIBILITY INIT — patches missing ARIA attributes
    // ===============================================================

    function initAccessibility() {

      // ----- 1. Tab panels: role + aria-labelledby -----
      document.querySelectorAll('.tab-panel').forEach(panel => {
        panel.setAttribute('role', 'tabpanel');
        const tabName = panel.id.replace('panel-', '');
        const tab = document.querySelector('.tab[data-tab="' + tabName + '"]');
        if (tab) {
          if (!tab.id) tab.id = 'tab-' + tabName;
          panel.setAttribute('aria-labelledby', tab.id);
        }
      });

      // ----- 2. Visually-hidden h2 headings per tab panel (heading hierarchy) -----
      document.querySelectorAll('.tab-panel').forEach(panel => {
        const tabName = panel.id.replace('panel-', '');
        const tab = document.querySelector('.tab[data-tab="' + tabName + '"]');
        if (tab && !panel.querySelector('h2')) {
          const h2 = document.createElement('h2');
          h2.className = 'sr-only';
          h2.textContent = tab.textContent.trim() + ' Settings';
          panel.insertBefore(h2, panel.firstChild);
        }
      });

      // ----- 3. Toggle switches: role, aria-checked, tabindex -----
      document.querySelectorAll('.toggle-switch').forEach(toggle => {
        if (!toggle.hasAttribute('role')) {
          toggle.setAttribute('role', 'switch');
        }
        toggle.setAttribute('aria-checked', String(toggle.classList.contains('active')));
        if (!toggle.hasAttribute('tabindex')) {
          toggle.setAttribute('tabindex', '0');
        }
      });

      // ----- 4. Radio groups: role="radiogroup" + role="radio" + roving tabindex -----
      document.querySelectorAll('.radio-group, .radio-inline, [data-radio-group]').forEach(group => {
        group.setAttribute('role', 'radiogroup');
        group.querySelectorAll('.radio-option').forEach(option => {
          option.setAttribute('role', 'radio');
          const isSelected = option.classList.contains('selected');
          option.setAttribute('aria-checked', String(isSelected));
          option.setAttribute('tabindex', isSelected ? '0' : '-1');
        });
      });

      // ----- 5. Form label associations (aria-labelledby) -----
      let labelCounter = 0;
      document.querySelectorAll('.form-row').forEach(row => {
        const label = row.querySelector('.form-label');
        if (!label) return;
        const labelId = 'flabel-' + (labelCounter++);
        label.setAttribute('id', labelId);

        // Associate with text/email/password inputs
        row.querySelectorAll('.input-field input').forEach(input => {
          input.setAttribute('aria-labelledby', labelId);
        });

        // Associate with toggle switches
        const toggle = row.querySelector('.toggle-switch');
        if (toggle) {
          toggle.setAttribute('aria-labelledby', labelId);
        }

        // Associate with radio groups
        const radioGroup = row.querySelector('.radio-group, .radio-inline, [data-radio-group]');
        if (radioGroup) {
          radioGroup.setAttribute('aria-labelledby', labelId);
        }

        // Associate with file uploads
        const fileUpload = row.querySelector('.file-upload-field');
        if (fileUpload) {
          fileUpload.setAttribute('role', 'button');
          fileUpload.setAttribute('aria-labelledby', labelId);
          fileUpload.setAttribute('tabindex', '0');
        }
      });

      // ----- 6. Icon-only interactive elements: role, tabindex, aria-label -----
      document.querySelectorAll('.edit-icon').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Edit');
      });
      document.querySelectorAll('.filter-icon').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Filter column');
      });
      document.querySelectorAll('.input-clear').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Clear input');
      });
      document.querySelectorAll('.input-eye').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Toggle password visibility');
      });
      document.querySelectorAll('.top-toast-close').forEach(icon => {
        icon.setAttribute('role', 'button');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'Close notification');
      });

      // Pool table action icons (delete + view per row)
      document.querySelectorAll('.pool-icons').forEach(container => {
        const svgs = container.querySelectorAll('svg');
        if (svgs[0]) {
          svgs[0].setAttribute('role', 'button');
          svgs[0].setAttribute('tabindex', '0');
          svgs[0].setAttribute('aria-label', 'Delete instance');
        }
        if (svgs[1]) {
          svgs[1].setAttribute('role', 'button');
          svgs[1].setAttribute('tabindex', '0');
          svgs[1].setAttribute('aria-label', 'View instance details');
        }
      });

      // Help icons — focusable with tooltip description
      document.querySelectorAll('.help-icon').forEach(icon => {
        icon.setAttribute('role', 'img');
        icon.setAttribute('tabindex', '0');
        icon.setAttribute('aria-label', 'More information');
      });

      // ----- 7. Decorative SVGs: aria-hidden -----
      document.querySelectorAll('.banner-icon svg, .header-logo-icon svg, .file-upload-icon svg, .top-toast-icon svg, .nav-item svg, .header-icon svg').forEach(svg => {
        svg.setAttribute('aria-hidden', 'true');
        svg.setAttribute('focusable', 'false');
      });

      // ----- 8. Active nav item: aria-current -----
      const activeNav = document.querySelector('.nav-item.active');
      if (activeNav) {
        activeNav.setAttribute('aria-current', 'page');
      }

      // ----- 9. Autocomplete attributes (WCAG 1.3.5 Identify Input Purpose) -----
      const profilePanel = document.getElementById('panel-profile');
      if (profilePanel) {
        profilePanel.querySelectorAll('.form-row').forEach(row => {
          const label = row.querySelector('.form-label');
          const input = row.querySelector('input');
          if (!label || !input) return;
          const t = label.textContent.trim().toLowerCase();
          if (t.includes('full name')) input.setAttribute('autocomplete', 'name');
          else if (t === 'email') input.setAttribute('autocomplete', 'email');
          else if (t.includes('new password')) input.setAttribute('autocomplete', 'new-password');
          else if (t.includes('repeat password')) input.setAttribute('autocomplete', 'new-password');
        });
      }

      // SMTP authentication username/password
      const smtpPanel = document.getElementById('panel-smtp');
      if (smtpPanel) {
        smtpPanel.querySelectorAll('.form-row').forEach(row => {
          const label = row.querySelector('.form-label');
          const input = row.querySelector('input');
          if (!label || !input) return;
          const t = label.textContent.trim().toLowerCase();
          if (t.includes('username')) input.setAttribute('autocomplete', 'username');
          else if (t === 'password') input.setAttribute('autocomplete', 'current-password');
          else if (t.includes('sender email')) input.setAttribute('autocomplete', 'email');
        });
      }

      // ----- 10. Toast live regions -----
      const toast = document.getElementById('toast');
      toast.setAttribute('role', 'status');
      toast.setAttribute('aria-live', 'polite');

      // Notification toast ARIA is set inline in HTML (role="alert", aria-live="assertive")

      // ----- 11. All data tables: scope attributes for screen readers -----
      document.querySelectorAll('.pool-table thead th, .data-table thead th').forEach(th => {
        th.setAttribute('scope', 'col');
      });

      // ----- 12. Select fields: ensure they have aria-label if no visible label -----
      document.querySelectorAll('.select-field').forEach(sel => {
        if (!sel.getAttribute('aria-labelledby') && !sel.getAttribute('aria-label') && !sel.id) {
          const row = sel.closest('.form-row');
          if (row) {
            const label = row.querySelector('.form-label');
            if (label && label.id) sel.setAttribute('aria-labelledby', label.id);
          }
        }
      });

      // ----- 13. Modal / dialog ARIA for new elements -----
      document.querySelectorAll('.slide-panel .radio-group, .modal .radio-group').forEach(group => {
        group.setAttribute('role', 'radiogroup');
        group.querySelectorAll('.radio-option').forEach(opt => {
          opt.setAttribute('role', 'radio');
          opt.setAttribute('aria-checked', String(opt.classList.contains('selected')));
          opt.setAttribute('tabindex', opt.classList.contains('selected') ? '0' : '-1');
        });
      });
    }

    // ===============================================================
    // MODAL DIALOGS
    // ===============================================================

    function openModal(id) {
      const overlay = document.getElementById(id);
      if (!overlay) return;
      overlay.classList.add('open');
      overlay.setAttribute('aria-hidden', 'false');
      // Trap focus inside modal
      const modal = overlay.querySelector('.modal');
      const focusable = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if (focusable.length) focusable[0].focus();
      // Close on overlay click
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) closeModal(id);
      });
      // Close on Escape
      overlay._escHandler = (e) => {
        if (e.key === 'Escape') closeModal(id);
      };
      document.addEventListener('keydown', overlay._escHandler);
    }

    function closeModal(id) {
      const overlay = document.getElementById(id);
      if (!overlay) return;
      overlay.classList.remove('open');
      overlay.setAttribute('aria-hidden', 'true');
      if (overlay._escHandler) {
        document.removeEventListener('keydown', overlay._escHandler);
      }
    }

    // License modal: switch between Online / Offline modes
    function showLicenseMode(mode) {
      const onlineEl = document.getElementById('licenseOnlineMode');
      const offlineEl = document.getElementById('licenseOfflineMode');
      if (mode === 'online') {
        onlineEl.style.display = '';
        offlineEl.style.display = 'none';
      } else {
        onlineEl.style.display = 'none';
        offlineEl.style.display = '';
      }
    }

    function activateLicense() {
      const isOnline = document.getElementById('licenseOnlineMode').style.display !== 'none';
      if (isOnline) {
        const keyInput = document.getElementById('licenseKeyInput');
        if (!keyInput.value.trim()) {
          showNotification('warning', 'Missing field', 'Please enter a license key.');
          return;
        }
      }
      closeModal('addLicenseModal');
      document.getElementById('licenseEmptyState').style.display = 'none';
      document.getElementById('licenseActiveState').style.display = '';
      // Reset badge to active state
      var badge = document.getElementById('licenseExpBadge');
      badge.className = 'license-badge green';
      badge.textContent = 'Dec 31, 2026';
      showNotification('success', 'License activated', 'Your license has been activated successfully.');
      document.getElementById('licenseKeyInput').value = '';

      // Hide the license expired notification on activation, show empty state
      var expNotif = document.getElementById('notifLicenseExpired');
      if (expNotif) expNotif.style.display = 'none';
      var notifEmpty = document.getElementById('notifEmptyState');
      if (notifEmpty) notifEmpty.style.display = '';
      // Hide the red dot on bell
      var notifDot = document.querySelector('.notif-dot');
      if (notifDot) notifDot.style.display = 'none';

      // After 10 seconds, expire the license and return to empty state
      clearTimeout(window._licenseExpTimer);
      window._licenseExpTimer = setTimeout(function() {
        var badge = document.getElementById('licenseExpBadge');
        if (badge && document.getElementById('licenseActiveState').style.display !== 'none') {
          badge.className = 'license-badge red';
          badge.textContent = 'Expired';
          showNotification('error', 'License expired', 'Your license has expired. Please add a new license to restore functionality.');
          // Show the license expired item in the notification dropdown, hide empty state
          var expNotif = document.getElementById('notifLicenseExpired');
          if (expNotif) { expNotif.style.display = ''; expNotif.querySelector('.notif-msg-time').textContent = 'Just now'; }
          var notifEmpty = document.getElementById('notifEmptyState');
          if (notifEmpty) notifEmpty.style.display = 'none';
          // Show the red dot on bell
          var notifDot = document.querySelector('.notif-dot');
          if (notifDot) notifDot.style.display = '';
          // Switch to empty state after a short delay so user sees the expired badge
          setTimeout(function() {
            document.getElementById('licenseActiveState').style.display = 'none';
            document.getElementById('licenseEmptyState').style.display = '';
          }, 2000);
        }
      }, 10000);
    }

    function prefillLicenseKey(input) {
      if (!input.value) {
        input.value = 'EVAL-2026-MDSS-XKPL-9F7H';
      }
    }

    function deactivateLicense() {
      clearTimeout(window._licenseExpTimer);
      document.getElementById('licenseActiveState').style.display = 'none';
      document.getElementById('licenseEmptyState').style.display = '';
      showNotification('info', 'License deactivated', 'The license has been deactivated.');
    }

    // ===============================================================
    // SLIDE-OUT PANELS
    // ===============================================================

    function openSlidePanel(id) {
      const panel = document.getElementById(id);
      if (!panel) return;
      const overlayId = id.replace('Panel', 'Overlay');
      const overlay = document.getElementById(overlayId);
      if (overlay) overlay.classList.add('open');
      panel.classList.add('open');
      // Focus first input in panel
      const focusable = panel.querySelectorAll('input, select, button, [tabindex]:not([tabindex="-1"])');
      if (focusable.length) setTimeout(() => focusable[0].focus(), 300);
      // Escape handler
      panel._escHandler = (e) => {
        if (e.key === 'Escape') closeSlidePanel(id);
      };
      document.addEventListener('keydown', panel._escHandler);
    }

    function closeSlidePanel(id) {
      const panel = document.getElementById(id);
      if (!panel) return;
      const overlayId = id.replace('Panel', 'Overlay');
      const overlay = document.getElementById(overlayId);
      if (overlay) overlay.classList.remove('open');
      panel.classList.remove('open');
      if (panel._escHandler) {
        document.removeEventListener('keydown', panel._escHandler);
      }
    }

    // ===============================================================
    // ADD COLLECTOR → inserts row into collectors table
    // ===============================================================
    function addCollectorRow() {
      const name = document.getElementById('collectorName').value.trim();
      const endpoint = document.getElementById('collectorEndpoint').value.trim();
      const apiKey = document.getElementById('collectorApiKey').value.trim();
      const selectedRadio = document.querySelector('#addCollectorPanel .radio-option.selected .radio-label');
      const protocol = selectedRadio ? selectedRadio.textContent.trim() : 'gRPC';

      if (!name) {
        showNotification('warning', 'Missing field', 'Please enter a Collector Name.');
        return;
      }

      const tbody = document.getElementById('collectorsTableBody');
      const editSvg = '<span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span>';

      const tr = document.createElement('tr');
      tr.innerHTML =
        '<td><span class="av-badge">' + escapeHtml(name) + '</span></td>' +
        '<td>' + escapeHtml(endpoint || '-') + '</td>' +
        '<td>' + (apiKey ? '••••••••' : '-') + '</td>' +
        '<td>' + escapeHtml(protocol) + '</td>' +
        '<td>' + editSvg + '</td>';
      tbody.appendChild(tr);

      // Reset form
      document.getElementById('collectorName').value = '';
      document.getElementById('collectorEndpoint').value = '';
      document.getElementById('collectorApiKey').value = '';

      closeSlidePanel('addCollectorPanel');
      showNotification('success', 'Collector added', 'The new collector has been configured successfully.');
    }

    // ===============================================================
    // ADD LOGGER → inserts row into external loggers table
    // ===============================================================
    function addLoggerRow() {
      const statusToggle = document.querySelector('#addLoggerPanel .toggle-switch');
      const isEnabled = statusToggle && statusToggle.getAttribute('aria-checked') === 'true';
      const serverType = document.getElementById('loggerType').value;
      const address = document.getElementById('loggerAddress').value.trim();
      const port = document.getElementById('loggerPort').value.trim();

      if (!address) {
        showNotification('warning', 'Missing field', 'Please enter a Server Address.');
        return;
      }

      const tbody = document.getElementById('loggersTableBody');
      const editSvg = '<span class="edit-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg></span>';

      const statusDot = isEnabled ? '<span class="status-dot green"></span>Enabled' : '<span class="status-dot red"></span>Disabled';
      const fullAddress = address + (port ? ':' + port : ':514');

      const tr = document.createElement('tr');
      tr.innerHTML =
        '<td>' + escapeHtml(serverType) + '</td>' +
        '<td>' + statusDot + '</td>' +
        '<td>' + escapeHtml(fullAddress) + '</td>' +
        '<td>-</td>' +
        '<td>' + editSvg + '</td>';
      tbody.appendChild(tr);

      // Reset form
      document.getElementById('loggerAddress').value = '';
      document.getElementById('loggerPort').value = '';

      closeSlidePanel('addLoggerPanel');
      showNotification('success', 'Logger instance added', 'The external logger has been configured successfully.');
    }

    // HTML escaping helper
    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // ===============================================================
    // POOL ACTION MENU — toggle "..." menu on scan pool table rows
    // ===============================================================
    function togglePoolActionMenu(btn) {
      event.stopPropagation();
      const menu = btn.querySelector('.pool-action-menu');
      const wasOpen = menu.classList.contains('open');
      // Close all other open menus
      document.querySelectorAll('.pool-action-menu.open').forEach(m => m.classList.remove('open'));
      if (!wasOpen) {
        // Position menu using fixed coords relative to the button
        const rect = btn.getBoundingClientRect();
        menu.style.top = (rect.bottom + 4) + 'px';
        menu.style.right = (window.innerWidth - rect.right) + 'px';
        menu.classList.add('open');
        // Close on outside click
        const closeMenu = function(e) {
          if (!btn.contains(e.target)) {
            menu.classList.remove('open');
            document.removeEventListener('click', closeMenu);
          }
        };
        document.addEventListener('click', closeMenu);
      }
    }

    // ===============================================================
    // ADD SCAN POOL — creates a new scan pool card
    // ===============================================================
    function addScanPool() {
      const name = document.getElementById('scanPoolName').value.trim();
      if (!name) {
        showNotification('warning', 'Missing field', 'Please enter a pool name.');
        return;
      }

      const type = document.getElementById('scanPoolType').value;
      const url = document.getElementById('scanPoolUrl').value.trim();
      const timeout = document.getElementById('scanPoolTimeout').value;

      // Build action menu cell template
      const actionCell = '<div class="pool-action-btn" onclick="togglePoolActionMenu(this)"><svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg><div class="pool-action-menu"><button class="pool-action-menu-item" onclick="showToast(\'Edit instance\')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M12.146.854a.5.5 0 01.708 0l2.292 2.292a.5.5 0 010 .708L5.354 13.646a.5.5 0 01-.233.131l-3 .875a.5.5 0 01-.631-.631l.875-3a.5.5 0 01.131-.233L12.146.854z"/></svg>Edit</button><button class="pool-action-menu-item danger" onclick="showToast(\'Delete instance\')"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>Delete</button></div></div>';

      // Filter icon SVG
      const filterSvg = '<span class="filter-icon"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg></span>';

      const instanceCount = url ? '1 instance' : '0 instances';
      let tbodyContent = '';
      if (url) {
        tbodyContent = '<tr><td>' + escapeHtml(url) + '</td><td><span class="av-badge">-</span></td><td><span class="api-dots">\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022</span></td><td>' + escapeHtml(timeout) + '</td><td>' + actionCell + '</td></tr>';
      } else {
        tbodyContent = '<tr><td colspan="5" style="text-align:center; color:var(--text-muted); padding:20px;">No instances configured. Click Add Instance to add one.</td></tr>';
      }

      const dragSvg = '<span class="pool-drag-handle" draggable="true"><svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.5 12C4.32843 12 5 11.3284 5 10.5C5 9.67157 4.32843 9 3.5 9C2.67157 9 2 9.67157 2 10.5C2 11.3284 2.67157 12 3.5 12Z"/><path d="M12.5 12C13.3284 12 14 11.3284 14 10.5C14 9.67157 13.3284 9 12.5 9C11.6716 9 11 9.67157 11 10.5C11 11.3284 11.6716 12 12.5 12Z"/><path d="M8 12C8.82843 12 9.5 11.3284 9.5 10.5C9.5 9.67157 8.82843 9 8 9C7.17157 9 6.5 9.67157 6.5 10.5C6.5 11.3284 7.17157 12 8 12Z"/><path d="M3.5 7C4.32843 7 5 6.32843 5 5.5C5 4.67157 4.32843 4 3.5 4C2.67157 4 2 4.67157 2 5.5C2 6.32843 2.67157 7 3.5 7Z"/><path d="M12.5 7C13.3284 7 14 6.32843 14 5.5C14 4.67157 13.3284 4 12.5 4C11.6716 4 11 4.67157 11 5.5C11 6.32843 11.6716 7 12.5 7Z"/><path d="M8 7C8.82843 7 9.5 6.32843 9.5 5.5C9.5 4.67157 8.82843 4 8 4C7.17157 4 6.5 4.67157 6.5 5.5C6.5 6.32843 7.17157 7 8 7Z"/></svg></span>';

      const cardHtml = '<div class="settings-card pool-card">' +
        '<div class="pool-card-header">' +
          '<div class="pool-card-header-left">' + dragSvg + '<h2>' + escapeHtml(name) + '</h2><span class="pool-instance-count">' + instanceCount + '</span></div>' +
          '<div class="pool-card-header-right"><button class="btn-outline" onclick="showToast(\'Add Instance dialog would open\')">Add Instance</button></div>' +
        '</div>' +
        '<table class="pool-table"><thead><tr>' +
          '<th class="col-url">Scan Instance URL ' + filterSvg + '</th>' +
          '<th class="col-av">AV Package ' + filterSvg + '</th>' +
          '<th class="col-api">API Key ' + filterSvg + '</th>' +
          '<th class="col-timeout">Timeout ' + filterSvg + '</th>' +
          '<th class="col-actions"></th>' +
        '</tr></thead><tbody>' + tbodyContent + '</tbody></table></div>';

      const panel = document.getElementById('panel-scan-pools');
      const promoBanner = panel.querySelector('.promo-banner');
      promoBanner.insertAdjacentHTML('afterend', cardHtml);

      // Reset form
      document.getElementById('scanPoolName').value = '';
      document.getElementById('scanPoolUrl').value = '';
      document.getElementById('scanPoolApiKey').value = '';

      closeSlidePanel('addScanPoolPanel');
      showNotification('success', 'Scan pool added', 'The scan pool "' + escapeHtml(name) + '" has been created successfully.');
    }

    // ===============================================================
    // POOL CARD DRAG & DROP REORDERING (animated)
    // ===============================================================
    (function() {
      var draggedCard = null;
      var isAnimating = false;

      function getPoolCards() {
        var panel = document.getElementById('panel-scan-pools');
        return panel ? Array.from(panel.querySelectorAll('.pool-card')) : [];
      }

      // FLIP: snapshot positions → move DOM → animate delta
      function flipMove(target, before) {
        if (isAnimating) return;
        isAnimating = true;
        var cards = getPoolCards();
        var rects = new Map();
        cards.forEach(function(c) { rects.set(c, c.getBoundingClientRect()); });

        if (before) { target.before(draggedCard); }
        else { target.after(draggedCard); }

        getPoolCards().forEach(function(c) {
          if (c === draggedCard) return;
          var old = rects.get(c);
          if (!old) return;
          var now = c.getBoundingClientRect();
          var dy = old.top - now.top;
          if (Math.abs(dy) < 1) return;
          c.style.transition = 'none';
          c.style.transform = 'translateY(' + dy + 'px)';
          c.offsetHeight;
          c.classList.add('flip-animate');
          c.style.transform = '';
        });

        setTimeout(function() {
          getPoolCards().forEach(function(c) {
            c.classList.remove('flip-animate');
            c.style.transition = '';
            c.style.transform = '';
          });
          isAnimating = false;
        }, 160);
      }

      document.addEventListener('dragstart', function(e) {
        var handle = e.target.closest('.pool-drag-handle');
        if (!handle) return;
        draggedCard = handle.closest('.pool-card');
        if (draggedCard) {
          setTimeout(function() { if (draggedCard) draggedCard.classList.add('dragging'); }, 0);
          e.dataTransfer.effectAllowed = 'move';
          e.dataTransfer.setData('text/plain', '');
        }
      });

      document.addEventListener('dragover', function(e) {
        if (!draggedCard || isAnimating) return;
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        var target = e.target.closest('.pool-card');
        if (!target || target === draggedCard) return;

        var cards = getPoolCards();
        var dragIdx = cards.indexOf(draggedCard);
        var targetIdx = cards.indexOf(target);
        if (dragIdx === -1 || targetIdx === -1) return;

        // Only swap if cursor crosses the midpoint of the neighbor
        var rect = target.getBoundingClientRect();
        var mid = rect.top + rect.height / 2;
        if (dragIdx < targetIdx && e.clientY > mid) {
          flipMove(target, false);
        } else if (dragIdx > targetIdx && e.clientY < mid) {
          flipMove(target, true);
        }
      });

      document.addEventListener('drop', function(e) {
        if (!draggedCard) return;
        e.preventDefault();
        draggedCard.classList.remove('dragging');
        draggedCard = null;
      });

      document.addEventListener('dragend', function() {
        if (draggedCard) {
          draggedCard.classList.remove('dragging');
          draggedCard = null;
        }
        isAnimating = false;
      });
    })();

    // ===============================================================
    // UNSAVED CHANGES — warn when switching tabs with dirty cards
    // ===============================================================

    let pendingTabSwitch = null;

    function switchTabWithDirtyCheck(tab) {
      // Check if any visible card is dirty
      const activePanel = document.querySelector('.tab-panel.active');
      if (activePanel) {
        const dirtyCards = activePanel.querySelectorAll('.settings-card.dirty');
        if (dirtyCards.length > 0) {
          pendingTabSwitch = tab;
          openModal('unsavedModal');
          // Override the Leave Anyway button
          const leaveBtn = document.querySelector('#unsavedModal .btn-primary');
          leaveBtn.onclick = () => {
            // Discard all dirty cards in current panel
            dirtyCards.forEach(card => restoreCardState(card));
            closeModal('unsavedModal');
            switchTab(tab);
            pendingTabSwitch = null;
          };
          return;
        }
      }
      switchTab(tab);
    }

    // (Tab handlers already use switchTabWithDirtyCheck from initial setup)

    // ===============================================================
    // FILTER ICON SVG STATES
    // ===============================================================

    const FILTER_SVG_NORMAL = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M3.835 8.77C3.635 8.77 3.455 8.7 3.315 8.56C3.175 8.42 3.105 8.25 3.105 8.05C3.105 7.85 3.175 7.68 3.315 7.54C3.455 7.4 3.625 7.33 3.825 7.33H12.155C12.355 7.33 12.535 7.4 12.675 7.54C12.815 7.68 12.885 7.85 12.885 8.05C12.885 8.25 12.815 8.42 12.675 8.56C12.535 8.7 12.365 8.77 12.165 8.77H3.835Z"/><path d="M1.715 5.44C1.515 5.44 1.345 5.37 1.205 5.23C1.065 5.09 0.994995 4.92 0.994995 4.72C0.994995 4.52 1.065 4.35 1.205 4.21C1.345 4.07 1.515 4 1.715 4H14.275C14.475 4 14.645 4.07 14.785 4.21C14.925 4.35 14.995 4.52 14.995 4.72C14.995 4.92 14.925 5.09 14.785 5.23C14.645 5.37 14.475 5.44 14.275 5.44H1.715Z"/><path d="M5.515 12.09C5.315 12.09 5.14499 12.02 5.00499 11.88C4.86499 11.74 4.795 11.57 4.795 11.37C4.795 11.17 4.86499 11 5.00499 10.86C5.14499 10.72 5.315 10.65 5.515 10.65H10.475C10.675 10.65 10.845 10.72 10.985 10.86C11.125 11 11.195 11.17 11.195 11.37C11.195 11.57 11.125 11.74 10.985 11.88C10.845 12.02 10.675 12.09 10.475 12.09H5.515Z"/></svg>';

    const FILTER_SVG_ASC = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.71999 7.77C1.51999 7.77 1.33999 7.7 1.19999 7.56C1.05999 7.42 0.98999 7.25 0.98999 7.05C0.98999 6.85 1.05999 6.68 1.19999 6.54C1.33999 6.4 1.50999 6.33 1.70999 6.33H8.03999C8.23999 6.33 8.41999 6.4 8.55999 6.54C8.69999 6.68 8.76999 6.85 8.76999 7.05C8.76999 7.25 8.69999 7.42 8.55999 7.56C8.41999 7.7 8.24999 7.77 8.04999 7.77H1.71999Z"/><path d="M1.71999 4.44C1.51999 4.44 1.34999 4.37 1.20999 4.23C1.06999 4.09 0.99999 3.92 0.99999 3.72C0.99999 3.52 1.06999 3.35 1.20999 3.21C1.34999 3.07 1.51999 3 1.71999 3H12.28C12.48 3 12.65 3.07 12.79 3.21C12.93 3.35 13 3.52 13 3.72C13 3.92 12.93 4.09 12.79 4.23C12.65 4.37 12.48 4.44 12.28 4.44H1.71999Z"/><path d="M1.71999 11.09C1.51999 11.09 1.34999 11.02 1.20999 10.88C1.06999 10.74 0.99999 10.57 0.99999 10.37C0.99999 10.17 1.06999 10 1.20999 9.86C1.34999 9.72 1.51999 9.65 1.71999 9.65H4.67999C4.87999 9.65 5.04999 9.72 5.18999 9.86C5.32999 10 5.39999 10.17 5.39999 10.37C5.39999 10.57 5.32999 10.74 5.18999 10.88C5.04999 11.02 4.87999 11.09 4.67999 11.09H1.71999Z"/><path d="M9.18999 12.13L11.53 10.2C11.79 9.99 12.2 9.99 12.45 10.2L14.79 12.13C15.2 12.47 14.91 13.05 14.33 13.05H9.63999C9.05999 13.05 8.76999 12.47 9.17999 12.13H9.18999Z"/></svg>';

    const FILTER_SVG_DESC = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M1.71999 7.77C1.51999 7.77 1.33999 7.7 1.19999 7.56C1.05999 7.42 0.98999 7.25 0.98999 7.05C0.98999 6.85 1.05999 6.68 1.19999 6.54C1.33999 6.4 1.50999 6.33 1.70999 6.33H8.03999C8.23999 6.33 8.41999 6.4 8.55999 6.54C8.69999 6.68 8.76999 6.85 8.76999 7.05C8.76999 7.25 8.69999 7.42 8.55999 7.56C8.41999 7.7 8.24999 7.77 8.04999 7.77H1.71999Z"/><path d="M1.71999 4.44C1.51999 4.44 1.34999 4.37 1.20999 4.23C1.06999 4.09 0.99999 3.92 0.99999 3.72C0.99999 3.52 1.06999 3.35 1.20999 3.21C1.34999 3.07 1.51999 3 1.71999 3H12.28C12.48 3 12.65 3.07 12.79 3.21C12.93 3.35 13 3.52 13 3.72C13 3.92 12.93 4.09 12.79 4.23C12.65 4.37 12.48 4.44 12.28 4.44H1.71999Z"/><path d="M1.71999 11.09C1.51999 11.09 1.34999 11.02 1.20999 10.88C1.06999 10.74 0.99999 10.57 0.99999 10.37C0.99999 10.17 1.06999 10 1.20999 9.86C1.34999 9.72 1.51999 9.65 1.71999 9.65H4.67999C4.87999 9.65 5.04999 9.72 5.18999 9.86C5.32999 10 5.39999 10.17 5.39999 10.37C5.39999 10.57 5.32999 10.74 5.18999 10.88C5.04999 11.02 4.87999 11.09 4.67999 11.09H1.71999Z"/><path d="M14.81 10.96L12.47 12.89C12.21 13.1 11.8 13.1 11.55 12.89L9.20999 10.96C8.79999 10.62 9.08999 10.04 9.66999 10.04H14.36C14.94 10.04 15.23 10.62 14.82 10.96H14.81Z"/></svg>';

    function updateFilterIconSvg(icon, state) {
      if (state === 'asc') {
        icon.innerHTML = FILTER_SVG_ASC;
      } else if (state === 'desc') {
        icon.innerHTML = FILTER_SVG_DESC;
      } else {
        icon.innerHTML = FILTER_SVG_NORMAL;
      }
    }

    // ===============================================================
    // COLUMN DROPDOWN (Sorting / Pinning)
    // ===============================================================

    const colDropdown = document.getElementById('colDropdown');
    let activeFilterIcon = null;
    let activeColIndex = null;
    let activeTable = null;

    // Open dropdown on filter-icon click
    document.addEventListener('click', function(e) {
      const icon = e.target.closest('.filter-icon');
      if (icon) {
        e.stopPropagation();
        if (activeFilterIcon === icon && colDropdown.classList.contains('open')) {
          closeColDropdown();
          return;
        }
        activeFilterIcon = icon;

        // Determine column index and table
        const th = icon.closest('th') || icon.closest('.col-key, .col-value');
        const table = icon.closest('table') || icon.closest('.headers-table');
        activeTable = table;

        if (th && th.tagName === 'TH') {
          const row = th.closest('tr');
          activeColIndex = Array.from(row.children).indexOf(th);
        } else if (th) {
          const head = th.closest('.headers-table-head');
          activeColIndex = Array.from(head.children).indexOf(th);
        }

        // Update active states
        updateDropdownState();

        // Position dropdown with smart flip
        const rect = icon.getBoundingClientRect();
        colDropdown.style.top = '0';
        colDropdown.style.left = '0';
        colDropdown.style.visibility = 'hidden';
        colDropdown.classList.add('open');

        requestAnimationFrame(() => {
          const ddRect = colDropdown.getBoundingClientRect();
          const spaceBelow = window.innerHeight - rect.bottom - 4;
          const spaceAbove = rect.top - 4;

          // Flip above if not enough space below
          if (ddRect.height > spaceBelow && spaceAbove > spaceBelow) {
            colDropdown.style.top = (rect.top - ddRect.height - 4) + 'px';
          } else {
            colDropdown.style.top = (rect.bottom + 4) + 'px';
          }

          // Horizontal: align left, clamp to viewport
          let left = rect.left;
          if (left + ddRect.width > window.innerWidth - 8) {
            left = window.innerWidth - ddRect.width - 8;
          }
          if (left < 8) left = 8;
          colDropdown.style.left = left + 'px';

          colDropdown.style.visibility = '';
        });
        return;
      }

      // Close if clicking outside
      if (!e.target.closest('.col-dropdown')) {
        closeColDropdown();
      }
    });

    function closeColDropdown() {
      colDropdown.classList.remove('open');
      activeFilterIcon = null;
      activeColIndex = null;
      activeTable = null;
    }

    // Close on Escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && colDropdown.classList.contains('open')) {
        closeColDropdown();
      }
    });

    // Update active/selected states in dropdown
    function updateDropdownState() {
      colDropdown.querySelectorAll('.col-dropdown-item').forEach(item => {
        item.classList.remove('active');
      });
      if (activeFilterIcon) {
        const sortDir = activeFilterIcon.dataset.sortDir;
        if (sortDir === 'asc') {
          colDropdown.querySelector('[data-action="sort-asc"]').classList.add('active');
        } else if (sortDir === 'desc') {
          colDropdown.querySelector('[data-action="sort-desc"]').classList.add('active');
        }
        const pinItem = colDropdown.querySelector('[data-action="pin"]');
        if (activeFilterIcon.dataset.pinned === 'true') {
          pinItem.classList.add('active');
          pinItem.innerHTML = pinItem.innerHTML.replace('Pin Column', 'Unpin Column');
        } else {
          pinItem.innerHTML = pinItem.innerHTML.replace('Unpin Column', 'Pin Column');
        }
      }
    }

    // Handle dropdown item clicks
    colDropdown.addEventListener('click', function(e) {
      const item = e.target.closest('.col-dropdown-item');
      if (!item) return;
      const action = item.dataset.action;

      if (action === 'sort-asc' || action === 'sort-desc') {
        const dir = action === 'sort-asc' ? 'asc' : 'desc';
        // Toggle off if already active
        if (activeFilterIcon.dataset.sortDir === dir) {
          delete activeFilterIcon.dataset.sortDir;
          activeFilterIcon.classList.remove('active');
          updateFilterIconSvg(activeFilterIcon, 'normal');
          // Unsort - restore original order
          unsortTable();
        } else {
          // Clear other sort indicators in the same table
          clearSortInTable();
          activeFilterIcon.dataset.sortDir = dir;
          activeFilterIcon.classList.add('active');
          updateFilterIconSvg(activeFilterIcon, dir);
          sortTable(dir);
        }
      } else if (action === 'pin') {
        togglePinColumn();
      }

      closeColDropdown();
    });

    function sortTable(dir) {
      if (!activeTable || activeColIndex === null) return;

      if (activeTable.classList.contains('headers-table')) {
        sortHeadersTable(activeTable, activeColIndex, dir);
      } else {
        sortHtmlTable(activeTable, activeColIndex, dir);
      }
    }

    function unsortTable() {
      // For demo: just show toast
      showToast('Sort cleared');
    }

    function sortHtmlTable(table, colIdx, dir) {
      const tbody = table.querySelector('tbody');
      if (!tbody) return;
      const rows = Array.from(tbody.querySelectorAll('tr'));

      rows.sort((a, b) => {
        const aText = (a.children[colIdx]?.textContent || '').trim().toLowerCase();
        const bText = (b.children[colIdx]?.textContent || '').trim().toLowerCase();
        if (dir === 'asc') return aText.localeCompare(bText);
        return bText.localeCompare(aText);
      });

      rows.forEach(row => tbody.appendChild(row));
      showToast('Column sorted ' + (dir === 'asc' ? 'ascending' : 'descending'));
    }

    function sortHeadersTable(table, colIdx, dir) {
      const body = table.querySelector('.headers-table-body');
      if (!body) return;
      const rows = Array.from(body.querySelectorAll('.headers-table-row'));

      rows.sort((a, b) => {
        const aText = (a.children[colIdx]?.textContent || '').trim().toLowerCase();
        const bText = (b.children[colIdx]?.textContent || '').trim().toLowerCase();
        if (dir === 'asc') return aText.localeCompare(bText);
        return bText.localeCompare(aText);
      });

      rows.forEach(row => body.appendChild(row));
      showToast('Column sorted ' + (dir === 'asc' ? 'ascending' : 'descending'));
    }

    function clearSortInTable() {
      if (!activeTable) return;
      activeTable.querySelectorAll('.filter-icon').forEach(icon => {
        delete icon.dataset.sortDir;
        icon.classList.remove('active');
        updateFilterIconSvg(icon, 'normal');
      });
    }

    function togglePinColumn() {
      if (!activeFilterIcon || !activeTable || activeColIndex === null) return;

      const isPinned = activeFilterIcon.dataset.pinned === 'true';

      if (isPinned) {
        activeFilterIcon.dataset.pinned = 'false';
        // Unpin: remove sticky styling
        unpinColumn(activeTable, activeColIndex);
        showToast('Column unpinned');
      } else {
        activeFilterIcon.dataset.pinned = 'true';
        // Pin: apply sticky styling
        pinColumn(activeTable, activeColIndex);
        showToast('Column pinned');
      }
    }

    function pinColumn(table, colIdx) {
      if (table.classList.contains('headers-table')) {
        // For div-based headers table
        const allRows = table.querySelectorAll('.headers-table-head, .headers-table-row');
        allRows.forEach(row => {
          const cell = row.children[colIdx];
          if (cell) {
            cell.style.position = 'sticky';
            cell.style.left = '0';
            cell.style.zIndex = '2';
            cell.style.background = '#fff';
            cell.style.boxShadow = '2px 0 4px rgba(0,0,0,0.06)';
          }
        });
      } else {
        // For HTML tables
        const cells = table.querySelectorAll('tr > *:nth-child(' + (colIdx + 1) + ')');
        cells.forEach(cell => {
          cell.style.position = 'sticky';
          cell.style.left = '0';
          cell.style.zIndex = '2';
          cell.style.background = '#fff';
          cell.style.boxShadow = '2px 0 4px rgba(0,0,0,0.06)';
        });
      }
    }

    function unpinColumn(table, colIdx) {
      if (table.classList.contains('headers-table')) {
        const allRows = table.querySelectorAll('.headers-table-head, .headers-table-row');
        allRows.forEach(row => {
          const cell = row.children[colIdx];
          if (cell) {
            cell.style.position = '';
            cell.style.left = '';
            cell.style.zIndex = '';
            cell.style.background = '';
            cell.style.boxShadow = '';
          }
        });
      } else {
        const cells = table.querySelectorAll('tr > *:nth-child(' + (colIdx + 1) + ')');
        cells.forEach(cell => {
          cell.style.position = '';
          cell.style.left = '';
          cell.style.zIndex = '';
          cell.style.background = '';
          cell.style.boxShadow = '';
        });
      }
    }

    // ===============================================================
    // TOOLTIPS (help-icon hover/focus)
    // ===============================================================

    let activeTooltip = null;

    function showTooltipFor(icon) {
      hideTooltip();
      const text = icon.dataset.tooltip;
      if (!text) return;

      const tip = document.createElement('div');
      tip.className = 'tooltip-popover';
      tip.textContent = text;
      tip.style.position = 'fixed';
      tip.style.pointerEvents = 'none';
      tip.style.visibility = 'hidden';
      document.body.appendChild(tip);

      requestAnimationFrame(() => {
        const rect = icon.getBoundingClientRect();
        const tipRect = tip.getBoundingClientRect();
        const spaceBelow = window.innerHeight - rect.bottom - 4;
        const spaceAbove = rect.top - 4;

        // Vertical: below by default, flip above if not enough space
        if (tipRect.height > spaceBelow && spaceAbove > spaceBelow) {
          tip.style.top = (rect.top - tipRect.height - 4) + 'px';
        } else {
          tip.style.top = (rect.bottom + 4) + 'px';
        }

        // Horizontal: center on icon, clamp to viewport
        let left = rect.left + rect.width / 2 - tipRect.width / 2;
        if (left + tipRect.width > window.innerWidth - 8) {
          left = window.innerWidth - tipRect.width - 8;
        }
        if (left < 8) left = 8;
        tip.style.left = left + 'px';

        tip.style.visibility = '';
      });

      activeTooltip = tip;
    }

    function hideTooltip() {
      if (activeTooltip) {
        activeTooltip.remove();
        activeTooltip = null;
      }
    }

    // Auto-assign tooltip text from label context if not set
    const tooltipTexts = {
      'API Key': 'API key used for authenticating scan requests.',
      'Generated Report': 'Configure how scan reports are generated and stored.',
      'Blocked Files': 'Files blocked during the scanning process.',
      'Encryption Key Status': 'Shows the age and status of the current encryption key.',
      'Service Status': 'Enable or disable this service.',
      'Host': 'SMTP server hostname or IP address.',
      'Port': 'SMTP server port number (e.g. 25, 465, 587).',
      'Base URL (optional)': 'Base URL used in email notifications for links.',
      'Sender name (optional)': 'Display name shown in outgoing email notifications.',
      'Sender email address (optional)': 'Email address used as the sender for notifications.',
      'Security option': 'TLS/SSL encryption method for SMTP connection.',
      'Telemetry Data Collection': 'Collect and send anonymous usage telemetry data.',
      'Send Telemetry to OPSWAT': 'Share telemetry data with OPSWAT for product improvement.',
    };

    document.querySelectorAll('.help-icon').forEach(icon => {
      if (!icon.dataset.tooltip) {
        const label = icon.closest('.form-label, .panel-field-label, [class*="label"]');
        if (label) {
          const labelText = label.childNodes[0]?.textContent?.trim() || label.textContent.trim();
          icon.dataset.tooltip = tooltipTexts[labelText] || 'More information about this setting.';
        } else {
          icon.dataset.tooltip = 'More information about this setting.';
        }
      }
      icon.addEventListener('mouseenter', () => showTooltipFor(icon));
      icon.addEventListener('mouseleave', hideTooltip);
      icon.addEventListener('focus', () => showTooltipFor(icon));
      icon.addEventListener('blur', hideTooltip);
    });

    // ===============================================================
    // NAV PAGE SWITCHING
    // ===============================================================

    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        const text = this.querySelector('.nav-text')?.textContent?.trim();
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        this.classList.add('active');

        // Hide all pages, show the selected one
        document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
        if (text === 'Audit') {
          document.getElementById('auditPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else if (text === 'Settings') {
          document.getElementById('settingsPage').classList.add('active');
          document.getElementById('componentsPage').style.display = 'none';
        } else {
          // For other nav items, show settings by default or show toast
          document.getElementById('componentsPage').style.display = 'none';
          document.getElementById('settingsPage').classList.add('active');
          document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
          document.querySelector('.nav-item .nav-text')?.closest('.nav-item')?.classList.add('active');
          showToast(text + ' page coming soon');
          // Re-highlight the correct nav item
          document.querySelectorAll('.nav-item').forEach(n => {
            if (n.querySelector('.nav-text')?.textContent?.trim() === text) n.classList.add('active');
          });
        }
        // Scroll content to top
        document.querySelector('.content').scrollTop = 0;
      });
    });

    // ===============================================================
    // AUDIT: Generate 50 rows of data
    // ===============================================================
    (function generateAuditData() {
      const tbody = document.getElementById('auditTableBody');
      if (!tbody) return;
      const users = [
        { name: 'Alex Johnson', initials: 'A', color: '#c17a5a,#a8624a' },
        { name: 'Emily Johnson', initials: 'E', color: '#6b8faa,#4a6f8a' },
        { name: 'Irene Miller', initials: 'I', color: '#8a7faa,#6a5f8a' },
        { name: 'Sophia Davis', initials: 'S', color: '#7aaa6b,#5a8a4a' },
        { name: 'Michael Chen', initials: 'M', color: '#aa8a6b,#8a6a4a' },
        { name: 'Sarah Wilson', initials: 'S', color: '#6b7aaa,#4a5a8a' },
        { name: 'David Brown', initials: 'D', color: '#aa6b8a,#8a4a6a' },
        null // System
      ];
      const levels = ['Warning', 'Info', 'Error', 'Warning', 'Info', 'Warning'];
      const categories = ['Settings', 'Scan Activity', 'Authentication', 'Scan Activity', 'Settings', 'Authentication', 'Settings'];
      const types = ['Workflow Technologies refreshed', 'File Discovery Failed', 'Logged In', 'Scan Profile Updated', 'API Key Rotated', 'Password Changed', 'Configuration Updated', 'License Renewed', 'User Role Modified', 'Scan Engine Updated'];
      const details = [
        'Scanning modules for Workflow have been updated. New values applied.',
        'Unable to discover files in the configured storage path.',
        'User authentication session initiated from 192.168.1.45.',
        'Scan profile "Default Cloud" settings modified by administrator.',
        'API key rotation completed successfully for all services.',
        'Password change request processed for user account.',
        'System configuration backup created automatically.',
        'License validation check completed with renewed status.',
        'User role permissions updated in access control system.',
        'MetaDefender Core scan engine definitions updated to latest.',
        'Workflow engine restarted after configuration changes.',
        'File quarantine policy updated for blocked file types.',
        'SMTP notification settings verified and connection tested.',
        'Data retention policy applied to audit records older than 30 days.',
        'SSL certificate renewed for API endpoint connections.'
      ];
      const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      const chevronSvg = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M7.99994 10.7499C7.80994 10.7499 7.61994 10.6799 7.46994 10.5299L3.21994 6.27994C2.92994 5.98994 2.92994 5.50994 3.21994 5.21994C3.50994 4.92994 3.98994 4.92994 4.27994 5.21994L7.99994 8.93994L11.7199 5.21994C12.0099 4.92994 12.4899 4.92994 12.7799 5.21994C13.0699 5.50994 13.0699 5.98994 12.7799 6.27994L8.52994 10.5299C8.37994 10.6799 8.18994 10.7499 7.99994 10.7499Z"/></svg>';
      const copySvg = '<svg viewBox="0 0 16 16" fill="currentColor"><path d="M13 2H6C5.44772 2 5 2.44772 5 3V10C5 10.5523 5.44772 11 6 11H13C13.5523 11 14 10.5523 14 10V3C14 2.44772 13.5523 2 13 2Z"/><path d="M11 12.5V14H3C2.45 14 2 13.55 2 13V5H3.5V12.5H11Z"/></svg>';
      let html = '';
      for (let i = 0; i < 50; i++) {
        const user = users[i % users.length];
        const level = levels[i % levels.length];
        const category = categories[i % categories.length];
        const type = types[i % types.length];
        const detail = details[i % details.length];
        const month = months[i % 12];
        const day = ((i * 3 + 1) % 28) + 1;
        const hour = ((i * 2 + 8) % 24);
        const minute = (i * 7) % 60;
        const dateStr = month + ' ' + String(day).padStart(2,'0') + ', 2025 ' + String(hour).padStart(2,'0') + ':' + String(minute).padStart(2,'0') + ':00';
        const levelTag = level === 'Error' ? 'tag-alert' : level === 'Info' ? 'tag-accent' : 'tag-warn';
        const detailTrunc = detail.length > 20 ? detail.substring(0, 18) + '...' : detail;
        let userCell;
        if (user) {
          userCell = '<div class="audit-user"><span class="audit-avatar" style="background:linear-gradient(135deg,' + user.color + ');">' + user.initials + '</span> ' + user.name + '</div>';
        } else {
          userCell = '<div class="audit-user">System</div>';
        }
        html += '<tr data-expandable data-detail="' + detail.replace(/"/g, '&quot;') + '">';
        html += '<td class="col-expand"><button class="expand-btn" onclick="toggleAuditRow(this)">' + chevronSvg + '</button></td>';
        html += '<td>' + userCell + '</td>';
        html += '<td><span class="tag ' + levelTag + '">' + level + '</span></td>';
        html += '<td><span class="tag-keyword">' + category + '</span></td>';
        html += '<td>' + type + '</td>';
        html += '<td>' + dateStr + '</td>';
        html += '<td class="col-details">' + detailTrunc + '</td>';
        html += '<td class="col-copy"><button class="copy-btn" onclick="copyAuditRow(this)">' + copySvg + '</button></td>';
        html += '</tr>';
      }
      tbody.innerHTML = html;
      window._auditTotal = 1256;
      window._auditUsers = users;
      window._auditLevels = levels;
      window._auditCategories = categories;
      window._auditTypes = types;
      window._auditDetails = details;
      window._auditChevronSvg = chevronSvg;
      window._auditCopySvg = copySvg;
    })();

    function refreshAuditLog() {
      const tbody = document.getElementById('auditTableBody');
      if (!tbody) return;
      const newCount = 3 + Math.floor(Math.random() * 3); // 3-5 new items
      const users = window._auditUsers;
      const levels = window._auditLevels;
      const categories = window._auditCategories;
      const types = window._auditTypes;
      const details = window._auditDetails;
      const chevronSvg = window._auditChevronSvg;
      const copySvg = window._auditCopySvg;
      const now = new Date();
      const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      let html = '';
      for (let i = 0; i < newCount; i++) {
        const user = users[Math.floor(Math.random() * users.length)];
        const level = levels[Math.floor(Math.random() * levels.length)];
        const category = categories[Math.floor(Math.random() * categories.length)];
        const type = types[Math.floor(Math.random() * types.length)];
        const detail = details[Math.floor(Math.random() * details.length)];
        const d = new Date(now.getTime() - i * 60000);
        const dateStr = months[d.getMonth()] + ' ' + String(d.getDate()).padStart(2,'0') + ', ' + d.getFullYear() + ' ' + String(d.getHours()).padStart(2,'0') + ':' + String(d.getMinutes()).padStart(2,'0') + ':' + String(d.getSeconds()).padStart(2,'0');
        const levelTag = level === 'Error' ? 'tag-alert' : level === 'Info' ? 'tag-accent' : 'tag-warn';
        const detailTrunc = detail.length > 20 ? detail.substring(0, 18) + '...' : detail;
        let userCell;
        if (user) {
          userCell = '<div class="audit-user"><span class="audit-avatar" style="background:linear-gradient(135deg,' + user.color + ');">' + user.initials + '</span> ' + user.name + '</div>';
        } else {
          userCell = '<div class="audit-user">System</div>';
        }
        html += '<tr data-expandable data-detail="' + detail.replace(/"/g, '&quot;') + '" style="background:#f0f7ff;">';
        html += '<td class="col-expand"><button class="expand-btn" onclick="toggleAuditRow(this)">' + chevronSvg + '</button></td>';
        html += '<td>' + userCell + '</td>';
        html += '<td><span class="tag ' + levelTag + '">' + level + '</span></td>';
        html += '<td><span class="tag-keyword">' + category + '</span></td>';
        html += '<td>' + type + '</td>';
        html += '<td>' + dateStr + '</td>';
        html += '<td class="col-details">' + detailTrunc + '</td>';
        html += '<td class="col-copy"><button class="copy-btn" onclick="copyAuditRow(this)">' + copySvg + '</button></td>';
        html += '</tr>';
      }
      tbody.insertAdjacentHTML('afterbegin', html);
      // Fade highlight then remove after 2s
      setTimeout(function() {
        tbody.querySelectorAll('tr[style*="f0f7ff"]').forEach(function(tr) {
          tr.style.transition = 'background 0.5s ease';
          tr.style.background = '';
        });
      }, 2000);
      // Update total count
      window._auditTotal += newCount;
      const countEl = document.getElementById('auditTotalCount');
      if (countEl) countEl.textContent = window._auditTotal.toLocaleString();
      // Update pagination info
      const pageInfo = document.getElementById('auditPageInfo');
      if (pageInfo) {
        const perPage = parseInt(document.getElementById('auditPerPage').value) || 50;
        pageInfo.textContent = '1-' + perPage + ' of ' + window._auditTotal.toLocaleString() + ' items';
      }
      showToast(newCount + ' new events added');
    }

    // ===============================================================
    // DARK MODE TOGGLE
    // ===============================================================
    function toggleDarkMode() {
      const html = document.documentElement;
      const isDark = html.dataset.theme === 'dark';
      if (isDark) {
        delete html.dataset.theme;
      } else {
        html.dataset.theme = 'dark';
      }
      // Toggle icon visibility
      document.querySelectorAll('.theme-icon-moon').forEach(function(el) { el.style.display = isDark ? '' : 'none'; });
      document.querySelectorAll('.theme-icon-sun').forEach(function(el) { el.style.display = isDark ? 'none' : ''; });
      // Update theme label in dropdown
      var themeLabel = document.getElementById('avdThemeLabel');
      if (themeLabel) themeLabel.textContent = isDark ? 'Light Theme' : 'Dark Theme';
      // Update active check in theme submenu
      updateAvdThemeChecks(isDark ? 'light' : 'dark');
    }

    // ===============================================================
    // AVATAR DROPDOWN
    // ===============================================================
    function toggleAvatarDropdown(e) {
      e.stopPropagation();
      var dd = document.getElementById('avatarDropdown');
      if (dd.classList.contains('open')) {
        closeAvatarDropdown();
      } else {
        dd.classList.add('open');
        // Always reset to main menu
        showAvdSub('avdMain');
      }
    }

    function closeAvatarDropdown() {
      var dd = document.getElementById('avatarDropdown');
      if (dd) dd.classList.remove('open');
    }

    // Close dropdown on outside click
    document.addEventListener('click', function(e) {
      var dd = document.getElementById('avatarDropdown');
      if (dd && dd.classList.contains('open')) {
        var wrap = dd.closest('.avatar-dropdown-wrap');
        if (!wrap.contains(e.target)) closeAvatarDropdown();
      }
    });

    // Close dropdown on Escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeAvatarDropdown();
    });

    function showAvdSub(id) {
      var dd = document.getElementById('avatarDropdown');
      dd.querySelectorAll('.avd-submenu').forEach(function(s) { s.classList.remove('open'); });
      document.getElementById(id).classList.add('open');
    }

    function setAvdTheme(theme, btn) {
      var html = document.documentElement;
      if (theme === 'dark') {
        html.dataset.theme = 'dark';
      } else if (theme === 'light') {
        delete html.dataset.theme;
      } else {
        // System default — check prefers-color-scheme
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          html.dataset.theme = 'dark';
        } else {
          delete html.dataset.theme;
        }
      }
      var isDark = html.dataset.theme === 'dark';
      document.querySelectorAll('.theme-icon-moon').forEach(function(el) { el.style.display = isDark ? 'none' : ''; });
      document.querySelectorAll('.theme-icon-sun').forEach(function(el) { el.style.display = isDark ? '' : 'none'; });
      var themeLabel = document.getElementById('avdThemeLabel');
      if (themeLabel) themeLabel.textContent = isDark ? 'Dark Theme' : 'Light Theme';
      updateAvdThemeChecks(theme);
    }

    function updateAvdThemeChecks(activeTheme) {
      var themePanel = document.getElementById('avdTheme');
      if (!themePanel) return;
      themePanel.querySelectorAll('.avd-item').forEach(function(item) {
        item.classList.remove('active');
      });
      var labels = { 'light': 'Light Theme', 'dark': 'Dark Theme', 'system': 'System Default' };
      themePanel.querySelectorAll('.avd-item').forEach(function(item) {
        var text = item.querySelector('.avd-item-text');
        if (text && text.textContent === labels[activeTheme]) {
          item.classList.add('active');
        }
      });
    }

    // ===============================================================
    // AVATAR DROPDOWN NAVIGATION
    // ===============================================================
    function avdNavigate(target) {
      closeAvatarDropdown();
      if (target === 'settings' || target === 'profile') {
        // Navigate to Settings page
        document.querySelectorAll('.page-view').forEach(function(p) { p.classList.remove('active'); });
        document.getElementById('componentsPage').style.display = 'none';
        document.getElementById('settingsPage').classList.add('active');
        document.querySelectorAll('.nav-item').forEach(function(n) { n.classList.remove('active'); });
        document.querySelectorAll('.nav-item').forEach(function(n) {
          if (n.querySelector('.nav-text') && n.querySelector('.nav-text').textContent.trim() === 'Settings') n.classList.add('active');
        });
        // Switch to Profile tab
        var profileTab = document.querySelector('.tab[data-tab="profile"]');
        if (profileTab) switchTab(profileTab);
        document.querySelector('.content').scrollTop = 0;
      }
    }

    // ===============================================================
    // NOTIFICATIONS DROPDOWN
    // ===============================================================
    function toggleNotifDropdown(e) {
      e.stopPropagation();
      closeAvatarDropdown();
      var dd = document.getElementById('notifDropdown');
      if (dd.classList.contains('open')) {
        dd.classList.remove('open');
      } else {
        dd.classList.add('open');
      }
    }

    function closeNotifDropdown() {
      var dd = document.getElementById('notifDropdown');
      if (dd) dd.classList.remove('open');
    }

    document.addEventListener('click', function(e) {
      var dd = document.getElementById('notifDropdown');
      if (dd && dd.classList.contains('open')) {
        var wrap = dd.closest('.notif-dropdown-wrap');
        if (!wrap.contains(e.target)) closeNotifDropdown();
      }
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeNotifDropdown();
    });

    function markAllNotifRead() {
      document.querySelectorAll('.notif-msg-dot').forEach(function(d) { d.style.display = 'none'; });
      document.querySelector('.notif-dot').style.display = 'none';
      showToast('All notifications marked as read');
    }

    function notifNavigateLicensing() {
      closeNotifDropdown();
      // Navigate to Settings > Licensing
      document.querySelectorAll('.page-view').forEach(function(p) { p.classList.remove('active'); });
      document.getElementById('componentsPage').style.display = 'none';
      document.getElementById('settingsPage').classList.add('active');
      document.querySelectorAll('.nav-item').forEach(function(n) { n.classList.remove('active'); });
      document.querySelectorAll('.nav-item').forEach(function(n) {
        if (n.querySelector('.nav-text') && n.querySelector('.nav-text').textContent.trim() === 'Settings') n.classList.add('active');
      });
      // Switch to Licensing tab using the existing switchTab function
      var licensingTab = document.querySelector('.tab[data-tab="licensing"]');
      if (licensingTab) switchTab(licensingTab);
      document.querySelector('.content').scrollTop = 0;
    }

    // ===============================================================
    // AUDIT: Row expansion
    // ===============================================================

    function toggleAuditRow(btn) {
      const row = btn.closest('tr');
      const detail = row.dataset.detail;
      const isOpen = btn.classList.contains('open');

      if (isOpen) {
        btn.classList.remove('open');
        const expandedRow = row.nextElementSibling;
        if (expandedRow && expandedRow.classList.contains('audit-expanded-row')) {
          expandedRow.remove();
        }
      } else {
        btn.classList.add('open');
        const colCount = row.children.length;
        const newRow = document.createElement('tr');
        newRow.classList.add('audit-expanded-row');
        const td = document.createElement('td');
        td.setAttribute('colspan', colCount);
        td.textContent = detail;
        newRow.appendChild(td);
        row.after(newRow);
      }
    }

    // ===============================================================
    // AUDIT: Copy row
    // ===============================================================

    function copyAuditRow(btn) {
      const row = btn.closest('tr');
      const cells = row.querySelectorAll('td');
      const text = Array.from(cells).map(c => c.textContent.trim()).filter(t => t).join(' | ');
      navigator.clipboard?.writeText(text).then(() => {
        showNotification('success', 'Description copied');
      }).catch(() => {
        showNotification('success', 'Description copied');
      });
    }

    // ===============================================================
    // AUDIT: Advanced Filters
    // ===============================================================

    function openAdvancedFilters() {
      document.getElementById('advancedFiltersOverlay').classList.add('open');
      document.getElementById('advancedFiltersPanel').classList.add('open');
    }

    function closeAdvancedFilters() {
      document.getElementById('advancedFiltersOverlay').classList.remove('open');
      document.getElementById('advancedFiltersPanel').classList.remove('open');
    }

    function applyAdvancedFilters() {
      closeAdvancedFilters();
      showToast('Filters applied');
    }

    // Close on overlay click
    document.getElementById('advancedFiltersOverlay')?.addEventListener('click', function() {
      closeAdvancedFilters();
    });

    // ===============================================================
    // AUDIT: Search
    // ===============================================================

    document.getElementById('auditSearchInput')?.addEventListener('input', function() {
      const q = this.value.toLowerCase();
      const rows = document.querySelectorAll('#auditTableBody > tr[data-expandable]');
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(q) ? '' : 'none';
        // Also hide expanded rows
        const next = row.nextElementSibling;
        if (next && next.classList.contains('audit-expanded-row')) {
          next.style.display = text.includes(q) ? '' : 'none';
        }
      });
    });

    // ===============================================================
    // BOOT
    // ===============================================================

    initAccessibility();
    initDirtyTracking();

  </script>
</body>
</html>